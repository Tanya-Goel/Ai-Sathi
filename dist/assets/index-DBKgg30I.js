var dC=Object.defineProperty;var OP=e=>{throw TypeError(e)};var pC=(e,s,i)=>s in e?dC(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i;var Oo=(e,s,i)=>pC(e,typeof s!="symbol"?s+"":s,i),i0=(e,s,i)=>s.has(e)||OP("Cannot "+i);var ap=(e,s,i)=>(i0(e,s,"read from private field"),i?i.call(e):s.get(e)),E_=(e,s,i)=>s.has(e)?OP("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(e):s.set(e,i),f_=(e,s,i,c)=>(i0(e,s,"write to private field"),c?c.call(e,i):s.set(e,i),i),yx=(e,s,i)=>(i0(e,s,"access private method"),i);var Nv=(e,s,i,c)=>({set _(d){f_(e,s,d,i)},get _(){return ap(e,s,c)}});function _mergeNamespaces(e,s){for(var i=0;i<s.length;i++){const c=s[i];if(typeof c!="string"&&!Array.isArray(c)){for(const d in c)if(d!=="default"&&!(d in e)){const h=Object.getOwnPropertyDescriptor(c,d);h&&Object.defineProperty(e,d,h.get?h:{enumerable:!0,get:()=>c[d]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))c(d);new MutationObserver(d=>{for(const h of d)if(h.type==="childList")for(const _ of h.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&c(_)}).observe(document,{childList:!0,subtree:!0});function i(d){const h={};return d.integrity&&(h.integrity=d.integrity),d.referrerPolicy&&(h.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?h.credentials="include":d.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function c(d){if(d.ep)return;d.ep=!0;const h=i(d);fetch(d.href,h)}})();function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r$1=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$2=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(e){return e===null||typeof e!="object"?null:(e=z$1&&e[z$1]||e["@@iterator"],typeof e=="function"?e:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$2={};function E$2(e,s,i){this.props=e,this.context=s,this.refs=D$2,this.updater=i||B$1}E$2.prototype.isReactComponent={};E$2.prototype.setState=function(e,s){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,s,"setState")};E$2.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function F$1(){}F$1.prototype=E$2.prototype;function G$1(e,s,i){this.props=e,this.context=s,this.refs=D$2,this.updater=i||B$1}var H$1=G$1.prototype=new F$1;H$1.constructor=G$1;C$1(H$1,E$2.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J$1=Object.prototype.hasOwnProperty,K$1={current:null},L$2={key:!0,ref:!0,__self:!0,__source:!0};function M$3(e,s,i){var c,d={},h=null,_=null;if(s!=null)for(c in s.ref!==void 0&&(_=s.ref),s.key!==void 0&&(h=""+s.key),s)J$1.call(s,c)&&!L$2.hasOwnProperty(c)&&(d[c]=s[c]);var g=arguments.length-2;if(g===1)d.children=i;else if(1<g){for(var $=Array(g),_e=0;_e<g;_e++)$[_e]=arguments[_e+2];d.children=$}if(e&&e.defaultProps)for(c in g=e.defaultProps,g)d[c]===void 0&&(d[c]=g[c]);return{$$typeof:l$1,type:e,key:h,ref:_,props:d,_owner:K$1.current}}function N$2(e,s){return{$$typeof:l$1,type:e.type,key:s,ref:e.ref,props:e.props,_owner:e._owner}}function O$1(e){return typeof e=="object"&&e!==null&&e.$$typeof===l$1}function escape(e){var s={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(i){return s[i]})}var P$3=/\/+/g;function Q$1(e,s){return typeof e=="object"&&e!==null&&e.key!=null?escape(""+e.key):s.toString(36)}function R$1(e,s,i,c,d){var h=typeof e;(h==="undefined"||h==="boolean")&&(e=null);var _=!1;if(e===null)_=!0;else switch(h){case"string":case"number":_=!0;break;case"object":switch(e.$$typeof){case l$1:case n$1:_=!0}}if(_)return _=e,d=d(_),e=c===""?"."+Q$1(_,0):c,I$1(d)?(i="",e!=null&&(i=e.replace(P$3,"$&/")+"/"),R$1(d,s,i,"",function(_e){return _e})):d!=null&&(O$1(d)&&(d=N$2(d,i+(!d.key||_&&_.key===d.key?"":(""+d.key).replace(P$3,"$&/")+"/")+e)),s.push(d)),1;if(_=0,c=c===""?".":c+":",I$1(e))for(var g=0;g<e.length;g++){h=e[g];var $=c+Q$1(h,g);_+=R$1(h,s,i,$,d)}else if($=A$1(e),typeof $=="function")for(e=$.call(e),g=0;!(h=e.next()).done;)h=h.value,$=c+Q$1(h,g++),_+=R$1(h,s,i,$,d);else if(h==="object")throw s=String(e),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return _}function S$1(e,s,i){if(e==null)return e;var c=[],d=0;return R$1(e,c,"","",function(h){return s.call(i,h,d++)}),c}function T$1(e){if(e._status===-1){var s=e._result;s=s(),s.then(function(i){(e._status===0||e._status===-1)&&(e._status=1,e._result=i)},function(i){(e._status===0||e._status===-1)&&(e._status=2,e._result=i)}),e._status===-1&&(e._status=0,e._result=s)}if(e._status===1)return e._result.default;throw e._result}var U$2={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$2,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$2(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$1,forEach:function(e,s,i){S$1(e,function(){s.apply(this,arguments)},i)},count:function(e){var s=0;return S$1(e,function(){s++}),s},toArray:function(e){return S$1(e,function(s){return s})||[]},only:function(e){if(!O$1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};react_production_min.Component=E$2;react_production_min.Fragment=p$2;react_production_min.Profiler=r$1;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$2;react_production_min.cloneElement=function(e,s,i){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var c=C$1({},e.props),d=e.key,h=e.ref,_=e._owner;if(s!=null){if(s.ref!==void 0&&(h=s.ref,_=K$1.current),s.key!==void 0&&(d=""+s.key),e.type&&e.type.defaultProps)var g=e.type.defaultProps;for($ in s)J$1.call(s,$)&&!L$2.hasOwnProperty($)&&(c[$]=s[$]===void 0&&g!==void 0?g[$]:s[$])}var $=arguments.length-2;if($===1)c.children=i;else if(1<$){g=Array($);for(var _e=0;_e<$;_e++)g[_e]=arguments[_e+2];c.children=g}return{$$typeof:l$1,type:e.type,key:d,ref:h,props:c,_owner:_}};react_production_min.createContext=function(e){return e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:t,_context:e},e.Consumer=e};react_production_min.createElement=M$3;react_production_min.createFactory=function(e){var s=M$3.bind(null,e);return s.type=e,s};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(e){return{$$typeof:v$2,render:e}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(e){return{$$typeof:y,_payload:{_status:-1,_result:e},_init:T$1}};react_production_min.memo=function(e,s){return{$$typeof:x,type:e,compare:s===void 0?null:s}};react_production_min.startTransition=function(e){var s=V$1.transition;V$1.transition={};try{e()}finally{V$1.transition=s}};react_production_min.unstable_act=X$2;react_production_min.useCallback=function(e,s){return U$2.current.useCallback(e,s)};react_production_min.useContext=function(e){return U$2.current.useContext(e)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(e){return U$2.current.useDeferredValue(e)};react_production_min.useEffect=function(e,s){return U$2.current.useEffect(e,s)};react_production_min.useId=function(){return U$2.current.useId()};react_production_min.useImperativeHandle=function(e,s,i){return U$2.current.useImperativeHandle(e,s,i)};react_production_min.useInsertionEffect=function(e,s){return U$2.current.useInsertionEffect(e,s)};react_production_min.useLayoutEffect=function(e,s){return U$2.current.useLayoutEffect(e,s)};react_production_min.useMemo=function(e,s){return U$2.current.useMemo(e,s)};react_production_min.useReducer=function(e,s,i){return U$2.current.useReducer(e,s,i)};react_production_min.useRef=function(e){return U$2.current.useRef(e)};react_production_min.useState=function(e){return U$2.current.useState(e)};react_production_min.useSyncExternalStore=function(e,s,i){return U$2.current.useSyncExternalStore(e,s,i)};react_production_min.useTransition=function(){return U$2.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const o=getDefaultExportFromCjs(reactExports),React=_mergeNamespaces({__proto__:null,default:o},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k$1=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(e,s,i){var c,d={},h=null,_=null;i!==void 0&&(h=""+i),s.key!==void 0&&(h=""+s.key),s.ref!==void 0&&(_=s.ref);for(c in s)m$1.call(s,c)&&!p$1.hasOwnProperty(c)&&(d[c]=s[c]);if(e&&e.defaultProps)for(c in s=e.defaultProps,s)d[c]===void 0&&(d[c]=s[c]);return{$$typeof:k$1,type:e,key:h,ref:_,props:d,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function s(bn,Sn){var fn=bn.length;bn.push(Sn);e:for(;0<fn;){var or=fn-1>>>1,lr=bn[or];if(0<d(lr,Sn))bn[or]=Sn,bn[fn]=lr,fn=or;else break e}}function i(bn){return bn.length===0?null:bn[0]}function c(bn){if(bn.length===0)return null;var Sn=bn[0],fn=bn.pop();if(fn!==Sn){bn[0]=fn;e:for(var or=0,lr=bn.length,pn=lr>>>1;or<pn;){var Cn=2*(or+1)-1,Lo=bn[Cn],Mo=Cn+1,Ro=bn[Mo];if(0>d(Lo,fn))Mo<lr&&0>d(Ro,Lo)?(bn[or]=Ro,bn[Mo]=fn,or=Mo):(bn[or]=Lo,bn[Cn]=fn,or=Cn);else if(Mo<lr&&0>d(Ro,fn))bn[or]=Ro,bn[Mo]=fn,or=Mo;else break e}}return Sn}function d(bn,Sn){var fn=bn.sortIndex-Sn.sortIndex;return fn!==0?fn:bn.id-Sn.id}if(typeof performance=="object"&&typeof performance.now=="function"){var h=performance;e.unstable_now=function(){return h.now()}}else{var _=Date,g=_.now();e.unstable_now=function(){return _.now()-g}}var $=[],_e=[],lt=1,at=null,it=3,ct=!1,mt=!1,pt=!1,zt=typeof setTimeout=="function"?setTimeout:null,dt=typeof clearTimeout=="function"?clearTimeout:null,ft=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function kt(bn){for(var Sn=i(_e);Sn!==null;){if(Sn.callback===null)c(_e);else if(Sn.startTime<=bn)c(_e),Sn.sortIndex=Sn.expirationTime,s($,Sn);else break;Sn=i(_e)}}function St(bn){if(pt=!1,kt(bn),!mt)if(i($)!==null)mt=!0,Tn(Lt);else{var Sn=i(_e);Sn!==null&&kn(St,Sn.startTime-bn)}}function Lt(bn,Sn){mt=!1,pt&&(pt=!1,dt(nr),nr=-1),ct=!0;var fn=it;try{for(kt(Sn),at=i($);at!==null&&(!(at.expirationTime>Sn)||bn&&!yn());){var or=at.callback;if(typeof or=="function"){at.callback=null,it=at.priorityLevel;var lr=or(at.expirationTime<=Sn);Sn=e.unstable_now(),typeof lr=="function"?at.callback=lr:at===i($)&&c($),kt(Sn)}else c($);at=i($)}if(at!==null)var pn=!0;else{var Cn=i(_e);Cn!==null&&kn(St,Cn.startTime-Sn),pn=!1}return pn}finally{at=null,it=fn,ct=!1}}var Gt=!1,Bt=null,nr=-1,cr=5,ur=-1;function yn(){return!(e.unstable_now()-ur<cr)}function hn(){if(Bt!==null){var bn=e.unstable_now();ur=bn;var Sn=!0;try{Sn=Bt(!0,bn)}finally{Sn?_n():(Gt=!1,Bt=null)}}else Gt=!1}var _n;if(typeof ft=="function")_n=function(){ft(hn)};else if(typeof MessageChannel<"u"){var gn=new MessageChannel,vn=gn.port2;gn.port1.onmessage=hn,_n=function(){vn.postMessage(null)}}else _n=function(){zt(hn,0)};function Tn(bn){Bt=bn,Gt||(Gt=!0,_n())}function kn(bn,Sn){nr=zt(function(){bn(e.unstable_now())},Sn)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(bn){bn.callback=null},e.unstable_continueExecution=function(){mt||ct||(mt=!0,Tn(Lt))},e.unstable_forceFrameRate=function(bn){0>bn||125<bn?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):cr=0<bn?Math.floor(1e3/bn):5},e.unstable_getCurrentPriorityLevel=function(){return it},e.unstable_getFirstCallbackNode=function(){return i($)},e.unstable_next=function(bn){switch(it){case 1:case 2:case 3:var Sn=3;break;default:Sn=it}var fn=it;it=Sn;try{return bn()}finally{it=fn}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(bn,Sn){switch(bn){case 1:case 2:case 3:case 4:case 5:break;default:bn=3}var fn=it;it=bn;try{return Sn()}finally{it=fn}},e.unstable_scheduleCallback=function(bn,Sn,fn){var or=e.unstable_now();switch(typeof fn=="object"&&fn!==null?(fn=fn.delay,fn=typeof fn=="number"&&0<fn?or+fn:or):fn=or,bn){case 1:var lr=-1;break;case 2:lr=250;break;case 5:lr=1073741823;break;case 4:lr=1e4;break;default:lr=5e3}return lr=fn+lr,bn={id:lt++,callback:Sn,priorityLevel:bn,startTime:fn,expirationTime:lr,sortIndex:-1},fn>or?(bn.sortIndex=fn,s(_e,bn),i($)===null&&bn===i(_e)&&(pt?(dt(nr),nr=-1):pt=!0,kn(St,fn-or))):(bn.sortIndex=lr,s($,bn),mt||ct||(mt=!0,Tn(Lt))),bn},e.unstable_shouldYield=yn,e.unstable_wrapCallback=function(bn){var Sn=it;return function(){var fn=it;it=Sn;try{return bn.apply(this,arguments)}finally{it=fn}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa$1=reactExports,ca$1=schedulerExports;function p(e){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)s+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da$1=new Set,ea$1={};function fa$1(e,s){ha$1(e,s),ha$1(e+"Capture",s)}function ha$1(e,s){for(ea$1[e]=s,e=0;e<s.length;e++)da$1.add(s[e])}var ia$1=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja$1=Object.prototype.hasOwnProperty,ka$1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la$1={},ma$1={};function oa$1(e){return ja$1.call(ma$1,e)?!0:ja$1.call(la$1,e)?!1:ka$1.test(e)?ma$1[e]=!0:(la$1[e]=!0,!1)}function pa$1(e,s,i,c){if(i!==null&&i.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return c?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qa$1(e,s,i,c){if(s===null||typeof s>"u"||pa$1(e,s,i,c))return!0;if(c)return!1;if(i!==null)switch(i.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function v$1(e,s,i,c,d,h,_){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=c,this.attributeNamespace=d,this.mustUseProperty=i,this.propertyName=e,this.type=s,this.sanitizeURL=h,this.removeEmptyString=_}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){z[e]=new v$1(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var s=e[0];z[s]=new v$1(s,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){z[e]=new v$1(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){z[e]=new v$1(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){z[e]=new v$1(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){z[e]=new v$1(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){z[e]=new v$1(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){z[e]=new v$1(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){z[e]=new v$1(e,5,!1,e.toLowerCase(),null,!1,!1)});var ra$1=/[\-:]([a-z])/g;function sa$1(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var s=e.replace(ra$1,sa$1);z[s]=new v$1(s,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var s=e.replace(ra$1,sa$1);z[s]=new v$1(s,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var s=e.replace(ra$1,sa$1);z[s]=new v$1(s,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){z[e]=new v$1(e,1,!1,e.toLowerCase(),null,!1,!1)});z.xlinkHref=new v$1("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){z[e]=new v$1(e,1,!1,e.toLowerCase(),null,!0,!0)});function ta$1(e,s,i,c){var d=z.hasOwnProperty(s)?z[s]:null;(d!==null?d.type!==0:c||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(qa$1(s,i,d,c)&&(i=null),c||d===null?oa$1(s)&&(i===null?e.removeAttribute(s):e.setAttribute(s,""+i)):d.mustUseProperty?e[d.propertyName]=i===null?d.type===3?!1:"":i:(s=d.attributeName,c=d.attributeNamespace,i===null?e.removeAttribute(s):(d=d.type,i=d===3||d===4&&i===!0?"":""+i,c?e.setAttributeNS(c,s,i):e.setAttribute(s,i))))}var ua$1=aa$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va$1=Symbol.for("react.element"),wa$1=Symbol.for("react.portal"),ya$1=Symbol.for("react.fragment"),za$1=Symbol.for("react.strict_mode"),Aa$1=Symbol.for("react.profiler"),Ba$1=Symbol.for("react.provider"),Ca$1=Symbol.for("react.context"),Da$1=Symbol.for("react.forward_ref"),Ea$1=Symbol.for("react.suspense"),Fa$1=Symbol.for("react.suspense_list"),Ga$1=Symbol.for("react.memo"),Ha$1=Symbol.for("react.lazy"),Ia$1=Symbol.for("react.offscreen"),Ja$1=Symbol.iterator;function Ka$1(e){return e===null||typeof e!="object"?null:(e=Ja$1&&e[Ja$1]||e["@@iterator"],typeof e=="function"?e:null)}var A=Object.assign,La$1;function Ma$1(e){if(La$1===void 0)try{throw Error()}catch(i){var s=i.stack.trim().match(/\n( *(at )?)/);La$1=s&&s[1]||""}return`
`+La$1+e}var Na$1=!1;function Oa$1(e,s){if(!e||Na$1)return"";Na$1=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(_e){var c=_e}Reflect.construct(e,[],s)}else{try{s.call()}catch(_e){c=_e}e.call(s.prototype)}else{try{throw Error()}catch(_e){c=_e}e()}}catch(_e){if(_e&&c&&typeof _e.stack=="string"){for(var d=_e.stack.split(`
`),h=c.stack.split(`
`),_=d.length-1,g=h.length-1;1<=_&&0<=g&&d[_]!==h[g];)g--;for(;1<=_&&0<=g;_--,g--)if(d[_]!==h[g]){if(_!==1||g!==1)do if(_--,g--,0>g||d[_]!==h[g]){var $=`
`+d[_].replace(" at new "," at ");return e.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",e.displayName)),$}while(1<=_&&0<=g);break}}}finally{Na$1=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?Ma$1(e):""}function Pa$1(e){switch(e.tag){case 5:return Ma$1(e.type);case 16:return Ma$1("Lazy");case 13:return Ma$1("Suspense");case 19:return Ma$1("SuspenseList");case 0:case 2:case 15:return e=Oa$1(e.type,!1),e;case 11:return e=Oa$1(e.type.render,!1),e;case 1:return e=Oa$1(e.type,!0),e;default:return""}}function Qa$1(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ya$1:return"Fragment";case wa$1:return"Portal";case Aa$1:return"Profiler";case za$1:return"StrictMode";case Ea$1:return"Suspense";case Fa$1:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ca$1:return(e.displayName||"Context")+".Consumer";case Ba$1:return(e._context.displayName||"Context")+".Provider";case Da$1:var s=e.render;return e=e.displayName,e||(e=s.displayName||s.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ga$1:return s=e.displayName||null,s!==null?s:Qa$1(e.type)||"Memo";case Ha$1:s=e._payload,e=e._init;try{return Qa$1(e(s))}catch{}}return null}function Ra$1(e){var s=e.type;switch(e.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=s.render,e=e.displayName||e.name||"",s.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa$1(s);case 8:return s===za$1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function Sa$1(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ta$1(e){var s=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Ua$1(e){var s=Ta$1(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,s),c=""+e[s];if(!e.hasOwnProperty(s)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var d=i.get,h=i.set;return Object.defineProperty(e,s,{configurable:!0,get:function(){return d.call(this)},set:function(_){c=""+_,h.call(this,_)}}),Object.defineProperty(e,s,{enumerable:i.enumerable}),{getValue:function(){return c},setValue:function(_){c=""+_},stopTracking:function(){e._valueTracker=null,delete e[s]}}}}function Va$1(e){e._valueTracker||(e._valueTracker=Ua$1(e))}function Wa$1(e){if(!e)return!1;var s=e._valueTracker;if(!s)return!0;var i=s.getValue(),c="";return e&&(c=Ta$1(e)?e.checked?"true":"false":e.value),e=c,e!==i?(s.setValue(e),!0):!1}function Xa$1(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ya(e,s){var i=s.checked;return A({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function Za$1(e,s){var i=s.defaultValue==null?"":s.defaultValue,c=s.checked!=null?s.checked:s.defaultChecked;i=Sa$1(s.value!=null?s.value:i),e._wrapperState={initialChecked:c,initialValue:i,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function ab(e,s){s=s.checked,s!=null&&ta$1(e,"checked",s,!1)}function bb(e,s){ab(e,s);var i=Sa$1(s.value),c=s.type;if(i!=null)c==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(c==="submit"||c==="reset"){e.removeAttribute("value");return}s.hasOwnProperty("value")?cb(e,s.type,i):s.hasOwnProperty("defaultValue")&&cb(e,s.type,Sa$1(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(e.defaultChecked=!!s.defaultChecked)}function db(e,s,i){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var c=s.type;if(!(c!=="submit"&&c!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+e._wrapperState.initialValue,i||s===e.value||(e.value=s),e.defaultValue=s}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function cb(e,s,i){(s!=="number"||Xa$1(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var eb=Array.isArray;function fb(e,s,i,c){if(e=e.options,s){s={};for(var d=0;d<i.length;d++)s["$"+i[d]]=!0;for(i=0;i<e.length;i++)d=s.hasOwnProperty("$"+e[i].value),e[i].selected!==d&&(e[i].selected=d),d&&c&&(e[i].defaultSelected=!0)}else{for(i=""+Sa$1(i),s=null,d=0;d<e.length;d++){if(e[d].value===i){e[d].selected=!0,c&&(e[d].defaultSelected=!0);return}s!==null||e[d].disabled||(s=e[d])}s!==null&&(s.selected=!0)}}function gb(e,s){if(s.dangerouslySetInnerHTML!=null)throw Error(p(91));return A({},s,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hb(e,s){var i=s.value;if(i==null){if(i=s.children,s=s.defaultValue,i!=null){if(s!=null)throw Error(p(92));if(eb(i)){if(1<i.length)throw Error(p(93));i=i[0]}s=i}s==null&&(s=""),i=s}e._wrapperState={initialValue:Sa$1(i)}}function ib(e,s){var i=Sa$1(s.value),c=Sa$1(s.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),s.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),c!=null&&(e.defaultValue=""+c)}function jb(e){var s=e.textContent;s===e._wrapperState.initialValue&&s!==""&&s!==null&&(e.value=s)}function kb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(e,s){return e==null||e==="http://www.w3.org/1999/xhtml"?kb(s):e==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mb,nb=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,i,c,d){MSApp.execUnsafeLocalFunction(function(){return e(s,i,c,d)})}:e}(function(e,s){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=s;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=mb.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;s.firstChild;)e.appendChild(s.firstChild)}});function ob(e,s){if(s){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=s;return}}e.textContent=s}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(e){qb.forEach(function(s){s=s+e.charAt(0).toUpperCase()+e.substring(1),pb[s]=pb[e]})});function rb(e,s,i){return s==null||typeof s=="boolean"||s===""?"":i||typeof s!="number"||s===0||pb.hasOwnProperty(e)&&pb[e]?(""+s).trim():s+"px"}function sb(e,s){e=e.style;for(var i in s)if(s.hasOwnProperty(i)){var c=i.indexOf("--")===0,d=rb(i,s[i],c);i==="float"&&(i="cssFloat"),c?e.setProperty(i,d):e[i]=d}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(e,s){if(s){if(tb[e]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(p(137,e));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(p(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(p(61))}if(s.style!=null&&typeof s.style!="object")throw Error(p(62))}}function vb(e,s){if(e.indexOf("-")===-1)return typeof s.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yb=null,zb=null,Ab=null;function Bb(e){if(e=Cb(e)){if(typeof yb!="function")throw Error(p(280));var s=e.stateNode;s&&(s=Db(s),yb(e.stateNode,e.type,s))}}function Eb(e){zb?Ab?Ab.push(e):Ab=[e]:zb=e}function Fb(){if(zb){var e=zb,s=Ab;if(Ab=zb=null,Bb(e),s)for(e=0;e<s.length;e++)Bb(s[e])}}function Gb(e,s){return e(s)}function Hb(){}var Ib=!1;function Jb(e,s,i){if(Ib)return e(s,i);Ib=!0;try{return Gb(e,s,i)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(e,s){var i=e.stateNode;if(i===null)return null;var c=Db(i);if(c===null)return null;i=c[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(e=e.type,c=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!c;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(p(231,s,typeof i));return i}var Lb=!1;if(ia$1)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(e,s,i,c,d,h,_,g,$){var _e=Array.prototype.slice.call(arguments,3);try{s.apply(i,_e)}catch(lt){this.onError(lt)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(e){Ob=!0,Pb=e}};function Tb(e,s,i,c,d,h,_,g,$){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(e,s,i,c,d,h,_,g,$){if(Tb.apply(this,arguments),Ob){if(Ob){var _e=Pb;Ob=!1,Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=_e)}}function Vb(e){var s=e,i=e;if(e.alternate)for(;s.return;)s=s.return;else{e=s;do s=e,s.flags&4098&&(i=s.return),e=s.return;while(e)}return s.tag===3?i:null}function Wb(e){if(e.tag===13){var s=e.memoizedState;if(s===null&&(e=e.alternate,e!==null&&(s=e.memoizedState)),s!==null)return s.dehydrated}return null}function Xb(e){if(Vb(e)!==e)throw Error(p(188))}function Yb(e){var s=e.alternate;if(!s){if(s=Vb(e),s===null)throw Error(p(188));return s!==e?null:e}for(var i=e,c=s;;){var d=i.return;if(d===null)break;var h=d.alternate;if(h===null){if(c=d.return,c!==null){i=c;continue}break}if(d.child===h.child){for(h=d.child;h;){if(h===i)return Xb(d),e;if(h===c)return Xb(d),s;h=h.sibling}throw Error(p(188))}if(i.return!==c.return)i=d,c=h;else{for(var _=!1,g=d.child;g;){if(g===i){_=!0,i=d,c=h;break}if(g===c){_=!0,c=d,i=h;break}g=g.sibling}if(!_){for(g=h.child;g;){if(g===i){_=!0,i=h,c=d;break}if(g===c){_=!0,c=h,i=d;break}g=g.sibling}if(!_)throw Error(p(189))}}if(i.alternate!==c)throw Error(p(190))}if(i.tag!==3)throw Error(p(188));return i.stateNode.current===i?e:s}function Zb(e){return e=Yb(e),e!==null?$b(e):null}function $b(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var s=$b(e);if(s!==null)return s;e=e.sibling}return null}var ac$1=ca$1.unstable_scheduleCallback,bc=ca$1.unstable_cancelCallback,cc$1=ca$1.unstable_shouldYield,dc$1=ca$1.unstable_requestPaint,B=ca$1.unstable_now,ec$1=ca$1.unstable_getCurrentPriorityLevel,fc$1=ca$1.unstable_ImmediatePriority,gc$1=ca$1.unstable_UserBlockingPriority,hc$1=ca$1.unstable_NormalPriority,ic$1=ca$1.unstable_LowPriority,jc=ca$1.unstable_IdlePriority,kc=null,lc$1=null;function mc$1(e){if(lc$1&&typeof lc$1.onCommitFiberRoot=="function")try{lc$1.onCommitFiberRoot(kc,e,void 0,(e.current.flags&128)===128)}catch{}}var oc$1=Math.clz32?Math.clz32:nc$1,pc$1=Math.log,qc=Math.LN2;function nc$1(e){return e>>>=0,e===0?32:31-(pc$1(e)/qc|0)|0}var rc$1=64,sc$1=4194304;function tc$1(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function uc$1(e,s){var i=e.pendingLanes;if(i===0)return 0;var c=0,d=e.suspendedLanes,h=e.pingedLanes,_=i&268435455;if(_!==0){var g=_&~d;g!==0?c=tc$1(g):(h&=_,h!==0&&(c=tc$1(h)))}else _=i&~d,_!==0?c=tc$1(_):h!==0&&(c=tc$1(h));if(c===0)return 0;if(s!==0&&s!==c&&!(s&d)&&(d=c&-c,h=s&-s,d>=h||d===16&&(h&4194240)!==0))return s;if(c&4&&(c|=i&16),s=e.entangledLanes,s!==0)for(e=e.entanglements,s&=c;0<s;)i=31-oc$1(s),d=1<<i,c|=e[i],s&=~d;return c}function vc(e,s){switch(e){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(e,s){for(var i=e.suspendedLanes,c=e.pingedLanes,d=e.expirationTimes,h=e.pendingLanes;0<h;){var _=31-oc$1(h),g=1<<_,$=d[_];$===-1?(!(g&i)||g&c)&&(d[_]=vc(g,s)):$<=s&&(e.expiredLanes|=g),h&=~g}}function xc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function yc(){var e=rc$1;return rc$1<<=1,!(rc$1&4194240)&&(rc$1=64),e}function zc(e){for(var s=[],i=0;31>i;i++)s.push(e);return s}function Ac(e,s,i){e.pendingLanes|=s,s!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,s=31-oc$1(s),e[s]=i}function Bc(e,s){var i=e.pendingLanes&~s;e.pendingLanes=s,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=s,e.mutableReadLanes&=s,e.entangledLanes&=s,s=e.entanglements;var c=e.eventTimes;for(e=e.expirationTimes;0<i;){var d=31-oc$1(i),h=1<<d;s[d]=0,c[d]=-1,e[d]=-1,i&=~h}}function Cc(e,s){var i=e.entangledLanes|=s;for(e=e.entanglements;i;){var c=31-oc$1(i),d=1<<c;d&s|e[c]&s&&(e[c]|=s),i&=~d}}var C=0;function Dc(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(e,s){switch(e){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(s.pointerId)}}function Tc(e,s,i,c,d,h){return e===null||e.nativeEvent!==h?(e={blockedOn:s,domEventName:i,eventSystemFlags:c,nativeEvent:h,targetContainers:[d]},s!==null&&(s=Cb(s),s!==null&&Fc(s)),e):(e.eventSystemFlags|=c,s=e.targetContainers,d!==null&&s.indexOf(d)===-1&&s.push(d),e)}function Uc(e,s,i,c,d){switch(s){case"focusin":return Lc=Tc(Lc,e,s,i,c,d),!0;case"dragenter":return Mc=Tc(Mc,e,s,i,c,d),!0;case"mouseover":return Nc=Tc(Nc,e,s,i,c,d),!0;case"pointerover":var h=d.pointerId;return Oc.set(h,Tc(Oc.get(h)||null,e,s,i,c,d)),!0;case"gotpointercapture":return h=d.pointerId,Pc.set(h,Tc(Pc.get(h)||null,e,s,i,c,d)),!0}return!1}function Vc(e){var s=Wc(e.target);if(s!==null){var i=Vb(s);if(i!==null){if(s=i.tag,s===13){if(s=Wb(i),s!==null){e.blockedOn=s,Ic(e.priority,function(){Gc(i)});return}}else if(s===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xc(e){if(e.blockedOn!==null)return!1;for(var s=e.targetContainers;0<s.length;){var i=Yc(e.domEventName,e.eventSystemFlags,s[0],e.nativeEvent);if(i===null){i=e.nativeEvent;var c=new i.constructor(i.type,i);wb=c,i.target.dispatchEvent(c),wb=null}else return s=Cb(i),s!==null&&Fc(s),e.blockedOn=i,!1;s.shift()}return!0}function Zc(e,s,i){Xc(e)&&i.delete(s)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad$1(e,s){e.blockedOn===s&&(e.blockedOn=null,Jc||(Jc=!0,ca$1.unstable_scheduleCallback(ca$1.unstable_NormalPriority,$c)))}function bd$1(e){function s(d){return ad$1(d,e)}if(0<Kc.length){ad$1(Kc[0],e);for(var i=1;i<Kc.length;i++){var c=Kc[i];c.blockedOn===e&&(c.blockedOn=null)}}for(Lc!==null&&ad$1(Lc,e),Mc!==null&&ad$1(Mc,e),Nc!==null&&ad$1(Nc,e),Oc.forEach(s),Pc.forEach(s),i=0;i<Qc.length;i++)c=Qc[i],c.blockedOn===e&&(c.blockedOn=null);for(;0<Qc.length&&(i=Qc[0],i.blockedOn===null);)Vc(i),i.blockedOn===null&&Qc.shift()}var cd$1=ua$1.ReactCurrentBatchConfig,dd$1=!0;function ed$1(e,s,i,c){var d=C,h=cd$1.transition;cd$1.transition=null;try{C=1,fd$1(e,s,i,c)}finally{C=d,cd$1.transition=h}}function gd$1(e,s,i,c){var d=C,h=cd$1.transition;cd$1.transition=null;try{C=4,fd$1(e,s,i,c)}finally{C=d,cd$1.transition=h}}function fd$1(e,s,i,c){if(dd$1){var d=Yc(e,s,i,c);if(d===null)hd$1(e,s,c,id$1,i),Sc(e,c);else if(Uc(d,e,s,i,c))c.stopPropagation();else if(Sc(e,c),s&4&&-1<Rc.indexOf(e)){for(;d!==null;){var h=Cb(d);if(h!==null&&Ec(h),h=Yc(e,s,i,c),h===null&&hd$1(e,s,c,id$1,i),h===d)break;d=h}d!==null&&c.stopPropagation()}else hd$1(e,s,c,null,i)}}var id$1=null;function Yc(e,s,i,c){if(id$1=null,e=xb(c),e=Wc(e),e!==null)if(s=Vb(e),s===null)e=null;else if(i=s.tag,i===13){if(e=Wb(s),e!==null)return e;e=null}else if(i===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;e=null}else s!==e&&(e=null);return id$1=e,null}function jd$1(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec$1()){case fc$1:return 1;case gc$1:return 4;case hc$1:case ic$1:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd$1=null,ld$1=null,md$1=null;function nd$1(){if(md$1)return md$1;var e,s=ld$1,i=s.length,c,d="value"in kd$1?kd$1.value:kd$1.textContent,h=d.length;for(e=0;e<i&&s[e]===d[e];e++);var _=i-e;for(c=1;c<=_&&s[i-c]===d[h-c];c++);return md$1=d.slice(e,1<c?1-c:void 0)}function od$1(e){var s=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&s===13&&(e=13)):e=s,e===10&&(e=13),32<=e||e===13?e:0}function pd$1(){return!0}function qd$1(){return!1}function rd$1(e){function s(i,c,d,h,_){this._reactName=i,this._targetInst=d,this.type=c,this.nativeEvent=h,this.target=_,this.currentTarget=null;for(var g in e)e.hasOwnProperty(g)&&(i=e[g],this[g]=i?i(h):h[g]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?pd$1:qd$1,this.isPropagationStopped=qd$1,this}return A(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=pd$1)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=pd$1)},persist:function(){},isPersistent:pd$1}),s}var sd$1={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td$1=rd$1(sd$1),ud$1=A({},sd$1,{view:0,detail:0}),vd$1=rd$1(ud$1),wd$1,xd$1,yd$1,Ad$1=A({},ud$1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd$1,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yd$1&&(yd$1&&e.type==="mousemove"?(wd$1=e.screenX-yd$1.screenX,xd$1=e.screenY-yd$1.screenY):xd$1=wd$1=0,yd$1=e),wd$1)},movementY:function(e){return"movementY"in e?e.movementY:xd$1}}),Bd$1=rd$1(Ad$1),Cd$1=A({},Ad$1,{dataTransfer:0}),Dd$1=rd$1(Cd$1),Ed$1=A({},ud$1,{relatedTarget:0}),Fd$1=rd$1(Ed$1),Gd$1=A({},sd$1,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd$1=rd$1(Gd$1),Id$1=A({},sd$1,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jd$1=rd$1(Id$1),Kd$1=A({},sd$1,{data:0}),Ld$1=rd$1(Kd$1),Md$1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd$1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od$1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd$1(e){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(e):(e=Od$1[e])?!!s[e]:!1}function zd$1(){return Pd$1}var Qd$1=A({},ud$1,{key:function(e){if(e.key){var s=Md$1[e.key]||e.key;if(s!=="Unidentified")return s}return e.type==="keypress"?(e=od$1(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Nd$1[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd$1,charCode:function(e){return e.type==="keypress"?od$1(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?od$1(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Rd$1=rd$1(Qd$1),Sd$1=A({},Ad$1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td$1=rd$1(Sd$1),Ud$1=A({},ud$1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd$1}),Vd$1=rd$1(Ud$1),Wd$1=A({},sd$1,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd$1=rd$1(Wd$1),Yd$1=A({},Ad$1,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd$1=rd$1(Yd$1),$d$1=[9,13,27,32],ae$1=ia$1&&"CompositionEvent"in window,be$2=null;ia$1&&"documentMode"in document&&(be$2=document.documentMode);var ce$2=ia$1&&"TextEvent"in window&&!be$2,de$1=ia$1&&(!ae$1||be$2&&8<be$2&&11>=be$2),ee$2=" ",fe$1=!1;function ge$2(e,s){switch(e){case"keyup":return $d$1.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he$1(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ie$2=!1;function je$1(e,s){switch(e){case"compositionend":return he$1(s);case"keypress":return s.which!==32?null:(fe$1=!0,ee$2);case"textInput":return e=s.data,e===ee$2&&fe$1?null:e;default:return null}}function ke(e,s){if(ie$2)return e==="compositionend"||!ae$1&&ge$2(e,s)?(e=nd$1(),md$1=ld$1=kd$1=null,ie$2=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return de$1&&s.locale!=="ko"?null:s.data;default:return null}}var le$1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me$2(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s==="input"?!!le$1[e.type]:s==="textarea"}function ne$2(e,s,i,c){Eb(c),s=oe$1(s,"onChange"),0<s.length&&(i=new td$1("onChange","change",null,i,c),e.push({event:i,listeners:s}))}var pe$2=null,qe$1=null;function re(e){se$2(e,0)}function te$1(e){var s=ue$1(e);if(Wa$1(s))return e}function ve$1(e,s){if(e==="change")return s}var we$1=!1;if(ia$1){var xe$1;if(ia$1){var ye$1="oninput"in document;if(!ye$1){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye$1=typeof ze.oninput=="function"}xe$1=ye$1}else xe$1=!1;we$1=xe$1&&(!document.documentMode||9<document.documentMode)}function Ae$1(){pe$2&&(pe$2.detachEvent("onpropertychange",Be$1),qe$1=pe$2=null)}function Be$1(e){if(e.propertyName==="value"&&te$1(qe$1)){var s=[];ne$2(s,qe$1,e,xb(e)),Jb(re,s)}}function Ce(e,s,i){e==="focusin"?(Ae$1(),pe$2=s,qe$1=i,pe$2.attachEvent("onpropertychange",Be$1)):e==="focusout"&&Ae$1()}function De(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return te$1(qe$1)}function Ee$1(e,s){if(e==="click")return te$1(s)}function Fe$1(e,s){if(e==="input"||e==="change")return te$1(s)}function Ge$1(e,s){return e===s&&(e!==0||1/e===1/s)||e!==e&&s!==s}var He$1=typeof Object.is=="function"?Object.is:Ge$1;function Ie$1(e,s){if(He$1(e,s))return!0;if(typeof e!="object"||e===null||typeof s!="object"||s===null)return!1;var i=Object.keys(e),c=Object.keys(s);if(i.length!==c.length)return!1;for(c=0;c<i.length;c++){var d=i[c];if(!ja$1.call(s,d)||!He$1(e[d],s[d]))return!1}return!0}function Je$1(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ke(e,s){var i=Je$1(e);e=0;for(var c;i;){if(i.nodeType===3){if(c=e+i.textContent.length,e<=s&&c>=s)return{node:i,offset:s-e};e=c}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Je$1(i)}}function Le$1(e,s){return e&&s?e===s?!0:e&&e.nodeType===3?!1:s&&s.nodeType===3?Le$1(e,s.parentNode):"contains"in e?e.contains(s):e.compareDocumentPosition?!!(e.compareDocumentPosition(s)&16):!1:!1}function Me$1(){for(var e=window,s=Xa$1();s instanceof e.HTMLIFrameElement;){try{var i=typeof s.contentWindow.location.href=="string"}catch{i=!1}if(i)e=s.contentWindow;else break;s=Xa$1(e.document)}return s}function Ne$1(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s&&(s==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||s==="textarea"||e.contentEditable==="true")}function Oe$1(e){var s=Me$1(),i=e.focusedElem,c=e.selectionRange;if(s!==i&&i&&i.ownerDocument&&Le$1(i.ownerDocument.documentElement,i)){if(c!==null&&Ne$1(i)){if(s=c.start,e=c.end,e===void 0&&(e=s),"selectionStart"in i)i.selectionStart=s,i.selectionEnd=Math.min(e,i.value.length);else if(e=(s=i.ownerDocument||document)&&s.defaultView||window,e.getSelection){e=e.getSelection();var d=i.textContent.length,h=Math.min(c.start,d);c=c.end===void 0?h:Math.min(c.end,d),!e.extend&&h>c&&(d=c,c=h,h=d),d=Ke(i,h);var _=Ke(i,c);d&&_&&(e.rangeCount!==1||e.anchorNode!==d.node||e.anchorOffset!==d.offset||e.focusNode!==_.node||e.focusOffset!==_.offset)&&(s=s.createRange(),s.setStart(d.node,d.offset),e.removeAllRanges(),h>c?(e.addRange(s),e.extend(_.node,_.offset)):(s.setEnd(_.node,_.offset),e.addRange(s)))}}for(s=[],e=i;e=e.parentNode;)e.nodeType===1&&s.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<s.length;i++)e=s[i],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Pe$1=ia$1&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re$1=null,Se$1=null,Te$1=!1;function Ue$1(e,s,i){var c=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Te$1||Qe==null||Qe!==Xa$1(c)||(c=Qe,"selectionStart"in c&&Ne$1(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Se$1&&Ie$1(Se$1,c)||(Se$1=c,c=oe$1(Re$1,"onSelect"),0<c.length&&(s=new td$1("onSelect","select",null,s,i),e.push({event:s,listeners:c}),s.target=Qe)))}function Ve(e,s){var i={};return i[e.toLowerCase()]=s.toLowerCase(),i["Webkit"+e]="webkit"+s,i["Moz"+e]="moz"+s,i}var We$1={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe$1={},Ye$1={};ia$1&&(Ye$1=document.createElement("div").style,"AnimationEvent"in window||(delete We$1.animationend.animation,delete We$1.animationiteration.animation,delete We$1.animationstart.animation),"TransitionEvent"in window||delete We$1.transitionend.transition);function Ze(e){if(Xe$1[e])return Xe$1[e];if(!We$1[e])return e;var s=We$1[e],i;for(i in s)if(s.hasOwnProperty(i)&&i in Ye$1)return Xe$1[e]=s[i];return e}var $e$1=Ze("animationend"),af$1=Ze("animationiteration"),bf$1=Ze("animationstart"),cf$1=Ze("transitionend"),df$1=new Map,ef$1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff$1(e,s){df$1.set(e,s),fa$1(s,[e])}for(var gf$1=0;gf$1<ef$1.length;gf$1++){var hf$1=ef$1[gf$1],jf$1=hf$1.toLowerCase(),kf$1=hf$1[0].toUpperCase()+hf$1.slice(1);ff$1(jf$1,"on"+kf$1)}ff$1($e$1,"onAnimationEnd");ff$1(af$1,"onAnimationIteration");ff$1(bf$1,"onAnimationStart");ff$1("dblclick","onDoubleClick");ff$1("focusin","onFocus");ff$1("focusout","onBlur");ff$1(cf$1,"onTransitionEnd");ha$1("onMouseEnter",["mouseout","mouseover"]);ha$1("onMouseLeave",["mouseout","mouseover"]);ha$1("onPointerEnter",["pointerout","pointerover"]);ha$1("onPointerLeave",["pointerout","pointerover"]);fa$1("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa$1("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa$1("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa$1("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa$1("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa$1("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf$1="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf$1=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf$1));function nf$1(e,s,i){var c=e.type||"unknown-event";e.currentTarget=i,Ub(c,s,void 0,e),e.currentTarget=null}function se$2(e,s){s=(s&4)!==0;for(var i=0;i<e.length;i++){var c=e[i],d=c.event;c=c.listeners;e:{var h=void 0;if(s)for(var _=c.length-1;0<=_;_--){var g=c[_],$=g.instance,_e=g.currentTarget;if(g=g.listener,$!==h&&d.isPropagationStopped())break e;nf$1(d,g,_e),h=$}else for(_=0;_<c.length;_++){if(g=c[_],$=g.instance,_e=g.currentTarget,g=g.listener,$!==h&&d.isPropagationStopped())break e;nf$1(d,g,_e),h=$}}}if(Qb)throw e=Rb,Qb=!1,Rb=null,e}function D$1(e,s){var i=s[of$1];i===void 0&&(i=s[of$1]=new Set);var c=e+"__bubble";i.has(c)||(pf$1(s,e,2,!1),i.add(c))}function qf$1(e,s,i){var c=0;s&&(c|=4),pf$1(i,e,c,s)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf$1(e){if(!e[rf]){e[rf]=!0,da$1.forEach(function(i){i!=="selectionchange"&&(mf$1.has(i)||qf$1(i,!1,e),qf$1(i,!0,e))});var s=e.nodeType===9?e:e.ownerDocument;s===null||s[rf]||(s[rf]=!0,qf$1("selectionchange",!1,s))}}function pf$1(e,s,i,c){switch(jd$1(s)){case 1:var d=ed$1;break;case 4:d=gd$1;break;default:d=fd$1}i=d.bind(null,s,i,e),d=void 0,!Lb||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(d=!0),c?d!==void 0?e.addEventListener(s,i,{capture:!0,passive:d}):e.addEventListener(s,i,!0):d!==void 0?e.addEventListener(s,i,{passive:d}):e.addEventListener(s,i,!1)}function hd$1(e,s,i,c,d){var h=c;if(!(s&1)&&!(s&2)&&c!==null)e:for(;;){if(c===null)return;var _=c.tag;if(_===3||_===4){var g=c.stateNode.containerInfo;if(g===d||g.nodeType===8&&g.parentNode===d)break;if(_===4)for(_=c.return;_!==null;){var $=_.tag;if(($===3||$===4)&&($=_.stateNode.containerInfo,$===d||$.nodeType===8&&$.parentNode===d))return;_=_.return}for(;g!==null;){if(_=Wc(g),_===null)return;if($=_.tag,$===5||$===6){c=h=_;continue e}g=g.parentNode}}c=c.return}Jb(function(){var _e=h,lt=xb(i),at=[];e:{var it=df$1.get(e);if(it!==void 0){var ct=td$1,mt=e;switch(e){case"keypress":if(od$1(i)===0)break e;case"keydown":case"keyup":ct=Rd$1;break;case"focusin":mt="focus",ct=Fd$1;break;case"focusout":mt="blur",ct=Fd$1;break;case"beforeblur":case"afterblur":ct=Fd$1;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ct=Bd$1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ct=Dd$1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ct=Vd$1;break;case $e$1:case af$1:case bf$1:ct=Hd$1;break;case cf$1:ct=Xd$1;break;case"scroll":ct=vd$1;break;case"wheel":ct=Zd$1;break;case"copy":case"cut":case"paste":ct=Jd$1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ct=Td$1}var pt=(s&4)!==0,zt=!pt&&e==="scroll",dt=pt?it!==null?it+"Capture":null:it;pt=[];for(var ft=_e,kt;ft!==null;){kt=ft;var St=kt.stateNode;if(kt.tag===5&&St!==null&&(kt=St,dt!==null&&(St=Kb(ft,dt),St!=null&&pt.push(tf$1(ft,St,kt)))),zt)break;ft=ft.return}0<pt.length&&(it=new ct(it,mt,null,i,lt),at.push({event:it,listeners:pt}))}}if(!(s&7)){e:{if(it=e==="mouseover"||e==="pointerover",ct=e==="mouseout"||e==="pointerout",it&&i!==wb&&(mt=i.relatedTarget||i.fromElement)&&(Wc(mt)||mt[uf$1]))break e;if((ct||it)&&(it=lt.window===lt?lt:(it=lt.ownerDocument)?it.defaultView||it.parentWindow:window,ct?(mt=i.relatedTarget||i.toElement,ct=_e,mt=mt?Wc(mt):null,mt!==null&&(zt=Vb(mt),mt!==zt||mt.tag!==5&&mt.tag!==6)&&(mt=null)):(ct=null,mt=_e),ct!==mt)){if(pt=Bd$1,St="onMouseLeave",dt="onMouseEnter",ft="mouse",(e==="pointerout"||e==="pointerover")&&(pt=Td$1,St="onPointerLeave",dt="onPointerEnter",ft="pointer"),zt=ct==null?it:ue$1(ct),kt=mt==null?it:ue$1(mt),it=new pt(St,ft+"leave",ct,i,lt),it.target=zt,it.relatedTarget=kt,St=null,Wc(lt)===_e&&(pt=new pt(dt,ft+"enter",mt,i,lt),pt.target=kt,pt.relatedTarget=zt,St=pt),zt=St,ct&&mt)t:{for(pt=ct,dt=mt,ft=0,kt=pt;kt;kt=vf$1(kt))ft++;for(kt=0,St=dt;St;St=vf$1(St))kt++;for(;0<ft-kt;)pt=vf$1(pt),ft--;for(;0<kt-ft;)dt=vf$1(dt),kt--;for(;ft--;){if(pt===dt||dt!==null&&pt===dt.alternate)break t;pt=vf$1(pt),dt=vf$1(dt)}pt=null}else pt=null;ct!==null&&wf$1(at,it,ct,pt,!1),mt!==null&&zt!==null&&wf$1(at,zt,mt,pt,!0)}}e:{if(it=_e?ue$1(_e):window,ct=it.nodeName&&it.nodeName.toLowerCase(),ct==="select"||ct==="input"&&it.type==="file")var Lt=ve$1;else if(me$2(it))if(we$1)Lt=Fe$1;else{Lt=De;var Gt=Ce}else(ct=it.nodeName)&&ct.toLowerCase()==="input"&&(it.type==="checkbox"||it.type==="radio")&&(Lt=Ee$1);if(Lt&&(Lt=Lt(e,_e))){ne$2(at,Lt,i,lt);break e}Gt&&Gt(e,it,_e),e==="focusout"&&(Gt=it._wrapperState)&&Gt.controlled&&it.type==="number"&&cb(it,"number",it.value)}switch(Gt=_e?ue$1(_e):window,e){case"focusin":(me$2(Gt)||Gt.contentEditable==="true")&&(Qe=Gt,Re$1=_e,Se$1=null);break;case"focusout":Se$1=Re$1=Qe=null;break;case"mousedown":Te$1=!0;break;case"contextmenu":case"mouseup":case"dragend":Te$1=!1,Ue$1(at,i,lt);break;case"selectionchange":if(Pe$1)break;case"keydown":case"keyup":Ue$1(at,i,lt)}var Bt;if(ae$1)e:{switch(e){case"compositionstart":var nr="onCompositionStart";break e;case"compositionend":nr="onCompositionEnd";break e;case"compositionupdate":nr="onCompositionUpdate";break e}nr=void 0}else ie$2?ge$2(e,i)&&(nr="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(nr="onCompositionStart");nr&&(de$1&&i.locale!=="ko"&&(ie$2||nr!=="onCompositionStart"?nr==="onCompositionEnd"&&ie$2&&(Bt=nd$1()):(kd$1=lt,ld$1="value"in kd$1?kd$1.value:kd$1.textContent,ie$2=!0)),Gt=oe$1(_e,nr),0<Gt.length&&(nr=new Ld$1(nr,e,null,i,lt),at.push({event:nr,listeners:Gt}),Bt?nr.data=Bt:(Bt=he$1(i),Bt!==null&&(nr.data=Bt)))),(Bt=ce$2?je$1(e,i):ke(e,i))&&(_e=oe$1(_e,"onBeforeInput"),0<_e.length&&(lt=new Ld$1("onBeforeInput","beforeinput",null,i,lt),at.push({event:lt,listeners:_e}),lt.data=Bt))}se$2(at,s)})}function tf$1(e,s,i){return{instance:e,listener:s,currentTarget:i}}function oe$1(e,s){for(var i=s+"Capture",c=[];e!==null;){var d=e,h=d.stateNode;d.tag===5&&h!==null&&(d=h,h=Kb(e,i),h!=null&&c.unshift(tf$1(e,h,d)),h=Kb(e,s),h!=null&&c.push(tf$1(e,h,d))),e=e.return}return c}function vf$1(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function wf$1(e,s,i,c,d){for(var h=s._reactName,_=[];i!==null&&i!==c;){var g=i,$=g.alternate,_e=g.stateNode;if($!==null&&$===c)break;g.tag===5&&_e!==null&&(g=_e,d?($=Kb(i,h),$!=null&&_.unshift(tf$1(i,$,g))):d||($=Kb(i,h),$!=null&&_.push(tf$1(i,$,g)))),i=i.return}_.length!==0&&e.push({event:s,listeners:_})}var xf$1=/\r\n?/g,yf$1=/\u0000|\uFFFD/g;function zf$1(e){return(typeof e=="string"?e:""+e).replace(xf$1,`
`).replace(yf$1,"")}function Af$1(e,s,i){if(s=zf$1(s),zf$1(e)!==s&&i)throw Error(p(425))}function Bf$1(){}var Cf$1=null,Df$1=null;function Ef$1(e,s){return e==="textarea"||e==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Ff$1=typeof setTimeout=="function"?setTimeout:void 0,Gf$1=typeof clearTimeout=="function"?clearTimeout:void 0,Hf$1=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf$1<"u"?function(e){return Hf$1.resolve(null).then(e).catch(If$1)}:Ff$1;function If$1(e){setTimeout(function(){throw e})}function Kf$1(e,s){var i=s,c=0;do{var d=i.nextSibling;if(e.removeChild(i),d&&d.nodeType===8)if(i=d.data,i==="/$"){if(c===0){e.removeChild(d),bd$1(s);return}c--}else i!=="$"&&i!=="$?"&&i!=="$!"||c++;i=d}while(i);bd$1(s)}function Lf$1(e){for(;e!=null;e=e.nextSibling){var s=e.nodeType;if(s===1||s===3)break;if(s===8){if(s=e.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return e}function Mf$1(e){e=e.previousSibling;for(var s=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(s===0)return e;s--}else i==="/$"&&s++}e=e.previousSibling}return null}var Nf$1=Math.random().toString(36).slice(2),Of$1="__reactFiber$"+Nf$1,Pf$1="__reactProps$"+Nf$1,uf$1="__reactContainer$"+Nf$1,of$1="__reactEvents$"+Nf$1,Qf$1="__reactListeners$"+Nf$1,Rf$1="__reactHandles$"+Nf$1;function Wc(e){var s=e[Of$1];if(s)return s;for(var i=e.parentNode;i;){if(s=i[uf$1]||i[Of$1]){if(i=s.alternate,s.child!==null||i!==null&&i.child!==null)for(e=Mf$1(e);e!==null;){if(i=e[Of$1])return i;e=Mf$1(e)}return s}e=i,i=e.parentNode}return null}function Cb(e){return e=e[Of$1]||e[uf$1],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ue$1(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(p(33))}function Db(e){return e[Pf$1]||null}var Sf$1=[],Tf$1=-1;function Uf$1(e){return{current:e}}function E$1(e){0>Tf$1||(e.current=Sf$1[Tf$1],Sf$1[Tf$1]=null,Tf$1--)}function G(e,s){Tf$1++,Sf$1[Tf$1]=e.current,e.current=s}var Vf$1={},H=Uf$1(Vf$1),Wf$1=Uf$1(!1),Xf$1=Vf$1;function Yf$1(e,s){var i=e.type.contextTypes;if(!i)return Vf$1;var c=e.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===s)return c.__reactInternalMemoizedMaskedChildContext;var d={},h;for(h in i)d[h]=s[h];return c&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=d),d}function Zf$1(e){return e=e.childContextTypes,e!=null}function $f$1(){E$1(Wf$1),E$1(H)}function ag$1(e,s,i){if(H.current!==Vf$1)throw Error(p(168));G(H,s),G(Wf$1,i)}function bg$1(e,s,i){var c=e.stateNode;if(s=s.childContextTypes,typeof c.getChildContext!="function")return i;c=c.getChildContext();for(var d in c)if(!(d in s))throw Error(p(108,Ra$1(e)||"Unknown",d));return A({},i,c)}function cg$1(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vf$1,Xf$1=H.current,G(H,e),G(Wf$1,Wf$1.current),!0}function dg$1(e,s,i){var c=e.stateNode;if(!c)throw Error(p(169));i?(e=bg$1(e,s,Xf$1),c.__reactInternalMemoizedMergedChildContext=e,E$1(Wf$1),E$1(H),G(H,e)):E$1(Wf$1),G(Wf$1,i)}var eg$1=null,fg$1=!1,gg=!1;function hg$1(e){eg$1===null?eg$1=[e]:eg$1.push(e)}function ig$1(e){fg$1=!0,hg$1(e)}function jg(){if(!gg&&eg$1!==null){gg=!0;var e=0,s=C;try{var i=eg$1;for(C=1;e<i.length;e++){var c=i[e];do c=c(!0);while(c!==null)}eg$1=null,fg$1=!1}catch(d){throw eg$1!==null&&(eg$1=eg$1.slice(e+1)),ac$1(fc$1,jg),d}finally{C=s,gg=!1}}return null}var kg=[],lg$1=0,mg$1=null,ng$1=0,og$1=[],pg$1=0,qg=null,rg$1=1,sg$1="";function tg$1(e,s){kg[lg$1++]=ng$1,kg[lg$1++]=mg$1,mg$1=e,ng$1=s}function ug$1(e,s,i){og$1[pg$1++]=rg$1,og$1[pg$1++]=sg$1,og$1[pg$1++]=qg,qg=e;var c=rg$1;e=sg$1;var d=32-oc$1(c)-1;c&=~(1<<d),i+=1;var h=32-oc$1(s)+d;if(30<h){var _=d-d%5;h=(c&(1<<_)-1).toString(32),c>>=_,d-=_,rg$1=1<<32-oc$1(s)+d|i<<d|c,sg$1=h+e}else rg$1=1<<h|i<<d|c,sg$1=e}function vg(e){e.return!==null&&(tg$1(e,1),ug$1(e,1,0))}function wg(e){for(;e===mg$1;)mg$1=kg[--lg$1],kg[lg$1]=null,ng$1=kg[--lg$1],kg[lg$1]=null;for(;e===qg;)qg=og$1[--pg$1],og$1[pg$1]=null,sg$1=og$1[--pg$1],og$1[pg$1]=null,rg$1=og$1[--pg$1],og$1[pg$1]=null}var xg=null,yg$1=null,I=!1,zg=null;function Ag(e,s){var i=Bg(5,null,null,0);i.elementType="DELETED",i.stateNode=s,i.return=e,s=e.deletions,s===null?(e.deletions=[i],e.flags|=16):s.push(i)}function Cg(e,s){switch(e.tag){case 5:var i=e.type;return s=s.nodeType!==1||i.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(e.stateNode=s,xg=e,yg$1=Lf$1(s.firstChild),!0):!1;case 6:return s=e.pendingProps===""||s.nodeType!==3?null:s,s!==null?(e.stateNode=s,xg=e,yg$1=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(i=qg!==null?{id:rg$1,overflow:sg$1}:null,e.memoizedState={dehydrated:s,treeContext:i,retryLane:1073741824},i=Bg(18,null,null,0),i.stateNode=s,i.return=e,e.child=i,xg=e,yg$1=null,!0):!1;default:return!1}}function Dg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Eg(e){if(I){var s=yg$1;if(s){var i=s;if(!Cg(e,s)){if(Dg(e))throw Error(p(418));s=Lf$1(i.nextSibling);var c=xg;s&&Cg(e,s)?Ag(c,i):(e.flags=e.flags&-4097|2,I=!1,xg=e)}}else{if(Dg(e))throw Error(p(418));e.flags=e.flags&-4097|2,I=!1,xg=e}}}function Fg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xg=e}function Gg(e){if(e!==xg)return!1;if(!I)return Fg(e),I=!0,!1;var s;if((s=e.tag!==3)&&!(s=e.tag!==5)&&(s=e.type,s=s!=="head"&&s!=="body"&&!Ef$1(e.type,e.memoizedProps)),s&&(s=yg$1)){if(Dg(e))throw Hg(),Error(p(418));for(;s;)Ag(e,s),s=Lf$1(s.nextSibling)}if(Fg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(p(317));e:{for(e=e.nextSibling,s=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(s===0){yg$1=Lf$1(e.nextSibling);break e}s--}else i!=="$"&&i!=="$!"&&i!=="$?"||s++}e=e.nextSibling}yg$1=null}}else yg$1=xg?Lf$1(e.stateNode.nextSibling):null;return!0}function Hg(){for(var e=yg$1;e;)e=Lf$1(e.nextSibling)}function Ig(){yg$1=xg=null,I=!1}function Jg(e){zg===null?zg=[e]:zg.push(e)}var Kg=ua$1.ReactCurrentBatchConfig;function Lg(e,s,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(p(309));var c=i.stateNode}if(!c)throw Error(p(147,e));var d=c,h=""+e;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===h?s.ref:(s=function(_){var g=d.refs;_===null?delete g[h]:g[h]=_},s._stringRef=h,s)}if(typeof e!="string")throw Error(p(284));if(!i._owner)throw Error(p(290,e))}return e}function Mg(e,s){throw e=Object.prototype.toString.call(s),Error(p(31,e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e))}function Ng(e){var s=e._init;return s(e._payload)}function Og(e){function s(dt,ft){if(e){var kt=dt.deletions;kt===null?(dt.deletions=[ft],dt.flags|=16):kt.push(ft)}}function i(dt,ft){if(!e)return null;for(;ft!==null;)s(dt,ft),ft=ft.sibling;return null}function c(dt,ft){for(dt=new Map;ft!==null;)ft.key!==null?dt.set(ft.key,ft):dt.set(ft.index,ft),ft=ft.sibling;return dt}function d(dt,ft){return dt=Pg(dt,ft),dt.index=0,dt.sibling=null,dt}function h(dt,ft,kt){return dt.index=kt,e?(kt=dt.alternate,kt!==null?(kt=kt.index,kt<ft?(dt.flags|=2,ft):kt):(dt.flags|=2,ft)):(dt.flags|=1048576,ft)}function _(dt){return e&&dt.alternate===null&&(dt.flags|=2),dt}function g(dt,ft,kt,St){return ft===null||ft.tag!==6?(ft=Qg(kt,dt.mode,St),ft.return=dt,ft):(ft=d(ft,kt),ft.return=dt,ft)}function $(dt,ft,kt,St){var Lt=kt.type;return Lt===ya$1?lt(dt,ft,kt.props.children,St,kt.key):ft!==null&&(ft.elementType===Lt||typeof Lt=="object"&&Lt!==null&&Lt.$$typeof===Ha$1&&Ng(Lt)===ft.type)?(St=d(ft,kt.props),St.ref=Lg(dt,ft,kt),St.return=dt,St):(St=Rg(kt.type,kt.key,kt.props,null,dt.mode,St),St.ref=Lg(dt,ft,kt),St.return=dt,St)}function _e(dt,ft,kt,St){return ft===null||ft.tag!==4||ft.stateNode.containerInfo!==kt.containerInfo||ft.stateNode.implementation!==kt.implementation?(ft=Sg(kt,dt.mode,St),ft.return=dt,ft):(ft=d(ft,kt.children||[]),ft.return=dt,ft)}function lt(dt,ft,kt,St,Lt){return ft===null||ft.tag!==7?(ft=Tg(kt,dt.mode,St,Lt),ft.return=dt,ft):(ft=d(ft,kt),ft.return=dt,ft)}function at(dt,ft,kt){if(typeof ft=="string"&&ft!==""||typeof ft=="number")return ft=Qg(""+ft,dt.mode,kt),ft.return=dt,ft;if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case va$1:return kt=Rg(ft.type,ft.key,ft.props,null,dt.mode,kt),kt.ref=Lg(dt,null,ft),kt.return=dt,kt;case wa$1:return ft=Sg(ft,dt.mode,kt),ft.return=dt,ft;case Ha$1:var St=ft._init;return at(dt,St(ft._payload),kt)}if(eb(ft)||Ka$1(ft))return ft=Tg(ft,dt.mode,kt,null),ft.return=dt,ft;Mg(dt,ft)}return null}function it(dt,ft,kt,St){var Lt=ft!==null?ft.key:null;if(typeof kt=="string"&&kt!==""||typeof kt=="number")return Lt!==null?null:g(dt,ft,""+kt,St);if(typeof kt=="object"&&kt!==null){switch(kt.$$typeof){case va$1:return kt.key===Lt?$(dt,ft,kt,St):null;case wa$1:return kt.key===Lt?_e(dt,ft,kt,St):null;case Ha$1:return Lt=kt._init,it(dt,ft,Lt(kt._payload),St)}if(eb(kt)||Ka$1(kt))return Lt!==null?null:lt(dt,ft,kt,St,null);Mg(dt,kt)}return null}function ct(dt,ft,kt,St,Lt){if(typeof St=="string"&&St!==""||typeof St=="number")return dt=dt.get(kt)||null,g(ft,dt,""+St,Lt);if(typeof St=="object"&&St!==null){switch(St.$$typeof){case va$1:return dt=dt.get(St.key===null?kt:St.key)||null,$(ft,dt,St,Lt);case wa$1:return dt=dt.get(St.key===null?kt:St.key)||null,_e(ft,dt,St,Lt);case Ha$1:var Gt=St._init;return ct(dt,ft,kt,Gt(St._payload),Lt)}if(eb(St)||Ka$1(St))return dt=dt.get(kt)||null,lt(ft,dt,St,Lt,null);Mg(ft,St)}return null}function mt(dt,ft,kt,St){for(var Lt=null,Gt=null,Bt=ft,nr=ft=0,cr=null;Bt!==null&&nr<kt.length;nr++){Bt.index>nr?(cr=Bt,Bt=null):cr=Bt.sibling;var ur=it(dt,Bt,kt[nr],St);if(ur===null){Bt===null&&(Bt=cr);break}e&&Bt&&ur.alternate===null&&s(dt,Bt),ft=h(ur,ft,nr),Gt===null?Lt=ur:Gt.sibling=ur,Gt=ur,Bt=cr}if(nr===kt.length)return i(dt,Bt),I&&tg$1(dt,nr),Lt;if(Bt===null){for(;nr<kt.length;nr++)Bt=at(dt,kt[nr],St),Bt!==null&&(ft=h(Bt,ft,nr),Gt===null?Lt=Bt:Gt.sibling=Bt,Gt=Bt);return I&&tg$1(dt,nr),Lt}for(Bt=c(dt,Bt);nr<kt.length;nr++)cr=ct(Bt,dt,nr,kt[nr],St),cr!==null&&(e&&cr.alternate!==null&&Bt.delete(cr.key===null?nr:cr.key),ft=h(cr,ft,nr),Gt===null?Lt=cr:Gt.sibling=cr,Gt=cr);return e&&Bt.forEach(function(yn){return s(dt,yn)}),I&&tg$1(dt,nr),Lt}function pt(dt,ft,kt,St){var Lt=Ka$1(kt);if(typeof Lt!="function")throw Error(p(150));if(kt=Lt.call(kt),kt==null)throw Error(p(151));for(var Gt=Lt=null,Bt=ft,nr=ft=0,cr=null,ur=kt.next();Bt!==null&&!ur.done;nr++,ur=kt.next()){Bt.index>nr?(cr=Bt,Bt=null):cr=Bt.sibling;var yn=it(dt,Bt,ur.value,St);if(yn===null){Bt===null&&(Bt=cr);break}e&&Bt&&yn.alternate===null&&s(dt,Bt),ft=h(yn,ft,nr),Gt===null?Lt=yn:Gt.sibling=yn,Gt=yn,Bt=cr}if(ur.done)return i(dt,Bt),I&&tg$1(dt,nr),Lt;if(Bt===null){for(;!ur.done;nr++,ur=kt.next())ur=at(dt,ur.value,St),ur!==null&&(ft=h(ur,ft,nr),Gt===null?Lt=ur:Gt.sibling=ur,Gt=ur);return I&&tg$1(dt,nr),Lt}for(Bt=c(dt,Bt);!ur.done;nr++,ur=kt.next())ur=ct(Bt,dt,nr,ur.value,St),ur!==null&&(e&&ur.alternate!==null&&Bt.delete(ur.key===null?nr:ur.key),ft=h(ur,ft,nr),Gt===null?Lt=ur:Gt.sibling=ur,Gt=ur);return e&&Bt.forEach(function(hn){return s(dt,hn)}),I&&tg$1(dt,nr),Lt}function zt(dt,ft,kt,St){if(typeof kt=="object"&&kt!==null&&kt.type===ya$1&&kt.key===null&&(kt=kt.props.children),typeof kt=="object"&&kt!==null){switch(kt.$$typeof){case va$1:e:{for(var Lt=kt.key,Gt=ft;Gt!==null;){if(Gt.key===Lt){if(Lt=kt.type,Lt===ya$1){if(Gt.tag===7){i(dt,Gt.sibling),ft=d(Gt,kt.props.children),ft.return=dt,dt=ft;break e}}else if(Gt.elementType===Lt||typeof Lt=="object"&&Lt!==null&&Lt.$$typeof===Ha$1&&Ng(Lt)===Gt.type){i(dt,Gt.sibling),ft=d(Gt,kt.props),ft.ref=Lg(dt,Gt,kt),ft.return=dt,dt=ft;break e}i(dt,Gt);break}else s(dt,Gt);Gt=Gt.sibling}kt.type===ya$1?(ft=Tg(kt.props.children,dt.mode,St,kt.key),ft.return=dt,dt=ft):(St=Rg(kt.type,kt.key,kt.props,null,dt.mode,St),St.ref=Lg(dt,ft,kt),St.return=dt,dt=St)}return _(dt);case wa$1:e:{for(Gt=kt.key;ft!==null;){if(ft.key===Gt)if(ft.tag===4&&ft.stateNode.containerInfo===kt.containerInfo&&ft.stateNode.implementation===kt.implementation){i(dt,ft.sibling),ft=d(ft,kt.children||[]),ft.return=dt,dt=ft;break e}else{i(dt,ft);break}else s(dt,ft);ft=ft.sibling}ft=Sg(kt,dt.mode,St),ft.return=dt,dt=ft}return _(dt);case Ha$1:return Gt=kt._init,zt(dt,ft,Gt(kt._payload),St)}if(eb(kt))return mt(dt,ft,kt,St);if(Ka$1(kt))return pt(dt,ft,kt,St);Mg(dt,kt)}return typeof kt=="string"&&kt!==""||typeof kt=="number"?(kt=""+kt,ft!==null&&ft.tag===6?(i(dt,ft.sibling),ft=d(ft,kt),ft.return=dt,dt=ft):(i(dt,ft),ft=Qg(kt,dt.mode,St),ft.return=dt,dt=ft),_(dt)):i(dt,ft)}return zt}var Ug=Og(!0),Vg=Og(!1),Wg=Uf$1(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah$1(e){var s=Wg.current;E$1(Wg),e._currentValue=s}function bh$1(e,s,i){for(;e!==null;){var c=e.alternate;if((e.childLanes&s)!==s?(e.childLanes|=s,c!==null&&(c.childLanes|=s)):c!==null&&(c.childLanes&s)!==s&&(c.childLanes|=s),e===i)break;e=e.return}}function ch$1(e,s){Xg=e,Zg=Yg=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&s&&(dh$1=!0),e.firstContext=null)}function eh(e){var s=e._currentValue;if(Zg!==e)if(e={context:e,memoizedValue:s,next:null},Yg===null){if(Xg===null)throw Error(p(308));Yg=e,Xg.dependencies={lanes:0,firstContext:e}}else Yg=Yg.next=e;return s}var fh$1=null;function gh$1(e){fh$1===null?fh$1=[e]:fh$1.push(e)}function hh$1(e,s,i,c){var d=s.interleaved;return d===null?(i.next=i,gh$1(s)):(i.next=d.next,d.next=i),s.interleaved=i,ih$1(e,c)}function ih$1(e,s){e.lanes|=s;var i=e.alternate;for(i!==null&&(i.lanes|=s),i=e,e=e.return;e!==null;)e.childLanes|=s,i=e.alternate,i!==null&&(i.childLanes|=s),i=e,e=e.return;return i.tag===3?i.stateNode:null}var jh$1=!1;function kh$1(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh$1(e,s){e=e.updateQueue,s.updateQueue===e&&(s.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function mh$1(e,s){return{eventTime:e,lane:s,tag:0,payload:null,callback:null,next:null}}function nh$1(e,s,i){var c=e.updateQueue;if(c===null)return null;if(c=c.shared,K&2){var d=c.pending;return d===null?s.next=s:(s.next=d.next,d.next=s),c.pending=s,ih$1(e,i)}return d=c.interleaved,d===null?(s.next=s,gh$1(c)):(s.next=d.next,d.next=s),c.interleaved=s,ih$1(e,i)}function oh$1(e,s,i){if(s=s.updateQueue,s!==null&&(s=s.shared,(i&4194240)!==0)){var c=s.lanes;c&=e.pendingLanes,i|=c,s.lanes=i,Cc(e,i)}}function ph$1(e,s){var i=e.updateQueue,c=e.alternate;if(c!==null&&(c=c.updateQueue,i===c)){var d=null,h=null;if(i=i.firstBaseUpdate,i!==null){do{var _={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};h===null?d=h=_:h=h.next=_,i=i.next}while(i!==null);h===null?d=h=s:h=h.next=s}else d=h=s;i={baseState:c.baseState,firstBaseUpdate:d,lastBaseUpdate:h,shared:c.shared,effects:c.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=s:e.next=s,i.lastBaseUpdate=s}function qh$1(e,s,i,c){var d=e.updateQueue;jh$1=!1;var h=d.firstBaseUpdate,_=d.lastBaseUpdate,g=d.shared.pending;if(g!==null){d.shared.pending=null;var $=g,_e=$.next;$.next=null,_===null?h=_e:_.next=_e,_=$;var lt=e.alternate;lt!==null&&(lt=lt.updateQueue,g=lt.lastBaseUpdate,g!==_&&(g===null?lt.firstBaseUpdate=_e:g.next=_e,lt.lastBaseUpdate=$))}if(h!==null){var at=d.baseState;_=0,lt=_e=$=null,g=h;do{var it=g.lane,ct=g.eventTime;if((c&it)===it){lt!==null&&(lt=lt.next={eventTime:ct,lane:0,tag:g.tag,payload:g.payload,callback:g.callback,next:null});e:{var mt=e,pt=g;switch(it=s,ct=i,pt.tag){case 1:if(mt=pt.payload,typeof mt=="function"){at=mt.call(ct,at,it);break e}at=mt;break e;case 3:mt.flags=mt.flags&-65537|128;case 0:if(mt=pt.payload,it=typeof mt=="function"?mt.call(ct,at,it):mt,it==null)break e;at=A({},at,it);break e;case 2:jh$1=!0}}g.callback!==null&&g.lane!==0&&(e.flags|=64,it=d.effects,it===null?d.effects=[g]:it.push(g))}else ct={eventTime:ct,lane:it,tag:g.tag,payload:g.payload,callback:g.callback,next:null},lt===null?(_e=lt=ct,$=at):lt=lt.next=ct,_|=it;if(g=g.next,g===null){if(g=d.shared.pending,g===null)break;it=g,g=it.next,it.next=null,d.lastBaseUpdate=it,d.shared.pending=null}}while(!0);if(lt===null&&($=at),d.baseState=$,d.firstBaseUpdate=_e,d.lastBaseUpdate=lt,s=d.shared.interleaved,s!==null){d=s;do _|=d.lane,d=d.next;while(d!==s)}else h===null&&(d.shared.lanes=0);rh$1|=_,e.lanes=_,e.memoizedState=at}}function sh$1(e,s,i){if(e=s.effects,s.effects=null,e!==null)for(s=0;s<e.length;s++){var c=e[s],d=c.callback;if(d!==null){if(c.callback=null,c=i,typeof d!="function")throw Error(p(191,d));d.call(c)}}}var th$1={},uh$1=Uf$1(th$1),vh$1=Uf$1(th$1),wh$1=Uf$1(th$1);function xh$1(e){if(e===th$1)throw Error(p(174));return e}function yh$1(e,s){switch(G(wh$1,s),G(vh$1,e),G(uh$1,th$1),e=s.nodeType,e){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:lb(null,"");break;default:e=e===8?s.parentNode:s,s=e.namespaceURI||null,e=e.tagName,s=lb(s,e)}E$1(uh$1),G(uh$1,s)}function zh$1(){E$1(uh$1),E$1(vh$1),E$1(wh$1)}function Ah$1(e){xh$1(wh$1.current);var s=xh$1(uh$1.current),i=lb(s,e.type);s!==i&&(G(vh$1,e),G(uh$1,i))}function Bh$1(e){vh$1.current===e&&(E$1(uh$1),E$1(vh$1))}var L$1=Uf$1(0);function Ch$1(e){for(var s=e;s!==null;){if(s.tag===13){var i=s.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Dh$1=[];function Eh(){for(var e=0;e<Dh$1.length;e++)Dh$1[e]._workInProgressVersionPrimary=null;Dh$1.length=0}var Fh$1=ua$1.ReactCurrentDispatcher,Gh$1=ua$1.ReactCurrentBatchConfig,Hh$1=0,M$2=null,N$1=null,O=null,Ih$1=!1,Jh$1=!1,Kh$1=0,Lh$1=0;function P$2(){throw Error(p(321))}function Mh$1(e,s){if(s===null)return!1;for(var i=0;i<s.length&&i<e.length;i++)if(!He$1(e[i],s[i]))return!1;return!0}function Nh$1(e,s,i,c,d,h){if(Hh$1=h,M$2=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Fh$1.current=e===null||e.memoizedState===null?Oh$1:Ph$1,e=i(c,d),Jh$1){h=0;do{if(Jh$1=!1,Kh$1=0,25<=h)throw Error(p(301));h+=1,O=N$1=null,s.updateQueue=null,Fh$1.current=Qh$1,e=i(c,d)}while(Jh$1)}if(Fh$1.current=Rh$1,s=N$1!==null&&N$1.next!==null,Hh$1=0,O=N$1=M$2=null,Ih$1=!1,s)throw Error(p(300));return e}function Sh$1(){var e=Kh$1!==0;return Kh$1=0,e}function Th$1(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O===null?M$2.memoizedState=O=e:O=O.next=e,O}function Uh$1(){if(N$1===null){var e=M$2.alternate;e=e!==null?e.memoizedState:null}else e=N$1.next;var s=O===null?M$2.memoizedState:O.next;if(s!==null)O=s,N$1=e;else{if(e===null)throw Error(p(310));N$1=e,e={memoizedState:N$1.memoizedState,baseState:N$1.baseState,baseQueue:N$1.baseQueue,queue:N$1.queue,next:null},O===null?M$2.memoizedState=O=e:O=O.next=e}return O}function Vh$1(e,s){return typeof s=="function"?s(e):s}function Wh$1(e){var s=Uh$1(),i=s.queue;if(i===null)throw Error(p(311));i.lastRenderedReducer=e;var c=N$1,d=c.baseQueue,h=i.pending;if(h!==null){if(d!==null){var _=d.next;d.next=h.next,h.next=_}c.baseQueue=d=h,i.pending=null}if(d!==null){h=d.next,c=c.baseState;var g=_=null,$=null,_e=h;do{var lt=_e.lane;if((Hh$1&lt)===lt)$!==null&&($=$.next={lane:0,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null}),c=_e.hasEagerState?_e.eagerState:e(c,_e.action);else{var at={lane:lt,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null};$===null?(g=$=at,_=c):$=$.next=at,M$2.lanes|=lt,rh$1|=lt}_e=_e.next}while(_e!==null&&_e!==h);$===null?_=c:$.next=g,He$1(c,s.memoizedState)||(dh$1=!0),s.memoizedState=c,s.baseState=_,s.baseQueue=$,i.lastRenderedState=c}if(e=i.interleaved,e!==null){d=e;do h=d.lane,M$2.lanes|=h,rh$1|=h,d=d.next;while(d!==e)}else d===null&&(i.lanes=0);return[s.memoizedState,i.dispatch]}function Xh$1(e){var s=Uh$1(),i=s.queue;if(i===null)throw Error(p(311));i.lastRenderedReducer=e;var c=i.dispatch,d=i.pending,h=s.memoizedState;if(d!==null){i.pending=null;var _=d=d.next;do h=e(h,_.action),_=_.next;while(_!==d);He$1(h,s.memoizedState)||(dh$1=!0),s.memoizedState=h,s.baseQueue===null&&(s.baseState=h),i.lastRenderedState=h}return[h,c]}function Yh$1(){}function Zh$1(e,s){var i=M$2,c=Uh$1(),d=s(),h=!He$1(c.memoizedState,d);if(h&&(c.memoizedState=d,dh$1=!0),c=c.queue,$h$1(ai.bind(null,i,c,e),[e]),c.getSnapshot!==s||h||O!==null&&O.memoizedState.tag&1){if(i.flags|=2048,bi(9,ci.bind(null,i,c,d,s),void 0,null),Q===null)throw Error(p(349));Hh$1&30||di(i,s,d)}return d}function di(e,s,i){e.flags|=16384,e={getSnapshot:s,value:i},s=M$2.updateQueue,s===null?(s={lastEffect:null,stores:null},M$2.updateQueue=s,s.stores=[e]):(i=s.stores,i===null?s.stores=[e]:i.push(e))}function ci(e,s,i,c){s.value=i,s.getSnapshot=c,ei(s)&&fi(e)}function ai(e,s,i){return i(function(){ei(s)&&fi(e)})}function ei(e){var s=e.getSnapshot;e=e.value;try{var i=s();return!He$1(e,i)}catch{return!0}}function fi(e){var s=ih$1(e,1);s!==null&&gi(s,e,1,-1)}function hi(e){var s=Th$1();return typeof e=="function"&&(e=e()),s.memoizedState=s.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh$1,lastRenderedState:e},s.queue=e,e=e.dispatch=ii.bind(null,M$2,e),[s.memoizedState,e]}function bi(e,s,i,c){return e={tag:e,create:s,destroy:i,deps:c,next:null},s=M$2.updateQueue,s===null?(s={lastEffect:null,stores:null},M$2.updateQueue=s,s.lastEffect=e.next=e):(i=s.lastEffect,i===null?s.lastEffect=e.next=e:(c=i.next,i.next=e,e.next=c,s.lastEffect=e)),e}function ji$1(){return Uh$1().memoizedState}function ki(e,s,i,c){var d=Th$1();M$2.flags|=e,d.memoizedState=bi(1|s,i,void 0,c===void 0?null:c)}function li(e,s,i,c){var d=Uh$1();c=c===void 0?null:c;var h=void 0;if(N$1!==null){var _=N$1.memoizedState;if(h=_.destroy,c!==null&&Mh$1(c,_.deps)){d.memoizedState=bi(s,i,h,c);return}}M$2.flags|=e,d.memoizedState=bi(1|s,i,h,c)}function mi(e,s){return ki(8390656,8,e,s)}function $h$1(e,s){return li(2048,8,e,s)}function ni(e,s){return li(4,2,e,s)}function oi(e,s){return li(4,4,e,s)}function pi(e,s){if(typeof s=="function")return e=e(),s(e),function(){s(null)};if(s!=null)return e=e(),s.current=e,function(){s.current=null}}function qi$1(e,s,i){return i=i!=null?i.concat([e]):null,li(4,4,pi.bind(null,s,e),i)}function ri(){}function si(e,s){var i=Uh$1();s=s===void 0?null:s;var c=i.memoizedState;return c!==null&&s!==null&&Mh$1(s,c[1])?c[0]:(i.memoizedState=[e,s],e)}function ti(e,s){var i=Uh$1();s=s===void 0?null:s;var c=i.memoizedState;return c!==null&&s!==null&&Mh$1(s,c[1])?c[0]:(e=e(),i.memoizedState=[e,s],e)}function ui(e,s,i){return Hh$1&21?(He$1(i,s)||(i=yc(),M$2.lanes|=i,rh$1|=i,e.baseState=!0),s):(e.baseState&&(e.baseState=!1,dh$1=!0),e.memoizedState=i)}function vi(e,s){var i=C;C=i!==0&&4>i?i:4,e(!0);var c=Gh$1.transition;Gh$1.transition={};try{e(!1),s()}finally{C=i,Gh$1.transition=c}}function wi(){return Uh$1().memoizedState}function xi(e,s,i){var c=yi(e);if(i={lane:c,action:i,hasEagerState:!1,eagerState:null,next:null},zi(e))Ai(s,i);else if(i=hh$1(e,s,i,c),i!==null){var d=R();gi(i,e,c,d),Bi(i,s,c)}}function ii(e,s,i){var c=yi(e),d={lane:c,action:i,hasEagerState:!1,eagerState:null,next:null};if(zi(e))Ai(s,d);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=s.lastRenderedReducer,h!==null))try{var _=s.lastRenderedState,g=h(_,i);if(d.hasEagerState=!0,d.eagerState=g,He$1(g,_)){var $=s.interleaved;$===null?(d.next=d,gh$1(s)):(d.next=$.next,$.next=d),s.interleaved=d;return}}catch{}finally{}i=hh$1(e,s,d,c),i!==null&&(d=R(),gi(i,e,c,d),Bi(i,s,c))}}function zi(e){var s=e.alternate;return e===M$2||s!==null&&s===M$2}function Ai(e,s){Jh$1=Ih$1=!0;var i=e.pending;i===null?s.next=s:(s.next=i.next,i.next=s),e.pending=s}function Bi(e,s,i){if(i&4194240){var c=s.lanes;c&=e.pendingLanes,i|=c,s.lanes=i,Cc(e,i)}}var Rh$1={readContext:eh,useCallback:P$2,useContext:P$2,useEffect:P$2,useImperativeHandle:P$2,useInsertionEffect:P$2,useLayoutEffect:P$2,useMemo:P$2,useReducer:P$2,useRef:P$2,useState:P$2,useDebugValue:P$2,useDeferredValue:P$2,useTransition:P$2,useMutableSource:P$2,useSyncExternalStore:P$2,useId:P$2,unstable_isNewReconciler:!1},Oh$1={readContext:eh,useCallback:function(e,s){return Th$1().memoizedState=[e,s===void 0?null:s],e},useContext:eh,useEffect:mi,useImperativeHandle:function(e,s,i){return i=i!=null?i.concat([e]):null,ki(4194308,4,pi.bind(null,s,e),i)},useLayoutEffect:function(e,s){return ki(4194308,4,e,s)},useInsertionEffect:function(e,s){return ki(4,2,e,s)},useMemo:function(e,s){var i=Th$1();return s=s===void 0?null:s,e=e(),i.memoizedState=[e,s],e},useReducer:function(e,s,i){var c=Th$1();return s=i!==void 0?i(s):s,c.memoizedState=c.baseState=s,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:s},c.queue=e,e=e.dispatch=xi.bind(null,M$2,e),[c.memoizedState,e]},useRef:function(e){var s=Th$1();return e={current:e},s.memoizedState=e},useState:hi,useDebugValue:ri,useDeferredValue:function(e){return Th$1().memoizedState=e},useTransition:function(){var e=hi(!1),s=e[0];return e=vi.bind(null,e[1]),Th$1().memoizedState=e,[s,e]},useMutableSource:function(){},useSyncExternalStore:function(e,s,i){var c=M$2,d=Th$1();if(I){if(i===void 0)throw Error(p(407));i=i()}else{if(i=s(),Q===null)throw Error(p(349));Hh$1&30||di(c,s,i)}d.memoizedState=i;var h={value:i,getSnapshot:s};return d.queue=h,mi(ai.bind(null,c,h,e),[e]),c.flags|=2048,bi(9,ci.bind(null,c,h,i,s),void 0,null),i},useId:function(){var e=Th$1(),s=Q.identifierPrefix;if(I){var i=sg$1,c=rg$1;i=(c&~(1<<32-oc$1(c)-1)).toString(32)+i,s=":"+s+"R"+i,i=Kh$1++,0<i&&(s+="H"+i.toString(32)),s+=":"}else i=Lh$1++,s=":"+s+"r"+i.toString(32)+":";return e.memoizedState=s},unstable_isNewReconciler:!1},Ph$1={readContext:eh,useCallback:si,useContext:eh,useEffect:$h$1,useImperativeHandle:qi$1,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh$1,useRef:ji$1,useState:function(){return Wh$1(Vh$1)},useDebugValue:ri,useDeferredValue:function(e){var s=Uh$1();return ui(s,N$1.memoizedState,e)},useTransition:function(){var e=Wh$1(Vh$1)[0],s=Uh$1().memoizedState;return[e,s]},useMutableSource:Yh$1,useSyncExternalStore:Zh$1,useId:wi,unstable_isNewReconciler:!1},Qh$1={readContext:eh,useCallback:si,useContext:eh,useEffect:$h$1,useImperativeHandle:qi$1,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh$1,useRef:ji$1,useState:function(){return Xh$1(Vh$1)},useDebugValue:ri,useDeferredValue:function(e){var s=Uh$1();return N$1===null?s.memoizedState=e:ui(s,N$1.memoizedState,e)},useTransition:function(){var e=Xh$1(Vh$1)[0],s=Uh$1().memoizedState;return[e,s]},useMutableSource:Yh$1,useSyncExternalStore:Zh$1,useId:wi,unstable_isNewReconciler:!1};function Ci(e,s){if(e&&e.defaultProps){s=A({},s),e=e.defaultProps;for(var i in e)s[i]===void 0&&(s[i]=e[i]);return s}return s}function Di(e,s,i,c){s=e.memoizedState,i=i(c,s),i=i==null?s:A({},s,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var Ei={isMounted:function(e){return(e=e._reactInternals)?Vb(e)===e:!1},enqueueSetState:function(e,s,i){e=e._reactInternals;var c=R(),d=yi(e),h=mh$1(c,d);h.payload=s,i!=null&&(h.callback=i),s=nh$1(e,h,d),s!==null&&(gi(s,e,d,c),oh$1(s,e,d))},enqueueReplaceState:function(e,s,i){e=e._reactInternals;var c=R(),d=yi(e),h=mh$1(c,d);h.tag=1,h.payload=s,i!=null&&(h.callback=i),s=nh$1(e,h,d),s!==null&&(gi(s,e,d,c),oh$1(s,e,d))},enqueueForceUpdate:function(e,s){e=e._reactInternals;var i=R(),c=yi(e),d=mh$1(i,c);d.tag=2,s!=null&&(d.callback=s),s=nh$1(e,d,c),s!==null&&(gi(s,e,c,i),oh$1(s,e,c))}};function Fi$1(e,s,i,c,d,h,_){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(c,h,_):s.prototype&&s.prototype.isPureReactComponent?!Ie$1(i,c)||!Ie$1(d,h):!0}function Gi(e,s,i){var c=!1,d=Vf$1,h=s.contextType;return typeof h=="object"&&h!==null?h=eh(h):(d=Zf$1(s)?Xf$1:H.current,c=s.contextTypes,h=(c=c!=null)?Yf$1(e,d):Vf$1),s=new s(i,h),e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=Ei,e.stateNode=s,s._reactInternals=e,c&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=d,e.__reactInternalMemoizedMaskedChildContext=h),s}function Hi(e,s,i,c){e=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(i,c),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(i,c),s.state!==e&&Ei.enqueueReplaceState(s,s.state,null)}function Ii(e,s,i,c){var d=e.stateNode;d.props=i,d.state=e.memoizedState,d.refs={},kh$1(e);var h=s.contextType;typeof h=="object"&&h!==null?d.context=eh(h):(h=Zf$1(s)?Xf$1:H.current,d.context=Yf$1(e,h)),d.state=e.memoizedState,h=s.getDerivedStateFromProps,typeof h=="function"&&(Di(e,s,h,i),d.state=e.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(s=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),s!==d.state&&Ei.enqueueReplaceState(d,d.state,null),qh$1(e,i,d,c),d.state=e.memoizedState),typeof d.componentDidMount=="function"&&(e.flags|=4194308)}function Ji$1(e,s){try{var i="",c=s;do i+=Pa$1(c),c=c.return;while(c);var d=i}catch(h){d=`
Error generating stack: `+h.message+`
`+h.stack}return{value:e,source:s,stack:d,digest:null}}function Ki$1(e,s,i){return{value:e,source:null,stack:i??null,digest:s??null}}function Li(e,s){try{console.error(s.value)}catch(i){setTimeout(function(){throw i})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(e,s,i){i=mh$1(-1,i),i.tag=3,i.payload={element:null};var c=s.value;return i.callback=function(){Oi||(Oi=!0,Pi=c),Li(e,s)},i}function Qi$1(e,s,i){i=mh$1(-1,i),i.tag=3;var c=e.type.getDerivedStateFromError;if(typeof c=="function"){var d=s.value;i.payload=function(){return c(d)},i.callback=function(){Li(e,s)}}var h=e.stateNode;return h!==null&&typeof h.componentDidCatch=="function"&&(i.callback=function(){Li(e,s),typeof c!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var _=s.stack;this.componentDidCatch(s.value,{componentStack:_!==null?_:""})}),i}function Si(e,s,i){var c=e.pingCache;if(c===null){c=e.pingCache=new Mi;var d=new Set;c.set(s,d)}else d=c.get(s),d===void 0&&(d=new Set,c.set(s,d));d.has(i)||(d.add(i),e=Ti.bind(null,e,s,i),s.then(e,e))}function Ui(e){do{var s;if((s=e.tag===13)&&(s=e.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return e;e=e.return}while(e!==null);return null}function Vi(e,s,i,c,d){return e.mode&1?(e.flags|=65536,e.lanes=d,e):(e===s?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(s=mh$1(-1,1),s.tag=2,nh$1(i,s,1))),i.lanes|=1),e)}var Wi=ua$1.ReactCurrentOwner,dh$1=!1;function Xi$1(e,s,i,c){s.child=e===null?Vg(s,null,i,c):Ug(s,e.child,i,c)}function Yi$1(e,s,i,c,d){i=i.render;var h=s.ref;return ch$1(s,d),c=Nh$1(e,s,i,c,h,d),i=Sh$1(),e!==null&&!dh$1?(s.updateQueue=e.updateQueue,s.flags&=-2053,e.lanes&=~d,Zi$1(e,s,d)):(I&&i&&vg(s),s.flags|=1,Xi$1(e,s,c,d),s.child)}function $i(e,s,i,c,d){if(e===null){var h=i.type;return typeof h=="function"&&!aj(h)&&h.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(s.tag=15,s.type=h,bj(e,s,h,c,d)):(e=Rg(i.type,null,c,s,s.mode,d),e.ref=s.ref,e.return=s,s.child=e)}if(h=e.child,!(e.lanes&d)){var _=h.memoizedProps;if(i=i.compare,i=i!==null?i:Ie$1,i(_,c)&&e.ref===s.ref)return Zi$1(e,s,d)}return s.flags|=1,e=Pg(h,c),e.ref=s.ref,e.return=s,s.child=e}function bj(e,s,i,c,d){if(e!==null){var h=e.memoizedProps;if(Ie$1(h,c)&&e.ref===s.ref)if(dh$1=!1,s.pendingProps=c=h,(e.lanes&d)!==0)e.flags&131072&&(dh$1=!0);else return s.lanes=e.lanes,Zi$1(e,s,d)}return cj(e,s,i,c,d)}function dj(e,s,i){var c=s.pendingProps,d=c.children,h=e!==null?e.memoizedState:null;if(c.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=i;else{if(!(i&1073741824))return e=h!==null?h.baseLanes|i:i,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:e,cachePool:null,transitions:null},s.updateQueue=null,G(ej,fj),fj|=e,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=h!==null?h.baseLanes:i,G(ej,fj),fj|=c}else h!==null?(c=h.baseLanes|i,s.memoizedState=null):c=i,G(ej,fj),fj|=c;return Xi$1(e,s,d,i),s.child}function gj(e,s){var i=s.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(s.flags|=512,s.flags|=2097152)}function cj(e,s,i,c,d){var h=Zf$1(i)?Xf$1:H.current;return h=Yf$1(s,h),ch$1(s,d),i=Nh$1(e,s,i,c,h,d),c=Sh$1(),e!==null&&!dh$1?(s.updateQueue=e.updateQueue,s.flags&=-2053,e.lanes&=~d,Zi$1(e,s,d)):(I&&c&&vg(s),s.flags|=1,Xi$1(e,s,i,d),s.child)}function hj(e,s,i,c,d){if(Zf$1(i)){var h=!0;cg$1(s)}else h=!1;if(ch$1(s,d),s.stateNode===null)ij(e,s),Gi(s,i,c),Ii(s,i,c,d),c=!0;else if(e===null){var _=s.stateNode,g=s.memoizedProps;_.props=g;var $=_.context,_e=i.contextType;typeof _e=="object"&&_e!==null?_e=eh(_e):(_e=Zf$1(i)?Xf$1:H.current,_e=Yf$1(s,_e));var lt=i.getDerivedStateFromProps,at=typeof lt=="function"||typeof _.getSnapshotBeforeUpdate=="function";at||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(g!==c||$!==_e)&&Hi(s,_,c,_e),jh$1=!1;var it=s.memoizedState;_.state=it,qh$1(s,c,_,d),$=s.memoizedState,g!==c||it!==$||Wf$1.current||jh$1?(typeof lt=="function"&&(Di(s,i,lt,c),$=s.memoizedState),(g=jh$1||Fi$1(s,i,g,c,it,$,_e))?(at||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(s.flags|=4194308)):(typeof _.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=c,s.memoizedState=$),_.props=c,_.state=$,_.context=_e,c=g):(typeof _.componentDidMount=="function"&&(s.flags|=4194308),c=!1)}else{_=s.stateNode,lh$1(e,s),g=s.memoizedProps,_e=s.type===s.elementType?g:Ci(s.type,g),_.props=_e,at=s.pendingProps,it=_.context,$=i.contextType,typeof $=="object"&&$!==null?$=eh($):($=Zf$1(i)?Xf$1:H.current,$=Yf$1(s,$));var ct=i.getDerivedStateFromProps;(lt=typeof ct=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(g!==at||it!==$)&&Hi(s,_,c,$),jh$1=!1,it=s.memoizedState,_.state=it,qh$1(s,c,_,d);var mt=s.memoizedState;g!==at||it!==mt||Wf$1.current||jh$1?(typeof ct=="function"&&(Di(s,i,ct,c),mt=s.memoizedState),(_e=jh$1||Fi$1(s,i,_e,c,it,mt,$)||!1)?(lt||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(c,mt,$),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(c,mt,$)),typeof _.componentDidUpdate=="function"&&(s.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof _.componentDidUpdate!="function"||g===e.memoizedProps&&it===e.memoizedState||(s.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&it===e.memoizedState||(s.flags|=1024),s.memoizedProps=c,s.memoizedState=mt),_.props=c,_.state=mt,_.context=$,c=_e):(typeof _.componentDidUpdate!="function"||g===e.memoizedProps&&it===e.memoizedState||(s.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&it===e.memoizedState||(s.flags|=1024),c=!1)}return jj(e,s,i,c,h,d)}function jj(e,s,i,c,d,h){gj(e,s);var _=(s.flags&128)!==0;if(!c&&!_)return d&&dg$1(s,i,!1),Zi$1(e,s,h);c=s.stateNode,Wi.current=s;var g=_&&typeof i.getDerivedStateFromError!="function"?null:c.render();return s.flags|=1,e!==null&&_?(s.child=Ug(s,e.child,null,h),s.child=Ug(s,null,g,h)):Xi$1(e,s,g,h),s.memoizedState=c.state,d&&dg$1(s,i,!0),s.child}function kj(e){var s=e.stateNode;s.pendingContext?ag$1(e,s.pendingContext,s.pendingContext!==s.context):s.context&&ag$1(e,s.context,!1),yh$1(e,s.containerInfo)}function lj(e,s,i,c,d){return Ig(),Jg(d),s.flags|=256,Xi$1(e,s,i,c),s.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(e){return{baseLanes:e,cachePool:null,transitions:null}}function oj(e,s,i){var c=s.pendingProps,d=L$1.current,h=!1,_=(s.flags&128)!==0,g;if((g=_)||(g=e!==null&&e.memoizedState===null?!1:(d&2)!==0),g?(h=!0,s.flags&=-129):(e===null||e.memoizedState!==null)&&(d|=1),G(L$1,d&1),e===null)return Eg(s),e=s.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(s.mode&1?e.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(_=c.children,e=c.fallback,h?(c=s.mode,h=s.child,_={mode:"hidden",children:_},!(c&1)&&h!==null?(h.childLanes=0,h.pendingProps=_):h=pj(_,c,0,null),e=Tg(e,c,i,null),h.return=s,e.return=s,h.sibling=e,s.child=h,s.child.memoizedState=nj(i),s.memoizedState=mj,e):qj(s,_));if(d=e.memoizedState,d!==null&&(g=d.dehydrated,g!==null))return rj(e,s,_,c,g,d,i);if(h){h=c.fallback,_=s.mode,d=e.child,g=d.sibling;var $={mode:"hidden",children:c.children};return!(_&1)&&s.child!==d?(c=s.child,c.childLanes=0,c.pendingProps=$,s.deletions=null):(c=Pg(d,$),c.subtreeFlags=d.subtreeFlags&14680064),g!==null?h=Pg(g,h):(h=Tg(h,_,i,null),h.flags|=2),h.return=s,c.return=s,c.sibling=h,s.child=c,c=h,h=s.child,_=e.child.memoizedState,_=_===null?nj(i):{baseLanes:_.baseLanes|i,cachePool:null,transitions:_.transitions},h.memoizedState=_,h.childLanes=e.childLanes&~i,s.memoizedState=mj,c}return h=e.child,e=h.sibling,c=Pg(h,{mode:"visible",children:c.children}),!(s.mode&1)&&(c.lanes=i),c.return=s,c.sibling=null,e!==null&&(i=s.deletions,i===null?(s.deletions=[e],s.flags|=16):i.push(e)),s.child=c,s.memoizedState=null,c}function qj(e,s){return s=pj({mode:"visible",children:s},e.mode,0,null),s.return=e,e.child=s}function sj(e,s,i,c){return c!==null&&Jg(c),Ug(s,e.child,null,i),e=qj(s,s.pendingProps.children),e.flags|=2,s.memoizedState=null,e}function rj(e,s,i,c,d,h,_){if(i)return s.flags&256?(s.flags&=-257,c=Ki$1(Error(p(422))),sj(e,s,_,c)):s.memoizedState!==null?(s.child=e.child,s.flags|=128,null):(h=c.fallback,d=s.mode,c=pj({mode:"visible",children:c.children},d,0,null),h=Tg(h,d,_,null),h.flags|=2,c.return=s,h.return=s,c.sibling=h,s.child=c,s.mode&1&&Ug(s,e.child,null,_),s.child.memoizedState=nj(_),s.memoizedState=mj,h);if(!(s.mode&1))return sj(e,s,_,null);if(d.data==="$!"){if(c=d.nextSibling&&d.nextSibling.dataset,c)var g=c.dgst;return c=g,h=Error(p(419)),c=Ki$1(h,c,void 0),sj(e,s,_,c)}if(g=(_&e.childLanes)!==0,dh$1||g){if(c=Q,c!==null){switch(_&-_){case 4:d=2;break;case 16:d=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:d=32;break;case 536870912:d=268435456;break;default:d=0}d=d&(c.suspendedLanes|_)?0:d,d!==0&&d!==h.retryLane&&(h.retryLane=d,ih$1(e,d),gi(c,e,d,-1))}return tj(),c=Ki$1(Error(p(421))),sj(e,s,_,c)}return d.data==="$?"?(s.flags|=128,s.child=e.child,s=uj.bind(null,e),d._reactRetry=s,null):(e=h.treeContext,yg$1=Lf$1(d.nextSibling),xg=s,I=!0,zg=null,e!==null&&(og$1[pg$1++]=rg$1,og$1[pg$1++]=sg$1,og$1[pg$1++]=qg,rg$1=e.id,sg$1=e.overflow,qg=s),s=qj(s,c.children),s.flags|=4096,s)}function vj(e,s,i){e.lanes|=s;var c=e.alternate;c!==null&&(c.lanes|=s),bh$1(e.return,s,i)}function wj(e,s,i,c,d){var h=e.memoizedState;h===null?e.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:c,tail:i,tailMode:d}:(h.isBackwards=s,h.rendering=null,h.renderingStartTime=0,h.last=c,h.tail=i,h.tailMode=d)}function xj(e,s,i){var c=s.pendingProps,d=c.revealOrder,h=c.tail;if(Xi$1(e,s,c.children,i),c=L$1.current,c&2)c=c&1|2,s.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=s.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&vj(e,i,s);else if(e.tag===19)vj(e,i,s);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===s)break e;for(;e.sibling===null;){if(e.return===null||e.return===s)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}c&=1}if(G(L$1,c),!(s.mode&1))s.memoizedState=null;else switch(d){case"forwards":for(i=s.child,d=null;i!==null;)e=i.alternate,e!==null&&Ch$1(e)===null&&(d=i),i=i.sibling;i=d,i===null?(d=s.child,s.child=null):(d=i.sibling,i.sibling=null),wj(s,!1,d,i,h);break;case"backwards":for(i=null,d=s.child,s.child=null;d!==null;){if(e=d.alternate,e!==null&&Ch$1(e)===null){s.child=d;break}e=d.sibling,d.sibling=i,i=d,d=e}wj(s,!0,i,null,h);break;case"together":wj(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function ij(e,s){!(s.mode&1)&&e!==null&&(e.alternate=null,s.alternate=null,s.flags|=2)}function Zi$1(e,s,i){if(e!==null&&(s.dependencies=e.dependencies),rh$1|=s.lanes,!(i&s.childLanes))return null;if(e!==null&&s.child!==e.child)throw Error(p(153));if(s.child!==null){for(e=s.child,i=Pg(e,e.pendingProps),s.child=i,i.return=s;e.sibling!==null;)e=e.sibling,i=i.sibling=Pg(e,e.pendingProps),i.return=s;i.sibling=null}return s.child}function yj(e,s,i){switch(s.tag){case 3:kj(s),Ig();break;case 5:Ah$1(s);break;case 1:Zf$1(s.type)&&cg$1(s);break;case 4:yh$1(s,s.stateNode.containerInfo);break;case 10:var c=s.type._context,d=s.memoizedProps.value;G(Wg,c._currentValue),c._currentValue=d;break;case 13:if(c=s.memoizedState,c!==null)return c.dehydrated!==null?(G(L$1,L$1.current&1),s.flags|=128,null):i&s.child.childLanes?oj(e,s,i):(G(L$1,L$1.current&1),e=Zi$1(e,s,i),e!==null?e.sibling:null);G(L$1,L$1.current&1);break;case 19:if(c=(i&s.childLanes)!==0,e.flags&128){if(c)return xj(e,s,i);s.flags|=128}if(d=s.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),G(L$1,L$1.current),c)break;return null;case 22:case 23:return s.lanes=0,dj(e,s,i)}return Zi$1(e,s,i)}var zj,Aj,Bj,Cj;zj=function(e,s){for(var i=s.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};Aj=function(){};Bj=function(e,s,i,c){var d=e.memoizedProps;if(d!==c){e=s.stateNode,xh$1(uh$1.current);var h=null;switch(i){case"input":d=Ya(e,d),c=Ya(e,c),h=[];break;case"select":d=A({},d,{value:void 0}),c=A({},c,{value:void 0}),h=[];break;case"textarea":d=gb(e,d),c=gb(e,c),h=[];break;default:typeof d.onClick!="function"&&typeof c.onClick=="function"&&(e.onclick=Bf$1)}ub(i,c);var _;i=null;for(_e in d)if(!c.hasOwnProperty(_e)&&d.hasOwnProperty(_e)&&d[_e]!=null)if(_e==="style"){var g=d[_e];for(_ in g)g.hasOwnProperty(_)&&(i||(i={}),i[_]="")}else _e!=="dangerouslySetInnerHTML"&&_e!=="children"&&_e!=="suppressContentEditableWarning"&&_e!=="suppressHydrationWarning"&&_e!=="autoFocus"&&(ea$1.hasOwnProperty(_e)?h||(h=[]):(h=h||[]).push(_e,null));for(_e in c){var $=c[_e];if(g=d!=null?d[_e]:void 0,c.hasOwnProperty(_e)&&$!==g&&($!=null||g!=null))if(_e==="style")if(g){for(_ in g)!g.hasOwnProperty(_)||$&&$.hasOwnProperty(_)||(i||(i={}),i[_]="");for(_ in $)$.hasOwnProperty(_)&&g[_]!==$[_]&&(i||(i={}),i[_]=$[_])}else i||(h||(h=[]),h.push(_e,i)),i=$;else _e==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,g=g?g.__html:void 0,$!=null&&g!==$&&(h=h||[]).push(_e,$)):_e==="children"?typeof $!="string"&&typeof $!="number"||(h=h||[]).push(_e,""+$):_e!=="suppressContentEditableWarning"&&_e!=="suppressHydrationWarning"&&(ea$1.hasOwnProperty(_e)?($!=null&&_e==="onScroll"&&D$1("scroll",e),h||g===$||(h=[])):(h=h||[]).push(_e,$))}i&&(h=h||[]).push("style",i);var _e=h;(s.updateQueue=_e)&&(s.flags|=4)}};Cj=function(e,s,i,c){i!==c&&(s.flags|=4)};function Dj(e,s){if(!I)switch(e.tailMode){case"hidden":s=e.tail;for(var i=null;s!==null;)s.alternate!==null&&(i=s),s=s.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?s||e.tail===null?e.tail=null:e.tail.sibling=null:c.sibling=null}}function S(e){var s=e.alternate!==null&&e.alternate.child===e.child,i=0,c=0;if(s)for(var d=e.child;d!==null;)i|=d.lanes|d.childLanes,c|=d.subtreeFlags&14680064,c|=d.flags&14680064,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)i|=d.lanes|d.childLanes,c|=d.subtreeFlags,c|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=c,e.childLanes=i,s}function Ej(e,s,i){var c=s.pendingProps;switch(wg(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(s),null;case 1:return Zf$1(s.type)&&$f$1(),S(s),null;case 3:return c=s.stateNode,zh$1(),E$1(Wf$1),E$1(H),Eh(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(e===null||e.child===null)&&(Gg(s)?s.flags|=4:e===null||e.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(e,s),S(s),null;case 5:Bh$1(s);var d=xh$1(wh$1.current);if(i=s.type,e!==null&&s.stateNode!=null)Bj(e,s,i,c,d),e.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!c){if(s.stateNode===null)throw Error(p(166));return S(s),null}if(e=xh$1(uh$1.current),Gg(s)){c=s.stateNode,i=s.type;var h=s.memoizedProps;switch(c[Of$1]=s,c[Pf$1]=h,e=(s.mode&1)!==0,i){case"dialog":D$1("cancel",c),D$1("close",c);break;case"iframe":case"object":case"embed":D$1("load",c);break;case"video":case"audio":for(d=0;d<lf$1.length;d++)D$1(lf$1[d],c);break;case"source":D$1("error",c);break;case"img":case"image":case"link":D$1("error",c),D$1("load",c);break;case"details":D$1("toggle",c);break;case"input":Za$1(c,h),D$1("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!h.multiple},D$1("invalid",c);break;case"textarea":hb(c,h),D$1("invalid",c)}ub(i,h),d=null;for(var _ in h)if(h.hasOwnProperty(_)){var g=h[_];_==="children"?typeof g=="string"?c.textContent!==g&&(h.suppressHydrationWarning!==!0&&Af$1(c.textContent,g,e),d=["children",g]):typeof g=="number"&&c.textContent!==""+g&&(h.suppressHydrationWarning!==!0&&Af$1(c.textContent,g,e),d=["children",""+g]):ea$1.hasOwnProperty(_)&&g!=null&&_==="onScroll"&&D$1("scroll",c)}switch(i){case"input":Va$1(c),db(c,h,!0);break;case"textarea":Va$1(c),jb(c);break;case"select":case"option":break;default:typeof h.onClick=="function"&&(c.onclick=Bf$1)}c=d,s.updateQueue=c,c!==null&&(s.flags|=4)}else{_=d.nodeType===9?d:d.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kb(i)),e==="http://www.w3.org/1999/xhtml"?i==="script"?(e=_.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof c.is=="string"?e=_.createElement(i,{is:c.is}):(e=_.createElement(i),i==="select"&&(_=e,c.multiple?_.multiple=!0:c.size&&(_.size=c.size))):e=_.createElementNS(e,i),e[Of$1]=s,e[Pf$1]=c,zj(e,s,!1,!1),s.stateNode=e;e:{switch(_=vb(i,c),i){case"dialog":D$1("cancel",e),D$1("close",e),d=c;break;case"iframe":case"object":case"embed":D$1("load",e),d=c;break;case"video":case"audio":for(d=0;d<lf$1.length;d++)D$1(lf$1[d],e);d=c;break;case"source":D$1("error",e),d=c;break;case"img":case"image":case"link":D$1("error",e),D$1("load",e),d=c;break;case"details":D$1("toggle",e),d=c;break;case"input":Za$1(e,c),d=Ya(e,c),D$1("invalid",e);break;case"option":d=c;break;case"select":e._wrapperState={wasMultiple:!!c.multiple},d=A({},c,{value:void 0}),D$1("invalid",e);break;case"textarea":hb(e,c),d=gb(e,c),D$1("invalid",e);break;default:d=c}ub(i,d),g=d;for(h in g)if(g.hasOwnProperty(h)){var $=g[h];h==="style"?sb(e,$):h==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,$!=null&&nb(e,$)):h==="children"?typeof $=="string"?(i!=="textarea"||$!=="")&&ob(e,$):typeof $=="number"&&ob(e,""+$):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(ea$1.hasOwnProperty(h)?$!=null&&h==="onScroll"&&D$1("scroll",e):$!=null&&ta$1(e,h,$,_))}switch(i){case"input":Va$1(e),db(e,c,!1);break;case"textarea":Va$1(e),jb(e);break;case"option":c.value!=null&&e.setAttribute("value",""+Sa$1(c.value));break;case"select":e.multiple=!!c.multiple,h=c.value,h!=null?fb(e,!!c.multiple,h,!1):c.defaultValue!=null&&fb(e,!!c.multiple,c.defaultValue,!0);break;default:typeof d.onClick=="function"&&(e.onclick=Bf$1)}switch(i){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}}c&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return S(s),null;case 6:if(e&&s.stateNode!=null)Cj(e,s,e.memoizedProps,c);else{if(typeof c!="string"&&s.stateNode===null)throw Error(p(166));if(i=xh$1(wh$1.current),xh$1(uh$1.current),Gg(s)){if(c=s.stateNode,i=s.memoizedProps,c[Of$1]=s,(h=c.nodeValue!==i)&&(e=xg,e!==null))switch(e.tag){case 3:Af$1(c.nodeValue,i,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Af$1(c.nodeValue,i,(e.mode&1)!==0)}h&&(s.flags|=4)}else c=(i.nodeType===9?i:i.ownerDocument).createTextNode(c),c[Of$1]=s,s.stateNode=c}return S(s),null;case 13:if(E$1(L$1),c=s.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(I&&yg$1!==null&&s.mode&1&&!(s.flags&128))Hg(),Ig(),s.flags|=98560,h=!1;else if(h=Gg(s),c!==null&&c.dehydrated!==null){if(e===null){if(!h)throw Error(p(318));if(h=s.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(p(317));h[Of$1]=s}else Ig(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;S(s),h=!1}else zg!==null&&(Fj(zg),zg=null),h=!0;if(!h)return s.flags&65536?s:null}return s.flags&128?(s.lanes=i,s):(c=c!==null,c!==(e!==null&&e.memoizedState!==null)&&c&&(s.child.flags|=8192,s.mode&1&&(e===null||L$1.current&1?T===0&&(T=3):tj())),s.updateQueue!==null&&(s.flags|=4),S(s),null);case 4:return zh$1(),Aj(e,s),e===null&&sf$1(s.stateNode.containerInfo),S(s),null;case 10:return ah$1(s.type._context),S(s),null;case 17:return Zf$1(s.type)&&$f$1(),S(s),null;case 19:if(E$1(L$1),h=s.memoizedState,h===null)return S(s),null;if(c=(s.flags&128)!==0,_=h.rendering,_===null)if(c)Dj(h,!1);else{if(T!==0||e!==null&&e.flags&128)for(e=s.child;e!==null;){if(_=Ch$1(e),_!==null){for(s.flags|=128,Dj(h,!1),c=_.updateQueue,c!==null&&(s.updateQueue=c,s.flags|=4),s.subtreeFlags=0,c=i,i=s.child;i!==null;)h=i,e=c,h.flags&=14680066,_=h.alternate,_===null?(h.childLanes=0,h.lanes=e,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=_.childLanes,h.lanes=_.lanes,h.child=_.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=_.memoizedProps,h.memoizedState=_.memoizedState,h.updateQueue=_.updateQueue,h.type=_.type,e=_.dependencies,h.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return G(L$1,L$1.current&1|2),s.child}e=e.sibling}h.tail!==null&&B()>Gj&&(s.flags|=128,c=!0,Dj(h,!1),s.lanes=4194304)}else{if(!c)if(e=Ch$1(_),e!==null){if(s.flags|=128,c=!0,i=e.updateQueue,i!==null&&(s.updateQueue=i,s.flags|=4),Dj(h,!0),h.tail===null&&h.tailMode==="hidden"&&!_.alternate&&!I)return S(s),null}else 2*B()-h.renderingStartTime>Gj&&i!==1073741824&&(s.flags|=128,c=!0,Dj(h,!1),s.lanes=4194304);h.isBackwards?(_.sibling=s.child,s.child=_):(i=h.last,i!==null?i.sibling=_:s.child=_,h.last=_)}return h.tail!==null?(s=h.tail,h.rendering=s,h.tail=s.sibling,h.renderingStartTime=B(),s.sibling=null,i=L$1.current,G(L$1,c?i&1|2:i&1),s):(S(s),null);case 22:case 23:return Hj(),c=s.memoizedState!==null,e!==null&&e.memoizedState!==null!==c&&(s.flags|=8192),c&&s.mode&1?fj&1073741824&&(S(s),s.subtreeFlags&6&&(s.flags|=8192)):S(s),null;case 24:return null;case 25:return null}throw Error(p(156,s.tag))}function Ij(e,s){switch(wg(s),s.tag){case 1:return Zf$1(s.type)&&$f$1(),e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 3:return zh$1(),E$1(Wf$1),E$1(H),Eh(),e=s.flags,e&65536&&!(e&128)?(s.flags=e&-65537|128,s):null;case 5:return Bh$1(s),null;case 13:if(E$1(L$1),e=s.memoizedState,e!==null&&e.dehydrated!==null){if(s.alternate===null)throw Error(p(340));Ig()}return e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 19:return E$1(L$1),null;case 4:return zh$1(),null;case 10:return ah$1(s.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U$1=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(e,s){var i=e.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(c){W(e,s,c)}else i.current=null}function Mj(e,s,i){try{i()}catch(c){W(e,s,c)}}var Nj=!1;function Oj(e,s){if(Cf$1=dd$1,e=Me$1(),Ne$1(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var c=i.getSelection&&i.getSelection();if(c&&c.rangeCount!==0){i=c.anchorNode;var d=c.anchorOffset,h=c.focusNode;c=c.focusOffset;try{i.nodeType,h.nodeType}catch{i=null;break e}var _=0,g=-1,$=-1,_e=0,lt=0,at=e,it=null;t:for(;;){for(var ct;at!==i||d!==0&&at.nodeType!==3||(g=_+d),at!==h||c!==0&&at.nodeType!==3||($=_+c),at.nodeType===3&&(_+=at.nodeValue.length),(ct=at.firstChild)!==null;)it=at,at=ct;for(;;){if(at===e)break t;if(it===i&&++_e===d&&(g=_),it===h&&++lt===c&&($=_),(ct=at.nextSibling)!==null)break;at=it,it=at.parentNode}at=ct}i=g===-1||$===-1?null:{start:g,end:$}}else i=null}i=i||{start:0,end:0}}else i=null;for(Df$1={focusedElem:e,selectionRange:i},dd$1=!1,V=s;V!==null;)if(s=V,e=s.child,(s.subtreeFlags&1028)!==0&&e!==null)e.return=s,V=e;else for(;V!==null;){s=V;try{var mt=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(mt!==null){var pt=mt.memoizedProps,zt=mt.memoizedState,dt=s.stateNode,ft=dt.getSnapshotBeforeUpdate(s.elementType===s.type?pt:Ci(s.type,pt),zt);dt.__reactInternalSnapshotBeforeUpdate=ft}break;case 3:var kt=s.stateNode.containerInfo;kt.nodeType===1?kt.textContent="":kt.nodeType===9&&kt.documentElement&&kt.removeChild(kt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163))}}catch(St){W(s,s.return,St)}if(e=s.sibling,e!==null){e.return=s.return,V=e;break}V=s.return}return mt=Nj,Nj=!1,mt}function Pj(e,s,i){var c=s.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&e)===e){var h=d.destroy;d.destroy=void 0,h!==void 0&&Mj(s,i,h)}d=d.next}while(d!==c)}}function Qj(e,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var i=s=s.next;do{if((i.tag&e)===e){var c=i.create;i.destroy=c()}i=i.next}while(i!==s)}}function Rj(e){var s=e.ref;if(s!==null){var i=e.stateNode;switch(e.tag){case 5:e=i;break;default:e=i}typeof s=="function"?s(e):s.current=e}}function Sj(e){var s=e.alternate;s!==null&&(e.alternate=null,Sj(s)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(s=e.stateNode,s!==null&&(delete s[Of$1],delete s[Pf$1],delete s[of$1],delete s[Qf$1],delete s[Rf$1])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Tj(e){return e.tag===5||e.tag===3||e.tag===4}function Uj(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Tj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Vj(e,s,i){var c=e.tag;if(c===5||c===6)e=e.stateNode,s?i.nodeType===8?i.parentNode.insertBefore(e,s):i.insertBefore(e,s):(i.nodeType===8?(s=i.parentNode,s.insertBefore(e,i)):(s=i,s.appendChild(e)),i=i._reactRootContainer,i!=null||s.onclick!==null||(s.onclick=Bf$1));else if(c!==4&&(e=e.child,e!==null))for(Vj(e,s,i),e=e.sibling;e!==null;)Vj(e,s,i),e=e.sibling}function Wj(e,s,i){var c=e.tag;if(c===5||c===6)e=e.stateNode,s?i.insertBefore(e,s):i.appendChild(e);else if(c!==4&&(e=e.child,e!==null))for(Wj(e,s,i),e=e.sibling;e!==null;)Wj(e,s,i),e=e.sibling}var X$1=null,Xj=!1;function Yj(e,s,i){for(i=i.child;i!==null;)Zj(e,s,i),i=i.sibling}function Zj(e,s,i){if(lc$1&&typeof lc$1.onCommitFiberUnmount=="function")try{lc$1.onCommitFiberUnmount(kc,i)}catch{}switch(i.tag){case 5:U$1||Lj(i,s);case 6:var c=X$1,d=Xj;X$1=null,Yj(e,s,i),X$1=c,Xj=d,X$1!==null&&(Xj?(e=X$1,i=i.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)):X$1.removeChild(i.stateNode));break;case 18:X$1!==null&&(Xj?(e=X$1,i=i.stateNode,e.nodeType===8?Kf$1(e.parentNode,i):e.nodeType===1&&Kf$1(e,i),bd$1(e)):Kf$1(X$1,i.stateNode));break;case 4:c=X$1,d=Xj,X$1=i.stateNode.containerInfo,Xj=!0,Yj(e,s,i),X$1=c,Xj=d;break;case 0:case 11:case 14:case 15:if(!U$1&&(c=i.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){d=c=c.next;do{var h=d,_=h.destroy;h=h.tag,_!==void 0&&(h&2||h&4)&&Mj(i,s,_),d=d.next}while(d!==c)}Yj(e,s,i);break;case 1:if(!U$1&&(Lj(i,s),c=i.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=i.memoizedProps,c.state=i.memoizedState,c.componentWillUnmount()}catch(g){W(i,s,g)}Yj(e,s,i);break;case 21:Yj(e,s,i);break;case 22:i.mode&1?(U$1=(c=U$1)||i.memoizedState!==null,Yj(e,s,i),U$1=c):Yj(e,s,i);break;default:Yj(e,s,i)}}function ak(e){var s=e.updateQueue;if(s!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new Kj),s.forEach(function(c){var d=bk.bind(null,e,c);i.has(c)||(i.add(c),c.then(d,d))})}}function ck(e,s){var i=s.deletions;if(i!==null)for(var c=0;c<i.length;c++){var d=i[c];try{var h=e,_=s,g=_;e:for(;g!==null;){switch(g.tag){case 5:X$1=g.stateNode,Xj=!1;break e;case 3:X$1=g.stateNode.containerInfo,Xj=!0;break e;case 4:X$1=g.stateNode.containerInfo,Xj=!0;break e}g=g.return}if(X$1===null)throw Error(p(160));Zj(h,_,d),X$1=null,Xj=!1;var $=d.alternate;$!==null&&($.return=null),d.return=null}catch(_e){W(d,s,_e)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)dk(s,e),s=s.sibling}function dk(e,s){var i=e.alternate,c=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ck(s,e),ek(e),c&4){try{Pj(3,e,e.return),Qj(3,e)}catch(pt){W(e,e.return,pt)}try{Pj(5,e,e.return)}catch(pt){W(e,e.return,pt)}}break;case 1:ck(s,e),ek(e),c&512&&i!==null&&Lj(i,i.return);break;case 5:if(ck(s,e),ek(e),c&512&&i!==null&&Lj(i,i.return),e.flags&32){var d=e.stateNode;try{ob(d,"")}catch(pt){W(e,e.return,pt)}}if(c&4&&(d=e.stateNode,d!=null)){var h=e.memoizedProps,_=i!==null?i.memoizedProps:h,g=e.type,$=e.updateQueue;if(e.updateQueue=null,$!==null)try{g==="input"&&h.type==="radio"&&h.name!=null&&ab(d,h),vb(g,_);var _e=vb(g,h);for(_=0;_<$.length;_+=2){var lt=$[_],at=$[_+1];lt==="style"?sb(d,at):lt==="dangerouslySetInnerHTML"?nb(d,at):lt==="children"?ob(d,at):ta$1(d,lt,at,_e)}switch(g){case"input":bb(d,h);break;case"textarea":ib(d,h);break;case"select":var it=d._wrapperState.wasMultiple;d._wrapperState.wasMultiple=!!h.multiple;var ct=h.value;ct!=null?fb(d,!!h.multiple,ct,!1):it!==!!h.multiple&&(h.defaultValue!=null?fb(d,!!h.multiple,h.defaultValue,!0):fb(d,!!h.multiple,h.multiple?[]:"",!1))}d[Pf$1]=h}catch(pt){W(e,e.return,pt)}}break;case 6:if(ck(s,e),ek(e),c&4){if(e.stateNode===null)throw Error(p(162));d=e.stateNode,h=e.memoizedProps;try{d.nodeValue=h}catch(pt){W(e,e.return,pt)}}break;case 3:if(ck(s,e),ek(e),c&4&&i!==null&&i.memoizedState.isDehydrated)try{bd$1(s.containerInfo)}catch(pt){W(e,e.return,pt)}break;case 4:ck(s,e),ek(e);break;case 13:ck(s,e),ek(e),d=e.child,d.flags&8192&&(h=d.memoizedState!==null,d.stateNode.isHidden=h,!h||d.alternate!==null&&d.alternate.memoizedState!==null||(fk=B())),c&4&&ak(e);break;case 22:if(lt=i!==null&&i.memoizedState!==null,e.mode&1?(U$1=(_e=U$1)||lt,ck(s,e),U$1=_e):ck(s,e),ek(e),c&8192){if(_e=e.memoizedState!==null,(e.stateNode.isHidden=_e)&&!lt&&e.mode&1)for(V=e,lt=e.child;lt!==null;){for(at=V=lt;V!==null;){switch(it=V,ct=it.child,it.tag){case 0:case 11:case 14:case 15:Pj(4,it,it.return);break;case 1:Lj(it,it.return);var mt=it.stateNode;if(typeof mt.componentWillUnmount=="function"){c=it,i=it.return;try{s=c,mt.props=s.memoizedProps,mt.state=s.memoizedState,mt.componentWillUnmount()}catch(pt){W(c,i,pt)}}break;case 5:Lj(it,it.return);break;case 22:if(it.memoizedState!==null){gk(at);continue}}ct!==null?(ct.return=it,V=ct):gk(at)}lt=lt.sibling}e:for(lt=null,at=e;;){if(at.tag===5){if(lt===null){lt=at;try{d=at.stateNode,_e?(h=d.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none"):(g=at.stateNode,$=at.memoizedProps.style,_=$!=null&&$.hasOwnProperty("display")?$.display:null,g.style.display=rb("display",_))}catch(pt){W(e,e.return,pt)}}}else if(at.tag===6){if(lt===null)try{at.stateNode.nodeValue=_e?"":at.memoizedProps}catch(pt){W(e,e.return,pt)}}else if((at.tag!==22&&at.tag!==23||at.memoizedState===null||at===e)&&at.child!==null){at.child.return=at,at=at.child;continue}if(at===e)break e;for(;at.sibling===null;){if(at.return===null||at.return===e)break e;lt===at&&(lt=null),at=at.return}lt===at&&(lt=null),at.sibling.return=at.return,at=at.sibling}}break;case 19:ck(s,e),ek(e),c&4&&ak(e);break;case 21:break;default:ck(s,e),ek(e)}}function ek(e){var s=e.flags;if(s&2){try{e:{for(var i=e.return;i!==null;){if(Tj(i)){var c=i;break e}i=i.return}throw Error(p(160))}switch(c.tag){case 5:var d=c.stateNode;c.flags&32&&(ob(d,""),c.flags&=-33);var h=Uj(e);Wj(e,h,d);break;case 3:case 4:var _=c.stateNode.containerInfo,g=Uj(e);Vj(e,g,_);break;default:throw Error(p(161))}}catch($){W(e,e.return,$)}e.flags&=-3}s&4096&&(e.flags&=-4097)}function hk(e,s,i){V=e,ik(e)}function ik(e,s,i){for(var c=(e.mode&1)!==0;V!==null;){var d=V,h=d.child;if(d.tag===22&&c){var _=d.memoizedState!==null||Jj;if(!_){var g=d.alternate,$=g!==null&&g.memoizedState!==null||U$1;g=Jj;var _e=U$1;if(Jj=_,(U$1=$)&&!_e)for(V=d;V!==null;)_=V,$=_.child,_.tag===22&&_.memoizedState!==null?jk(d):$!==null?($.return=_,V=$):jk(d);for(;h!==null;)V=h,ik(h),h=h.sibling;V=d,Jj=g,U$1=_e}kk(e)}else d.subtreeFlags&8772&&h!==null?(h.return=d,V=h):kk(e)}}function kk(e){for(;V!==null;){var s=V;if(s.flags&8772){var i=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:U$1||Qj(5,s);break;case 1:var c=s.stateNode;if(s.flags&4&&!U$1)if(i===null)c.componentDidMount();else{var d=s.elementType===s.type?i.memoizedProps:Ci(s.type,i.memoizedProps);c.componentDidUpdate(d,i.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var h=s.updateQueue;h!==null&&sh$1(s,h,c);break;case 3:var _=s.updateQueue;if(_!==null){if(i=null,s.child!==null)switch(s.child.tag){case 5:i=s.child.stateNode;break;case 1:i=s.child.stateNode}sh$1(s,_,i)}break;case 5:var g=s.stateNode;if(i===null&&s.flags&4){i=g;var $=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":$.autoFocus&&i.focus();break;case"img":$.src&&(i.src=$.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var _e=s.alternate;if(_e!==null){var lt=_e.memoizedState;if(lt!==null){var at=lt.dehydrated;at!==null&&bd$1(at)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p(163))}U$1||s.flags&512&&Rj(s)}catch(it){W(s,s.return,it)}}if(s===e){V=null;break}if(i=s.sibling,i!==null){i.return=s.return,V=i;break}V=s.return}}function gk(e){for(;V!==null;){var s=V;if(s===e){V=null;break}var i=s.sibling;if(i!==null){i.return=s.return,V=i;break}V=s.return}}function jk(e){for(;V!==null;){var s=V;try{switch(s.tag){case 0:case 11:case 15:var i=s.return;try{Qj(4,s)}catch($){W(s,i,$)}break;case 1:var c=s.stateNode;if(typeof c.componentDidMount=="function"){var d=s.return;try{c.componentDidMount()}catch($){W(s,d,$)}}var h=s.return;try{Rj(s)}catch($){W(s,h,$)}break;case 5:var _=s.return;try{Rj(s)}catch($){W(s,_,$)}}}catch($){W(s,s.return,$)}if(s===e){V=null;break}var g=s.sibling;if(g!==null){g.return=s.return,V=g;break}V=s.return}}var lk=Math.ceil,mk=ua$1.ReactCurrentDispatcher,nk=ua$1.ReactCurrentOwner,ok=ua$1.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf$1(0),T=0,pk=null,rh$1=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return K&6?B():Ak!==-1?Ak:Ak=B()}function yi(e){return e.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(e=C,e!==0||(e=window.event,e=e===void 0?16:jd$1(e.type)),e):1}function gi(e,s,i,c){if(50<yk)throw yk=0,zk=null,Error(p(185));Ac(e,i,c),(!(K&2)||e!==Q)&&(e===Q&&(!(K&2)&&(qk|=i),T===4&&Ck(e,Z)),Dk(e,c),i===1&&K===0&&!(s.mode&1)&&(Gj=B()+500,fg$1&&jg()))}function Dk(e,s){var i=e.callbackNode;wc(e,s);var c=uc$1(e,e===Q?Z:0);if(c===0)i!==null&&bc(i),e.callbackNode=null,e.callbackPriority=0;else if(s=c&-c,e.callbackPriority!==s){if(i!=null&&bc(i),s===1)e.tag===0?ig$1(Ek.bind(null,e)):hg$1(Ek.bind(null,e)),Jf(function(){!(K&6)&&jg()}),i=null;else{switch(Dc(c)){case 1:i=fc$1;break;case 4:i=gc$1;break;case 16:i=hc$1;break;case 536870912:i=jc;break;default:i=hc$1}i=Fk(i,Gk.bind(null,e))}e.callbackPriority=s,e.callbackNode=i}}function Gk(e,s){if(Ak=-1,Bk=0,K&6)throw Error(p(327));var i=e.callbackNode;if(Hk()&&e.callbackNode!==i)return null;var c=uc$1(e,e===Q?Z:0);if(c===0)return null;if(c&30||c&e.expiredLanes||s)s=Ik(e,c);else{s=c;var d=K;K|=2;var h=Jk();(Q!==e||Z!==s)&&(uk=null,Gj=B()+500,Kk(e,s));do try{Lk();break}catch(g){Mk(e,g)}while(!0);$g(),mk.current=h,K=d,Y!==null?s=0:(Q=null,Z=0,s=T)}if(s!==0){if(s===2&&(d=xc(e),d!==0&&(c=d,s=Nk(e,d))),s===1)throw i=pk,Kk(e,0),Ck(e,c),Dk(e,B()),i;if(s===6)Ck(e,c);else{if(d=e.current.alternate,!(c&30)&&!Ok(d)&&(s=Ik(e,c),s===2&&(h=xc(e),h!==0&&(c=h,s=Nk(e,h))),s===1))throw i=pk,Kk(e,0),Ck(e,c),Dk(e,B()),i;switch(e.finishedWork=d,e.finishedLanes=c,s){case 0:case 1:throw Error(p(345));case 2:Pk(e,tk,uk);break;case 3:if(Ck(e,c),(c&130023424)===c&&(s=fk+500-B(),10<s)){if(uc$1(e,0)!==0)break;if(d=e.suspendedLanes,(d&c)!==c){R(),e.pingedLanes|=e.suspendedLanes&d;break}e.timeoutHandle=Ff$1(Pk.bind(null,e,tk,uk),s);break}Pk(e,tk,uk);break;case 4:if(Ck(e,c),(c&4194240)===c)break;for(s=e.eventTimes,d=-1;0<c;){var _=31-oc$1(c);h=1<<_,_=s[_],_>d&&(d=_),c&=~h}if(c=d,c=B()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*lk(c/1960))-c,10<c){e.timeoutHandle=Ff$1(Pk.bind(null,e,tk,uk),c);break}Pk(e,tk,uk);break;case 5:Pk(e,tk,uk);break;default:throw Error(p(329))}}}return Dk(e,B()),e.callbackNode===i?Gk.bind(null,e):null}function Nk(e,s){var i=sk;return e.current.memoizedState.isDehydrated&&(Kk(e,s).flags|=256),e=Ik(e,s),e!==2&&(s=tk,tk=i,s!==null&&Fj(s)),e}function Fj(e){tk===null?tk=e:tk.push.apply(tk,e)}function Ok(e){for(var s=e;;){if(s.flags&16384){var i=s.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var c=0;c<i.length;c++){var d=i[c],h=d.getSnapshot;d=d.value;try{if(!He$1(h(),d))return!1}catch{return!1}}}if(i=s.child,s.subtreeFlags&16384&&i!==null)i.return=s,s=i;else{if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Ck(e,s){for(s&=~rk,s&=~qk,e.suspendedLanes|=s,e.pingedLanes&=~s,e=e.expirationTimes;0<s;){var i=31-oc$1(s),c=1<<i;e[i]=-1,s&=~c}}function Ek(e){if(K&6)throw Error(p(327));Hk();var s=uc$1(e,0);if(!(s&1))return Dk(e,B()),null;var i=Ik(e,s);if(e.tag!==0&&i===2){var c=xc(e);c!==0&&(s=c,i=Nk(e,c))}if(i===1)throw i=pk,Kk(e,0),Ck(e,s),Dk(e,B()),i;if(i===6)throw Error(p(345));return e.finishedWork=e.current.alternate,e.finishedLanes=s,Pk(e,tk,uk),Dk(e,B()),null}function Qk(e,s){var i=K;K|=1;try{return e(s)}finally{K=i,K===0&&(Gj=B()+500,fg$1&&jg())}}function Rk(e){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var s=K;K|=1;var i=ok.transition,c=C;try{if(ok.transition=null,C=1,e)return e()}finally{C=c,ok.transition=i,K=s,!(K&6)&&jg()}}function Hj(){fj=ej.current,E$1(ej)}function Kk(e,s){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,Gf$1(i)),Y!==null)for(i=Y.return;i!==null;){var c=i;switch(wg(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&$f$1();break;case 3:zh$1(),E$1(Wf$1),E$1(H),Eh();break;case 5:Bh$1(c);break;case 4:zh$1();break;case 13:E$1(L$1);break;case 19:E$1(L$1);break;case 10:ah$1(c.type._context);break;case 22:case 23:Hj()}i=i.return}if(Q=e,Y=e=Pg(e.current,null),Z=fj=s,T=0,pk=null,rk=qk=rh$1=0,tk=sk=null,fh$1!==null){for(s=0;s<fh$1.length;s++)if(i=fh$1[s],c=i.interleaved,c!==null){i.interleaved=null;var d=c.next,h=i.pending;if(h!==null){var _=h.next;h.next=d,c.next=_}i.pending=c}fh$1=null}return e}function Mk(e,s){do{var i=Y;try{if($g(),Fh$1.current=Rh$1,Ih$1){for(var c=M$2.memoizedState;c!==null;){var d=c.queue;d!==null&&(d.pending=null),c=c.next}Ih$1=!1}if(Hh$1=0,O=N$1=M$2=null,Jh$1=!1,Kh$1=0,nk.current=null,i===null||i.return===null){T=1,pk=s,Y=null;break}e:{var h=e,_=i.return,g=i,$=s;if(s=Z,g.flags|=32768,$!==null&&typeof $=="object"&&typeof $.then=="function"){var _e=$,lt=g,at=lt.tag;if(!(lt.mode&1)&&(at===0||at===11||at===15)){var it=lt.alternate;it?(lt.updateQueue=it.updateQueue,lt.memoizedState=it.memoizedState,lt.lanes=it.lanes):(lt.updateQueue=null,lt.memoizedState=null)}var ct=Ui(_);if(ct!==null){ct.flags&=-257,Vi(ct,_,g,h,s),ct.mode&1&&Si(h,_e,s),s=ct,$=_e;var mt=s.updateQueue;if(mt===null){var pt=new Set;pt.add($),s.updateQueue=pt}else mt.add($);break e}else{if(!(s&1)){Si(h,_e,s),tj();break e}$=Error(p(426))}}else if(I&&g.mode&1){var zt=Ui(_);if(zt!==null){!(zt.flags&65536)&&(zt.flags|=256),Vi(zt,_,g,h,s),Jg(Ji$1($,g));break e}}h=$=Ji$1($,g),T!==4&&(T=2),sk===null?sk=[h]:sk.push(h),h=_;do{switch(h.tag){case 3:h.flags|=65536,s&=-s,h.lanes|=s;var dt=Ni(h,$,s);ph$1(h,dt);break e;case 1:g=$;var ft=h.type,kt=h.stateNode;if(!(h.flags&128)&&(typeof ft.getDerivedStateFromError=="function"||kt!==null&&typeof kt.componentDidCatch=="function"&&(Ri===null||!Ri.has(kt)))){h.flags|=65536,s&=-s,h.lanes|=s;var St=Qi$1(h,g,s);ph$1(h,St);break e}}h=h.return}while(h!==null)}Sk(i)}catch(Lt){s=Lt,Y===i&&i!==null&&(Y=i=i.return);continue}break}while(!0)}function Jk(){var e=mk.current;return mk.current=Rh$1,e===null?Rh$1:e}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh$1&268435455)&&!(qk&268435455)||Ck(Q,Z)}function Ik(e,s){var i=K;K|=2;var c=Jk();(Q!==e||Z!==s)&&(uk=null,Kk(e,s));do try{Tk();break}catch(d){Mk(e,d)}while(!0);if($g(),K=i,mk.current=c,Y!==null)throw Error(p(261));return Q=null,Z=0,T}function Tk(){for(;Y!==null;)Uk(Y)}function Lk(){for(;Y!==null&&!cc$1();)Uk(Y)}function Uk(e){var s=Vk(e.alternate,e,fj);e.memoizedProps=e.pendingProps,s===null?Sk(e):Y=s,nk.current=null}function Sk(e){var s=e;do{var i=s.alternate;if(e=s.return,s.flags&32768){if(i=Ij(i,s),i!==null){i.flags&=32767,Y=i;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{T=6,Y=null;return}}else if(i=Ej(i,s,fj),i!==null){Y=i;return}if(s=s.sibling,s!==null){Y=s;return}Y=s=e}while(s!==null);T===0&&(T=5)}function Pk(e,s,i){var c=C,d=ok.transition;try{ok.transition=null,C=1,Wk(e,s,i,c)}finally{ok.transition=d,C=c}return null}function Wk(e,s,i,c){do Hk();while(wk!==null);if(K&6)throw Error(p(327));i=e.finishedWork;var d=e.finishedLanes;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(p(177));e.callbackNode=null,e.callbackPriority=0;var h=i.lanes|i.childLanes;if(Bc(e,h),e===Q&&(Y=Q=null,Z=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||vk||(vk=!0,Fk(hc$1,function(){return Hk(),null})),h=(i.flags&15990)!==0,i.subtreeFlags&15990||h){h=ok.transition,ok.transition=null;var _=C;C=1;var g=K;K|=4,nk.current=null,Oj(e,i),dk(i,e),Oe$1(Df$1),dd$1=!!Cf$1,Df$1=Cf$1=null,e.current=i,hk(i),dc$1(),K=g,C=_,ok.transition=h}else e.current=i;if(vk&&(vk=!1,wk=e,xk=d),h=e.pendingLanes,h===0&&(Ri=null),mc$1(i.stateNode),Dk(e,B()),s!==null)for(c=e.onRecoverableError,i=0;i<s.length;i++)d=s[i],c(d.value,{componentStack:d.stack,digest:d.digest});if(Oi)throw Oi=!1,e=Pi,Pi=null,e;return xk&1&&e.tag!==0&&Hk(),h=e.pendingLanes,h&1?e===zk?yk++:(yk=0,zk=e):yk=0,jg(),null}function Hk(){if(wk!==null){var e=Dc(xk),s=ok.transition,i=C;try{if(ok.transition=null,C=16>e?16:e,wk===null)var c=!1;else{if(e=wk,wk=null,xk=0,K&6)throw Error(p(331));var d=K;for(K|=4,V=e.current;V!==null;){var h=V,_=h.child;if(V.flags&16){var g=h.deletions;if(g!==null){for(var $=0;$<g.length;$++){var _e=g[$];for(V=_e;V!==null;){var lt=V;switch(lt.tag){case 0:case 11:case 15:Pj(8,lt,h)}var at=lt.child;if(at!==null)at.return=lt,V=at;else for(;V!==null;){lt=V;var it=lt.sibling,ct=lt.return;if(Sj(lt),lt===_e){V=null;break}if(it!==null){it.return=ct,V=it;break}V=ct}}}var mt=h.alternate;if(mt!==null){var pt=mt.child;if(pt!==null){mt.child=null;do{var zt=pt.sibling;pt.sibling=null,pt=zt}while(pt!==null)}}V=h}}if(h.subtreeFlags&2064&&_!==null)_.return=h,V=_;else e:for(;V!==null;){if(h=V,h.flags&2048)switch(h.tag){case 0:case 11:case 15:Pj(9,h,h.return)}var dt=h.sibling;if(dt!==null){dt.return=h.return,V=dt;break e}V=h.return}}var ft=e.current;for(V=ft;V!==null;){_=V;var kt=_.child;if(_.subtreeFlags&2064&&kt!==null)kt.return=_,V=kt;else e:for(_=ft;V!==null;){if(g=V,g.flags&2048)try{switch(g.tag){case 0:case 11:case 15:Qj(9,g)}}catch(Lt){W(g,g.return,Lt)}if(g===_){V=null;break e}var St=g.sibling;if(St!==null){St.return=g.return,V=St;break e}V=g.return}}if(K=d,jg(),lc$1&&typeof lc$1.onPostCommitFiberRoot=="function")try{lc$1.onPostCommitFiberRoot(kc,e)}catch{}c=!0}return c}finally{C=i,ok.transition=s}}return!1}function Xk(e,s,i){s=Ji$1(i,s),s=Ni(e,s,1),e=nh$1(e,s,1),s=R(),e!==null&&(Ac(e,1,s),Dk(e,s))}function W(e,s,i){if(e.tag===3)Xk(e,e,i);else for(;s!==null;){if(s.tag===3){Xk(s,e,i);break}else if(s.tag===1){var c=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Ri===null||!Ri.has(c))){e=Ji$1(i,e),e=Qi$1(s,e,1),s=nh$1(s,e,1),e=R(),s!==null&&(Ac(s,1,e),Dk(s,e));break}}s=s.return}}function Ti(e,s,i){var c=e.pingCache;c!==null&&c.delete(s),s=R(),e.pingedLanes|=e.suspendedLanes&i,Q===e&&(Z&i)===i&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-fk?Kk(e,0):rk|=i),Dk(e,s)}function Yk(e,s){s===0&&(e.mode&1?(s=sc$1,sc$1<<=1,!(sc$1&130023424)&&(sc$1=4194304)):s=1);var i=R();e=ih$1(e,s),e!==null&&(Ac(e,s,i),Dk(e,i))}function uj(e){var s=e.memoizedState,i=0;s!==null&&(i=s.retryLane),Yk(e,i)}function bk(e,s){var i=0;switch(e.tag){case 13:var c=e.stateNode,d=e.memoizedState;d!==null&&(i=d.retryLane);break;case 19:c=e.stateNode;break;default:throw Error(p(314))}c!==null&&c.delete(s),Yk(e,i)}var Vk;Vk=function(e,s,i){if(e!==null)if(e.memoizedProps!==s.pendingProps||Wf$1.current)dh$1=!0;else{if(!(e.lanes&i)&&!(s.flags&128))return dh$1=!1,yj(e,s,i);dh$1=!!(e.flags&131072)}else dh$1=!1,I&&s.flags&1048576&&ug$1(s,ng$1,s.index);switch(s.lanes=0,s.tag){case 2:var c=s.type;ij(e,s),e=s.pendingProps;var d=Yf$1(s,H.current);ch$1(s,i),d=Nh$1(null,s,c,e,d,i);var h=Sh$1();return s.flags|=1,typeof d=="object"&&d!==null&&typeof d.render=="function"&&d.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,Zf$1(c)?(h=!0,cg$1(s)):h=!1,s.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,kh$1(s),d.updater=Ei,s.stateNode=d,d._reactInternals=s,Ii(s,c,e,i),s=jj(null,s,c,!0,h,i)):(s.tag=0,I&&h&&vg(s),Xi$1(null,s,d,i),s=s.child),s;case 16:c=s.elementType;e:{switch(ij(e,s),e=s.pendingProps,d=c._init,c=d(c._payload),s.type=c,d=s.tag=Zk(c),e=Ci(c,e),d){case 0:s=cj(null,s,c,e,i);break e;case 1:s=hj(null,s,c,e,i);break e;case 11:s=Yi$1(null,s,c,e,i);break e;case 14:s=$i(null,s,c,Ci(c.type,e),i);break e}throw Error(p(306,c,""))}return s;case 0:return c=s.type,d=s.pendingProps,d=s.elementType===c?d:Ci(c,d),cj(e,s,c,d,i);case 1:return c=s.type,d=s.pendingProps,d=s.elementType===c?d:Ci(c,d),hj(e,s,c,d,i);case 3:e:{if(kj(s),e===null)throw Error(p(387));c=s.pendingProps,h=s.memoizedState,d=h.element,lh$1(e,s),qh$1(s,c,null,i);var _=s.memoizedState;if(c=_.element,h.isDehydrated)if(h={element:c,isDehydrated:!1,cache:_.cache,pendingSuspenseBoundaries:_.pendingSuspenseBoundaries,transitions:_.transitions},s.updateQueue.baseState=h,s.memoizedState=h,s.flags&256){d=Ji$1(Error(p(423)),s),s=lj(e,s,c,i,d);break e}else if(c!==d){d=Ji$1(Error(p(424)),s),s=lj(e,s,c,i,d);break e}else for(yg$1=Lf$1(s.stateNode.containerInfo.firstChild),xg=s,I=!0,zg=null,i=Vg(s,null,c,i),s.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Ig(),c===d){s=Zi$1(e,s,i);break e}Xi$1(e,s,c,i)}s=s.child}return s;case 5:return Ah$1(s),e===null&&Eg(s),c=s.type,d=s.pendingProps,h=e!==null?e.memoizedProps:null,_=d.children,Ef$1(c,d)?_=null:h!==null&&Ef$1(c,h)&&(s.flags|=32),gj(e,s),Xi$1(e,s,_,i),s.child;case 6:return e===null&&Eg(s),null;case 13:return oj(e,s,i);case 4:return yh$1(s,s.stateNode.containerInfo),c=s.pendingProps,e===null?s.child=Ug(s,null,c,i):Xi$1(e,s,c,i),s.child;case 11:return c=s.type,d=s.pendingProps,d=s.elementType===c?d:Ci(c,d),Yi$1(e,s,c,d,i);case 7:return Xi$1(e,s,s.pendingProps,i),s.child;case 8:return Xi$1(e,s,s.pendingProps.children,i),s.child;case 12:return Xi$1(e,s,s.pendingProps.children,i),s.child;case 10:e:{if(c=s.type._context,d=s.pendingProps,h=s.memoizedProps,_=d.value,G(Wg,c._currentValue),c._currentValue=_,h!==null)if(He$1(h.value,_)){if(h.children===d.children&&!Wf$1.current){s=Zi$1(e,s,i);break e}}else for(h=s.child,h!==null&&(h.return=s);h!==null;){var g=h.dependencies;if(g!==null){_=h.child;for(var $=g.firstContext;$!==null;){if($.context===c){if(h.tag===1){$=mh$1(-1,i&-i),$.tag=2;var _e=h.updateQueue;if(_e!==null){_e=_e.shared;var lt=_e.pending;lt===null?$.next=$:($.next=lt.next,lt.next=$),_e.pending=$}}h.lanes|=i,$=h.alternate,$!==null&&($.lanes|=i),bh$1(h.return,i,s),g.lanes|=i;break}$=$.next}}else if(h.tag===10)_=h.type===s.type?null:h.child;else if(h.tag===18){if(_=h.return,_===null)throw Error(p(341));_.lanes|=i,g=_.alternate,g!==null&&(g.lanes|=i),bh$1(_,i,s),_=h.sibling}else _=h.child;if(_!==null)_.return=h;else for(_=h;_!==null;){if(_===s){_=null;break}if(h=_.sibling,h!==null){h.return=_.return,_=h;break}_=_.return}h=_}Xi$1(e,s,d.children,i),s=s.child}return s;case 9:return d=s.type,c=s.pendingProps.children,ch$1(s,i),d=eh(d),c=c(d),s.flags|=1,Xi$1(e,s,c,i),s.child;case 14:return c=s.type,d=Ci(c,s.pendingProps),d=Ci(c.type,d),$i(e,s,c,d,i);case 15:return bj(e,s,s.type,s.pendingProps,i);case 17:return c=s.type,d=s.pendingProps,d=s.elementType===c?d:Ci(c,d),ij(e,s),s.tag=1,Zf$1(c)?(e=!0,cg$1(s)):e=!1,ch$1(s,i),Gi(s,c,d),Ii(s,c,d,i),jj(null,s,c,!0,e,i);case 19:return xj(e,s,i);case 22:return dj(e,s,i)}throw Error(p(156,s.tag))};function Fk(e,s){return ac$1(e,s)}function $k(e,s,i,c){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(e,s,i,c){return new $k(e,s,i,c)}function aj(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Zk(e){if(typeof e=="function")return aj(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Da$1)return 11;if(e===Ga$1)return 14}return 2}function Pg(e,s){var i=e.alternate;return i===null?(i=Bg(e.tag,s,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=s,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&14680064,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,s=e.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function Rg(e,s,i,c,d,h){var _=2;if(c=e,typeof e=="function")aj(e)&&(_=1);else if(typeof e=="string")_=5;else e:switch(e){case ya$1:return Tg(i.children,d,h,s);case za$1:_=8,d|=8;break;case Aa$1:return e=Bg(12,i,s,d|2),e.elementType=Aa$1,e.lanes=h,e;case Ea$1:return e=Bg(13,i,s,d),e.elementType=Ea$1,e.lanes=h,e;case Fa$1:return e=Bg(19,i,s,d),e.elementType=Fa$1,e.lanes=h,e;case Ia$1:return pj(i,d,h,s);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ba$1:_=10;break e;case Ca$1:_=9;break e;case Da$1:_=11;break e;case Ga$1:_=14;break e;case Ha$1:_=16,c=null;break e}throw Error(p(130,e==null?e:typeof e,""))}return s=Bg(_,i,s,d),s.elementType=e,s.type=c,s.lanes=h,s}function Tg(e,s,i,c){return e=Bg(7,e,c,s),e.lanes=i,e}function pj(e,s,i,c){return e=Bg(22,e,c,s),e.elementType=Ia$1,e.lanes=i,e.stateNode={isHidden:!1},e}function Qg(e,s,i){return e=Bg(6,e,null,s),e.lanes=i,e}function Sg(e,s,i){return s=Bg(4,e.children!==null?e.children:[],e.key,s),s.lanes=i,s.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},s}function al$1(e,s,i,c,d){this.tag=s,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=c,this.onRecoverableError=d,this.mutableSourceEagerHydrationData=null}function bl$1(e,s,i,c,d,h,_,g,$){return e=new al$1(e,s,i,g,$),s===1?(s=1,h===!0&&(s|=8)):s=0,h=Bg(3,null,null,s),e.current=h,h.stateNode=e,h.memoizedState={element:c,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh$1(h),e}function cl$1(e,s,i){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa$1,key:c==null?null:""+c,children:e,containerInfo:s,implementation:i}}function dl$1(e){if(!e)return Vf$1;e=e._reactInternals;e:{if(Vb(e)!==e||e.tag!==1)throw Error(p(170));var s=e;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(Zf$1(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(p(171))}if(e.tag===1){var i=e.type;if(Zf$1(i))return bg$1(e,i,s)}return s}function el$1(e,s,i,c,d,h,_,g,$){return e=bl$1(i,c,!0,e,d,h,_,g,$),e.context=dl$1(null),i=e.current,c=R(),d=yi(i),h=mh$1(c,d),h.callback=s??null,nh$1(i,h,d),e.current.lanes=d,Ac(e,d,c),Dk(e,c),e}function fl$1(e,s,i,c){var d=s.current,h=R(),_=yi(d);return i=dl$1(i),s.context===null?s.context=i:s.pendingContext=i,s=mh$1(h,_),s.payload={element:e},c=c===void 0?null:c,c!==null&&(s.callback=c),e=nh$1(d,s,_),e!==null&&(gi(e,d,_,h),oh$1(e,d,_)),_}function gl$1(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function hl$1(e,s){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<s?i:s}}function il$1(e,s){hl$1(e,s),(e=e.alternate)&&hl$1(e,s)}function jl$1(){return null}var kl$1=typeof reportError=="function"?reportError:function(e){console.error(e)};function ll$1(e){this._internalRoot=e}ml$1.prototype.render=ll$1.prototype.render=function(e){var s=this._internalRoot;if(s===null)throw Error(p(409));fl$1(e,s,null,null)};ml$1.prototype.unmount=ll$1.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var s=e.containerInfo;Rk(function(){fl$1(null,e,null,null)}),s[uf$1]=null}};function ml$1(e){this._internalRoot=e}ml$1.prototype.unstable_scheduleHydration=function(e){if(e){var s=Hc();e={blockedOn:null,target:e,priority:s};for(var i=0;i<Qc.length&&s!==0&&s<Qc[i].priority;i++);Qc.splice(i,0,e),i===0&&Vc(e)}};function nl$1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ol$1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function pl$1(){}function ql$1(e,s,i,c,d){if(d){if(typeof c=="function"){var h=c;c=function(){var _e=gl$1(_);h.call(_e)}}var _=el$1(s,c,e,0,null,!1,!1,"",pl$1);return e._reactRootContainer=_,e[uf$1]=_.current,sf$1(e.nodeType===8?e.parentNode:e),Rk(),_}for(;d=e.lastChild;)e.removeChild(d);if(typeof c=="function"){var g=c;c=function(){var _e=gl$1($);g.call(_e)}}var $=bl$1(e,0,!1,null,null,!1,!1,"",pl$1);return e._reactRootContainer=$,e[uf$1]=$.current,sf$1(e.nodeType===8?e.parentNode:e),Rk(function(){fl$1(s,$,i,c)}),$}function rl$1(e,s,i,c,d){var h=i._reactRootContainer;if(h){var _=h;if(typeof d=="function"){var g=d;d=function(){var $=gl$1(_);g.call($)}}fl$1(s,_,e,d)}else _=ql$1(i,s,e,d,c);return gl$1(_)}Ec=function(e){switch(e.tag){case 3:var s=e.stateNode;if(s.current.memoizedState.isDehydrated){var i=tc$1(s.pendingLanes);i!==0&&(Cc(s,i|1),Dk(s,B()),!(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var c=ih$1(e,1);if(c!==null){var d=R();gi(c,e,1,d)}}),il$1(e,1)}};Fc=function(e){if(e.tag===13){var s=ih$1(e,134217728);if(s!==null){var i=R();gi(s,e,134217728,i)}il$1(e,134217728)}};Gc=function(e){if(e.tag===13){var s=yi(e),i=ih$1(e,s);if(i!==null){var c=R();gi(i,e,s,c)}il$1(e,s)}};Hc=function(){return C};Ic=function(e,s){var i=C;try{return C=e,s()}finally{C=i}};yb=function(e,s,i){switch(s){case"input":if(bb(e,i),s=i.name,i.type==="radio"&&s!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<i.length;s++){var c=i[s];if(c!==e&&c.form===e.form){var d=Db(c);if(!d)throw Error(p(90));Wa$1(c),bb(c,d)}}}break;case"textarea":ib(e,i);break;case"select":s=i.value,s!=null&&fb(e,!!i.multiple,s,!1)}};Gb=Qk;Hb=Rk;var sl$1={usingClientEntryPoint:!1,Events:[Cb,ue$1,Db,Eb,Fb,Qk]},tl$1={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul$1={bundleType:tl$1.bundleType,version:tl$1.version,rendererPackageName:tl$1.rendererPackageName,rendererConfig:tl$1.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua$1.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zb(e),e===null?null:e.stateNode},findFiberByHostInstance:tl$1.findFiberByHostInstance||jl$1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl$1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl$1.isDisabled&&vl$1.supportsFiber)try{kc=vl$1.inject(ul$1),lc$1=vl$1}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl$1;reactDom_production_min.createPortal=function(e,s){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl$1(s))throw Error(p(200));return cl$1(e,s,null,i)};reactDom_production_min.createRoot=function(e,s){if(!nl$1(e))throw Error(p(299));var i=!1,c="",d=kl$1;return s!=null&&(s.unstable_strictMode===!0&&(i=!0),s.identifierPrefix!==void 0&&(c=s.identifierPrefix),s.onRecoverableError!==void 0&&(d=s.onRecoverableError)),s=bl$1(e,1,!1,null,null,i,!1,c,d),e[uf$1]=s.current,sf$1(e.nodeType===8?e.parentNode:e),new ll$1(s)};reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var s=e._reactInternals;if(s===void 0)throw typeof e.render=="function"?Error(p(188)):(e=Object.keys(e).join(","),Error(p(268,e)));return e=Zb(s),e=e===null?null:e.stateNode,e};reactDom_production_min.flushSync=function(e){return Rk(e)};reactDom_production_min.hydrate=function(e,s,i){if(!ol$1(s))throw Error(p(200));return rl$1(null,e,s,!0,i)};reactDom_production_min.hydrateRoot=function(e,s,i){if(!nl$1(e))throw Error(p(405));var c=i!=null&&i.hydratedSources||null,d=!1,h="",_=kl$1;if(i!=null&&(i.unstable_strictMode===!0&&(d=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(_=i.onRecoverableError)),s=el$1(s,null,e,1,i??null,d,!1,h,_),e[uf$1]=s.current,sf$1(e),c)for(e=0;e<c.length;e++)i=c[e],d=i._getVersion,d=d(i._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[i,d]:s.mutableSourceEagerHydrationData.push(i,d);return new ml$1(s)};reactDom_production_min.render=function(e,s,i){if(!ol$1(s))throw Error(p(200));return rl$1(null,e,s,!1,i)};reactDom_production_min.unmountComponentAtNode=function(e){if(!ol$1(e))throw Error(p(40));return e._reactRootContainer?(Rk(function(){rl$1(null,null,e,!1,function(){e._reactRootContainer=null,e[uf$1]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,s,i,c){if(!ol$1(i))throw Error(p(200));if(e==null||e._reactInternals===void 0)throw Error(p(38));return rl$1(e,s,i,!1,c)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(e){console.error(e)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports;const vt$1=getDefaultExportFromCjs(reactDomExports);var createRoot,m=reactDomExports;createRoot=m.createRoot,m.hydrateRoot;const TOAST_LIMIT=1,TOAST_REMOVE_DELAY=1e6;let count$2=0;function genId(){return count$2=(count$2+1)%Number.MAX_SAFE_INTEGER,count$2.toString()}const toastTimeouts=new Map,addToRemoveQueue=e=>{if(toastTimeouts.has(e))return;const s=setTimeout(()=>{toastTimeouts.delete(e),dispatch({type:"REMOVE_TOAST",toastId:e})},TOAST_REMOVE_DELAY);toastTimeouts.set(e,s)},reducer=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,TOAST_LIMIT)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(i=>i.id===s.toast.id?{...i,...s.toast}:i)};case"DISMISS_TOAST":{const{toastId:i}=s;return i?addToRemoveQueue(i):e.toasts.forEach(c=>{addToRemoveQueue(c.id)}),{...e,toasts:e.toasts.map(c=>c.id===i||i===void 0?{...c,open:!1}:c)}}case"REMOVE_TOAST":return s.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==s.toastId)}}},listeners=[];let memoryState={toasts:[]};function dispatch(e){memoryState=reducer(memoryState,e),listeners.forEach(s=>{s(memoryState)})}function toast({...e}){const s=genId(),i=d=>dispatch({type:"UPDATE_TOAST",toast:{...d,id:s}}),c=()=>dispatch({type:"DISMISS_TOAST",toastId:s});return dispatch({type:"ADD_TOAST",toast:{...e,id:s,open:!0,onOpenChange:d=>{d||c()}}}),{id:s,dismiss:c,update:i}}function useToast(){const[e,s]=reactExports.useState(memoryState);return reactExports.useEffect(()=>(listeners.push(s),()=>{const i=listeners.indexOf(s);i>-1&&listeners.splice(i,1)}),[e]),{...e,toast,dismiss:i=>dispatch({type:"DISMISS_TOAST",toastId:i})}}function composeEventHandlers(e,s,{checkForDefaultPrevented:i=!0}={}){return function(d){if(e==null||e(d),i===!1||!d.defaultPrevented)return s==null?void 0:s(d)}}function setRef(e,s){if(typeof e=="function")return e(s);e!=null&&(e.current=s)}function composeRefs(...e){return s=>{let i=!1;const c=e.map(d=>{const h=setRef(d,s);return!i&&typeof h=="function"&&(i=!0),h});if(i)return()=>{for(let d=0;d<c.length;d++){const h=c[d];typeof h=="function"?h():setRef(e[d],null)}}}}function useComposedRefs(...e){return reactExports.useCallback(composeRefs(...e),e)}function createContextScope(e,s=[]){let i=[];function c(h,_){const g=reactExports.createContext(_),$=i.length;i=[...i,_];const _e=at=>{var dt;const{scope:it,children:ct,...mt}=at,pt=((dt=it==null?void 0:it[e])==null?void 0:dt[$])||g,zt=reactExports.useMemo(()=>mt,Object.values(mt));return jsxRuntimeExports.jsx(pt.Provider,{value:zt,children:ct})};_e.displayName=h+"Provider";function lt(at,it){var pt;const ct=((pt=it==null?void 0:it[e])==null?void 0:pt[$])||g,mt=reactExports.useContext(ct);if(mt)return mt;if(_!==void 0)return _;throw new Error(`\`${at}\` must be used within \`${h}\``)}return[_e,lt]}const d=()=>{const h=i.map(_=>reactExports.createContext(_));return function(g){const $=(g==null?void 0:g[e])||h;return reactExports.useMemo(()=>({[`__scope${e}`]:{...g,[e]:$}}),[g,$])}};return d.scopeName=e,[c,composeContextScopes(d,...s)]}function composeContextScopes(...e){const s=e[0];if(e.length===1)return s;const i=()=>{const c=e.map(d=>({useScope:d(),scopeName:d.scopeName}));return function(h){const _=c.reduce((g,{useScope:$,scopeName:_e})=>{const at=$(h)[`__scope${_e}`];return{...g,...at}},{});return reactExports.useMemo(()=>({[`__scope${s.scopeName}`]:_}),[_])}};return i.scopeName=s.scopeName,i}function createSlot(e){const s=createSlotClone(e),i=reactExports.forwardRef((c,d)=>{const{children:h,..._}=c,g=reactExports.Children.toArray(h),$=g.find(isSlottable);if($){const _e=$.props.children,lt=g.map(at=>at===$?reactExports.Children.count(_e)>1?reactExports.Children.only(null):reactExports.isValidElement(_e)?_e.props.children:null:at);return jsxRuntimeExports.jsx(s,{..._,ref:d,children:reactExports.isValidElement(_e)?reactExports.cloneElement(_e,void 0,lt):null})}return jsxRuntimeExports.jsx(s,{..._,ref:d,children:h})});return i.displayName=`${e}.Slot`,i}var Slot$1=createSlot("Slot");function createSlotClone(e){const s=reactExports.forwardRef((i,c)=>{const{children:d,...h}=i;if(reactExports.isValidElement(d)){const _=getElementRef$1(d),g=mergeProps(h,d.props);return d.type!==reactExports.Fragment&&(g.ref=c?composeRefs(c,_):_),reactExports.cloneElement(d,g)}return reactExports.Children.count(d)>1?reactExports.Children.only(null):null});return s.displayName=`${e}.SlotClone`,s}var SLOTTABLE_IDENTIFIER=Symbol("radix.slottable");function createSlottable(e){const s=({children:i})=>jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:i});return s.displayName=`${e}.Slottable`,s.__radixId=SLOTTABLE_IDENTIFIER,s}function isSlottable(e){return reactExports.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===SLOTTABLE_IDENTIFIER}function mergeProps(e,s){const i={...s};for(const c in s){const d=e[c],h=s[c];/^on[A-Z]/.test(c)?d&&h?i[c]=(...g)=>{const $=h(...g);return d(...g),$}:d&&(i[c]=d):c==="style"?i[c]={...d,...h}:c==="className"&&(i[c]=[d,h].filter(Boolean).join(" "))}return{...e,...i}}function getElementRef$1(e){var c,d;let s=(c=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:c.get,i=s&&"isReactWarning"in s&&s.isReactWarning;return i?e.ref:(s=(d=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:d.get,i=s&&"isReactWarning"in s&&s.isReactWarning,i?e.props.ref:e.props.ref||e.ref)}function createCollection(e){const s=e+"CollectionProvider",[i,c]=createContextScope(s),[d,h]=i(s,{collectionRef:{current:null},itemMap:new Map}),_=pt=>{const{scope:zt,children:dt}=pt,ft=o.useRef(null),kt=o.useRef(new Map).current;return jsxRuntimeExports.jsx(d,{scope:zt,itemMap:kt,collectionRef:ft,children:dt})};_.displayName=s;const g=e+"CollectionSlot",$=createSlot(g),_e=o.forwardRef((pt,zt)=>{const{scope:dt,children:ft}=pt,kt=h(g,dt),St=useComposedRefs(zt,kt.collectionRef);return jsxRuntimeExports.jsx($,{ref:St,children:ft})});_e.displayName=g;const lt=e+"CollectionItemSlot",at="data-radix-collection-item",it=createSlot(lt),ct=o.forwardRef((pt,zt)=>{const{scope:dt,children:ft,...kt}=pt,St=o.useRef(null),Lt=useComposedRefs(zt,St),Gt=h(lt,dt);return o.useEffect(()=>(Gt.itemMap.set(St,{ref:St,...kt}),()=>void Gt.itemMap.delete(St))),jsxRuntimeExports.jsx(it,{[at]:"",ref:Lt,children:ft})});ct.displayName=lt;function mt(pt){const zt=h(e+"CollectionConsumer",pt);return o.useCallback(()=>{const ft=zt.collectionRef.current;if(!ft)return[];const kt=Array.from(ft.querySelectorAll(`[${at}]`));return Array.from(zt.itemMap.values()).sort((Gt,Bt)=>kt.indexOf(Gt.ref.current)-kt.indexOf(Bt.ref.current))},[zt.collectionRef,zt.itemMap])}return[{Provider:_,Slot:_e,ItemSlot:ct},mt,c]}var NODES=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Primitive=NODES.reduce((e,s)=>{const i=createSlot(`Primitive.${s}`),c=reactExports.forwardRef((d,h)=>{const{asChild:_,...g}=d,$=_?i:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),jsxRuntimeExports.jsx($,{...g,ref:h})});return c.displayName=`Primitive.${s}`,{...e,[s]:c}},{});function dispatchDiscreteCustomEvent(e,s){e&&reactDomExports.flushSync(()=>e.dispatchEvent(s))}function useCallbackRef$1(e){const s=reactExports.useRef(e);return reactExports.useEffect(()=>{s.current=e}),reactExports.useMemo(()=>(...i)=>{var c;return(c=s.current)==null?void 0:c.call(s,...i)},[])}function useEscapeKeydown(e,s=globalThis==null?void 0:globalThis.document){const i=useCallbackRef$1(e);reactExports.useEffect(()=>{const c=d=>{d.key==="Escape"&&i(d)};return s.addEventListener("keydown",c,{capture:!0}),()=>s.removeEventListener("keydown",c,{capture:!0})},[i,s])}var DISMISSABLE_LAYER_NAME="DismissableLayer",CONTEXT_UPDATE="dismissableLayer.update",POINTER_DOWN_OUTSIDE="dismissableLayer.pointerDownOutside",FOCUS_OUTSIDE="dismissableLayer.focusOutside",originalBodyPointerEvents,DismissableLayerContext=reactExports.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),DismissableLayer=reactExports.forwardRef((e,s)=>{const{disableOutsidePointerEvents:i=!1,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:_,onDismiss:g,...$}=e,_e=reactExports.useContext(DismissableLayerContext),[lt,at]=reactExports.useState(null),it=(lt==null?void 0:lt.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,ct]=reactExports.useState({}),mt=useComposedRefs(s,Bt=>at(Bt)),pt=Array.from(_e.layers),[zt]=[..._e.layersWithOutsidePointerEventsDisabled].slice(-1),dt=pt.indexOf(zt),ft=lt?pt.indexOf(lt):-1,kt=_e.layersWithOutsidePointerEventsDisabled.size>0,St=ft>=dt,Lt=usePointerDownOutside(Bt=>{const nr=Bt.target,cr=[..._e.branches].some(ur=>ur.contains(nr));!St||cr||(d==null||d(Bt),_==null||_(Bt),Bt.defaultPrevented||g==null||g())},it),Gt=useFocusOutside(Bt=>{const nr=Bt.target;[..._e.branches].some(ur=>ur.contains(nr))||(h==null||h(Bt),_==null||_(Bt),Bt.defaultPrevented||g==null||g())},it);return useEscapeKeydown(Bt=>{ft===_e.layers.size-1&&(c==null||c(Bt),!Bt.defaultPrevented&&g&&(Bt.preventDefault(),g()))},it),reactExports.useEffect(()=>{if(lt)return i&&(_e.layersWithOutsidePointerEventsDisabled.size===0&&(originalBodyPointerEvents=it.body.style.pointerEvents,it.body.style.pointerEvents="none"),_e.layersWithOutsidePointerEventsDisabled.add(lt)),_e.layers.add(lt),dispatchUpdate(),()=>{i&&_e.layersWithOutsidePointerEventsDisabled.size===1&&(it.body.style.pointerEvents=originalBodyPointerEvents)}},[lt,it,i,_e]),reactExports.useEffect(()=>()=>{lt&&(_e.layers.delete(lt),_e.layersWithOutsidePointerEventsDisabled.delete(lt),dispatchUpdate())},[lt,_e]),reactExports.useEffect(()=>{const Bt=()=>ct({});return document.addEventListener(CONTEXT_UPDATE,Bt),()=>document.removeEventListener(CONTEXT_UPDATE,Bt)},[]),jsxRuntimeExports.jsx(Primitive.div,{...$,ref:mt,style:{pointerEvents:kt?St?"auto":"none":void 0,...e.style},onFocusCapture:composeEventHandlers(e.onFocusCapture,Gt.onFocusCapture),onBlurCapture:composeEventHandlers(e.onBlurCapture,Gt.onBlurCapture),onPointerDownCapture:composeEventHandlers(e.onPointerDownCapture,Lt.onPointerDownCapture)})});DismissableLayer.displayName=DISMISSABLE_LAYER_NAME;var BRANCH_NAME="DismissableLayerBranch",DismissableLayerBranch=reactExports.forwardRef((e,s)=>{const i=reactExports.useContext(DismissableLayerContext),c=reactExports.useRef(null),d=useComposedRefs(s,c);return reactExports.useEffect(()=>{const h=c.current;if(h)return i.branches.add(h),()=>{i.branches.delete(h)}},[i.branches]),jsxRuntimeExports.jsx(Primitive.div,{...e,ref:d})});DismissableLayerBranch.displayName=BRANCH_NAME;function usePointerDownOutside(e,s=globalThis==null?void 0:globalThis.document){const i=useCallbackRef$1(e),c=reactExports.useRef(!1),d=reactExports.useRef(()=>{});return reactExports.useEffect(()=>{const h=g=>{if(g.target&&!c.current){let $=function(){handleAndDispatchCustomEvent$1(POINTER_DOWN_OUTSIDE,i,_e,{discrete:!0})};const _e={originalEvent:g};g.pointerType==="touch"?(s.removeEventListener("click",d.current),d.current=$,s.addEventListener("click",d.current,{once:!0})):$()}else s.removeEventListener("click",d.current);c.current=!1},_=window.setTimeout(()=>{s.addEventListener("pointerdown",h)},0);return()=>{window.clearTimeout(_),s.removeEventListener("pointerdown",h),s.removeEventListener("click",d.current)}},[s,i]),{onPointerDownCapture:()=>c.current=!0}}function useFocusOutside(e,s=globalThis==null?void 0:globalThis.document){const i=useCallbackRef$1(e),c=reactExports.useRef(!1);return reactExports.useEffect(()=>{const d=h=>{h.target&&!c.current&&handleAndDispatchCustomEvent$1(FOCUS_OUTSIDE,i,{originalEvent:h},{discrete:!1})};return s.addEventListener("focusin",d),()=>s.removeEventListener("focusin",d)},[s,i]),{onFocusCapture:()=>c.current=!0,onBlurCapture:()=>c.current=!1}}function dispatchUpdate(){const e=new CustomEvent(CONTEXT_UPDATE);document.dispatchEvent(e)}function handleAndDispatchCustomEvent$1(e,s,i,{discrete:c}){const d=i.originalEvent.target,h=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:i});s&&d.addEventListener(e,s,{once:!0}),c?dispatchDiscreteCustomEvent(d,h):d.dispatchEvent(h)}var Root$3=DismissableLayer,Branch=DismissableLayerBranch,useLayoutEffect2=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:()=>{},PORTAL_NAME$2="Portal",Portal$1=reactExports.forwardRef((e,s)=>{var g;const{container:i,...c}=e,[d,h]=reactExports.useState(!1);useLayoutEffect2(()=>h(!0),[]);const _=i||d&&((g=globalThis==null?void 0:globalThis.document)==null?void 0:g.body);return _?vt$1.createPortal(jsxRuntimeExports.jsx(Primitive.div,{...c,ref:s}),_):null});Portal$1.displayName=PORTAL_NAME$2;function useStateMachine(e,s){return reactExports.useReducer((i,c)=>s[i][c]??i,e)}var Presence=e=>{const{present:s,children:i}=e,c=usePresence(s),d=typeof i=="function"?i({present:c.isPresent}):reactExports.Children.only(i),h=useComposedRefs(c.ref,getElementRef(d));return typeof i=="function"||c.isPresent?reactExports.cloneElement(d,{ref:h}):null};Presence.displayName="Presence";function usePresence(e){const[s,i]=reactExports.useState(),c=reactExports.useRef(null),d=reactExports.useRef(e),h=reactExports.useRef("none"),_=e?"mounted":"unmounted",[g,$]=useStateMachine(_,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return reactExports.useEffect(()=>{const _e=getAnimationName(c.current);h.current=g==="mounted"?_e:"none"},[g]),useLayoutEffect2(()=>{const _e=c.current,lt=d.current;if(lt!==e){const it=h.current,ct=getAnimationName(_e);e?$("MOUNT"):ct==="none"||(_e==null?void 0:_e.display)==="none"?$("UNMOUNT"):$(lt&&it!==ct?"ANIMATION_OUT":"UNMOUNT"),d.current=e}},[e,$]),useLayoutEffect2(()=>{if(s){let _e;const lt=s.ownerDocument.defaultView??window,at=ct=>{const pt=getAnimationName(c.current).includes(ct.animationName);if(ct.target===s&&pt&&($("ANIMATION_END"),!d.current)){const zt=s.style.animationFillMode;s.style.animationFillMode="forwards",_e=lt.setTimeout(()=>{s.style.animationFillMode==="forwards"&&(s.style.animationFillMode=zt)})}},it=ct=>{ct.target===s&&(h.current=getAnimationName(c.current))};return s.addEventListener("animationstart",it),s.addEventListener("animationcancel",at),s.addEventListener("animationend",at),()=>{lt.clearTimeout(_e),s.removeEventListener("animationstart",it),s.removeEventListener("animationcancel",at),s.removeEventListener("animationend",at)}}else $("ANIMATION_END")},[s,$]),{isPresent:["mounted","unmountSuspended"].includes(g),ref:reactExports.useCallback(_e=>{c.current=_e?getComputedStyle(_e):null,i(_e)},[])}}function getAnimationName(e){return(e==null?void 0:e.animationName)||"none"}function getElementRef(e){var c,d;let s=(c=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:c.get,i=s&&"isReactWarning"in s&&s.isReactWarning;return i?e.ref:(s=(d=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:d.get,i=s&&"isReactWarning"in s&&s.isReactWarning,i?e.props.ref:e.props.ref||e.ref)}var useInsertionEffect=React[" useInsertionEffect ".trim().toString()]||useLayoutEffect2;function useControllableState({prop:e,defaultProp:s,onChange:i=()=>{},caller:c}){const[d,h,_]=useUncontrolledState({defaultProp:s,onChange:i}),g=e!==void 0,$=g?e:d;{const lt=reactExports.useRef(e!==void 0);reactExports.useEffect(()=>{const at=lt.current;at!==g&&console.warn(`${c} is changing from ${at?"controlled":"uncontrolled"} to ${g?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),lt.current=g},[g,c])}const _e=reactExports.useCallback(lt=>{var at;if(g){const it=isFunction(lt)?lt(e):lt;it!==e&&((at=_.current)==null||at.call(_,it))}else h(lt)},[g,e,h,_]);return[$,_e]}function useUncontrolledState({defaultProp:e,onChange:s}){const[i,c]=reactExports.useState(e),d=reactExports.useRef(i),h=reactExports.useRef(s);return useInsertionEffect(()=>{h.current=s},[s]),reactExports.useEffect(()=>{var _;d.current!==i&&((_=h.current)==null||_.call(h,i),d.current=i)},[i,d]),[i,c,h]}function isFunction(e){return typeof e=="function"}var VISUALLY_HIDDEN_STYLES=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),NAME$1="VisuallyHidden",VisuallyHidden=reactExports.forwardRef((e,s)=>jsxRuntimeExports.jsx(Primitive.span,{...e,ref:s,style:{...VISUALLY_HIDDEN_STYLES,...e.style}}));VisuallyHidden.displayName=NAME$1;var Root$2=VisuallyHidden,PROVIDER_NAME$1="ToastProvider",[Collection$1,useCollection$1,createCollectionScope$1]=createCollection("Toast"),[createToastContext,createToastScope]=createContextScope("Toast",[createCollectionScope$1]),[ToastProviderProvider,useToastProviderContext]=createToastContext(PROVIDER_NAME$1),ToastProvider$1=e=>{const{__scopeToast:s,label:i="Notification",duration:c=5e3,swipeDirection:d="right",swipeThreshold:h=50,children:_}=e,[g,$]=reactExports.useState(null),[_e,lt]=reactExports.useState(0),at=reactExports.useRef(!1),it=reactExports.useRef(!1);return i.trim()||console.error(`Invalid prop \`label\` supplied to \`${PROVIDER_NAME$1}\`. Expected non-empty \`string\`.`),jsxRuntimeExports.jsx(Collection$1.Provider,{scope:s,children:jsxRuntimeExports.jsx(ToastProviderProvider,{scope:s,label:i,duration:c,swipeDirection:d,swipeThreshold:h,toastCount:_e,viewport:g,onViewportChange:$,onToastAdd:reactExports.useCallback(()=>lt(ct=>ct+1),[]),onToastRemove:reactExports.useCallback(()=>lt(ct=>ct-1),[]),isFocusedToastEscapeKeyDownRef:at,isClosePausedRef:it,children:_})})};ToastProvider$1.displayName=PROVIDER_NAME$1;var VIEWPORT_NAME$1="ToastViewport",VIEWPORT_DEFAULT_HOTKEY=["F8"],VIEWPORT_PAUSE="toast.viewportPause",VIEWPORT_RESUME="toast.viewportResume",ToastViewport$1=reactExports.forwardRef((e,s)=>{const{__scopeToast:i,hotkey:c=VIEWPORT_DEFAULT_HOTKEY,label:d="Notifications ({hotkey})",...h}=e,_=useToastProviderContext(VIEWPORT_NAME$1,i),g=useCollection$1(i),$=reactExports.useRef(null),_e=reactExports.useRef(null),lt=reactExports.useRef(null),at=reactExports.useRef(null),it=useComposedRefs(s,at,_.onViewportChange),ct=c.join("+").replace(/Key/g,"").replace(/Digit/g,""),mt=_.toastCount>0;reactExports.useEffect(()=>{const zt=dt=>{var kt;c.length!==0&&c.every(St=>dt[St]||dt.code===St)&&((kt=at.current)==null||kt.focus())};return document.addEventListener("keydown",zt),()=>document.removeEventListener("keydown",zt)},[c]),reactExports.useEffect(()=>{const zt=$.current,dt=at.current;if(mt&&zt&&dt){const ft=()=>{if(!_.isClosePausedRef.current){const Gt=new CustomEvent(VIEWPORT_PAUSE);dt.dispatchEvent(Gt),_.isClosePausedRef.current=!0}},kt=()=>{if(_.isClosePausedRef.current){const Gt=new CustomEvent(VIEWPORT_RESUME);dt.dispatchEvent(Gt),_.isClosePausedRef.current=!1}},St=Gt=>{!zt.contains(Gt.relatedTarget)&&kt()},Lt=()=>{zt.contains(document.activeElement)||kt()};return zt.addEventListener("focusin",ft),zt.addEventListener("focusout",St),zt.addEventListener("pointermove",ft),zt.addEventListener("pointerleave",Lt),window.addEventListener("blur",ft),window.addEventListener("focus",kt),()=>{zt.removeEventListener("focusin",ft),zt.removeEventListener("focusout",St),zt.removeEventListener("pointermove",ft),zt.removeEventListener("pointerleave",Lt),window.removeEventListener("blur",ft),window.removeEventListener("focus",kt)}}},[mt,_.isClosePausedRef]);const pt=reactExports.useCallback(({tabbingDirection:zt})=>{const ft=g().map(kt=>{const St=kt.ref.current,Lt=[St,...getTabbableCandidates$1(St)];return zt==="forwards"?Lt:Lt.reverse()});return(zt==="forwards"?ft.reverse():ft).flat()},[g]);return reactExports.useEffect(()=>{const zt=at.current;if(zt){const dt=ft=>{var Lt,Gt,Bt;const kt=ft.altKey||ft.ctrlKey||ft.metaKey;if(ft.key==="Tab"&&!kt){const nr=document.activeElement,cr=ft.shiftKey;if(ft.target===zt&&cr){(Lt=_e.current)==null||Lt.focus();return}const hn=pt({tabbingDirection:cr?"backwards":"forwards"}),_n=hn.findIndex(gn=>gn===nr);focusFirst$1(hn.slice(_n+1))?ft.preventDefault():cr?(Gt=_e.current)==null||Gt.focus():(Bt=lt.current)==null||Bt.focus()}};return zt.addEventListener("keydown",dt),()=>zt.removeEventListener("keydown",dt)}},[g,pt]),jsxRuntimeExports.jsxs(Branch,{ref:$,role:"region","aria-label":d.replace("{hotkey}",ct),tabIndex:-1,style:{pointerEvents:mt?void 0:"none"},children:[mt&&jsxRuntimeExports.jsx(FocusProxy,{ref:_e,onFocusFromOutsideViewport:()=>{const zt=pt({tabbingDirection:"forwards"});focusFirst$1(zt)}}),jsxRuntimeExports.jsx(Collection$1.Slot,{scope:i,children:jsxRuntimeExports.jsx(Primitive.ol,{tabIndex:-1,...h,ref:it})}),mt&&jsxRuntimeExports.jsx(FocusProxy,{ref:lt,onFocusFromOutsideViewport:()=>{const zt=pt({tabbingDirection:"backwards"});focusFirst$1(zt)}})]})});ToastViewport$1.displayName=VIEWPORT_NAME$1;var FOCUS_PROXY_NAME="ToastFocusProxy",FocusProxy=reactExports.forwardRef((e,s)=>{const{__scopeToast:i,onFocusFromOutsideViewport:c,...d}=e,h=useToastProviderContext(FOCUS_PROXY_NAME,i);return jsxRuntimeExports.jsx(VisuallyHidden,{"aria-hidden":!0,tabIndex:0,...d,ref:s,style:{position:"fixed"},onFocus:_=>{var _e;const g=_.relatedTarget;!((_e=h.viewport)!=null&&_e.contains(g))&&c()}})});FocusProxy.displayName=FOCUS_PROXY_NAME;var TOAST_NAME="Toast",TOAST_SWIPE_START="toast.swipeStart",TOAST_SWIPE_MOVE="toast.swipeMove",TOAST_SWIPE_CANCEL="toast.swipeCancel",TOAST_SWIPE_END="toast.swipeEnd",Toast$1=reactExports.forwardRef((e,s)=>{const{forceMount:i,open:c,defaultOpen:d,onOpenChange:h,..._}=e,[g,$]=useControllableState({prop:c,defaultProp:d??!0,onChange:h,caller:TOAST_NAME});return jsxRuntimeExports.jsx(Presence,{present:i||g,children:jsxRuntimeExports.jsx(ToastImpl,{open:g,..._,ref:s,onClose:()=>$(!1),onPause:useCallbackRef$1(e.onPause),onResume:useCallbackRef$1(e.onResume),onSwipeStart:composeEventHandlers(e.onSwipeStart,_e=>{_e.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:composeEventHandlers(e.onSwipeMove,_e=>{const{x:lt,y:at}=_e.detail.delta;_e.currentTarget.setAttribute("data-swipe","move"),_e.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${lt}px`),_e.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${at}px`)}),onSwipeCancel:composeEventHandlers(e.onSwipeCancel,_e=>{_e.currentTarget.setAttribute("data-swipe","cancel"),_e.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),_e.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),_e.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),_e.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:composeEventHandlers(e.onSwipeEnd,_e=>{const{x:lt,y:at}=_e.detail.delta;_e.currentTarget.setAttribute("data-swipe","end"),_e.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),_e.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),_e.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${lt}px`),_e.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${at}px`),$(!1)})})})});Toast$1.displayName=TOAST_NAME;var[ToastInteractiveProvider,useToastInteractiveContext]=createToastContext(TOAST_NAME,{onClose(){}}),ToastImpl=reactExports.forwardRef((e,s)=>{const{__scopeToast:i,type:c="foreground",duration:d,open:h,onClose:_,onEscapeKeyDown:g,onPause:$,onResume:_e,onSwipeStart:lt,onSwipeMove:at,onSwipeCancel:it,onSwipeEnd:ct,...mt}=e,pt=useToastProviderContext(TOAST_NAME,i),[zt,dt]=reactExports.useState(null),ft=useComposedRefs(s,gn=>dt(gn)),kt=reactExports.useRef(null),St=reactExports.useRef(null),Lt=d||pt.duration,Gt=reactExports.useRef(0),Bt=reactExports.useRef(Lt),nr=reactExports.useRef(0),{onToastAdd:cr,onToastRemove:ur}=pt,yn=useCallbackRef$1(()=>{var vn;(zt==null?void 0:zt.contains(document.activeElement))&&((vn=pt.viewport)==null||vn.focus()),_()}),hn=reactExports.useCallback(gn=>{!gn||gn===1/0||(window.clearTimeout(nr.current),Gt.current=new Date().getTime(),nr.current=window.setTimeout(yn,gn))},[yn]);reactExports.useEffect(()=>{const gn=pt.viewport;if(gn){const vn=()=>{hn(Bt.current),_e==null||_e()},Tn=()=>{const kn=new Date().getTime()-Gt.current;Bt.current=Bt.current-kn,window.clearTimeout(nr.current),$==null||$()};return gn.addEventListener(VIEWPORT_PAUSE,Tn),gn.addEventListener(VIEWPORT_RESUME,vn),()=>{gn.removeEventListener(VIEWPORT_PAUSE,Tn),gn.removeEventListener(VIEWPORT_RESUME,vn)}}},[pt.viewport,Lt,$,_e,hn]),reactExports.useEffect(()=>{h&&!pt.isClosePausedRef.current&&hn(Lt)},[h,Lt,pt.isClosePausedRef,hn]),reactExports.useEffect(()=>(cr(),()=>ur()),[cr,ur]);const _n=reactExports.useMemo(()=>zt?getAnnounceTextContent(zt):null,[zt]);return pt.viewport?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[_n&&jsxRuntimeExports.jsx(ToastAnnounce,{__scopeToast:i,role:"status","aria-live":c==="foreground"?"assertive":"polite","aria-atomic":!0,children:_n}),jsxRuntimeExports.jsx(ToastInteractiveProvider,{scope:i,onClose:yn,children:reactDomExports.createPortal(jsxRuntimeExports.jsx(Collection$1.ItemSlot,{scope:i,children:jsxRuntimeExports.jsx(Root$3,{asChild:!0,onEscapeKeyDown:composeEventHandlers(g,()=>{pt.isFocusedToastEscapeKeyDownRef.current||yn(),pt.isFocusedToastEscapeKeyDownRef.current=!1}),children:jsxRuntimeExports.jsx(Primitive.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":h?"open":"closed","data-swipe-direction":pt.swipeDirection,...mt,ref:ft,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:composeEventHandlers(e.onKeyDown,gn=>{gn.key==="Escape"&&(g==null||g(gn.nativeEvent),gn.nativeEvent.defaultPrevented||(pt.isFocusedToastEscapeKeyDownRef.current=!0,yn()))}),onPointerDown:composeEventHandlers(e.onPointerDown,gn=>{gn.button===0&&(kt.current={x:gn.clientX,y:gn.clientY})}),onPointerMove:composeEventHandlers(e.onPointerMove,gn=>{if(!kt.current)return;const vn=gn.clientX-kt.current.x,Tn=gn.clientY-kt.current.y,kn=!!St.current,bn=["left","right"].includes(pt.swipeDirection),Sn=["left","up"].includes(pt.swipeDirection)?Math.min:Math.max,fn=bn?Sn(0,vn):0,or=bn?0:Sn(0,Tn),lr=gn.pointerType==="touch"?10:2,pn={x:fn,y:or},Cn={originalEvent:gn,delta:pn};kn?(St.current=pn,handleAndDispatchCustomEvent(TOAST_SWIPE_MOVE,at,Cn,{discrete:!1})):isDeltaInDirection(pn,pt.swipeDirection,lr)?(St.current=pn,handleAndDispatchCustomEvent(TOAST_SWIPE_START,lt,Cn,{discrete:!1}),gn.target.setPointerCapture(gn.pointerId)):(Math.abs(vn)>lr||Math.abs(Tn)>lr)&&(kt.current=null)}),onPointerUp:composeEventHandlers(e.onPointerUp,gn=>{const vn=St.current,Tn=gn.target;if(Tn.hasPointerCapture(gn.pointerId)&&Tn.releasePointerCapture(gn.pointerId),St.current=null,kt.current=null,vn){const kn=gn.currentTarget,bn={originalEvent:gn,delta:vn};isDeltaInDirection(vn,pt.swipeDirection,pt.swipeThreshold)?handleAndDispatchCustomEvent(TOAST_SWIPE_END,ct,bn,{discrete:!0}):handleAndDispatchCustomEvent(TOAST_SWIPE_CANCEL,it,bn,{discrete:!0}),kn.addEventListener("click",Sn=>Sn.preventDefault(),{once:!0})}})})})}),pt.viewport)})]}):null}),ToastAnnounce=e=>{const{__scopeToast:s,children:i,...c}=e,d=useToastProviderContext(TOAST_NAME,s),[h,_]=reactExports.useState(!1),[g,$]=reactExports.useState(!1);return useNextFrame(()=>_(!0)),reactExports.useEffect(()=>{const _e=window.setTimeout(()=>$(!0),1e3);return()=>window.clearTimeout(_e)},[]),g?null:jsxRuntimeExports.jsx(Portal$1,{asChild:!0,children:jsxRuntimeExports.jsx(VisuallyHidden,{...c,children:h&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[d.label," ",i]})})})},TITLE_NAME="ToastTitle",ToastTitle$1=reactExports.forwardRef((e,s)=>{const{__scopeToast:i,...c}=e;return jsxRuntimeExports.jsx(Primitive.div,{...c,ref:s})});ToastTitle$1.displayName=TITLE_NAME;var DESCRIPTION_NAME="ToastDescription",ToastDescription$1=reactExports.forwardRef((e,s)=>{const{__scopeToast:i,...c}=e;return jsxRuntimeExports.jsx(Primitive.div,{...c,ref:s})});ToastDescription$1.displayName=DESCRIPTION_NAME;var ACTION_NAME="ToastAction",ToastAction$1=reactExports.forwardRef((e,s)=>{const{altText:i,...c}=e;return i.trim()?jsxRuntimeExports.jsx(ToastAnnounceExclude,{altText:i,asChild:!0,children:jsxRuntimeExports.jsx(ToastClose$1,{...c,ref:s})}):(console.error(`Invalid prop \`altText\` supplied to \`${ACTION_NAME}\`. Expected non-empty \`string\`.`),null)});ToastAction$1.displayName=ACTION_NAME;var CLOSE_NAME="ToastClose",ToastClose$1=reactExports.forwardRef((e,s)=>{const{__scopeToast:i,...c}=e,d=useToastInteractiveContext(CLOSE_NAME,i);return jsxRuntimeExports.jsx(ToastAnnounceExclude,{asChild:!0,children:jsxRuntimeExports.jsx(Primitive.button,{type:"button",...c,ref:s,onClick:composeEventHandlers(e.onClick,d.onClose)})})});ToastClose$1.displayName=CLOSE_NAME;var ToastAnnounceExclude=reactExports.forwardRef((e,s)=>{const{__scopeToast:i,altText:c,...d}=e;return jsxRuntimeExports.jsx(Primitive.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":c||void 0,...d,ref:s})});function getAnnounceTextContent(e){const s=[];return Array.from(e.childNodes).forEach(c=>{if(c.nodeType===c.TEXT_NODE&&c.textContent&&s.push(c.textContent),isHTMLElement$1(c)){const d=c.ariaHidden||c.hidden||c.style.display==="none",h=c.dataset.radixToastAnnounceExclude==="";if(!d)if(h){const _=c.dataset.radixToastAnnounceAlt;_&&s.push(_)}else s.push(...getAnnounceTextContent(c))}}),s}function handleAndDispatchCustomEvent(e,s,i,{discrete:c}){const d=i.originalEvent.currentTarget,h=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:i});s&&d.addEventListener(e,s,{once:!0}),c?dispatchDiscreteCustomEvent(d,h):d.dispatchEvent(h)}var isDeltaInDirection=(e,s,i=0)=>{const c=Math.abs(e.x),d=Math.abs(e.y),h=c>d;return s==="left"||s==="right"?h&&c>i:!h&&d>i};function useNextFrame(e=()=>{}){const s=useCallbackRef$1(e);useLayoutEffect2(()=>{let i=0,c=0;return i=window.requestAnimationFrame(()=>c=window.requestAnimationFrame(s)),()=>{window.cancelAnimationFrame(i),window.cancelAnimationFrame(c)}},[s])}function isHTMLElement$1(e){return e.nodeType===e.ELEMENT_NODE}function getTabbableCandidates$1(e){const s=[],i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:c=>{const d=c.tagName==="INPUT"&&c.type==="hidden";return c.disabled||c.hidden||d?NodeFilter.FILTER_SKIP:c.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;i.nextNode();)s.push(i.currentNode);return s}function focusFirst$1(e){const s=document.activeElement;return e.some(i=>i===s?!0:(i.focus(),document.activeElement!==s))}var Provider$1=ToastProvider$1,Viewport$1=ToastViewport$1,Root2$2=Toast$1,Title=ToastTitle$1,Description=ToastDescription$1,Action$1=ToastAction$1,Close=ToastClose$1;function r(e){var s,i,c="";if(typeof e=="string"||typeof e=="number")c+=e;else if(typeof e=="object")if(Array.isArray(e)){var d=e.length;for(s=0;s<d;s++)e[s]&&(i=r(e[s]))&&(c&&(c+=" "),c+=i)}else for(i in e)e[i]&&(c&&(c+=" "),c+=i);return c}function clsx(){for(var e,s,i=0,c="",d=arguments.length;i<d;i++)(e=arguments[i])&&(s=r(e))&&(c&&(c+=" "),c+=s);return c}const falsyToString=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,cx=clsx,cva=(e,s)=>i=>{var c;if((s==null?void 0:s.variants)==null)return cx(e,i==null?void 0:i.class,i==null?void 0:i.className);const{variants:d,defaultVariants:h}=s,_=Object.keys(d).map(_e=>{const lt=i==null?void 0:i[_e],at=h==null?void 0:h[_e];if(lt===null)return null;const it=falsyToString(lt)||falsyToString(at);return d[_e][it]}),g=i&&Object.entries(i).reduce((_e,lt)=>{let[at,it]=lt;return it===void 0||(_e[at]=it),_e},{}),$=s==null||(c=s.compoundVariants)===null||c===void 0?void 0:c.reduce((_e,lt)=>{let{class:at,className:it,...ct}=lt;return Object.entries(ct).every(mt=>{let[pt,zt]=mt;return Array.isArray(zt)?zt.includes({...h,...g}[pt]):{...h,...g}[pt]===zt})?[..._e,at,it]:_e},[]);return cx(e,_,$,i==null?void 0:i.class,i==null?void 0:i.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),mergeClasses=(...e)=>e.filter((s,i,c)=>!!s&&s.trim()!==""&&c.indexOf(s)===i).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Icon$1=reactExports.forwardRef(({color:e="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:c,className:d="",children:h,iconNode:_,...g},$)=>reactExports.createElement("svg",{ref:$,...defaultAttributes,width:s,height:s,stroke:e,strokeWidth:c?Number(i)*24/Number(s):i,className:mergeClasses("lucide",d),...g},[..._.map(([_e,lt])=>reactExports.createElement(_e,lt)),...Array.isArray(h)?h:[h]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const createLucideIcon=(e,s)=>{const i=reactExports.forwardRef(({className:c,...d},h)=>reactExports.createElement(Icon$1,{ref:h,iconNode:s,className:mergeClasses(`lucide-${toKebabCase(e)}`,c),...d}));return i.displayName=`${e}`,i};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ArrowLeft=createLucideIcon("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BookOpen=createLucideIcon("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Book=createLucideIcon("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bot=createLucideIcon("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Calculator=createLucideIcon("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Check=createLucideIcon("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronDown=createLucideIcon("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronUp=createLucideIcon("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Clock=createLucideIcon("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CloudSun=createLucideIcon("CloudSun",[["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}],["path",{d:"M15.947 12.65a4 4 0 0 0-5.925-4.128",key:"dpwdj0"}],["path",{d:"M13 22H7a5 5 0 1 1 4.9-6H13a3 3 0 0 1 0 6Z",key:"s09mg5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FlaskConical=createLucideIcon("FlaskConical",[["path",{d:"M10 2v7.527a2 2 0 0 1-.211.896L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45l-5.069-10.127A2 2 0 0 1 14 9.527V2",key:"pzvekw"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M7 16h10",key:"wp8him"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Globe=createLucideIcon("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GraduationCap=createLucideIcon("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HeartPulse=createLucideIcon("HeartPulse",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"1uw2ng"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Image$1=createLucideIcon("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Languages=createLucideIcon("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Leaf=createLucideIcon("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LoaderCircle=createLucideIcon("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lock=createLucideIcon("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Scale=createLucideIcon("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Send=createLucideIcon("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Shapes=createLucideIcon("Shapes",[["path",{d:"M8.3 10a.7.7 0 0 1-.626-1.079L11.4 3a.7.7 0 0 1 1.198-.043L16.3 8.9a.7.7 0 0 1-.572 1.1Z",key:"1bo67w"}],["rect",{x:"3",y:"14",width:"7",height:"7",rx:"1",key:"1bkyp8"}],["circle",{cx:"17.5",cy:"17.5",r:"3.5",key:"w3z12y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Star=createLucideIcon("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Trophy=createLucideIcon("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const User=createLucideIcon("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Volume2=createLucideIcon("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WifiOff=createLucideIcon("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wifi=createLucideIcon("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=createLucideIcon("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zap=createLucideIcon("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),CLASS_PART_SEPARATOR="-",createClassGroupUtils=e=>{const s=createClassMap(e),{conflictingClassGroups:i,conflictingClassGroupModifiers:c}=e;return{getClassGroupId:_=>{const g=_.split(CLASS_PART_SEPARATOR);return g[0]===""&&g.length!==1&&g.shift(),getGroupRecursive(g,s)||getGroupIdForArbitraryProperty(_)},getConflictingClassGroupIds:(_,g)=>{const $=i[_]||[];return g&&c[_]?[...$,...c[_]]:$}}},getGroupRecursive=(e,s)=>{var _;if(e.length===0)return s.classGroupId;const i=e[0],c=s.nextPart.get(i),d=c?getGroupRecursive(e.slice(1),c):void 0;if(d)return d;if(s.validators.length===0)return;const h=e.join(CLASS_PART_SEPARATOR);return(_=s.validators.find(({validator:g})=>g(h)))==null?void 0:_.classGroupId},arbitraryPropertyRegex=/^\[(.+)\]$/,getGroupIdForArbitraryProperty=e=>{if(arbitraryPropertyRegex.test(e)){const s=arbitraryPropertyRegex.exec(e)[1],i=s==null?void 0:s.substring(0,s.indexOf(":"));if(i)return"arbitrary.."+i}},createClassMap=e=>{const{theme:s,prefix:i}=e,c={nextPart:new Map,validators:[]};return getPrefixedClassGroupEntries(Object.entries(e.classGroups),i).forEach(([h,_])=>{processClassesRecursively(_,c,h,s)}),c},processClassesRecursively=(e,s,i,c)=>{e.forEach(d=>{if(typeof d=="string"){const h=d===""?s:getPart(s,d);h.classGroupId=i;return}if(typeof d=="function"){if(isThemeGetter(d)){processClassesRecursively(d(c),s,i,c);return}s.validators.push({validator:d,classGroupId:i});return}Object.entries(d).forEach(([h,_])=>{processClassesRecursively(_,getPart(s,h),i,c)})})},getPart=(e,s)=>{let i=e;return s.split(CLASS_PART_SEPARATOR).forEach(c=>{i.nextPart.has(c)||i.nextPart.set(c,{nextPart:new Map,validators:[]}),i=i.nextPart.get(c)}),i},isThemeGetter=e=>e.isThemeGetter,getPrefixedClassGroupEntries=(e,s)=>s?e.map(([i,c])=>{const d=c.map(h=>typeof h=="string"?s+h:typeof h=="object"?Object.fromEntries(Object.entries(h).map(([_,g])=>[s+_,g])):h);return[i,d]}):e,createLruCache=e=>{if(e<1)return{get:()=>{},set:()=>{}};let s=0,i=new Map,c=new Map;const d=(h,_)=>{i.set(h,_),s++,s>e&&(s=0,c=i,i=new Map)};return{get(h){let _=i.get(h);if(_!==void 0)return _;if((_=c.get(h))!==void 0)return d(h,_),_},set(h,_){i.has(h)?i.set(h,_):d(h,_)}}},IMPORTANT_MODIFIER="!",createParseClassName=e=>{const{separator:s,experimentalParseClassName:i}=e,c=s.length===1,d=s[0],h=s.length,_=g=>{const $=[];let _e=0,lt=0,at;for(let zt=0;zt<g.length;zt++){let dt=g[zt];if(_e===0){if(dt===d&&(c||g.slice(zt,zt+h)===s)){$.push(g.slice(lt,zt)),lt=zt+h;continue}if(dt==="/"){at=zt;continue}}dt==="["?_e++:dt==="]"&&_e--}const it=$.length===0?g:g.substring(lt),ct=it.startsWith(IMPORTANT_MODIFIER),mt=ct?it.substring(1):it,pt=at&&at>lt?at-lt:void 0;return{modifiers:$,hasImportantModifier:ct,baseClassName:mt,maybePostfixModifierPosition:pt}};return i?g=>i({className:g,parseClassName:_}):_},sortModifiers=e=>{if(e.length<=1)return e;const s=[];let i=[];return e.forEach(c=>{c[0]==="["?(s.push(...i.sort(),c),i=[]):i.push(c)}),s.push(...i.sort()),s},createConfigUtils=e=>({cache:createLruCache(e.cacheSize),parseClassName:createParseClassName(e),...createClassGroupUtils(e)}),SPLIT_CLASSES_REGEX=/\s+/,mergeClassList=(e,s)=>{const{parseClassName:i,getClassGroupId:c,getConflictingClassGroupIds:d}=s,h=[],_=e.trim().split(SPLIT_CLASSES_REGEX);let g="";for(let $=_.length-1;$>=0;$-=1){const _e=_[$],{modifiers:lt,hasImportantModifier:at,baseClassName:it,maybePostfixModifierPosition:ct}=i(_e);let mt=!!ct,pt=c(mt?it.substring(0,ct):it);if(!pt){if(!mt){g=_e+(g.length>0?" "+g:g);continue}if(pt=c(it),!pt){g=_e+(g.length>0?" "+g:g);continue}mt=!1}const zt=sortModifiers(lt).join(":"),dt=at?zt+IMPORTANT_MODIFIER:zt,ft=dt+pt;if(h.includes(ft))continue;h.push(ft);const kt=d(pt,mt);for(let St=0;St<kt.length;++St){const Lt=kt[St];h.push(dt+Lt)}g=_e+(g.length>0?" "+g:g)}return g};function twJoin(){let e=0,s,i,c="";for(;e<arguments.length;)(s=arguments[e++])&&(i=toValue(s))&&(c&&(c+=" "),c+=i);return c}const toValue=e=>{if(typeof e=="string")return e;let s,i="";for(let c=0;c<e.length;c++)e[c]&&(s=toValue(e[c]))&&(i&&(i+=" "),i+=s);return i};function createTailwindMerge(e,...s){let i,c,d,h=_;function _($){const _e=s.reduce((lt,at)=>at(lt),e());return i=createConfigUtils(_e),c=i.cache.get,d=i.cache.set,h=g,g($)}function g($){const _e=c($);if(_e)return _e;const lt=mergeClassList($,i);return d($,lt),lt}return function(){return h(twJoin.apply(null,arguments))}}const fromTheme=e=>{const s=i=>i[e]||[];return s.isThemeGetter=!0,s},arbitraryValueRegex=/^\[(?:([a-z-]+):)?(.+)\]$/i,fractionRegex=/^\d+\/\d+$/,stringLengths=new Set(["px","full","screen"]),tshirtUnitRegex=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,lengthUnitRegex=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,colorFunctionRegex=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,shadowRegex=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,imageRegex=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,isLength=e=>isNumber$1(e)||stringLengths.has(e)||fractionRegex.test(e),isArbitraryLength=e=>getIsArbitraryValue(e,"length",isLengthOnly),isNumber$1=e=>!!e&&!Number.isNaN(Number(e)),isArbitraryNumber=e=>getIsArbitraryValue(e,"number",isNumber$1),isInteger=e=>!!e&&Number.isInteger(Number(e)),isPercent=e=>e.endsWith("%")&&isNumber$1(e.slice(0,-1)),isArbitraryValue=e=>arbitraryValueRegex.test(e),isTshirtSize=e=>tshirtUnitRegex.test(e),sizeLabels=new Set(["length","size","percentage"]),isArbitrarySize=e=>getIsArbitraryValue(e,sizeLabels,isNever),isArbitraryPosition=e=>getIsArbitraryValue(e,"position",isNever),imageLabels=new Set(["image","url"]),isArbitraryImage=e=>getIsArbitraryValue(e,imageLabels,isImage),isArbitraryShadow=e=>getIsArbitraryValue(e,"",isShadow),isAny=()=>!0,getIsArbitraryValue=(e,s,i)=>{const c=arbitraryValueRegex.exec(e);return c?c[1]?typeof s=="string"?c[1]===s:s.has(c[1]):i(c[2]):!1},isLengthOnly=e=>lengthUnitRegex.test(e)&&!colorFunctionRegex.test(e),isNever=()=>!1,isShadow=e=>shadowRegex.test(e),isImage=e=>imageRegex.test(e),getDefaultConfig=()=>{const e=fromTheme("colors"),s=fromTheme("spacing"),i=fromTheme("blur"),c=fromTheme("brightness"),d=fromTheme("borderColor"),h=fromTheme("borderRadius"),_=fromTheme("borderSpacing"),g=fromTheme("borderWidth"),$=fromTheme("contrast"),_e=fromTheme("grayscale"),lt=fromTheme("hueRotate"),at=fromTheme("invert"),it=fromTheme("gap"),ct=fromTheme("gradientColorStops"),mt=fromTheme("gradientColorStopPositions"),pt=fromTheme("inset"),zt=fromTheme("margin"),dt=fromTheme("opacity"),ft=fromTheme("padding"),kt=fromTheme("saturate"),St=fromTheme("scale"),Lt=fromTheme("sepia"),Gt=fromTheme("skew"),Bt=fromTheme("space"),nr=fromTheme("translate"),cr=()=>["auto","contain","none"],ur=()=>["auto","hidden","clip","visible","scroll"],yn=()=>["auto",isArbitraryValue,s],hn=()=>[isArbitraryValue,s],_n=()=>["",isLength,isArbitraryLength],gn=()=>["auto",isNumber$1,isArbitraryValue],vn=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Tn=()=>["solid","dashed","dotted","double","none"],kn=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],bn=()=>["start","end","center","between","around","evenly","stretch"],Sn=()=>["","0",isArbitraryValue],fn=()=>["auto","avoid","all","avoid-page","page","left","right","column"],or=()=>[isNumber$1,isArbitraryValue];return{cacheSize:500,separator:":",theme:{colors:[isAny],spacing:[isLength,isArbitraryLength],blur:["none","",isTshirtSize,isArbitraryValue],brightness:or(),borderColor:[e],borderRadius:["none","","full",isTshirtSize,isArbitraryValue],borderSpacing:hn(),borderWidth:_n(),contrast:or(),grayscale:Sn(),hueRotate:or(),invert:Sn(),gap:hn(),gradientColorStops:[e],gradientColorStopPositions:[isPercent,isArbitraryLength],inset:yn(),margin:yn(),opacity:or(),padding:hn(),saturate:or(),scale:or(),sepia:Sn(),skew:or(),space:hn(),translate:hn()},classGroups:{aspect:[{aspect:["auto","square","video",isArbitraryValue]}],container:["container"],columns:[{columns:[isTshirtSize]}],"break-after":[{"break-after":fn()}],"break-before":[{"break-before":fn()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...vn(),isArbitraryValue]}],overflow:[{overflow:ur()}],"overflow-x":[{"overflow-x":ur()}],"overflow-y":[{"overflow-y":ur()}],overscroll:[{overscroll:cr()}],"overscroll-x":[{"overscroll-x":cr()}],"overscroll-y":[{"overscroll-y":cr()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[pt]}],"inset-x":[{"inset-x":[pt]}],"inset-y":[{"inset-y":[pt]}],start:[{start:[pt]}],end:[{end:[pt]}],top:[{top:[pt]}],right:[{right:[pt]}],bottom:[{bottom:[pt]}],left:[{left:[pt]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",isInteger,isArbitraryValue]}],basis:[{basis:yn()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",isArbitraryValue]}],grow:[{grow:Sn()}],shrink:[{shrink:Sn()}],order:[{order:["first","last","none",isInteger,isArbitraryValue]}],"grid-cols":[{"grid-cols":[isAny]}],"col-start-end":[{col:["auto",{span:["full",isInteger,isArbitraryValue]},isArbitraryValue]}],"col-start":[{"col-start":gn()}],"col-end":[{"col-end":gn()}],"grid-rows":[{"grid-rows":[isAny]}],"row-start-end":[{row:["auto",{span:[isInteger,isArbitraryValue]},isArbitraryValue]}],"row-start":[{"row-start":gn()}],"row-end":[{"row-end":gn()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",isArbitraryValue]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",isArbitraryValue]}],gap:[{gap:[it]}],"gap-x":[{"gap-x":[it]}],"gap-y":[{"gap-y":[it]}],"justify-content":[{justify:["normal",...bn()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...bn(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...bn(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[ft]}],px:[{px:[ft]}],py:[{py:[ft]}],ps:[{ps:[ft]}],pe:[{pe:[ft]}],pt:[{pt:[ft]}],pr:[{pr:[ft]}],pb:[{pb:[ft]}],pl:[{pl:[ft]}],m:[{m:[zt]}],mx:[{mx:[zt]}],my:[{my:[zt]}],ms:[{ms:[zt]}],me:[{me:[zt]}],mt:[{mt:[zt]}],mr:[{mr:[zt]}],mb:[{mb:[zt]}],ml:[{ml:[zt]}],"space-x":[{"space-x":[Bt]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[Bt]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",isArbitraryValue,s]}],"min-w":[{"min-w":[isArbitraryValue,s,"min","max","fit"]}],"max-w":[{"max-w":[isArbitraryValue,s,"none","full","min","max","fit","prose",{screen:[isTshirtSize]},isTshirtSize]}],h:[{h:[isArbitraryValue,s,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[isArbitraryValue,s,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[isArbitraryValue,s,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[isArbitraryValue,s,"auto","min","max","fit"]}],"font-size":[{text:["base",isTshirtSize,isArbitraryLength]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",isArbitraryNumber]}],"font-family":[{font:[isAny]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",isArbitraryValue]}],"line-clamp":[{"line-clamp":["none",isNumber$1,isArbitraryNumber]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",isLength,isArbitraryValue]}],"list-image":[{"list-image":["none",isArbitraryValue]}],"list-style-type":[{list:["none","disc","decimal",isArbitraryValue]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[dt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[dt]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Tn(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",isLength,isArbitraryLength]}],"underline-offset":[{"underline-offset":["auto",isLength,isArbitraryValue]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:hn()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",isArbitraryValue]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",isArbitraryValue]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[dt]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...vn(),isArbitraryPosition]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",isArbitrarySize]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},isArbitraryImage]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[mt]}],"gradient-via-pos":[{via:[mt]}],"gradient-to-pos":[{to:[mt]}],"gradient-from":[{from:[ct]}],"gradient-via":[{via:[ct]}],"gradient-to":[{to:[ct]}],rounded:[{rounded:[h]}],"rounded-s":[{"rounded-s":[h]}],"rounded-e":[{"rounded-e":[h]}],"rounded-t":[{"rounded-t":[h]}],"rounded-r":[{"rounded-r":[h]}],"rounded-b":[{"rounded-b":[h]}],"rounded-l":[{"rounded-l":[h]}],"rounded-ss":[{"rounded-ss":[h]}],"rounded-se":[{"rounded-se":[h]}],"rounded-ee":[{"rounded-ee":[h]}],"rounded-es":[{"rounded-es":[h]}],"rounded-tl":[{"rounded-tl":[h]}],"rounded-tr":[{"rounded-tr":[h]}],"rounded-br":[{"rounded-br":[h]}],"rounded-bl":[{"rounded-bl":[h]}],"border-w":[{border:[g]}],"border-w-x":[{"border-x":[g]}],"border-w-y":[{"border-y":[g]}],"border-w-s":[{"border-s":[g]}],"border-w-e":[{"border-e":[g]}],"border-w-t":[{"border-t":[g]}],"border-w-r":[{"border-r":[g]}],"border-w-b":[{"border-b":[g]}],"border-w-l":[{"border-l":[g]}],"border-opacity":[{"border-opacity":[dt]}],"border-style":[{border:[...Tn(),"hidden"]}],"divide-x":[{"divide-x":[g]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[g]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[dt]}],"divide-style":[{divide:Tn()}],"border-color":[{border:[d]}],"border-color-x":[{"border-x":[d]}],"border-color-y":[{"border-y":[d]}],"border-color-s":[{"border-s":[d]}],"border-color-e":[{"border-e":[d]}],"border-color-t":[{"border-t":[d]}],"border-color-r":[{"border-r":[d]}],"border-color-b":[{"border-b":[d]}],"border-color-l":[{"border-l":[d]}],"divide-color":[{divide:[d]}],"outline-style":[{outline:["",...Tn()]}],"outline-offset":[{"outline-offset":[isLength,isArbitraryValue]}],"outline-w":[{outline:[isLength,isArbitraryLength]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:_n()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[dt]}],"ring-offset-w":[{"ring-offset":[isLength,isArbitraryLength]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",isTshirtSize,isArbitraryShadow]}],"shadow-color":[{shadow:[isAny]}],opacity:[{opacity:[dt]}],"mix-blend":[{"mix-blend":[...kn(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":kn()}],filter:[{filter:["","none"]}],blur:[{blur:[i]}],brightness:[{brightness:[c]}],contrast:[{contrast:[$]}],"drop-shadow":[{"drop-shadow":["","none",isTshirtSize,isArbitraryValue]}],grayscale:[{grayscale:[_e]}],"hue-rotate":[{"hue-rotate":[lt]}],invert:[{invert:[at]}],saturate:[{saturate:[kt]}],sepia:[{sepia:[Lt]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[i]}],"backdrop-brightness":[{"backdrop-brightness":[c]}],"backdrop-contrast":[{"backdrop-contrast":[$]}],"backdrop-grayscale":[{"backdrop-grayscale":[_e]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[lt]}],"backdrop-invert":[{"backdrop-invert":[at]}],"backdrop-opacity":[{"backdrop-opacity":[dt]}],"backdrop-saturate":[{"backdrop-saturate":[kt]}],"backdrop-sepia":[{"backdrop-sepia":[Lt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[_]}],"border-spacing-x":[{"border-spacing-x":[_]}],"border-spacing-y":[{"border-spacing-y":[_]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",isArbitraryValue]}],duration:[{duration:or()}],ease:[{ease:["linear","in","out","in-out",isArbitraryValue]}],delay:[{delay:or()}],animate:[{animate:["none","spin","ping","pulse","bounce",isArbitraryValue]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[St]}],"scale-x":[{"scale-x":[St]}],"scale-y":[{"scale-y":[St]}],rotate:[{rotate:[isInteger,isArbitraryValue]}],"translate-x":[{"translate-x":[nr]}],"translate-y":[{"translate-y":[nr]}],"skew-x":[{"skew-x":[Gt]}],"skew-y":[{"skew-y":[Gt]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",isArbitraryValue]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",isArbitraryValue]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":hn()}],"scroll-mx":[{"scroll-mx":hn()}],"scroll-my":[{"scroll-my":hn()}],"scroll-ms":[{"scroll-ms":hn()}],"scroll-me":[{"scroll-me":hn()}],"scroll-mt":[{"scroll-mt":hn()}],"scroll-mr":[{"scroll-mr":hn()}],"scroll-mb":[{"scroll-mb":hn()}],"scroll-ml":[{"scroll-ml":hn()}],"scroll-p":[{"scroll-p":hn()}],"scroll-px":[{"scroll-px":hn()}],"scroll-py":[{"scroll-py":hn()}],"scroll-ps":[{"scroll-ps":hn()}],"scroll-pe":[{"scroll-pe":hn()}],"scroll-pt":[{"scroll-pt":hn()}],"scroll-pr":[{"scroll-pr":hn()}],"scroll-pb":[{"scroll-pb":hn()}],"scroll-pl":[{"scroll-pl":hn()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",isArbitraryValue]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[isLength,isArbitraryLength,isArbitraryNumber]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},twMerge=createTailwindMerge(getDefaultConfig);function cn(...e){return twMerge(clsx(e))}const ToastProvider=Provider$1,ToastViewport=reactExports.forwardRef(({className:e,...s},i)=>jsxRuntimeExports.jsx(Viewport$1,{ref:i,className:cn("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...s}));ToastViewport.displayName=Viewport$1.displayName;const toastVariants=cva("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Toast=reactExports.forwardRef(({className:e,variant:s,...i},c)=>jsxRuntimeExports.jsx(Root2$2,{ref:c,className:cn(toastVariants({variant:s}),e),...i}));Toast.displayName=Root2$2.displayName;const ToastAction=reactExports.forwardRef(({className:e,...s},i)=>jsxRuntimeExports.jsx(Action$1,{ref:i,className:cn("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",e),...s}));ToastAction.displayName=Action$1.displayName;const ToastClose=reactExports.forwardRef(({className:e,...s},i)=>jsxRuntimeExports.jsx(Close,{ref:i,className:cn("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...s,children:jsxRuntimeExports.jsx(X,{className:"h-4 w-4"})}));ToastClose.displayName=Close.displayName;const ToastTitle=reactExports.forwardRef(({className:e,...s},i)=>jsxRuntimeExports.jsx(Title,{ref:i,className:cn("text-sm font-semibold",e),...s}));ToastTitle.displayName=Title.displayName;const ToastDescription=reactExports.forwardRef(({className:e,...s},i)=>jsxRuntimeExports.jsx(Description,{ref:i,className:cn("text-sm opacity-90",e),...s}));ToastDescription.displayName=Description.displayName;function Toaster$1(){const{toasts:e}=useToast();return jsxRuntimeExports.jsxs(ToastProvider,{children:[e.map(function({id:s,title:i,description:c,action:d,...h}){return jsxRuntimeExports.jsxs(Toast,{...h,children:[jsxRuntimeExports.jsxs("div",{className:"grid gap-1",children:[i&&jsxRuntimeExports.jsx(ToastTitle,{children:i}),c&&jsxRuntimeExports.jsx(ToastDescription,{children:c})]}),d,jsxRuntimeExports.jsx(ToastClose,{})]},s)}),jsxRuntimeExports.jsx(ToastViewport,{})]})}var P$1=["light","dark"],E="(prefers-color-scheme: dark)",L=reactExports.createContext(void 0),D={setTheme:e=>{},themes:[]},j=()=>{var e;return(e=reactExports.useContext(L))!=null?e:D};reactExports.memo(({forcedTheme:e,storageKey:s,attribute:i,enableSystem:c,enableColorScheme:d,defaultTheme:h,value:_,attrs:g,nonce:$})=>{let _e=h==="system",lt=i==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${g.map(mt=>`'${mt}'`).join(",")})`};`:`var d=document.documentElement,n='${i}',s='setAttribute';`,at=d?P$1.includes(h)&&h?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${h}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",it=(mt,pt=!1,zt=!0)=>{let dt=_?_[mt]:mt,ft=pt?mt+"|| ''":`'${dt}'`,kt="";return d&&zt&&!pt&&P$1.includes(mt)&&(kt+=`d.style.colorScheme = '${mt}';`),i==="class"?pt||dt?kt+=`c.add(${ft})`:kt+="null":dt&&(kt+=`d[s](n,${ft})`),kt},ct=e?`!function(){${lt}${it(e)}}()`:c?`!function(){try{${lt}var e=localStorage.getItem('${s}');if('system'===e||(!e&&${_e})){var t='${E}',m=window.matchMedia(t);if(m.media!==t||m.matches){${it("dark")}}else{${it("light")}}}else if(e){${_?`var x=${JSON.stringify(_)};`:""}${it(_?"x[e]":"e",!0)}}${_e?"":"else{"+it(h,!1,!1)+"}"}${at}}catch(e){}}()`:`!function(){try{${lt}var e=localStorage.getItem('${s}');if(e){${_?`var x=${JSON.stringify(_)};`:""}${it(_?"x[e]":"e",!0)}}else{${it(h,!1,!1)};}${at}}catch(t){}}();`;return reactExports.createElement("script",{nonce:$,dangerouslySetInnerHTML:{__html:ct}})});var jt$1=e=>{switch(e){case"success":return ee$1;case"info":return ae;case"warning":return oe;case"error":return se$1;default:return null}},te=Array(12).fill(0),Yt$1=({visible:e,className:s})=>o.createElement("div",{className:["sonner-loading-wrapper",s].filter(Boolean).join(" "),"data-visible":e},o.createElement("div",{className:"sonner-spinner"},te.map((i,c)=>o.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${c}`})))),ee$1=o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},o.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),oe=o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},o.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),ae=o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},o.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),se$1=o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},o.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Ot=o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},o.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),Ft$1=()=>{let[e,s]=o.useState(document.hidden);return o.useEffect(()=>{let i=()=>{s(document.hidden)};return document.addEventListener("visibilitychange",i),()=>window.removeEventListener("visibilitychange",i)},[]),e},bt$1=1,yt$1=class{constructor(){this.subscribe=s=>(this.subscribers.push(s),()=>{let i=this.subscribers.indexOf(s);this.subscribers.splice(i,1)}),this.publish=s=>{this.subscribers.forEach(i=>i(s))},this.addToast=s=>{this.publish(s),this.toasts=[...this.toasts,s]},this.create=s=>{var i;let{message:c,...d}=s,h=typeof(s==null?void 0:s.id)=="number"||((i=s.id)==null?void 0:i.length)>0?s.id:bt$1++,_=this.toasts.find($=>$.id===h),g=s.dismissible===void 0?!0:s.dismissible;return this.dismissedToasts.has(h)&&this.dismissedToasts.delete(h),_?this.toasts=this.toasts.map($=>$.id===h?(this.publish({...$,...s,id:h,title:c}),{...$,...s,id:h,dismissible:g,title:c}):$):this.addToast({title:c,...d,dismissible:g,id:h}),h},this.dismiss=s=>(this.dismissedToasts.add(s),s||this.toasts.forEach(i=>{this.subscribers.forEach(c=>c({id:i.id,dismiss:!0}))}),this.subscribers.forEach(i=>i({id:s,dismiss:!0})),s),this.message=(s,i)=>this.create({...i,message:s}),this.error=(s,i)=>this.create({...i,message:s,type:"error"}),this.success=(s,i)=>this.create({...i,type:"success",message:s}),this.info=(s,i)=>this.create({...i,type:"info",message:s}),this.warning=(s,i)=>this.create({...i,type:"warning",message:s}),this.loading=(s,i)=>this.create({...i,type:"loading",message:s}),this.promise=(s,i)=>{if(!i)return;let c;i.loading!==void 0&&(c=this.create({...i,promise:s,type:"loading",message:i.loading,description:typeof i.description!="function"?i.description:void 0}));let d=s instanceof Promise?s:s(),h=c!==void 0,_,g=d.then(async _e=>{if(_=["resolve",_e],o.isValidElement(_e))h=!1,this.create({id:c,type:"default",message:_e});else if(ie$1(_e)&&!_e.ok){h=!1;let lt=typeof i.error=="function"?await i.error(`HTTP error! status: ${_e.status}`):i.error,at=typeof i.description=="function"?await i.description(`HTTP error! status: ${_e.status}`):i.description;this.create({id:c,type:"error",message:lt,description:at})}else if(i.success!==void 0){h=!1;let lt=typeof i.success=="function"?await i.success(_e):i.success,at=typeof i.description=="function"?await i.description(_e):i.description;this.create({id:c,type:"success",message:lt,description:at})}}).catch(async _e=>{if(_=["reject",_e],i.error!==void 0){h=!1;let lt=typeof i.error=="function"?await i.error(_e):i.error,at=typeof i.description=="function"?await i.description(_e):i.description;this.create({id:c,type:"error",message:lt,description:at})}}).finally(()=>{var _e;h&&(this.dismiss(c),c=void 0),(_e=i.finally)==null||_e.call(i)}),$=()=>new Promise((_e,lt)=>g.then(()=>_[0]==="reject"?lt(_[1]):_e(_[1])).catch(lt));return typeof c!="string"&&typeof c!="number"?{unwrap:$}:Object.assign(c,{unwrap:$})},this.custom=(s,i)=>{let c=(i==null?void 0:i.id)||bt$1++;return this.create({jsx:s(c),id:c,...i}),c},this.getActiveToasts=()=>this.toasts.filter(s=>!this.dismissedToasts.has(s.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},v=new yt$1,ne$1=(e,s)=>{let i=(s==null?void 0:s.id)||bt$1++;return v.addToast({title:e,...s,id:i}),i},ie$1=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",le=ne$1,ce$1=()=>v.toasts,de=()=>v.getActiveToasts(),ue=Object.assign(le,{success:v.success,info:v.info,warning:v.warning,error:v.error,custom:v.custom,message:v.message,promise:v.promise,dismiss:v.dismiss,loading:v.loading},{getHistory:ce$1,getToasts:de});function wt(e,{insertAt:s}={}){if(typeof document>"u")return;let i=document.head||document.getElementsByTagName("head")[0],c=document.createElement("style");c.type="text/css",s==="top"&&i.firstChild?i.insertBefore(c,i.firstChild):i.appendChild(c),c.styleSheet?c.styleSheet.cssText=e:c.appendChild(document.createTextNode(e))}wt(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function tt$1(e){return e.label!==void 0}var pe$1=3,me$1="32px",ge$1="16px",Wt$1=4e3,he=356,be$1=14,ye=20,we=200;function M$1(...e){return e.filter(Boolean).join(" ")}function xe(e){let[s,i]=e.split("-"),c=[];return s&&c.push(s),i&&c.push(i),c}var ve=e=>{var s,i,c,d,h,_,g,$,_e,lt,at;let{invert:it,toast:ct,unstyled:mt,interacting:pt,setHeights:zt,visibleToasts:dt,heights:ft,index:kt,toasts:St,expanded:Lt,removeToast:Gt,defaultRichColors:Bt,closeButton:nr,style:cr,cancelButtonStyle:ur,actionButtonStyle:yn,className:hn="",descriptionClassName:_n="",duration:gn,position:vn,gap:Tn,loadingIcon:kn,expandByDefault:bn,classNames:Sn,icons:fn,closeButtonAriaLabel:or="Close toast",pauseWhenPageIsHidden:lr}=e,[pn,Cn]=o.useState(null),[Lo,Mo]=o.useState(null),[Ro,qo]=o.useState(!1),[tp,Wo]=o.useState(!1),[En,mr]=o.useState(!1),[Do,Go]=o.useState(!1),[Jo,_i]=o.useState(!1),[Ho,_c]=o.useState(0),[Qo,ep]=o.useState(0),lp=o.useRef(ct.duration||gn||Wt$1),_p=o.useRef(null),Zo=o.useRef(null),bp=kt===0,gp=kt+1<=dt,Mp=ct.type,wp=ct.dismissible!==!1,ip=ct.className||"",fp=ct.descriptionClassName||"",Rp=o.useMemo(()=>ft.findIndex(r_=>r_.toastId===ct.id)||0,[ft,ct.id]),Ap=o.useMemo(()=>{var r_;return(r_=ct.closeButton)!=null?r_:nr},[ct.closeButton,nr]),u_=o.useMemo(()=>ct.duration||gn||Wt$1,[ct.duration,gn]),Ip=o.useRef(0),C_=o.useRef(0),G_=o.useRef(0),z_=o.useRef(null),[hx,S_]=vn.split("-"),H_=o.useMemo(()=>ft.reduce((r_,g_,Pp)=>Pp>=Rp?r_:r_+g_.height,0),[ft,Rp]),zx=Ft$1(),qx=ct.invert||it,Ix=Mp==="loading";C_.current=o.useMemo(()=>Rp*Tn+H_,[Rp,H_]),o.useEffect(()=>{lp.current=u_},[u_]),o.useEffect(()=>{qo(!0)},[]),o.useEffect(()=>{let r_=Zo.current;if(r_){let g_=r_.getBoundingClientRect().height;return ep(g_),zt(Pp=>[{toastId:ct.id,height:g_,position:ct.position},...Pp]),()=>zt(Pp=>Pp.filter(m_=>m_.toastId!==ct.id))}},[zt,ct.id]),o.useLayoutEffect(()=>{if(!Ro)return;let r_=Zo.current,g_=r_.style.height;r_.style.height="auto";let Pp=r_.getBoundingClientRect().height;r_.style.height=g_,ep(Pp),zt(m_=>m_.find(ir=>ir.toastId===ct.id)?m_.map(ir=>ir.toastId===ct.id?{...ir,height:Pp}:ir):[{toastId:ct.id,height:Pp,position:ct.position},...m_])},[Ro,ct.title,ct.description,zt,ct.id]);let X_=o.useCallback(()=>{Wo(!0),_c(C_.current),zt(r_=>r_.filter(g_=>g_.toastId!==ct.id)),setTimeout(()=>{Gt(ct)},we)},[ct,Gt,zt,C_]);o.useEffect(()=>{if(ct.promise&&Mp==="loading"||ct.duration===1/0||ct.type==="loading")return;let r_;return Lt||pt||lr&&zx?(()=>{if(G_.current<Ip.current){let g_=new Date().getTime()-Ip.current;lp.current=lp.current-g_}G_.current=new Date().getTime()})():lp.current!==1/0&&(Ip.current=new Date().getTime(),r_=setTimeout(()=>{var g_;(g_=ct.onAutoClose)==null||g_.call(ct,ct),X_()},lp.current)),()=>clearTimeout(r_)},[Lt,pt,ct,Mp,lr,zx,X_]),o.useEffect(()=>{ct.delete&&X_()},[X_,ct.delete]);function e_(){var r_,g_,Pp;return fn!=null&&fn.loading?o.createElement("div",{className:M$1(Sn==null?void 0:Sn.loader,(r_=ct==null?void 0:ct.classNames)==null?void 0:r_.loader,"sonner-loader"),"data-visible":Mp==="loading"},fn.loading):kn?o.createElement("div",{className:M$1(Sn==null?void 0:Sn.loader,(g_=ct==null?void 0:ct.classNames)==null?void 0:g_.loader,"sonner-loader"),"data-visible":Mp==="loading"},kn):o.createElement(Yt$1,{className:M$1(Sn==null?void 0:Sn.loader,(Pp=ct==null?void 0:ct.classNames)==null?void 0:Pp.loader),visible:Mp==="loading"})}return o.createElement("li",{tabIndex:0,ref:Zo,className:M$1(hn,ip,Sn==null?void 0:Sn.toast,(s=ct==null?void 0:ct.classNames)==null?void 0:s.toast,Sn==null?void 0:Sn.default,Sn==null?void 0:Sn[Mp],(i=ct==null?void 0:ct.classNames)==null?void 0:i[Mp]),"data-sonner-toast":"","data-rich-colors":(c=ct.richColors)!=null?c:Bt,"data-styled":!(ct.jsx||ct.unstyled||mt),"data-mounted":Ro,"data-promise":!!ct.promise,"data-swiped":Jo,"data-removed":tp,"data-visible":gp,"data-y-position":hx,"data-x-position":S_,"data-index":kt,"data-front":bp,"data-swiping":En,"data-dismissible":wp,"data-type":Mp,"data-invert":qx,"data-swipe-out":Do,"data-swipe-direction":Lo,"data-expanded":!!(Lt||bn&&Ro),style:{"--index":kt,"--toasts-before":kt,"--z-index":St.length-kt,"--offset":`${tp?Ho:C_.current}px`,"--initial-height":bn?"auto":`${Qo}px`,...cr,...ct.style},onDragEnd:()=>{mr(!1),Cn(null),z_.current=null},onPointerDown:r_=>{Ix||!wp||(_p.current=new Date,_c(C_.current),r_.target.setPointerCapture(r_.pointerId),r_.target.tagName!=="BUTTON"&&(mr(!0),z_.current={x:r_.clientX,y:r_.clientY}))},onPointerUp:()=>{var r_,g_,Pp,m_;if(Do||!wp)return;z_.current=null;let ir=Number(((r_=Zo.current)==null?void 0:r_.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),In=Number(((g_=Zo.current)==null?void 0:g_.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),wn=new Date().getTime()-((Pp=_p.current)==null?void 0:Pp.getTime()),An=pn==="x"?ir:In,No=Math.abs(An)/wn;if(Math.abs(An)>=ye||No>.11){_c(C_.current),(m_=ct.onDismiss)==null||m_.call(ct,ct),Mo(pn==="x"?ir>0?"right":"left":In>0?"down":"up"),X_(),Go(!0),_i(!1);return}mr(!1),Cn(null)},onPointerMove:r_=>{var g_,Pp,m_,ir;if(!z_.current||!wp||((g_=window.getSelection())==null?void 0:g_.toString().length)>0)return;let In=r_.clientY-z_.current.y,wn=r_.clientX-z_.current.x,An=(Pp=e.swipeDirections)!=null?Pp:xe(vn);!pn&&(Math.abs(wn)>1||Math.abs(In)>1)&&Cn(Math.abs(wn)>Math.abs(In)?"x":"y");let No={x:0,y:0};pn==="y"?(An.includes("top")||An.includes("bottom"))&&(An.includes("top")&&In<0||An.includes("bottom")&&In>0)&&(No.y=In):pn==="x"&&(An.includes("left")||An.includes("right"))&&(An.includes("left")&&wn<0||An.includes("right")&&wn>0)&&(No.x=wn),(Math.abs(No.x)>0||Math.abs(No.y)>0)&&_i(!0),(m_=Zo.current)==null||m_.style.setProperty("--swipe-amount-x",`${No.x}px`),(ir=Zo.current)==null||ir.style.setProperty("--swipe-amount-y",`${No.y}px`)}},Ap&&!ct.jsx?o.createElement("button",{"aria-label":or,"data-disabled":Ix,"data-close-button":!0,onClick:Ix||!wp?()=>{}:()=>{var r_;X_(),(r_=ct.onDismiss)==null||r_.call(ct,ct)},className:M$1(Sn==null?void 0:Sn.closeButton,(d=ct==null?void 0:ct.classNames)==null?void 0:d.closeButton)},(h=fn==null?void 0:fn.close)!=null?h:Ot):null,ct.jsx||reactExports.isValidElement(ct.title)?ct.jsx?ct.jsx:typeof ct.title=="function"?ct.title():ct.title:o.createElement(o.Fragment,null,Mp||ct.icon||ct.promise?o.createElement("div",{"data-icon":"",className:M$1(Sn==null?void 0:Sn.icon,(_=ct==null?void 0:ct.classNames)==null?void 0:_.icon)},ct.promise||ct.type==="loading"&&!ct.icon?ct.icon||e_():null,ct.type!=="loading"?ct.icon||(fn==null?void 0:fn[Mp])||jt$1(Mp):null):null,o.createElement("div",{"data-content":"",className:M$1(Sn==null?void 0:Sn.content,(g=ct==null?void 0:ct.classNames)==null?void 0:g.content)},o.createElement("div",{"data-title":"",className:M$1(Sn==null?void 0:Sn.title,($=ct==null?void 0:ct.classNames)==null?void 0:$.title)},typeof ct.title=="function"?ct.title():ct.title),ct.description?o.createElement("div",{"data-description":"",className:M$1(_n,fp,Sn==null?void 0:Sn.description,(_e=ct==null?void 0:ct.classNames)==null?void 0:_e.description)},typeof ct.description=="function"?ct.description():ct.description):null),reactExports.isValidElement(ct.cancel)?ct.cancel:ct.cancel&&tt$1(ct.cancel)?o.createElement("button",{"data-button":!0,"data-cancel":!0,style:ct.cancelButtonStyle||ur,onClick:r_=>{var g_,Pp;tt$1(ct.cancel)&&wp&&((Pp=(g_=ct.cancel).onClick)==null||Pp.call(g_,r_),X_())},className:M$1(Sn==null?void 0:Sn.cancelButton,(lt=ct==null?void 0:ct.classNames)==null?void 0:lt.cancelButton)},ct.cancel.label):null,reactExports.isValidElement(ct.action)?ct.action:ct.action&&tt$1(ct.action)?o.createElement("button",{"data-button":!0,"data-action":!0,style:ct.actionButtonStyle||yn,onClick:r_=>{var g_,Pp;tt$1(ct.action)&&((Pp=(g_=ct.action).onClick)==null||Pp.call(g_,r_),!r_.defaultPrevented&&X_())},className:M$1(Sn==null?void 0:Sn.actionButton,(at=ct==null?void 0:ct.classNames)==null?void 0:at.actionButton)},ct.action.label):null))};function _t(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function Te(e,s){let i={};return[e,s].forEach((c,d)=>{let h=d===1,_=h?"--mobile-offset":"--offset",g=h?ge$1:me$1;function $(_e){["top","right","bottom","left"].forEach(lt=>{i[`${_}-${lt}`]=typeof _e=="number"?`${_e}px`:_e})}typeof c=="number"||typeof c=="string"?$(c):typeof c=="object"?["top","right","bottom","left"].forEach(_e=>{c[_e]===void 0?i[`${_}-${_e}`]=g:i[`${_}-${_e}`]=typeof c[_e]=="number"?`${c[_e]}px`:c[_e]}):$(g)}),i}var $e=reactExports.forwardRef(function(e,s){let{invert:i,position:c="bottom-right",hotkey:d=["altKey","KeyT"],expand:h,closeButton:_,className:g,offset:$,mobileOffset:_e,theme:lt="light",richColors:at,duration:it,style:ct,visibleToasts:mt=pe$1,toastOptions:pt,dir:zt=_t(),gap:dt=be$1,loadingIcon:ft,icons:kt,containerAriaLabel:St="Notifications",pauseWhenPageIsHidden:Lt}=e,[Gt,Bt]=o.useState([]),nr=o.useMemo(()=>Array.from(new Set([c].concat(Gt.filter(lr=>lr.position).map(lr=>lr.position)))),[Gt,c]),[cr,ur]=o.useState([]),[yn,hn]=o.useState(!1),[_n,gn]=o.useState(!1),[vn,Tn]=o.useState(lt!=="system"?lt:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),kn=o.useRef(null),bn=d.join("+").replace(/Key/g,"").replace(/Digit/g,""),Sn=o.useRef(null),fn=o.useRef(!1),or=o.useCallback(lr=>{Bt(pn=>{var Cn;return(Cn=pn.find(Lo=>Lo.id===lr.id))!=null&&Cn.delete||v.dismiss(lr.id),pn.filter(({id:Lo})=>Lo!==lr.id)})},[]);return o.useEffect(()=>v.subscribe(lr=>{if(lr.dismiss){Bt(pn=>pn.map(Cn=>Cn.id===lr.id?{...Cn,delete:!0}:Cn));return}setTimeout(()=>{vt$1.flushSync(()=>{Bt(pn=>{let Cn=pn.findIndex(Lo=>Lo.id===lr.id);return Cn!==-1?[...pn.slice(0,Cn),{...pn[Cn],...lr},...pn.slice(Cn+1)]:[lr,...pn]})})})}),[]),o.useEffect(()=>{if(lt!=="system"){Tn(lt);return}if(lt==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Tn("dark"):Tn("light")),typeof window>"u")return;let lr=window.matchMedia("(prefers-color-scheme: dark)");try{lr.addEventListener("change",({matches:pn})=>{Tn(pn?"dark":"light")})}catch{lr.addListener(({matches:Cn})=>{try{Tn(Cn?"dark":"light")}catch(Lo){console.error(Lo)}})}},[lt]),o.useEffect(()=>{Gt.length<=1&&hn(!1)},[Gt]),o.useEffect(()=>{let lr=pn=>{var Cn,Lo;d.every(Mo=>pn[Mo]||pn.code===Mo)&&(hn(!0),(Cn=kn.current)==null||Cn.focus()),pn.code==="Escape"&&(document.activeElement===kn.current||(Lo=kn.current)!=null&&Lo.contains(document.activeElement))&&hn(!1)};return document.addEventListener("keydown",lr),()=>document.removeEventListener("keydown",lr)},[d]),o.useEffect(()=>{if(kn.current)return()=>{Sn.current&&(Sn.current.focus({preventScroll:!0}),Sn.current=null,fn.current=!1)}},[kn.current]),o.createElement("section",{ref:s,"aria-label":`${St} ${bn}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},nr.map((lr,pn)=>{var Cn;let[Lo,Mo]=lr.split("-");return Gt.length?o.createElement("ol",{key:lr,dir:zt==="auto"?_t():zt,tabIndex:-1,ref:kn,className:g,"data-sonner-toaster":!0,"data-theme":vn,"data-y-position":Lo,"data-lifted":yn&&Gt.length>1&&!h,"data-x-position":Mo,style:{"--front-toast-height":`${((Cn=cr[0])==null?void 0:Cn.height)||0}px`,"--width":`${he}px`,"--gap":`${dt}px`,...ct,...Te($,_e)},onBlur:Ro=>{fn.current&&!Ro.currentTarget.contains(Ro.relatedTarget)&&(fn.current=!1,Sn.current&&(Sn.current.focus({preventScroll:!0}),Sn.current=null))},onFocus:Ro=>{Ro.target instanceof HTMLElement&&Ro.target.dataset.dismissible==="false"||fn.current||(fn.current=!0,Sn.current=Ro.relatedTarget)},onMouseEnter:()=>hn(!0),onMouseMove:()=>hn(!0),onMouseLeave:()=>{_n||hn(!1)},onDragEnd:()=>hn(!1),onPointerDown:Ro=>{Ro.target instanceof HTMLElement&&Ro.target.dataset.dismissible==="false"||gn(!0)},onPointerUp:()=>gn(!1)},Gt.filter(Ro=>!Ro.position&&pn===0||Ro.position===lr).map((Ro,qo)=>{var tp,Wo;return o.createElement(ve,{key:Ro.id,icons:kt,index:qo,toast:Ro,defaultRichColors:at,duration:(tp=pt==null?void 0:pt.duration)!=null?tp:it,className:pt==null?void 0:pt.className,descriptionClassName:pt==null?void 0:pt.descriptionClassName,invert:i,visibleToasts:mt,closeButton:(Wo=pt==null?void 0:pt.closeButton)!=null?Wo:_,interacting:_n,position:lr,style:pt==null?void 0:pt.style,unstyled:pt==null?void 0:pt.unstyled,classNames:pt==null?void 0:pt.classNames,cancelButtonStyle:pt==null?void 0:pt.cancelButtonStyle,actionButtonStyle:pt==null?void 0:pt.actionButtonStyle,removeToast:or,toasts:Gt.filter(En=>En.position==Ro.position),heights:cr.filter(En=>En.position==Ro.position),setHeights:ur,expandByDefault:h,gap:dt,loadingIcon:ft,expanded:yn,pauseWhenPageIsHidden:Lt,swipeDirections:e.swipeDirections})})):null}))});const Toaster=({...e})=>{const{theme:s="system"}=j();return jsxRuntimeExports.jsx($e,{theme:s,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var useReactId=React[" useId ".trim().toString()]||(()=>{}),count$1=0;function useId(e){const[s,i]=reactExports.useState(useReactId());return useLayoutEffect2(()=>{i(c=>c??String(count$1++))},[e]),s?`radix-${s}`:""}const sides=["top","right","bottom","left"],min=Math.min,max=Math.max,round=Math.round,floor=Math.floor,createCoords=e=>({x:e,y:e}),oppositeSideMap={left:"right",right:"left",bottom:"top",top:"bottom"},oppositeAlignmentMap={start:"end",end:"start"};function clamp$1(e,s,i){return max(e,min(s,i))}function evaluate(e,s){return typeof e=="function"?e(s):e}function getSide(e){return e.split("-")[0]}function getAlignment(e){return e.split("-")[1]}function getOppositeAxis(e){return e==="x"?"y":"x"}function getAxisLength(e){return e==="y"?"height":"width"}const yAxisSides=new Set(["top","bottom"]);function getSideAxis(e){return yAxisSides.has(getSide(e))?"y":"x"}function getAlignmentAxis(e){return getOppositeAxis(getSideAxis(e))}function getAlignmentSides(e,s,i){i===void 0&&(i=!1);const c=getAlignment(e),d=getAlignmentAxis(e),h=getAxisLength(d);let _=d==="x"?c===(i?"end":"start")?"right":"left":c==="start"?"bottom":"top";return s.reference[h]>s.floating[h]&&(_=getOppositePlacement(_)),[_,getOppositePlacement(_)]}function getExpandedPlacements(e){const s=getOppositePlacement(e);return[getOppositeAlignmentPlacement(e),s,getOppositeAlignmentPlacement(s)]}function getOppositeAlignmentPlacement(e){return e.replace(/start|end/g,s=>oppositeAlignmentMap[s])}const lrPlacement=["left","right"],rlPlacement=["right","left"],tbPlacement=["top","bottom"],btPlacement=["bottom","top"];function getSideList(e,s,i){switch(e){case"top":case"bottom":return i?s?rlPlacement:lrPlacement:s?lrPlacement:rlPlacement;case"left":case"right":return s?tbPlacement:btPlacement;default:return[]}}function getOppositeAxisPlacements(e,s,i,c){const d=getAlignment(e);let h=getSideList(getSide(e),i==="start",c);return d&&(h=h.map(_=>_+"-"+d),s&&(h=h.concat(h.map(getOppositeAlignmentPlacement)))),h}function getOppositePlacement(e){return e.replace(/left|right|bottom|top/g,s=>oppositeSideMap[s])}function expandPaddingObject(e){return{top:0,right:0,bottom:0,left:0,...e}}function getPaddingObject(e){return typeof e!="number"?expandPaddingObject(e):{top:e,right:e,bottom:e,left:e}}function rectToClientRect(e){const{x:s,y:i,width:c,height:d}=e;return{width:c,height:d,top:i,left:s,right:s+c,bottom:i+d,x:s,y:i}}function computeCoordsFromPlacement(e,s,i){let{reference:c,floating:d}=e;const h=getSideAxis(s),_=getAlignmentAxis(s),g=getAxisLength(_),$=getSide(s),_e=h==="y",lt=c.x+c.width/2-d.width/2,at=c.y+c.height/2-d.height/2,it=c[g]/2-d[g]/2;let ct;switch($){case"top":ct={x:lt,y:c.y-d.height};break;case"bottom":ct={x:lt,y:c.y+c.height};break;case"right":ct={x:c.x+c.width,y:at};break;case"left":ct={x:c.x-d.width,y:at};break;default:ct={x:c.x,y:c.y}}switch(getAlignment(s)){case"start":ct[_]-=it*(i&&_e?-1:1);break;case"end":ct[_]+=it*(i&&_e?-1:1);break}return ct}const computePosition$1=async(e,s,i)=>{const{placement:c="bottom",strategy:d="absolute",middleware:h=[],platform:_}=i,g=h.filter(Boolean),$=await(_.isRTL==null?void 0:_.isRTL(s));let _e=await _.getElementRects({reference:e,floating:s,strategy:d}),{x:lt,y:at}=computeCoordsFromPlacement(_e,c,$),it=c,ct={},mt=0;for(let pt=0;pt<g.length;pt++){const{name:zt,fn:dt}=g[pt],{x:ft,y:kt,data:St,reset:Lt}=await dt({x:lt,y:at,initialPlacement:c,placement:it,strategy:d,middlewareData:ct,rects:_e,platform:_,elements:{reference:e,floating:s}});lt=ft??lt,at=kt??at,ct={...ct,[zt]:{...ct[zt],...St}},Lt&&mt<=50&&(mt++,typeof Lt=="object"&&(Lt.placement&&(it=Lt.placement),Lt.rects&&(_e=Lt.rects===!0?await _.getElementRects({reference:e,floating:s,strategy:d}):Lt.rects),{x:lt,y:at}=computeCoordsFromPlacement(_e,it,$)),pt=-1)}return{x:lt,y:at,placement:it,strategy:d,middlewareData:ct}};async function detectOverflow(e,s){var i;s===void 0&&(s={});const{x:c,y:d,platform:h,rects:_,elements:g,strategy:$}=e,{boundary:_e="clippingAncestors",rootBoundary:lt="viewport",elementContext:at="floating",altBoundary:it=!1,padding:ct=0}=evaluate(s,e),mt=getPaddingObject(ct),zt=g[it?at==="floating"?"reference":"floating":at],dt=rectToClientRect(await h.getClippingRect({element:(i=await(h.isElement==null?void 0:h.isElement(zt)))==null||i?zt:zt.contextElement||await(h.getDocumentElement==null?void 0:h.getDocumentElement(g.floating)),boundary:_e,rootBoundary:lt,strategy:$})),ft=at==="floating"?{x:c,y:d,width:_.floating.width,height:_.floating.height}:_.reference,kt=await(h.getOffsetParent==null?void 0:h.getOffsetParent(g.floating)),St=await(h.isElement==null?void 0:h.isElement(kt))?await(h.getScale==null?void 0:h.getScale(kt))||{x:1,y:1}:{x:1,y:1},Lt=rectToClientRect(h.convertOffsetParentRelativeRectToViewportRelativeRect?await h.convertOffsetParentRelativeRectToViewportRelativeRect({elements:g,rect:ft,offsetParent:kt,strategy:$}):ft);return{top:(dt.top-Lt.top+mt.top)/St.y,bottom:(Lt.bottom-dt.bottom+mt.bottom)/St.y,left:(dt.left-Lt.left+mt.left)/St.x,right:(Lt.right-dt.right+mt.right)/St.x}}const arrow$3=e=>({name:"arrow",options:e,async fn(s){const{x:i,y:c,placement:d,rects:h,platform:_,elements:g,middlewareData:$}=s,{element:_e,padding:lt=0}=evaluate(e,s)||{};if(_e==null)return{};const at=getPaddingObject(lt),it={x:i,y:c},ct=getAlignmentAxis(d),mt=getAxisLength(ct),pt=await _.getDimensions(_e),zt=ct==="y",dt=zt?"top":"left",ft=zt?"bottom":"right",kt=zt?"clientHeight":"clientWidth",St=h.reference[mt]+h.reference[ct]-it[ct]-h.floating[mt],Lt=it[ct]-h.reference[ct],Gt=await(_.getOffsetParent==null?void 0:_.getOffsetParent(_e));let Bt=Gt?Gt[kt]:0;(!Bt||!await(_.isElement==null?void 0:_.isElement(Gt)))&&(Bt=g.floating[kt]||h.floating[mt]);const nr=St/2-Lt/2,cr=Bt/2-pt[mt]/2-1,ur=min(at[dt],cr),yn=min(at[ft],cr),hn=ur,_n=Bt-pt[mt]-yn,gn=Bt/2-pt[mt]/2+nr,vn=clamp$1(hn,gn,_n),Tn=!$.arrow&&getAlignment(d)!=null&&gn!==vn&&h.reference[mt]/2-(gn<hn?ur:yn)-pt[mt]/2<0,kn=Tn?gn<hn?gn-hn:gn-_n:0;return{[ct]:it[ct]+kn,data:{[ct]:vn,centerOffset:gn-vn-kn,...Tn&&{alignmentOffset:kn}},reset:Tn}}}),flip$2=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(s){var i,c;const{placement:d,middlewareData:h,rects:_,initialPlacement:g,platform:$,elements:_e}=s,{mainAxis:lt=!0,crossAxis:at=!0,fallbackPlacements:it,fallbackStrategy:ct="bestFit",fallbackAxisSideDirection:mt="none",flipAlignment:pt=!0,...zt}=evaluate(e,s);if((i=h.arrow)!=null&&i.alignmentOffset)return{};const dt=getSide(d),ft=getSideAxis(g),kt=getSide(g)===g,St=await($.isRTL==null?void 0:$.isRTL(_e.floating)),Lt=it||(kt||!pt?[getOppositePlacement(g)]:getExpandedPlacements(g)),Gt=mt!=="none";!it&&Gt&&Lt.push(...getOppositeAxisPlacements(g,pt,mt,St));const Bt=[g,...Lt],nr=await detectOverflow(s,zt),cr=[];let ur=((c=h.flip)==null?void 0:c.overflows)||[];if(lt&&cr.push(nr[dt]),at){const gn=getAlignmentSides(d,_,St);cr.push(nr[gn[0]],nr[gn[1]])}if(ur=[...ur,{placement:d,overflows:cr}],!cr.every(gn=>gn<=0)){var yn,hn;const gn=(((yn=h.flip)==null?void 0:yn.index)||0)+1,vn=Bt[gn];if(vn&&(!(at==="alignment"?ft!==getSideAxis(vn):!1)||ur.every(bn=>bn.overflows[0]>0&&getSideAxis(bn.placement)===ft)))return{data:{index:gn,overflows:ur},reset:{placement:vn}};let Tn=(hn=ur.filter(kn=>kn.overflows[0]<=0).sort((kn,bn)=>kn.overflows[1]-bn.overflows[1])[0])==null?void 0:hn.placement;if(!Tn)switch(ct){case"bestFit":{var _n;const kn=(_n=ur.filter(bn=>{if(Gt){const Sn=getSideAxis(bn.placement);return Sn===ft||Sn==="y"}return!0}).map(bn=>[bn.placement,bn.overflows.filter(Sn=>Sn>0).reduce((Sn,fn)=>Sn+fn,0)]).sort((bn,Sn)=>bn[1]-Sn[1])[0])==null?void 0:_n[0];kn&&(Tn=kn);break}case"initialPlacement":Tn=g;break}if(d!==Tn)return{reset:{placement:Tn}}}return{}}}};function getSideOffsets(e,s){return{top:e.top-s.height,right:e.right-s.width,bottom:e.bottom-s.height,left:e.left-s.width}}function isAnySideFullyClipped(e){return sides.some(s=>e[s]>=0)}const hide$2=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(s){const{rects:i}=s,{strategy:c="referenceHidden",...d}=evaluate(e,s);switch(c){case"referenceHidden":{const h=await detectOverflow(s,{...d,elementContext:"reference"}),_=getSideOffsets(h,i.reference);return{data:{referenceHiddenOffsets:_,referenceHidden:isAnySideFullyClipped(_)}}}case"escaped":{const h=await detectOverflow(s,{...d,altBoundary:!0}),_=getSideOffsets(h,i.floating);return{data:{escapedOffsets:_,escaped:isAnySideFullyClipped(_)}}}default:return{}}}}},originSides=new Set(["left","top"]);async function convertValueToCoords(e,s){const{placement:i,platform:c,elements:d}=e,h=await(c.isRTL==null?void 0:c.isRTL(d.floating)),_=getSide(i),g=getAlignment(i),$=getSideAxis(i)==="y",_e=originSides.has(_)?-1:1,lt=h&&$?-1:1,at=evaluate(s,e);let{mainAxis:it,crossAxis:ct,alignmentAxis:mt}=typeof at=="number"?{mainAxis:at,crossAxis:0,alignmentAxis:null}:{mainAxis:at.mainAxis||0,crossAxis:at.crossAxis||0,alignmentAxis:at.alignmentAxis};return g&&typeof mt=="number"&&(ct=g==="end"?mt*-1:mt),$?{x:ct*lt,y:it*_e}:{x:it*_e,y:ct*lt}}const offset$2=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(s){var i,c;const{x:d,y:h,placement:_,middlewareData:g}=s,$=await convertValueToCoords(s,e);return _===((i=g.offset)==null?void 0:i.placement)&&(c=g.arrow)!=null&&c.alignmentOffset?{}:{x:d+$.x,y:h+$.y,data:{...$,placement:_}}}}},shift$2=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(s){const{x:i,y:c,placement:d}=s,{mainAxis:h=!0,crossAxis:_=!1,limiter:g={fn:zt=>{let{x:dt,y:ft}=zt;return{x:dt,y:ft}}},...$}=evaluate(e,s),_e={x:i,y:c},lt=await detectOverflow(s,$),at=getSideAxis(getSide(d)),it=getOppositeAxis(at);let ct=_e[it],mt=_e[at];if(h){const zt=it==="y"?"top":"left",dt=it==="y"?"bottom":"right",ft=ct+lt[zt],kt=ct-lt[dt];ct=clamp$1(ft,ct,kt)}if(_){const zt=at==="y"?"top":"left",dt=at==="y"?"bottom":"right",ft=mt+lt[zt],kt=mt-lt[dt];mt=clamp$1(ft,mt,kt)}const pt=g.fn({...s,[it]:ct,[at]:mt});return{...pt,data:{x:pt.x-i,y:pt.y-c,enabled:{[it]:h,[at]:_}}}}}},limitShift$2=function(e){return e===void 0&&(e={}),{options:e,fn(s){const{x:i,y:c,placement:d,rects:h,middlewareData:_}=s,{offset:g=0,mainAxis:$=!0,crossAxis:_e=!0}=evaluate(e,s),lt={x:i,y:c},at=getSideAxis(d),it=getOppositeAxis(at);let ct=lt[it],mt=lt[at];const pt=evaluate(g,s),zt=typeof pt=="number"?{mainAxis:pt,crossAxis:0}:{mainAxis:0,crossAxis:0,...pt};if($){const kt=it==="y"?"height":"width",St=h.reference[it]-h.floating[kt]+zt.mainAxis,Lt=h.reference[it]+h.reference[kt]-zt.mainAxis;ct<St?ct=St:ct>Lt&&(ct=Lt)}if(_e){var dt,ft;const kt=it==="y"?"width":"height",St=originSides.has(getSide(d)),Lt=h.reference[at]-h.floating[kt]+(St&&((dt=_.offset)==null?void 0:dt[at])||0)+(St?0:zt.crossAxis),Gt=h.reference[at]+h.reference[kt]+(St?0:((ft=_.offset)==null?void 0:ft[at])||0)-(St?zt.crossAxis:0);mt<Lt?mt=Lt:mt>Gt&&(mt=Gt)}return{[it]:ct,[at]:mt}}}},size$2=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(s){var i,c;const{placement:d,rects:h,platform:_,elements:g}=s,{apply:$=()=>{},..._e}=evaluate(e,s),lt=await detectOverflow(s,_e),at=getSide(d),it=getAlignment(d),ct=getSideAxis(d)==="y",{width:mt,height:pt}=h.floating;let zt,dt;at==="top"||at==="bottom"?(zt=at,dt=it===(await(_.isRTL==null?void 0:_.isRTL(g.floating))?"start":"end")?"left":"right"):(dt=at,zt=it==="end"?"top":"bottom");const ft=pt-lt.top-lt.bottom,kt=mt-lt.left-lt.right,St=min(pt-lt[zt],ft),Lt=min(mt-lt[dt],kt),Gt=!s.middlewareData.shift;let Bt=St,nr=Lt;if((i=s.middlewareData.shift)!=null&&i.enabled.x&&(nr=kt),(c=s.middlewareData.shift)!=null&&c.enabled.y&&(Bt=ft),Gt&&!it){const ur=max(lt.left,0),yn=max(lt.right,0),hn=max(lt.top,0),_n=max(lt.bottom,0);ct?nr=mt-2*(ur!==0||yn!==0?ur+yn:max(lt.left,lt.right)):Bt=pt-2*(hn!==0||_n!==0?hn+_n:max(lt.top,lt.bottom))}await $({...s,availableWidth:nr,availableHeight:Bt});const cr=await _.getDimensions(g.floating);return mt!==cr.width||pt!==cr.height?{reset:{rects:!0}}:{}}}};function hasWindow(){return typeof window<"u"}function getNodeName(e){return isNode(e)?(e.nodeName||"").toLowerCase():"#document"}function getWindow(e){var s;return(e==null||(s=e.ownerDocument)==null?void 0:s.defaultView)||window}function getDocumentElement(e){var s;return(s=(isNode(e)?e.ownerDocument:e.document)||window.document)==null?void 0:s.documentElement}function isNode(e){return hasWindow()?e instanceof Node||e instanceof getWindow(e).Node:!1}function isElement(e){return hasWindow()?e instanceof Element||e instanceof getWindow(e).Element:!1}function isHTMLElement(e){return hasWindow()?e instanceof HTMLElement||e instanceof getWindow(e).HTMLElement:!1}function isShadowRoot(e){return!hasWindow()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof getWindow(e).ShadowRoot}const invalidOverflowDisplayValues=new Set(["inline","contents"]);function isOverflowElement(e){const{overflow:s,overflowX:i,overflowY:c,display:d}=getComputedStyle$1(e);return/auto|scroll|overlay|hidden|clip/.test(s+c+i)&&!invalidOverflowDisplayValues.has(d)}const tableElements=new Set(["table","td","th"]);function isTableElement(e){return tableElements.has(getNodeName(e))}const topLayerSelectors=[":popover-open",":modal"];function isTopLayer(e){return topLayerSelectors.some(s=>{try{return e.matches(s)}catch{return!1}})}const transformProperties=["transform","translate","scale","rotate","perspective"],willChangeValues=["transform","translate","scale","rotate","perspective","filter"],containValues=["paint","layout","strict","content"];function isContainingBlock(e){const s=isWebKit(),i=isElement(e)?getComputedStyle$1(e):e;return transformProperties.some(c=>i[c]?i[c]!=="none":!1)||(i.containerType?i.containerType!=="normal":!1)||!s&&(i.backdropFilter?i.backdropFilter!=="none":!1)||!s&&(i.filter?i.filter!=="none":!1)||willChangeValues.some(c=>(i.willChange||"").includes(c))||containValues.some(c=>(i.contain||"").includes(c))}function getContainingBlock(e){let s=getParentNode(e);for(;isHTMLElement(s)&&!isLastTraversableNode(s);){if(isContainingBlock(s))return s;if(isTopLayer(s))return null;s=getParentNode(s)}return null}function isWebKit(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const lastTraversableNodeNames=new Set(["html","body","#document"]);function isLastTraversableNode(e){return lastTraversableNodeNames.has(getNodeName(e))}function getComputedStyle$1(e){return getWindow(e).getComputedStyle(e)}function getNodeScroll(e){return isElement(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function getParentNode(e){if(getNodeName(e)==="html")return e;const s=e.assignedSlot||e.parentNode||isShadowRoot(e)&&e.host||getDocumentElement(e);return isShadowRoot(s)?s.host:s}function getNearestOverflowAncestor(e){const s=getParentNode(e);return isLastTraversableNode(s)?e.ownerDocument?e.ownerDocument.body:e.body:isHTMLElement(s)&&isOverflowElement(s)?s:getNearestOverflowAncestor(s)}function getOverflowAncestors(e,s,i){var c;s===void 0&&(s=[]),i===void 0&&(i=!0);const d=getNearestOverflowAncestor(e),h=d===((c=e.ownerDocument)==null?void 0:c.body),_=getWindow(d);if(h){const g=getFrameElement(_);return s.concat(_,_.visualViewport||[],isOverflowElement(d)?d:[],g&&i?getOverflowAncestors(g):[])}return s.concat(d,getOverflowAncestors(d,[],i))}function getFrameElement(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function getCssDimensions(e){const s=getComputedStyle$1(e);let i=parseFloat(s.width)||0,c=parseFloat(s.height)||0;const d=isHTMLElement(e),h=d?e.offsetWidth:i,_=d?e.offsetHeight:c,g=round(i)!==h||round(c)!==_;return g&&(i=h,c=_),{width:i,height:c,$:g}}function unwrapElement(e){return isElement(e)?e:e.contextElement}function getScale(e){const s=unwrapElement(e);if(!isHTMLElement(s))return createCoords(1);const i=s.getBoundingClientRect(),{width:c,height:d,$:h}=getCssDimensions(s);let _=(h?round(i.width):i.width)/c,g=(h?round(i.height):i.height)/d;return(!_||!Number.isFinite(_))&&(_=1),(!g||!Number.isFinite(g))&&(g=1),{x:_,y:g}}const noOffsets=createCoords(0);function getVisualOffsets(e){const s=getWindow(e);return!isWebKit()||!s.visualViewport?noOffsets:{x:s.visualViewport.offsetLeft,y:s.visualViewport.offsetTop}}function shouldAddVisualOffsets(e,s,i){return s===void 0&&(s=!1),!i||s&&i!==getWindow(e)?!1:s}function getBoundingClientRect(e,s,i,c){s===void 0&&(s=!1),i===void 0&&(i=!1);const d=e.getBoundingClientRect(),h=unwrapElement(e);let _=createCoords(1);s&&(c?isElement(c)&&(_=getScale(c)):_=getScale(e));const g=shouldAddVisualOffsets(h,i,c)?getVisualOffsets(h):createCoords(0);let $=(d.left+g.x)/_.x,_e=(d.top+g.y)/_.y,lt=d.width/_.x,at=d.height/_.y;if(h){const it=getWindow(h),ct=c&&isElement(c)?getWindow(c):c;let mt=it,pt=getFrameElement(mt);for(;pt&&c&&ct!==mt;){const zt=getScale(pt),dt=pt.getBoundingClientRect(),ft=getComputedStyle$1(pt),kt=dt.left+(pt.clientLeft+parseFloat(ft.paddingLeft))*zt.x,St=dt.top+(pt.clientTop+parseFloat(ft.paddingTop))*zt.y;$*=zt.x,_e*=zt.y,lt*=zt.x,at*=zt.y,$+=kt,_e+=St,mt=getWindow(pt),pt=getFrameElement(mt)}}return rectToClientRect({width:lt,height:at,x:$,y:_e})}function getWindowScrollBarX(e,s){const i=getNodeScroll(e).scrollLeft;return s?s.left+i:getBoundingClientRect(getDocumentElement(e)).left+i}function getHTMLOffset(e,s,i){i===void 0&&(i=!1);const c=e.getBoundingClientRect(),d=c.left+s.scrollLeft-(i?0:getWindowScrollBarX(e,c)),h=c.top+s.scrollTop;return{x:d,y:h}}function convertOffsetParentRelativeRectToViewportRelativeRect(e){let{elements:s,rect:i,offsetParent:c,strategy:d}=e;const h=d==="fixed",_=getDocumentElement(c),g=s?isTopLayer(s.floating):!1;if(c===_||g&&h)return i;let $={scrollLeft:0,scrollTop:0},_e=createCoords(1);const lt=createCoords(0),at=isHTMLElement(c);if((at||!at&&!h)&&((getNodeName(c)!=="body"||isOverflowElement(_))&&($=getNodeScroll(c)),isHTMLElement(c))){const ct=getBoundingClientRect(c);_e=getScale(c),lt.x=ct.x+c.clientLeft,lt.y=ct.y+c.clientTop}const it=_&&!at&&!h?getHTMLOffset(_,$,!0):createCoords(0);return{width:i.width*_e.x,height:i.height*_e.y,x:i.x*_e.x-$.scrollLeft*_e.x+lt.x+it.x,y:i.y*_e.y-$.scrollTop*_e.y+lt.y+it.y}}function getClientRects(e){return Array.from(e.getClientRects())}function getDocumentRect(e){const s=getDocumentElement(e),i=getNodeScroll(e),c=e.ownerDocument.body,d=max(s.scrollWidth,s.clientWidth,c.scrollWidth,c.clientWidth),h=max(s.scrollHeight,s.clientHeight,c.scrollHeight,c.clientHeight);let _=-i.scrollLeft+getWindowScrollBarX(e);const g=-i.scrollTop;return getComputedStyle$1(c).direction==="rtl"&&(_+=max(s.clientWidth,c.clientWidth)-d),{width:d,height:h,x:_,y:g}}function getViewportRect(e,s){const i=getWindow(e),c=getDocumentElement(e),d=i.visualViewport;let h=c.clientWidth,_=c.clientHeight,g=0,$=0;if(d){h=d.width,_=d.height;const _e=isWebKit();(!_e||_e&&s==="fixed")&&(g=d.offsetLeft,$=d.offsetTop)}return{width:h,height:_,x:g,y:$}}const absoluteOrFixed=new Set(["absolute","fixed"]);function getInnerBoundingClientRect(e,s){const i=getBoundingClientRect(e,!0,s==="fixed"),c=i.top+e.clientTop,d=i.left+e.clientLeft,h=isHTMLElement(e)?getScale(e):createCoords(1),_=e.clientWidth*h.x,g=e.clientHeight*h.y,$=d*h.x,_e=c*h.y;return{width:_,height:g,x:$,y:_e}}function getClientRectFromClippingAncestor(e,s,i){let c;if(s==="viewport")c=getViewportRect(e,i);else if(s==="document")c=getDocumentRect(getDocumentElement(e));else if(isElement(s))c=getInnerBoundingClientRect(s,i);else{const d=getVisualOffsets(e);c={x:s.x-d.x,y:s.y-d.y,width:s.width,height:s.height}}return rectToClientRect(c)}function hasFixedPositionAncestor(e,s){const i=getParentNode(e);return i===s||!isElement(i)||isLastTraversableNode(i)?!1:getComputedStyle$1(i).position==="fixed"||hasFixedPositionAncestor(i,s)}function getClippingElementAncestors(e,s){const i=s.get(e);if(i)return i;let c=getOverflowAncestors(e,[],!1).filter(g=>isElement(g)&&getNodeName(g)!=="body"),d=null;const h=getComputedStyle$1(e).position==="fixed";let _=h?getParentNode(e):e;for(;isElement(_)&&!isLastTraversableNode(_);){const g=getComputedStyle$1(_),$=isContainingBlock(_);!$&&g.position==="fixed"&&(d=null),(h?!$&&!d:!$&&g.position==="static"&&!!d&&absoluteOrFixed.has(d.position)||isOverflowElement(_)&&!$&&hasFixedPositionAncestor(e,_))?c=c.filter(lt=>lt!==_):d=g,_=getParentNode(_)}return s.set(e,c),c}function getClippingRect(e){let{element:s,boundary:i,rootBoundary:c,strategy:d}=e;const _=[...i==="clippingAncestors"?isTopLayer(s)?[]:getClippingElementAncestors(s,this._c):[].concat(i),c],g=_[0],$=_.reduce((_e,lt)=>{const at=getClientRectFromClippingAncestor(s,lt,d);return _e.top=max(at.top,_e.top),_e.right=min(at.right,_e.right),_e.bottom=min(at.bottom,_e.bottom),_e.left=max(at.left,_e.left),_e},getClientRectFromClippingAncestor(s,g,d));return{width:$.right-$.left,height:$.bottom-$.top,x:$.left,y:$.top}}function getDimensions(e){const{width:s,height:i}=getCssDimensions(e);return{width:s,height:i}}function getRectRelativeToOffsetParent(e,s,i){const c=isHTMLElement(s),d=getDocumentElement(s),h=i==="fixed",_=getBoundingClientRect(e,!0,h,s);let g={scrollLeft:0,scrollTop:0};const $=createCoords(0);function _e(){$.x=getWindowScrollBarX(d)}if(c||!c&&!h)if((getNodeName(s)!=="body"||isOverflowElement(d))&&(g=getNodeScroll(s)),c){const ct=getBoundingClientRect(s,!0,h,s);$.x=ct.x+s.clientLeft,$.y=ct.y+s.clientTop}else d&&_e();h&&!c&&d&&_e();const lt=d&&!c&&!h?getHTMLOffset(d,g):createCoords(0),at=_.left+g.scrollLeft-$.x-lt.x,it=_.top+g.scrollTop-$.y-lt.y;return{x:at,y:it,width:_.width,height:_.height}}function isStaticPositioned(e){return getComputedStyle$1(e).position==="static"}function getTrueOffsetParent(e,s){if(!isHTMLElement(e)||getComputedStyle$1(e).position==="fixed")return null;if(s)return s(e);let i=e.offsetParent;return getDocumentElement(e)===i&&(i=i.ownerDocument.body),i}function getOffsetParent(e,s){const i=getWindow(e);if(isTopLayer(e))return i;if(!isHTMLElement(e)){let d=getParentNode(e);for(;d&&!isLastTraversableNode(d);){if(isElement(d)&&!isStaticPositioned(d))return d;d=getParentNode(d)}return i}let c=getTrueOffsetParent(e,s);for(;c&&isTableElement(c)&&isStaticPositioned(c);)c=getTrueOffsetParent(c,s);return c&&isLastTraversableNode(c)&&isStaticPositioned(c)&&!isContainingBlock(c)?i:c||getContainingBlock(e)||i}const getElementRects=async function(e){const s=this.getOffsetParent||getOffsetParent,i=this.getDimensions,c=await i(e.floating);return{reference:getRectRelativeToOffsetParent(e.reference,await s(e.floating),e.strategy),floating:{x:0,y:0,width:c.width,height:c.height}}};function isRTL(e){return getComputedStyle$1(e).direction==="rtl"}const platform={convertOffsetParentRelativeRectToViewportRelativeRect,getDocumentElement,getClippingRect,getOffsetParent,getElementRects,getClientRects,getDimensions,getScale,isElement,isRTL};function rectsAreEqual(e,s){return e.x===s.x&&e.y===s.y&&e.width===s.width&&e.height===s.height}function observeMove(e,s){let i=null,c;const d=getDocumentElement(e);function h(){var g;clearTimeout(c),(g=i)==null||g.disconnect(),i=null}function _(g,$){g===void 0&&(g=!1),$===void 0&&($=1),h();const _e=e.getBoundingClientRect(),{left:lt,top:at,width:it,height:ct}=_e;if(g||s(),!it||!ct)return;const mt=floor(at),pt=floor(d.clientWidth-(lt+it)),zt=floor(d.clientHeight-(at+ct)),dt=floor(lt),kt={rootMargin:-mt+"px "+-pt+"px "+-zt+"px "+-dt+"px",threshold:max(0,min(1,$))||1};let St=!0;function Lt(Gt){const Bt=Gt[0].intersectionRatio;if(Bt!==$){if(!St)return _();Bt?_(!1,Bt):c=setTimeout(()=>{_(!1,1e-7)},1e3)}Bt===1&&!rectsAreEqual(_e,e.getBoundingClientRect())&&_(),St=!1}try{i=new IntersectionObserver(Lt,{...kt,root:d.ownerDocument})}catch{i=new IntersectionObserver(Lt,kt)}i.observe(e)}return _(!0),h}function autoUpdate(e,s,i,c){c===void 0&&(c={});const{ancestorScroll:d=!0,ancestorResize:h=!0,elementResize:_=typeof ResizeObserver=="function",layoutShift:g=typeof IntersectionObserver=="function",animationFrame:$=!1}=c,_e=unwrapElement(e),lt=d||h?[..._e?getOverflowAncestors(_e):[],...getOverflowAncestors(s)]:[];lt.forEach(dt=>{d&&dt.addEventListener("scroll",i,{passive:!0}),h&&dt.addEventListener("resize",i)});const at=_e&&g?observeMove(_e,i):null;let it=-1,ct=null;_&&(ct=new ResizeObserver(dt=>{let[ft]=dt;ft&&ft.target===_e&&ct&&(ct.unobserve(s),cancelAnimationFrame(it),it=requestAnimationFrame(()=>{var kt;(kt=ct)==null||kt.observe(s)})),i()}),_e&&!$&&ct.observe(_e),ct.observe(s));let mt,pt=$?getBoundingClientRect(e):null;$&&zt();function zt(){const dt=getBoundingClientRect(e);pt&&!rectsAreEqual(pt,dt)&&i(),pt=dt,mt=requestAnimationFrame(zt)}return i(),()=>{var dt;lt.forEach(ft=>{d&&ft.removeEventListener("scroll",i),h&&ft.removeEventListener("resize",i)}),at==null||at(),(dt=ct)==null||dt.disconnect(),ct=null,$&&cancelAnimationFrame(mt)}}const offset$1=offset$2,shift$1=shift$2,flip$1=flip$2,size$1=size$2,hide$1=hide$2,arrow$2=arrow$3,limitShift$1=limitShift$2,computePosition=(e,s,i)=>{const c=new Map,d={platform,...i},h={...d.platform,_c:c};return computePosition$1(e,s,{...d,platform:h})};var isClient=typeof document<"u",noop$1=function(){},index=isClient?reactExports.useLayoutEffect:noop$1;function deepEqual(e,s){if(e===s)return!0;if(typeof e!=typeof s)return!1;if(typeof e=="function"&&e.toString()===s.toString())return!0;let i,c,d;if(e&&s&&typeof e=="object"){if(Array.isArray(e)){if(i=e.length,i!==s.length)return!1;for(c=i;c--!==0;)if(!deepEqual(e[c],s[c]))return!1;return!0}if(d=Object.keys(e),i=d.length,i!==Object.keys(s).length)return!1;for(c=i;c--!==0;)if(!{}.hasOwnProperty.call(s,d[c]))return!1;for(c=i;c--!==0;){const h=d[c];if(!(h==="_owner"&&e.$$typeof)&&!deepEqual(e[h],s[h]))return!1}return!0}return e!==e&&s!==s}function getDPR(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function roundByDPR(e,s){const i=getDPR(e);return Math.round(s*i)/i}function useLatestRef(e){const s=reactExports.useRef(e);return index(()=>{s.current=e}),s}function useFloating(e){e===void 0&&(e={});const{placement:s="bottom",strategy:i="absolute",middleware:c=[],platform:d,elements:{reference:h,floating:_}={},transform:g=!0,whileElementsMounted:$,open:_e}=e,[lt,at]=reactExports.useState({x:0,y:0,strategy:i,placement:s,middlewareData:{},isPositioned:!1}),[it,ct]=reactExports.useState(c);deepEqual(it,c)||ct(c);const[mt,pt]=reactExports.useState(null),[zt,dt]=reactExports.useState(null),ft=reactExports.useCallback(bn=>{bn!==Gt.current&&(Gt.current=bn,pt(bn))},[]),kt=reactExports.useCallback(bn=>{bn!==Bt.current&&(Bt.current=bn,dt(bn))},[]),St=h||mt,Lt=_||zt,Gt=reactExports.useRef(null),Bt=reactExports.useRef(null),nr=reactExports.useRef(lt),cr=$!=null,ur=useLatestRef($),yn=useLatestRef(d),hn=useLatestRef(_e),_n=reactExports.useCallback(()=>{if(!Gt.current||!Bt.current)return;const bn={placement:s,strategy:i,middleware:it};yn.current&&(bn.platform=yn.current),computePosition(Gt.current,Bt.current,bn).then(Sn=>{const fn={...Sn,isPositioned:hn.current!==!1};gn.current&&!deepEqual(nr.current,fn)&&(nr.current=fn,reactDomExports.flushSync(()=>{at(fn)}))})},[it,s,i,yn,hn]);index(()=>{_e===!1&&nr.current.isPositioned&&(nr.current.isPositioned=!1,at(bn=>({...bn,isPositioned:!1})))},[_e]);const gn=reactExports.useRef(!1);index(()=>(gn.current=!0,()=>{gn.current=!1}),[]),index(()=>{if(St&&(Gt.current=St),Lt&&(Bt.current=Lt),St&&Lt){if(ur.current)return ur.current(St,Lt,_n);_n()}},[St,Lt,_n,ur,cr]);const vn=reactExports.useMemo(()=>({reference:Gt,floating:Bt,setReference:ft,setFloating:kt}),[ft,kt]),Tn=reactExports.useMemo(()=>({reference:St,floating:Lt}),[St,Lt]),kn=reactExports.useMemo(()=>{const bn={position:i,left:0,top:0};if(!Tn.floating)return bn;const Sn=roundByDPR(Tn.floating,lt.x),fn=roundByDPR(Tn.floating,lt.y);return g?{...bn,transform:"translate("+Sn+"px, "+fn+"px)",...getDPR(Tn.floating)>=1.5&&{willChange:"transform"}}:{position:i,left:Sn,top:fn}},[i,g,Tn.floating,lt.x,lt.y]);return reactExports.useMemo(()=>({...lt,update:_n,refs:vn,elements:Tn,floatingStyles:kn}),[lt,_n,vn,Tn,kn])}const arrow$1=e=>{function s(i){return{}.hasOwnProperty.call(i,"current")}return{name:"arrow",options:e,fn(i){const{element:c,padding:d}=typeof e=="function"?e(i):e;return c&&s(c)?c.current!=null?arrow$2({element:c.current,padding:d}).fn(i):{}:c?arrow$2({element:c,padding:d}).fn(i):{}}}},offset=(e,s)=>({...offset$1(e),options:[e,s]}),shift=(e,s)=>({...shift$1(e),options:[e,s]}),limitShift=(e,s)=>({...limitShift$1(e),options:[e,s]}),flip=(e,s)=>({...flip$1(e),options:[e,s]}),size=(e,s)=>({...size$1(e),options:[e,s]}),hide=(e,s)=>({...hide$1(e),options:[e,s]}),arrow=(e,s)=>({...arrow$1(e),options:[e,s]});var NAME="Arrow",Arrow$1=reactExports.forwardRef((e,s)=>{const{children:i,width:c=10,height:d=5,...h}=e;return jsxRuntimeExports.jsx(Primitive.svg,{...h,ref:s,width:c,height:d,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?i:jsxRuntimeExports.jsx("polygon",{points:"0,0 30,0 15,10"})})});Arrow$1.displayName=NAME;var Root$1=Arrow$1;function useSize(e){const[s,i]=reactExports.useState(void 0);return useLayoutEffect2(()=>{if(e){i({width:e.offsetWidth,height:e.offsetHeight});const c=new ResizeObserver(d=>{if(!Array.isArray(d)||!d.length)return;const h=d[0];let _,g;if("borderBoxSize"in h){const $=h.borderBoxSize,_e=Array.isArray($)?$[0]:$;_=_e.inlineSize,g=_e.blockSize}else _=e.offsetWidth,g=e.offsetHeight;i({width:_,height:g})});return c.observe(e,{box:"border-box"}),()=>c.unobserve(e)}else i(void 0)},[e]),s}var POPPER_NAME="Popper",[createPopperContext,createPopperScope]=createContextScope(POPPER_NAME),[PopperProvider,usePopperContext]=createPopperContext(POPPER_NAME),Popper=e=>{const{__scopePopper:s,children:i}=e,[c,d]=reactExports.useState(null);return jsxRuntimeExports.jsx(PopperProvider,{scope:s,anchor:c,onAnchorChange:d,children:i})};Popper.displayName=POPPER_NAME;var ANCHOR_NAME="PopperAnchor",PopperAnchor=reactExports.forwardRef((e,s)=>{const{__scopePopper:i,virtualRef:c,...d}=e,h=usePopperContext(ANCHOR_NAME,i),_=reactExports.useRef(null),g=useComposedRefs(s,_);return reactExports.useEffect(()=>{h.onAnchorChange((c==null?void 0:c.current)||_.current)}),c?null:jsxRuntimeExports.jsx(Primitive.div,{...d,ref:g})});PopperAnchor.displayName=ANCHOR_NAME;var CONTENT_NAME$2="PopperContent",[PopperContentProvider,useContentContext]=createPopperContext(CONTENT_NAME$2),PopperContent=reactExports.forwardRef((e,s)=>{var Ro,qo,tp,Wo,En,mr;const{__scopePopper:i,side:c="bottom",sideOffset:d=0,align:h="center",alignOffset:_=0,arrowPadding:g=0,avoidCollisions:$=!0,collisionBoundary:_e=[],collisionPadding:lt=0,sticky:at="partial",hideWhenDetached:it=!1,updatePositionStrategy:ct="optimized",onPlaced:mt,...pt}=e,zt=usePopperContext(CONTENT_NAME$2,i),[dt,ft]=reactExports.useState(null),kt=useComposedRefs(s,Do=>ft(Do)),[St,Lt]=reactExports.useState(null),Gt=useSize(St),Bt=(Gt==null?void 0:Gt.width)??0,nr=(Gt==null?void 0:Gt.height)??0,cr=c+(h!=="center"?"-"+h:""),ur=typeof lt=="number"?lt:{top:0,right:0,bottom:0,left:0,...lt},yn=Array.isArray(_e)?_e:[_e],hn=yn.length>0,_n={padding:ur,boundary:yn.filter(isNotNull),altBoundary:hn},{refs:gn,floatingStyles:vn,placement:Tn,isPositioned:kn,middlewareData:bn}=useFloating({strategy:"fixed",placement:cr,whileElementsMounted:(...Do)=>autoUpdate(...Do,{animationFrame:ct==="always"}),elements:{reference:zt.anchor},middleware:[offset({mainAxis:d+nr,alignmentAxis:_}),$&&shift({mainAxis:!0,crossAxis:!1,limiter:at==="partial"?limitShift():void 0,..._n}),$&&flip({..._n}),size({..._n,apply:({elements:Do,rects:Go,availableWidth:Jo,availableHeight:_i})=>{const{width:Ho,height:_c}=Go.reference,Qo=Do.floating.style;Qo.setProperty("--radix-popper-available-width",`${Jo}px`),Qo.setProperty("--radix-popper-available-height",`${_i}px`),Qo.setProperty("--radix-popper-anchor-width",`${Ho}px`),Qo.setProperty("--radix-popper-anchor-height",`${_c}px`)}}),St&&arrow({element:St,padding:g}),transformOrigin({arrowWidth:Bt,arrowHeight:nr}),it&&hide({strategy:"referenceHidden",..._n})]}),[Sn,fn]=getSideAndAlignFromPlacement(Tn),or=useCallbackRef$1(mt);useLayoutEffect2(()=>{kn&&(or==null||or())},[kn,or]);const lr=(Ro=bn.arrow)==null?void 0:Ro.x,pn=(qo=bn.arrow)==null?void 0:qo.y,Cn=((tp=bn.arrow)==null?void 0:tp.centerOffset)!==0,[Lo,Mo]=reactExports.useState();return useLayoutEffect2(()=>{dt&&Mo(window.getComputedStyle(dt).zIndex)},[dt]),jsxRuntimeExports.jsx("div",{ref:gn.setFloating,"data-radix-popper-content-wrapper":"",style:{...vn,transform:kn?vn.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Lo,"--radix-popper-transform-origin":[(Wo=bn.transformOrigin)==null?void 0:Wo.x,(En=bn.transformOrigin)==null?void 0:En.y].join(" "),...((mr=bn.hide)==null?void 0:mr.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:jsxRuntimeExports.jsx(PopperContentProvider,{scope:i,placedSide:Sn,onArrowChange:Lt,arrowX:lr,arrowY:pn,shouldHideArrow:Cn,children:jsxRuntimeExports.jsx(Primitive.div,{"data-side":Sn,"data-align":fn,...pt,ref:kt,style:{...pt.style,animation:kn?void 0:"none"}})})})});PopperContent.displayName=CONTENT_NAME$2;var ARROW_NAME$2="PopperArrow",OPPOSITE_SIDE={top:"bottom",right:"left",bottom:"top",left:"right"},PopperArrow=reactExports.forwardRef(function(s,i){const{__scopePopper:c,...d}=s,h=useContentContext(ARROW_NAME$2,c),_=OPPOSITE_SIDE[h.placedSide];return jsxRuntimeExports.jsx("span",{ref:h.onArrowChange,style:{position:"absolute",left:h.arrowX,top:h.arrowY,[_]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[h.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[h.placedSide],visibility:h.shouldHideArrow?"hidden":void 0},children:jsxRuntimeExports.jsx(Root$1,{...d,ref:i,style:{...d.style,display:"block"}})})});PopperArrow.displayName=ARROW_NAME$2;function isNotNull(e){return e!==null}var transformOrigin=e=>({name:"transformOrigin",options:e,fn(s){var zt,dt,ft;const{placement:i,rects:c,middlewareData:d}=s,_=((zt=d.arrow)==null?void 0:zt.centerOffset)!==0,g=_?0:e.arrowWidth,$=_?0:e.arrowHeight,[_e,lt]=getSideAndAlignFromPlacement(i),at={start:"0%",center:"50%",end:"100%"}[lt],it=(((dt=d.arrow)==null?void 0:dt.x)??0)+g/2,ct=(((ft=d.arrow)==null?void 0:ft.y)??0)+$/2;let mt="",pt="";return _e==="bottom"?(mt=_?at:`${it}px`,pt=`${-$}px`):_e==="top"?(mt=_?at:`${it}px`,pt=`${c.floating.height+$}px`):_e==="right"?(mt=`${-$}px`,pt=_?at:`${ct}px`):_e==="left"&&(mt=`${c.floating.width+$}px`,pt=_?at:`${ct}px`),{data:{x:mt,y:pt}}}});function getSideAndAlignFromPlacement(e){const[s,i="center"]=e.split("-");return[s,i]}var Root2$1=Popper,Anchor=PopperAnchor,Content=PopperContent,Arrow=PopperArrow,[createTooltipContext,createTooltipScope]=createContextScope("Tooltip",[createPopperScope]),usePopperScope$1=createPopperScope(),PROVIDER_NAME="TooltipProvider",DEFAULT_DELAY_DURATION=700,TOOLTIP_OPEN="tooltip.open",[TooltipProviderContextProvider,useTooltipProviderContext]=createTooltipContext(PROVIDER_NAME),TooltipProvider$1=e=>{const{__scopeTooltip:s,delayDuration:i=DEFAULT_DELAY_DURATION,skipDelayDuration:c=300,disableHoverableContent:d=!1,children:h}=e,_=reactExports.useRef(!0),g=reactExports.useRef(!1),$=reactExports.useRef(0);return reactExports.useEffect(()=>{const _e=$.current;return()=>window.clearTimeout(_e)},[]),jsxRuntimeExports.jsx(TooltipProviderContextProvider,{scope:s,isOpenDelayedRef:_,delayDuration:i,onOpen:reactExports.useCallback(()=>{window.clearTimeout($.current),_.current=!1},[]),onClose:reactExports.useCallback(()=>{window.clearTimeout($.current),$.current=window.setTimeout(()=>_.current=!0,c)},[c]),isPointerInTransitRef:g,onPointerInTransitChange:reactExports.useCallback(_e=>{g.current=_e},[]),disableHoverableContent:d,children:h})};TooltipProvider$1.displayName=PROVIDER_NAME;var TOOLTIP_NAME="Tooltip",[TooltipContextProvider,useTooltipContext]=createTooltipContext(TOOLTIP_NAME),TRIGGER_NAME$1="TooltipTrigger",TooltipTrigger=reactExports.forwardRef((e,s)=>{const{__scopeTooltip:i,...c}=e,d=useTooltipContext(TRIGGER_NAME$1,i),h=useTooltipProviderContext(TRIGGER_NAME$1,i),_=usePopperScope$1(i),g=reactExports.useRef(null),$=useComposedRefs(s,g,d.onTriggerChange),_e=reactExports.useRef(!1),lt=reactExports.useRef(!1),at=reactExports.useCallback(()=>_e.current=!1,[]);return reactExports.useEffect(()=>()=>document.removeEventListener("pointerup",at),[at]),jsxRuntimeExports.jsx(Anchor,{asChild:!0,..._,children:jsxRuntimeExports.jsx(Primitive.button,{"aria-describedby":d.open?d.contentId:void 0,"data-state":d.stateAttribute,...c,ref:$,onPointerMove:composeEventHandlers(e.onPointerMove,it=>{it.pointerType!=="touch"&&!lt.current&&!h.isPointerInTransitRef.current&&(d.onTriggerEnter(),lt.current=!0)}),onPointerLeave:composeEventHandlers(e.onPointerLeave,()=>{d.onTriggerLeave(),lt.current=!1}),onPointerDown:composeEventHandlers(e.onPointerDown,()=>{d.open&&d.onClose(),_e.current=!0,document.addEventListener("pointerup",at,{once:!0})}),onFocus:composeEventHandlers(e.onFocus,()=>{_e.current||d.onOpen()}),onBlur:composeEventHandlers(e.onBlur,d.onClose),onClick:composeEventHandlers(e.onClick,d.onClose)})})});TooltipTrigger.displayName=TRIGGER_NAME$1;var PORTAL_NAME$1="TooltipPortal",[PortalProvider,usePortalContext]=createTooltipContext(PORTAL_NAME$1,{forceMount:void 0}),CONTENT_NAME$1="TooltipContent",TooltipContent$1=reactExports.forwardRef((e,s)=>{const i=usePortalContext(CONTENT_NAME$1,e.__scopeTooltip),{forceMount:c=i.forceMount,side:d="top",...h}=e,_=useTooltipContext(CONTENT_NAME$1,e.__scopeTooltip);return jsxRuntimeExports.jsx(Presence,{present:c||_.open,children:_.disableHoverableContent?jsxRuntimeExports.jsx(TooltipContentImpl,{side:d,...h,ref:s}):jsxRuntimeExports.jsx(TooltipContentHoverable,{side:d,...h,ref:s})})}),TooltipContentHoverable=reactExports.forwardRef((e,s)=>{const i=useTooltipContext(CONTENT_NAME$1,e.__scopeTooltip),c=useTooltipProviderContext(CONTENT_NAME$1,e.__scopeTooltip),d=reactExports.useRef(null),h=useComposedRefs(s,d),[_,g]=reactExports.useState(null),{trigger:$,onClose:_e}=i,lt=d.current,{onPointerInTransitChange:at}=c,it=reactExports.useCallback(()=>{g(null),at(!1)},[at]),ct=reactExports.useCallback((mt,pt)=>{const zt=mt.currentTarget,dt={x:mt.clientX,y:mt.clientY},ft=getExitSideFromRect(dt,zt.getBoundingClientRect()),kt=getPaddedExitPoints(dt,ft),St=getPointsFromRect(pt.getBoundingClientRect()),Lt=getHull([...kt,...St]);g(Lt),at(!0)},[at]);return reactExports.useEffect(()=>()=>it(),[it]),reactExports.useEffect(()=>{if($&&lt){const mt=zt=>ct(zt,lt),pt=zt=>ct(zt,$);return $.addEventListener("pointerleave",mt),lt.addEventListener("pointerleave",pt),()=>{$.removeEventListener("pointerleave",mt),lt.removeEventListener("pointerleave",pt)}}},[$,lt,ct,it]),reactExports.useEffect(()=>{if(_){const mt=pt=>{const zt=pt.target,dt={x:pt.clientX,y:pt.clientY},ft=($==null?void 0:$.contains(zt))||(lt==null?void 0:lt.contains(zt)),kt=!isPointInPolygon(dt,_);ft?it():kt&&(it(),_e())};return document.addEventListener("pointermove",mt),()=>document.removeEventListener("pointermove",mt)}},[$,lt,_,_e,it]),jsxRuntimeExports.jsx(TooltipContentImpl,{...e,ref:h})}),[VisuallyHiddenContentContextProvider,useVisuallyHiddenContentContext]=createTooltipContext(TOOLTIP_NAME,{isInside:!1}),Slottable=createSlottable("TooltipContent"),TooltipContentImpl=reactExports.forwardRef((e,s)=>{const{__scopeTooltip:i,children:c,"aria-label":d,onEscapeKeyDown:h,onPointerDownOutside:_,...g}=e,$=useTooltipContext(CONTENT_NAME$1,i),_e=usePopperScope$1(i),{onClose:lt}=$;return reactExports.useEffect(()=>(document.addEventListener(TOOLTIP_OPEN,lt),()=>document.removeEventListener(TOOLTIP_OPEN,lt)),[lt]),reactExports.useEffect(()=>{if($.trigger){const at=it=>{const ct=it.target;ct!=null&&ct.contains($.trigger)&&lt()};return window.addEventListener("scroll",at,{capture:!0}),()=>window.removeEventListener("scroll",at,{capture:!0})}},[$.trigger,lt]),jsxRuntimeExports.jsx(DismissableLayer,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:h,onPointerDownOutside:_,onFocusOutside:at=>at.preventDefault(),onDismiss:lt,children:jsxRuntimeExports.jsxs(Content,{"data-state":$.stateAttribute,..._e,...g,ref:s,style:{...g.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[jsxRuntimeExports.jsx(Slottable,{children:c}),jsxRuntimeExports.jsx(VisuallyHiddenContentContextProvider,{scope:i,isInside:!0,children:jsxRuntimeExports.jsx(Root$2,{id:$.contentId,role:"tooltip",children:d||c})})]})})});TooltipContent$1.displayName=CONTENT_NAME$1;var ARROW_NAME$1="TooltipArrow",TooltipArrow=reactExports.forwardRef((e,s)=>{const{__scopeTooltip:i,...c}=e,d=usePopperScope$1(i);return useVisuallyHiddenContentContext(ARROW_NAME$1,i).isInside?null:jsxRuntimeExports.jsx(Arrow,{...d,...c,ref:s})});TooltipArrow.displayName=ARROW_NAME$1;function getExitSideFromRect(e,s){const i=Math.abs(s.top-e.y),c=Math.abs(s.bottom-e.y),d=Math.abs(s.right-e.x),h=Math.abs(s.left-e.x);switch(Math.min(i,c,d,h)){case h:return"left";case d:return"right";case i:return"top";case c:return"bottom";default:throw new Error("unreachable")}}function getPaddedExitPoints(e,s,i=5){const c=[];switch(s){case"top":c.push({x:e.x-i,y:e.y+i},{x:e.x+i,y:e.y+i});break;case"bottom":c.push({x:e.x-i,y:e.y-i},{x:e.x+i,y:e.y-i});break;case"left":c.push({x:e.x+i,y:e.y-i},{x:e.x+i,y:e.y+i});break;case"right":c.push({x:e.x-i,y:e.y-i},{x:e.x-i,y:e.y+i});break}return c}function getPointsFromRect(e){const{top:s,right:i,bottom:c,left:d}=e;return[{x:d,y:s},{x:i,y:s},{x:i,y:c},{x:d,y:c}]}function isPointInPolygon(e,s){const{x:i,y:c}=e;let d=!1;for(let h=0,_=s.length-1;h<s.length;_=h++){const g=s[h],$=s[_],_e=g.x,lt=g.y,at=$.x,it=$.y;lt>c!=it>c&&i<(at-_e)*(c-lt)/(it-lt)+_e&&(d=!d)}return d}function getHull(e){const s=e.slice();return s.sort((i,c)=>i.x<c.x?-1:i.x>c.x?1:i.y<c.y?-1:i.y>c.y?1:0),getHullPresorted(s)}function getHullPresorted(e){if(e.length<=1)return e.slice();const s=[];for(let c=0;c<e.length;c++){const d=e[c];for(;s.length>=2;){const h=s[s.length-1],_=s[s.length-2];if((h.x-_.x)*(d.y-_.y)>=(h.y-_.y)*(d.x-_.x))s.pop();else break}s.push(d)}s.pop();const i=[];for(let c=e.length-1;c>=0;c--){const d=e[c];for(;i.length>=2;){const h=i[i.length-1],_=i[i.length-2];if((h.x-_.x)*(d.y-_.y)>=(h.y-_.y)*(d.x-_.x))i.pop();else break}i.push(d)}return i.pop(),s.length===1&&i.length===1&&s[0].x===i[0].x&&s[0].y===i[0].y?s:s.concat(i)}var Provider=TooltipProvider$1,Content2$1=TooltipContent$1;const TooltipProvider=Provider,TooltipContent=reactExports.forwardRef(({className:e,sideOffset:s=4,...i},c)=>jsxRuntimeExports.jsx(Content2$1,{ref:c,sideOffset:s,className:cn("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...i}));TooltipContent.displayName=Content2$1.displayName;var Subscribable=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},isServer=typeof window>"u"||"Deno"in globalThis;function noop(){}function functionalUpdate(e,s){return typeof e=="function"?e(s):e}function isValidTimeout(e){return typeof e=="number"&&e>=0&&e!==1/0}function timeUntilStale(e,s){return Math.max(e+(s||0)-Date.now(),0)}function resolveStaleTime(e,s){return typeof e=="function"?e(s):e}function resolveEnabled(e,s){return typeof e=="function"?e(s):e}function matchQuery(e,s){const{type:i="all",exact:c,fetchStatus:d,predicate:h,queryKey:_,stale:g}=e;if(_){if(c){if(s.queryHash!==hashQueryKeyByOptions(_,s.options))return!1}else if(!partialMatchKey(s.queryKey,_))return!1}if(i!=="all"){const $=s.isActive();if(i==="active"&&!$||i==="inactive"&&$)return!1}return!(typeof g=="boolean"&&s.isStale()!==g||d&&d!==s.state.fetchStatus||h&&!h(s))}function matchMutation(e,s){const{exact:i,status:c,predicate:d,mutationKey:h}=e;if(h){if(!s.options.mutationKey)return!1;if(i){if(hashKey(s.options.mutationKey)!==hashKey(h))return!1}else if(!partialMatchKey(s.options.mutationKey,h))return!1}return!(c&&s.state.status!==c||d&&!d(s))}function hashQueryKeyByOptions(e,s){return((s==null?void 0:s.queryKeyHashFn)||hashKey)(e)}function hashKey(e){return JSON.stringify(e,(s,i)=>isPlainObject(i)?Object.keys(i).sort().reduce((c,d)=>(c[d]=i[d],c),{}):i)}function partialMatchKey(e,s){return e===s?!0:typeof e!=typeof s?!1:e&&s&&typeof e=="object"&&typeof s=="object"?Object.keys(s).every(i=>partialMatchKey(e[i],s[i])):!1}function replaceEqualDeep(e,s){if(e===s)return e;const i=isPlainArray(e)&&isPlainArray(s);if(i||isPlainObject(e)&&isPlainObject(s)){const c=i?e:Object.keys(e),d=c.length,h=i?s:Object.keys(s),_=h.length,g=i?[]:{},$=new Set(c);let _e=0;for(let lt=0;lt<_;lt++){const at=i?lt:h[lt];(!i&&$.has(at)||i)&&e[at]===void 0&&s[at]===void 0?(g[at]=void 0,_e++):(g[at]=replaceEqualDeep(e[at],s[at]),g[at]===e[at]&&e[at]!==void 0&&_e++)}return d===_&&_e===d?e:g}return s}function isPlainArray(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function isPlainObject(e){if(!hasObjectPrototype(e))return!1;const s=e.constructor;if(s===void 0)return!0;const i=s.prototype;return!(!hasObjectPrototype(i)||!i.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function hasObjectPrototype(e){return Object.prototype.toString.call(e)==="[object Object]"}function sleep(e){return new Promise(s=>{setTimeout(s,e)})}function replaceData(e,s,i){return typeof i.structuralSharing=="function"?i.structuralSharing(e,s):i.structuralSharing!==!1?replaceEqualDeep(e,s):s}function addToEnd(e,s,i=0){const c=[...e,s];return i&&c.length>i?c.slice(1):c}function addToStart(e,s,i=0){const c=[s,...e];return i&&c.length>i?c.slice(0,-1):c}var skipToken=Symbol();function ensureQueryFn(e,s){return!e.queryFn&&(s!=null&&s.initialPromise)?()=>s.initialPromise:!e.queryFn||e.queryFn===skipToken?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Lw,_w,sy,jP,FocusManager=(jP=class extends Subscribable{constructor(){super();E_(this,Lw);E_(this,_w);E_(this,sy);f_(this,sy,s=>{if(!isServer&&window.addEventListener){const i=()=>s();return window.addEventListener("visibilitychange",i,!1),()=>{window.removeEventListener("visibilitychange",i)}}})}onSubscribe(){ap(this,_w)||this.setEventListener(ap(this,sy))}onUnsubscribe(){var s;this.hasListeners()||((s=ap(this,_w))==null||s.call(this),f_(this,_w,void 0))}setEventListener(s){var i;f_(this,sy,s),(i=ap(this,_w))==null||i.call(this),f_(this,_w,s(c=>{typeof c=="boolean"?this.setFocused(c):this.onFocus()}))}setFocused(s){ap(this,Lw)!==s&&(f_(this,Lw,s),this.onFocus())}onFocus(){const s=this.isFocused();this.listeners.forEach(i=>{i(s)})}isFocused(){var s;return typeof ap(this,Lw)=="boolean"?ap(this,Lw):((s=globalThis.document)==null?void 0:s.visibilityState)!=="hidden"}},Lw=new WeakMap,_w=new WeakMap,sy=new WeakMap,jP),focusManager=new FocusManager,oy,gw,ay,NP,OnlineManager=(NP=class extends Subscribable{constructor(){super();E_(this,oy,!0);E_(this,gw);E_(this,ay);f_(this,ay,s=>{if(!isServer&&window.addEventListener){const i=()=>s(!0),c=()=>s(!1);return window.addEventListener("online",i,!1),window.addEventListener("offline",c,!1),()=>{window.removeEventListener("online",i),window.removeEventListener("offline",c)}}})}onSubscribe(){ap(this,gw)||this.setEventListener(ap(this,ay))}onUnsubscribe(){var s;this.hasListeners()||((s=ap(this,gw))==null||s.call(this),f_(this,gw,void 0))}setEventListener(s){var i;f_(this,ay,s),(i=ap(this,gw))==null||i.call(this),f_(this,gw,s(this.setOnline.bind(this)))}setOnline(s){ap(this,oy)!==s&&(f_(this,oy,s),this.listeners.forEach(c=>{c(s)}))}isOnline(){return ap(this,oy)}},oy=new WeakMap,gw=new WeakMap,ay=new WeakMap,NP),onlineManager=new OnlineManager;function pendingThenable(){let e,s;const i=new Promise((d,h)=>{e=d,s=h});i.status="pending",i.catch(()=>{});function c(d){Object.assign(i,d),delete i.resolve,delete i.reject}return i.resolve=d=>{c({status:"fulfilled",value:d}),e(d)},i.reject=d=>{c({status:"rejected",reason:d}),s(d)},i}function defaultRetryDelay(e){return Math.min(1e3*2**e,3e4)}function canFetch(e){return(e??"online")==="online"?onlineManager.isOnline():!0}var CancelledError=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function isCancelledError(e){return e instanceof CancelledError}function createRetryer(e){let s=!1,i=0,c=!1,d;const h=pendingThenable(),_=pt=>{var zt;c||(it(new CancelledError(pt)),(zt=e.abort)==null||zt.call(e))},g=()=>{s=!0},$=()=>{s=!1},_e=()=>focusManager.isFocused()&&(e.networkMode==="always"||onlineManager.isOnline())&&e.canRun(),lt=()=>canFetch(e.networkMode)&&e.canRun(),at=pt=>{var zt;c||(c=!0,(zt=e.onSuccess)==null||zt.call(e,pt),d==null||d(),h.resolve(pt))},it=pt=>{var zt;c||(c=!0,(zt=e.onError)==null||zt.call(e,pt),d==null||d(),h.reject(pt))},ct=()=>new Promise(pt=>{var zt;d=dt=>{(c||_e())&&pt(dt)},(zt=e.onPause)==null||zt.call(e)}).then(()=>{var pt;d=void 0,c||(pt=e.onContinue)==null||pt.call(e)}),mt=()=>{if(c)return;let pt;const zt=i===0?e.initialPromise:void 0;try{pt=zt??e.fn()}catch(dt){pt=Promise.reject(dt)}Promise.resolve(pt).then(at).catch(dt=>{var Gt;if(c)return;const ft=e.retry??(isServer?0:3),kt=e.retryDelay??defaultRetryDelay,St=typeof kt=="function"?kt(i,dt):kt,Lt=ft===!0||typeof ft=="number"&&i<ft||typeof ft=="function"&&ft(i,dt);if(s||!Lt){it(dt);return}i++,(Gt=e.onFail)==null||Gt.call(e,i,dt),sleep(St).then(()=>_e()?void 0:ct()).then(()=>{s?it(dt):mt()})})};return{promise:h,cancel:_,continue:()=>(d==null||d(),h),cancelRetry:g,continueRetry:$,canStart:lt,start:()=>(lt()?mt():ct().then(mt),h)}}var defaultScheduler=e=>setTimeout(e,0);function createNotifyManager(){let e=[],s=0,i=g=>{g()},c=g=>{g()},d=defaultScheduler;const h=g=>{s?e.push(g):d(()=>{i(g)})},_=()=>{const g=e;e=[],g.length&&d(()=>{c(()=>{g.forEach($=>{i($)})})})};return{batch:g=>{let $;s++;try{$=g()}finally{s--,s||_()}return $},batchCalls:g=>(...$)=>{h(()=>{g(...$)})},schedule:h,setNotifyFunction:g=>{i=g},setBatchNotifyFunction:g=>{c=g},setScheduler:g=>{d=g}}}var notifyManager=createNotifyManager(),Fw,LP,Removable=(LP=class{constructor(){E_(this,Fw)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),isValidTimeout(this.gcTime)&&f_(this,Fw,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(isServer?1/0:5*60*1e3))}clearGcTimeout(){ap(this,Fw)&&(clearTimeout(ap(this,Fw)),f_(this,Fw,void 0))}},Fw=new WeakMap,LP),iy,Dw,Dx,zw,vx,Fy,Bw,Hx,iw,FP,Query=(FP=class extends Removable{constructor(s){super();E_(this,Hx);E_(this,iy);E_(this,Dw);E_(this,Dx);E_(this,zw);E_(this,vx);E_(this,Fy);E_(this,Bw);f_(this,Bw,!1),f_(this,Fy,s.defaultOptions),this.setOptions(s.options),this.observers=[],f_(this,zw,s.client),f_(this,Dx,ap(this,zw).getQueryCache()),this.queryKey=s.queryKey,this.queryHash=s.queryHash,f_(this,iy,getDefaultState$1(this.options)),this.state=s.state??ap(this,iy),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var s;return(s=ap(this,vx))==null?void 0:s.promise}setOptions(s){this.options={...ap(this,Fy),...s},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ap(this,Dx).remove(this)}setData(s,i){const c=replaceData(this.state.data,s,this.options);return yx(this,Hx,iw).call(this,{data:c,type:"success",dataUpdatedAt:i==null?void 0:i.updatedAt,manual:i==null?void 0:i.manual}),c}setState(s,i){yx(this,Hx,iw).call(this,{type:"setState",state:s,setStateOptions:i})}cancel(s){var c,d;const i=(c=ap(this,vx))==null?void 0:c.promise;return(d=ap(this,vx))==null||d.cancel(s),i?i.then(noop).catch(noop):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ap(this,iy))}isActive(){return this.observers.some(s=>resolveEnabled(s.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===skipToken||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(s=>resolveStaleTime(s.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(s=>s.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(s=0){return this.state.data===void 0?!0:s==="static"?!1:this.state.isInvalidated?!0:!timeUntilStale(this.state.dataUpdatedAt,s)}onFocus(){var i;const s=this.observers.find(c=>c.shouldFetchOnWindowFocus());s==null||s.refetch({cancelRefetch:!1}),(i=ap(this,vx))==null||i.continue()}onOnline(){var i;const s=this.observers.find(c=>c.shouldFetchOnReconnect());s==null||s.refetch({cancelRefetch:!1}),(i=ap(this,vx))==null||i.continue()}addObserver(s){this.observers.includes(s)||(this.observers.push(s),this.clearGcTimeout(),ap(this,Dx).notify({type:"observerAdded",query:this,observer:s}))}removeObserver(s){this.observers.includes(s)&&(this.observers=this.observers.filter(i=>i!==s),this.observers.length||(ap(this,vx)&&(ap(this,Bw)?ap(this,vx).cancel({revert:!0}):ap(this,vx).cancelRetry()),this.scheduleGc()),ap(this,Dx).notify({type:"observerRemoved",query:this,observer:s}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||yx(this,Hx,iw).call(this,{type:"invalidate"})}fetch(s,i){var _e,lt,at;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(i!=null&&i.cancelRefetch))this.cancel({silent:!0});else if(ap(this,vx))return ap(this,vx).continueRetry(),ap(this,vx).promise}if(s&&this.setOptions(s),!this.options.queryFn){const it=this.observers.find(ct=>ct.options.queryFn);it&&this.setOptions(it.options)}const c=new AbortController,d=it=>{Object.defineProperty(it,"signal",{enumerable:!0,get:()=>(f_(this,Bw,!0),c.signal)})},h=()=>{const it=ensureQueryFn(this.options,i),mt=(()=>{const pt={client:ap(this,zw),queryKey:this.queryKey,meta:this.meta};return d(pt),pt})();return f_(this,Bw,!1),this.options.persister?this.options.persister(it,mt,this):it(mt)},g=(()=>{const it={fetchOptions:i,options:this.options,queryKey:this.queryKey,client:ap(this,zw),state:this.state,fetchFn:h};return d(it),it})();(_e=this.options.behavior)==null||_e.onFetch(g,this),f_(this,Dw,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((lt=g.fetchOptions)==null?void 0:lt.meta))&&yx(this,Hx,iw).call(this,{type:"fetch",meta:(at=g.fetchOptions)==null?void 0:at.meta});const $=it=>{var ct,mt,pt,zt;isCancelledError(it)&&it.silent||yx(this,Hx,iw).call(this,{type:"error",error:it}),isCancelledError(it)||((mt=(ct=ap(this,Dx).config).onError)==null||mt.call(ct,it,this),(zt=(pt=ap(this,Dx).config).onSettled)==null||zt.call(pt,this.state.data,it,this)),this.scheduleGc()};return f_(this,vx,createRetryer({initialPromise:i==null?void 0:i.initialPromise,fn:g.fetchFn,abort:c.abort.bind(c),onSuccess:it=>{var ct,mt,pt,zt;if(it===void 0){$(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(it)}catch(dt){$(dt);return}(mt=(ct=ap(this,Dx).config).onSuccess)==null||mt.call(ct,it,this),(zt=(pt=ap(this,Dx).config).onSettled)==null||zt.call(pt,it,this.state.error,this),this.scheduleGc()},onError:$,onFail:(it,ct)=>{yx(this,Hx,iw).call(this,{type:"failed",failureCount:it,error:ct})},onPause:()=>{yx(this,Hx,iw).call(this,{type:"pause"})},onContinue:()=>{yx(this,Hx,iw).call(this,{type:"continue"})},retry:g.options.retry,retryDelay:g.options.retryDelay,networkMode:g.options.networkMode,canRun:()=>!0})),ap(this,vx).start()}},iy=new WeakMap,Dw=new WeakMap,Dx=new WeakMap,zw=new WeakMap,vx=new WeakMap,Fy=new WeakMap,Bw=new WeakMap,Hx=new WeakSet,iw=function(s){const i=c=>{switch(s.type){case"failed":return{...c,fetchFailureCount:s.failureCount,fetchFailureReason:s.error};case"pause":return{...c,fetchStatus:"paused"};case"continue":return{...c,fetchStatus:"fetching"};case"fetch":return{...c,...fetchState(c.data,this.options),fetchMeta:s.meta??null};case"success":return f_(this,Dw,void 0),{...c,data:s.data,dataUpdateCount:c.dataUpdateCount+1,dataUpdatedAt:s.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!s.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const d=s.error;return isCancelledError(d)&&d.revert&&ap(this,Dw)?{...ap(this,Dw),fetchStatus:"idle"}:{...c,error:d,errorUpdateCount:c.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:c.fetchFailureCount+1,fetchFailureReason:d,fetchStatus:"idle",status:"error"};case"invalidate":return{...c,isInvalidated:!0};case"setState":return{...c,...s.state}}};this.state=i(this.state),notifyManager.batch(()=>{this.observers.forEach(c=>{c.onQueryUpdate()}),ap(this,Dx).notify({query:this,type:"updated",action:s})})},FP);function fetchState(e,s){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:canFetch(s.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function getDefaultState$1(e){const s=typeof e.initialData=="function"?e.initialData():e.initialData,i=s!==void 0,c=i?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:s,dataUpdateCount:0,dataUpdatedAt:i?c??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:i?"success":"pending",fetchStatus:"idle"}}var Zx,DP,QueryCache=(DP=class extends Subscribable{constructor(s={}){super();E_(this,Zx);this.config=s,f_(this,Zx,new Map)}build(s,i,c){const d=i.queryKey,h=i.queryHash??hashQueryKeyByOptions(d,i);let _=this.get(h);return _||(_=new Query({client:s,queryKey:d,queryHash:h,options:s.defaultQueryOptions(i),state:c,defaultOptions:s.getQueryDefaults(d)}),this.add(_)),_}add(s){ap(this,Zx).has(s.queryHash)||(ap(this,Zx).set(s.queryHash,s),this.notify({type:"added",query:s}))}remove(s){const i=ap(this,Zx).get(s.queryHash);i&&(s.destroy(),i===s&&ap(this,Zx).delete(s.queryHash),this.notify({type:"removed",query:s}))}clear(){notifyManager.batch(()=>{this.getAll().forEach(s=>{this.remove(s)})})}get(s){return ap(this,Zx).get(s)}getAll(){return[...ap(this,Zx).values()]}find(s){const i={exact:!0,...s};return this.getAll().find(c=>matchQuery(i,c))}findAll(s={}){const i=this.getAll();return Object.keys(s).length>0?i.filter(c=>matchQuery(s,c)):i}notify(s){notifyManager.batch(()=>{this.listeners.forEach(i=>{i(s)})})}onFocus(){notifyManager.batch(()=>{this.getAll().forEach(s=>{s.onFocus()})})}onOnline(){notifyManager.batch(()=>{this.getAll().forEach(s=>{s.onOnline()})})}},Zx=new WeakMap,DP),ew,Tx,Uw,tw,hw,zP,Mutation=(zP=class extends Removable{constructor(s){super();E_(this,tw);E_(this,ew);E_(this,Tx);E_(this,Uw);this.mutationId=s.mutationId,f_(this,Tx,s.mutationCache),f_(this,ew,[]),this.state=s.state||getDefaultState(),this.setOptions(s.options),this.scheduleGc()}setOptions(s){this.options=s,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(s){ap(this,ew).includes(s)||(ap(this,ew).push(s),this.clearGcTimeout(),ap(this,Tx).notify({type:"observerAdded",mutation:this,observer:s}))}removeObserver(s){f_(this,ew,ap(this,ew).filter(i=>i!==s)),this.scheduleGc(),ap(this,Tx).notify({type:"observerRemoved",mutation:this,observer:s})}optionalRemove(){ap(this,ew).length||(this.state.status==="pending"?this.scheduleGc():ap(this,Tx).remove(this))}continue(){var s;return((s=ap(this,Uw))==null?void 0:s.continue())??this.execute(this.state.variables)}async execute(s){var h,_,g,$,_e,lt,at,it,ct,mt,pt,zt,dt,ft,kt,St,Lt,Gt,Bt,nr;const i=()=>{yx(this,tw,hw).call(this,{type:"continue"})};f_(this,Uw,createRetryer({fn:()=>this.options.mutationFn?this.options.mutationFn(s):Promise.reject(new Error("No mutationFn found")),onFail:(cr,ur)=>{yx(this,tw,hw).call(this,{type:"failed",failureCount:cr,error:ur})},onPause:()=>{yx(this,tw,hw).call(this,{type:"pause"})},onContinue:i,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ap(this,Tx).canRun(this)}));const c=this.state.status==="pending",d=!ap(this,Uw).canStart();try{if(c)i();else{yx(this,tw,hw).call(this,{type:"pending",variables:s,isPaused:d}),await((_=(h=ap(this,Tx).config).onMutate)==null?void 0:_.call(h,s,this));const ur=await(($=(g=this.options).onMutate)==null?void 0:$.call(g,s));ur!==this.state.context&&yx(this,tw,hw).call(this,{type:"pending",context:ur,variables:s,isPaused:d})}const cr=await ap(this,Uw).start();return await((lt=(_e=ap(this,Tx).config).onSuccess)==null?void 0:lt.call(_e,cr,s,this.state.context,this)),await((it=(at=this.options).onSuccess)==null?void 0:it.call(at,cr,s,this.state.context)),await((mt=(ct=ap(this,Tx).config).onSettled)==null?void 0:mt.call(ct,cr,null,this.state.variables,this.state.context,this)),await((zt=(pt=this.options).onSettled)==null?void 0:zt.call(pt,cr,null,s,this.state.context)),yx(this,tw,hw).call(this,{type:"success",data:cr}),cr}catch(cr){try{throw await((ft=(dt=ap(this,Tx).config).onError)==null?void 0:ft.call(dt,cr,s,this.state.context,this)),await((St=(kt=this.options).onError)==null?void 0:St.call(kt,cr,s,this.state.context)),await((Gt=(Lt=ap(this,Tx).config).onSettled)==null?void 0:Gt.call(Lt,void 0,cr,this.state.variables,this.state.context,this)),await((nr=(Bt=this.options).onSettled)==null?void 0:nr.call(Bt,void 0,cr,s,this.state.context)),cr}finally{yx(this,tw,hw).call(this,{type:"error",error:cr})}}finally{ap(this,Tx).runNext(this)}}},ew=new WeakMap,Tx=new WeakMap,Uw=new WeakMap,tw=new WeakSet,hw=function(s){const i=c=>{switch(s.type){case"failed":return{...c,failureCount:s.failureCount,failureReason:s.error};case"pause":return{...c,isPaused:!0};case"continue":return{...c,isPaused:!1};case"pending":return{...c,context:s.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:s.isPaused,status:"pending",variables:s.variables,submittedAt:Date.now()};case"success":return{...c,data:s.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...c,data:void 0,error:s.error,failureCount:c.failureCount+1,failureReason:s.error,isPaused:!1,status:"error"}}};this.state=i(this.state),notifyManager.batch(()=>{ap(this,ew).forEach(c=>{c.onMutationUpdate(s)}),ap(this,Tx).notify({mutation:this,type:"updated",action:s})})},zP);function getDefaultState(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var lw,Kx,Dy,BP,MutationCache=(BP=class extends Subscribable{constructor(s={}){super();E_(this,lw);E_(this,Kx);E_(this,Dy);this.config=s,f_(this,lw,new Set),f_(this,Kx,new Map),f_(this,Dy,0)}build(s,i,c){const d=new Mutation({mutationCache:this,mutationId:++Nv(this,Dy)._,options:s.defaultMutationOptions(i),state:c});return this.add(d),d}add(s){ap(this,lw).add(s);const i=scopeFor(s);if(typeof i=="string"){const c=ap(this,Kx).get(i);c?c.push(s):ap(this,Kx).set(i,[s])}this.notify({type:"added",mutation:s})}remove(s){if(ap(this,lw).delete(s)){const i=scopeFor(s);if(typeof i=="string"){const c=ap(this,Kx).get(i);if(c)if(c.length>1){const d=c.indexOf(s);d!==-1&&c.splice(d,1)}else c[0]===s&&ap(this,Kx).delete(i)}}this.notify({type:"removed",mutation:s})}canRun(s){const i=scopeFor(s);if(typeof i=="string"){const c=ap(this,Kx).get(i),d=c==null?void 0:c.find(h=>h.state.status==="pending");return!d||d===s}else return!0}runNext(s){var c;const i=scopeFor(s);if(typeof i=="string"){const d=(c=ap(this,Kx).get(i))==null?void 0:c.find(h=>h!==s&&h.state.isPaused);return(d==null?void 0:d.continue())??Promise.resolve()}else return Promise.resolve()}clear(){notifyManager.batch(()=>{ap(this,lw).forEach(s=>{this.notify({type:"removed",mutation:s})}),ap(this,lw).clear(),ap(this,Kx).clear()})}getAll(){return Array.from(ap(this,lw))}find(s){const i={exact:!0,...s};return this.getAll().find(c=>matchMutation(i,c))}findAll(s={}){return this.getAll().filter(i=>matchMutation(s,i))}notify(s){notifyManager.batch(()=>{this.listeners.forEach(i=>{i(s)})})}resumePausedMutations(){const s=this.getAll().filter(i=>i.state.isPaused);return notifyManager.batch(()=>Promise.all(s.map(i=>i.continue().catch(noop))))}},lw=new WeakMap,Kx=new WeakMap,Dy=new WeakMap,BP);function scopeFor(e){var s;return(s=e.options.scope)==null?void 0:s.id}function infiniteQueryBehavior(e){return{onFetch:(s,i)=>{var lt,at,it,ct,mt;const c=s.options,d=(it=(at=(lt=s.fetchOptions)==null?void 0:lt.meta)==null?void 0:at.fetchMore)==null?void 0:it.direction,h=((ct=s.state.data)==null?void 0:ct.pages)||[],_=((mt=s.state.data)==null?void 0:mt.pageParams)||[];let g={pages:[],pageParams:[]},$=0;const _e=async()=>{let pt=!1;const zt=kt=>{Object.defineProperty(kt,"signal",{enumerable:!0,get:()=>(s.signal.aborted?pt=!0:s.signal.addEventListener("abort",()=>{pt=!0}),s.signal)})},dt=ensureQueryFn(s.options,s.fetchOptions),ft=async(kt,St,Lt)=>{if(pt)return Promise.reject();if(St==null&&kt.pages.length)return Promise.resolve(kt);const Bt=(()=>{const yn={client:s.client,queryKey:s.queryKey,pageParam:St,direction:Lt?"backward":"forward",meta:s.options.meta};return zt(yn),yn})(),nr=await dt(Bt),{maxPages:cr}=s.options,ur=Lt?addToStart:addToEnd;return{pages:ur(kt.pages,nr,cr),pageParams:ur(kt.pageParams,St,cr)}};if(d&&h.length){const kt=d==="backward",St=kt?getPreviousPageParam:getNextPageParam,Lt={pages:h,pageParams:_},Gt=St(c,Lt);g=await ft(Lt,Gt,kt)}else{const kt=e??h.length;do{const St=$===0?_[0]??c.initialPageParam:getNextPageParam(c,g);if($>0&&St==null)break;g=await ft(g,St),$++}while($<kt)}return g};s.options.persister?s.fetchFn=()=>{var pt,zt;return(zt=(pt=s.options).persister)==null?void 0:zt.call(pt,_e,{client:s.client,queryKey:s.queryKey,meta:s.options.meta,signal:s.signal},i)}:s.fetchFn=_e}}}function getNextPageParam(e,{pages:s,pageParams:i}){const c=s.length-1;return s.length>0?e.getNextPageParam(s[c],s,i[c],i):void 0}function getPreviousPageParam(e,{pages:s,pageParams:i}){var c;return s.length>0?(c=e.getPreviousPageParam)==null?void 0:c.call(e,s[0],s,i[0],i):void 0}var Q_,xw,ww,ly,cy,yw,uy,dy,UP,QueryClient=(UP=class{constructor(e={}){E_(this,Q_);E_(this,xw);E_(this,ww);E_(this,ly);E_(this,cy);E_(this,yw);E_(this,uy);E_(this,dy);f_(this,Q_,e.queryCache||new QueryCache),f_(this,xw,e.mutationCache||new MutationCache),f_(this,ww,e.defaultOptions||{}),f_(this,ly,new Map),f_(this,cy,new Map),f_(this,yw,0)}mount(){Nv(this,yw)._++,ap(this,yw)===1&&(f_(this,uy,focusManager.subscribe(async e=>{e&&(await this.resumePausedMutations(),ap(this,Q_).onFocus())})),f_(this,dy,onlineManager.subscribe(async e=>{e&&(await this.resumePausedMutations(),ap(this,Q_).onOnline())})))}unmount(){var e,s;Nv(this,yw)._--,ap(this,yw)===0&&((e=ap(this,uy))==null||e.call(this),f_(this,uy,void 0),(s=ap(this,dy))==null||s.call(this),f_(this,dy,void 0))}isFetching(e){return ap(this,Q_).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ap(this,xw).findAll({...e,status:"pending"}).length}getQueryData(e){var i;const s=this.defaultQueryOptions({queryKey:e});return(i=ap(this,Q_).get(s.queryHash))==null?void 0:i.state.data}ensureQueryData(e){const s=this.defaultQueryOptions(e),i=ap(this,Q_).build(this,s),c=i.state.data;return c===void 0?this.fetchQuery(e):(e.revalidateIfStale&&i.isStaleByTime(resolveStaleTime(s.staleTime,i))&&this.prefetchQuery(s),Promise.resolve(c))}getQueriesData(e){return ap(this,Q_).findAll(e).map(({queryKey:s,state:i})=>{const c=i.data;return[s,c]})}setQueryData(e,s,i){const c=this.defaultQueryOptions({queryKey:e}),d=ap(this,Q_).get(c.queryHash),h=d==null?void 0:d.state.data,_=functionalUpdate(s,h);if(_!==void 0)return ap(this,Q_).build(this,c).setData(_,{...i,manual:!0})}setQueriesData(e,s,i){return notifyManager.batch(()=>ap(this,Q_).findAll(e).map(({queryKey:c})=>[c,this.setQueryData(c,s,i)]))}getQueryState(e){var i;const s=this.defaultQueryOptions({queryKey:e});return(i=ap(this,Q_).get(s.queryHash))==null?void 0:i.state}removeQueries(e){const s=ap(this,Q_);notifyManager.batch(()=>{s.findAll(e).forEach(i=>{s.remove(i)})})}resetQueries(e,s){const i=ap(this,Q_);return notifyManager.batch(()=>(i.findAll(e).forEach(c=>{c.reset()}),this.refetchQueries({type:"active",...e},s)))}cancelQueries(e,s={}){const i={revert:!0,...s},c=notifyManager.batch(()=>ap(this,Q_).findAll(e).map(d=>d.cancel(i)));return Promise.all(c).then(noop).catch(noop)}invalidateQueries(e,s={}){return notifyManager.batch(()=>(ap(this,Q_).findAll(e).forEach(i=>{i.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},s)))}refetchQueries(e,s={}){const i={...s,cancelRefetch:s.cancelRefetch??!0},c=notifyManager.batch(()=>ap(this,Q_).findAll(e).filter(d=>!d.isDisabled()&&!d.isStatic()).map(d=>{let h=d.fetch(void 0,i);return i.throwOnError||(h=h.catch(noop)),d.state.fetchStatus==="paused"?Promise.resolve():h}));return Promise.all(c).then(noop)}fetchQuery(e){const s=this.defaultQueryOptions(e);s.retry===void 0&&(s.retry=!1);const i=ap(this,Q_).build(this,s);return i.isStaleByTime(resolveStaleTime(s.staleTime,i))?i.fetch(s):Promise.resolve(i.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(noop).catch(noop)}fetchInfiniteQuery(e){return e.behavior=infiniteQueryBehavior(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(noop).catch(noop)}ensureInfiniteQueryData(e){return e.behavior=infiniteQueryBehavior(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return onlineManager.isOnline()?ap(this,xw).resumePausedMutations():Promise.resolve()}getQueryCache(){return ap(this,Q_)}getMutationCache(){return ap(this,xw)}getDefaultOptions(){return ap(this,ww)}setDefaultOptions(e){f_(this,ww,e)}setQueryDefaults(e,s){ap(this,ly).set(hashKey(e),{queryKey:e,defaultOptions:s})}getQueryDefaults(e){const s=[...ap(this,ly).values()],i={};return s.forEach(c=>{partialMatchKey(e,c.queryKey)&&Object.assign(i,c.defaultOptions)}),i}setMutationDefaults(e,s){ap(this,cy).set(hashKey(e),{mutationKey:e,defaultOptions:s})}getMutationDefaults(e){const s=[...ap(this,cy).values()],i={};return s.forEach(c=>{partialMatchKey(e,c.mutationKey)&&Object.assign(i,c.defaultOptions)}),i}defaultQueryOptions(e){if(e._defaulted)return e;const s={...ap(this,ww).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return s.queryHash||(s.queryHash=hashQueryKeyByOptions(s.queryKey,s)),s.refetchOnReconnect===void 0&&(s.refetchOnReconnect=s.networkMode!=="always"),s.throwOnError===void 0&&(s.throwOnError=!!s.suspense),!s.networkMode&&s.persister&&(s.networkMode="offlineFirst"),s.queryFn===skipToken&&(s.enabled=!1),s}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ap(this,ww).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ap(this,Q_).clear(),ap(this,xw).clear()}},Q_=new WeakMap,xw=new WeakMap,ww=new WeakMap,ly=new WeakMap,cy=new WeakMap,yw=new WeakMap,uy=new WeakMap,dy=new WeakMap,UP),QueryClientContext=reactExports.createContext(void 0),QueryClientProvider=({client:e,children:s})=>(reactExports.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),jsxRuntimeExports.jsx(QueryClientContext.Provider,{value:e,children:s}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var i=arguments[s];for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&(e[c]=i[c])}return e},_extends$1.apply(this,arguments)}var Action;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(e){e===void 0&&(e={});function s(c,d){let{pathname:h,search:_,hash:g}=c.location;return createLocation("",{pathname:h,search:_,hash:g},d.state&&d.state.usr||null,d.state&&d.state.key||"default")}function i(c,d){return typeof d=="string"?d:createPath(d)}return getUrlBasedHistory(s,i,null,e)}function invariant(e,s){if(e===!1||e===null||typeof e>"u")throw new Error(s)}function warning(e,s){if(!e){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(e,s){return{usr:e.state,key:e.key,idx:s}}function createLocation(e,s,i,c){return i===void 0&&(i=null),_extends$1({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof s=="string"?parsePath(s):s,{state:i,key:s&&s.key||c||createKey()})}function createPath(e){let{pathname:s="/",search:i="",hash:c=""}=e;return i&&i!=="?"&&(s+=i.charAt(0)==="?"?i:"?"+i),c&&c!=="#"&&(s+=c.charAt(0)==="#"?c:"#"+c),s}function parsePath(e){let s={};if(e){let i=e.indexOf("#");i>=0&&(s.hash=e.substr(i),e=e.substr(0,i));let c=e.indexOf("?");c>=0&&(s.search=e.substr(c),e=e.substr(0,c)),e&&(s.pathname=e)}return s}function getUrlBasedHistory(e,s,i,c){c===void 0&&(c={});let{window:d=document.defaultView,v5Compat:h=!1}=c,_=d.history,g=Action.Pop,$=null,_e=lt();_e==null&&(_e=0,_.replaceState(_extends$1({},_.state,{idx:_e}),""));function lt(){return(_.state||{idx:null}).idx}function at(){g=Action.Pop;let zt=lt(),dt=zt==null?null:zt-_e;_e=zt,$&&$({action:g,location:pt.location,delta:dt})}function it(zt,dt){g=Action.Push;let ft=createLocation(pt.location,zt,dt);_e=lt()+1;let kt=getHistoryState(ft,_e),St=pt.createHref(ft);try{_.pushState(kt,"",St)}catch(Lt){if(Lt instanceof DOMException&&Lt.name==="DataCloneError")throw Lt;d.location.assign(St)}h&&$&&$({action:g,location:pt.location,delta:1})}function ct(zt,dt){g=Action.Replace;let ft=createLocation(pt.location,zt,dt);_e=lt();let kt=getHistoryState(ft,_e),St=pt.createHref(ft);_.replaceState(kt,"",St),h&&$&&$({action:g,location:pt.location,delta:0})}function mt(zt){let dt=d.location.origin!=="null"?d.location.origin:d.location.href,ft=typeof zt=="string"?zt:createPath(zt);return ft=ft.replace(/ $/,"%20"),invariant(dt,"No window.location.(origin|href) available to create URL for href: "+ft),new URL(ft,dt)}let pt={get action(){return g},get location(){return e(d,_)},listen(zt){if($)throw new Error("A history only accepts one active listener");return d.addEventListener(PopStateEventType,at),$=zt,()=>{d.removeEventListener(PopStateEventType,at),$=null}},createHref(zt){return s(d,zt)},createURL:mt,encodeLocation(zt){let dt=mt(zt);return{pathname:dt.pathname,search:dt.search,hash:dt.hash}},push:it,replace:ct,go(zt){return _.go(zt)}};return pt}var ResultType;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(ResultType||(ResultType={}));function matchRoutes(e,s,i){return i===void 0&&(i="/"),matchRoutesImpl(e,s,i,!1)}function matchRoutesImpl(e,s,i,c){let d=typeof s=="string"?parsePath(s):s,h=stripBasename(d.pathname||"/",i);if(h==null)return null;let _=flattenRoutes(e);rankRouteBranches(_);let g=null;for(let $=0;g==null&&$<_.length;++$){let _e=decodePath(h);g=matchRouteBranch(_[$],_e,c)}return g}function flattenRoutes(e,s,i,c){s===void 0&&(s=[]),i===void 0&&(i=[]),c===void 0&&(c="");let d=(h,_,g)=>{let $={relativePath:g===void 0?h.path||"":g,caseSensitive:h.caseSensitive===!0,childrenIndex:_,route:h};$.relativePath.startsWith("/")&&(invariant($.relativePath.startsWith(c),'Absolute route path "'+$.relativePath+'" nested under path '+('"'+c+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),$.relativePath=$.relativePath.slice(c.length));let _e=joinPaths([c,$.relativePath]),lt=i.concat($);h.children&&h.children.length>0&&(invariant(h.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+_e+'".')),flattenRoutes(h.children,s,lt,_e)),!(h.path==null&&!h.index)&&s.push({path:_e,score:computeScore(_e,h.index),routesMeta:lt})};return e.forEach((h,_)=>{var g;if(h.path===""||!((g=h.path)!=null&&g.includes("?")))d(h,_);else for(let $ of explodeOptionalSegments(h.path))d(h,_,$)}),s}function explodeOptionalSegments(e){let s=e.split("/");if(s.length===0)return[];let[i,...c]=s,d=i.endsWith("?"),h=i.replace(/\?$/,"");if(c.length===0)return d?[h,""]:[h];let _=explodeOptionalSegments(c.join("/")),g=[];return g.push(..._.map($=>$===""?h:[h,$].join("/"))),d&&g.push(..._),g.map($=>e.startsWith("/")&&$===""?"/":$)}function rankRouteBranches(e){e.sort((s,i)=>s.score!==i.score?i.score-s.score:compareIndexes(s.routesMeta.map(c=>c.childrenIndex),i.routesMeta.map(c=>c.childrenIndex)))}const paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=e=>e==="*";function computeScore(e,s){let i=e.split("/"),c=i.length;return i.some(isSplat)&&(c+=splatPenalty),s&&(c+=indexRouteValue),i.filter(d=>!isSplat(d)).reduce((d,h)=>d+(paramRe.test(h)?dynamicSegmentValue:h===""?emptySegmentValue:staticSegmentValue),c)}function compareIndexes(e,s){return e.length===s.length&&e.slice(0,-1).every((c,d)=>c===s[d])?e[e.length-1]-s[s.length-1]:0}function matchRouteBranch(e,s,i){let{routesMeta:c}=e,d={},h="/",_=[];for(let g=0;g<c.length;++g){let $=c[g],_e=g===c.length-1,lt=h==="/"?s:s.slice(h.length)||"/",at=matchPath({path:$.relativePath,caseSensitive:$.caseSensitive,end:_e},lt),it=$.route;if(!at&&_e&&i&&!c[c.length-1].route.index&&(at=matchPath({path:$.relativePath,caseSensitive:$.caseSensitive,end:!1},lt)),!at)return null;Object.assign(d,at.params),_.push({params:d,pathname:joinPaths([h,at.pathname]),pathnameBase:normalizePathname(joinPaths([h,at.pathnameBase])),route:it}),at.pathnameBase!=="/"&&(h=joinPaths([h,at.pathnameBase]))}return _}function matchPath(e,s){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[i,c]=compilePath(e.path,e.caseSensitive,e.end),d=s.match(i);if(!d)return null;let h=d[0],_=h.replace(/(.)\/+$/,"$1"),g=d.slice(1);return{params:c.reduce((_e,lt,at)=>{let{paramName:it,isOptional:ct}=lt;if(it==="*"){let pt=g[at]||"";_=h.slice(0,h.length-pt.length).replace(/(.)\/+$/,"$1")}const mt=g[at];return ct&&!mt?_e[it]=void 0:_e[it]=(mt||"").replace(/%2F/g,"/"),_e},{}),pathname:h,pathnameBase:_,pattern:e}}function compilePath(e,s,i){s===void 0&&(s=!1),i===void 0&&(i=!0),warning(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let c=[],d="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(_,g,$)=>(c.push({paramName:g,isOptional:$!=null}),$?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(c.push({paramName:"*"}),d+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?d+="\\/*$":e!==""&&e!=="/"&&(d+="(?:(?=\\/|$))"),[new RegExp(d,s?void 0:"i"),c]}function decodePath(e){try{return e.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return warning(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),e}}function stripBasename(e,s){if(s==="/")return e;if(!e.toLowerCase().startsWith(s.toLowerCase()))return null;let i=s.endsWith("/")?s.length-1:s.length,c=e.charAt(i);return c&&c!=="/"?null:e.slice(i)||"/"}function resolvePath(e,s){s===void 0&&(s="/");let{pathname:i,search:c="",hash:d=""}=typeof e=="string"?parsePath(e):e;return{pathname:i?i.startsWith("/")?i:resolvePathname(i,s):s,search:normalizeSearch(c),hash:normalizeHash(d)}}function resolvePathname(e,s){let i=s.replace(/\/+$/,"").split("/");return e.split("/").forEach(d=>{d===".."?i.length>1&&i.pop():d!=="."&&i.push(d)}),i.length>1?i.join("/"):"/"}function getInvalidPathError(e,s,i,c){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(c)+"].  Please separate it out to the ")+("`to."+i+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(e){return e.filter((s,i)=>i===0||s.route.path&&s.route.path.length>0)}function getResolveToMatches(e,s){let i=getPathContributingMatches(e);return s?i.map((c,d)=>d===i.length-1?c.pathname:c.pathnameBase):i.map(c=>c.pathnameBase)}function resolveTo(e,s,i,c){c===void 0&&(c=!1);let d;typeof e=="string"?d=parsePath(e):(d=_extends$1({},e),invariant(!d.pathname||!d.pathname.includes("?"),getInvalidPathError("?","pathname","search",d)),invariant(!d.pathname||!d.pathname.includes("#"),getInvalidPathError("#","pathname","hash",d)),invariant(!d.search||!d.search.includes("#"),getInvalidPathError("#","search","hash",d)));let h=e===""||d.pathname==="",_=h?"/":d.pathname,g;if(_==null)g=i;else{let at=s.length-1;if(!c&&_.startsWith("..")){let it=_.split("/");for(;it[0]==="..";)it.shift(),at-=1;d.pathname=it.join("/")}g=at>=0?s[at]:"/"}let $=resolvePath(d,g),_e=_&&_!=="/"&&_.endsWith("/"),lt=(h||_===".")&&i.endsWith("/");return!$.pathname.endsWith("/")&&(_e||lt)&&($.pathname+="/"),$}const joinPaths=e=>e.join("/").replace(/\/\/+/g,"/"),normalizePathname=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,normalizeHash=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function isRouteErrorResponse(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var i=arguments[s];for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&(e[c]=i[c])}return e},_extends.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect$1(e){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(e)}function useNavigate(){let{isDataRoute:e}=reactExports.useContext(RouteContext);return e?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant(!1);let e=reactExports.useContext(DataRouterContext),{basename:s,future:i,navigator:c}=reactExports.useContext(NavigationContext),{matches:d}=reactExports.useContext(RouteContext),{pathname:h}=useLocation(),_=JSON.stringify(getResolveToMatches(d,i.v7_relativeSplatPath)),g=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{g.current=!0}),reactExports.useCallback(function(_e,lt){if(lt===void 0&&(lt={}),!g.current)return;if(typeof _e=="number"){c.go(_e);return}let at=resolveTo(_e,JSON.parse(_),h,lt.relative==="path");e==null&&s!=="/"&&(at.pathname=at.pathname==="/"?s:joinPaths([s,at.pathname])),(lt.replace?c.replace:c.push)(at,lt.state,lt)},[s,c,_,h,e])}function useParams(){let{matches:e}=reactExports.useContext(RouteContext),s=e[e.length-1];return s?s.params:{}}function useRoutes(e,s){return useRoutesImpl(e,s)}function useRoutesImpl(e,s,i,c){useInRouterContext()||invariant(!1);let{navigator:d}=reactExports.useContext(NavigationContext),{matches:h}=reactExports.useContext(RouteContext),_=h[h.length-1],g=_?_.params:{};_&&_.pathname;let $=_?_.pathnameBase:"/";_&&_.route;let _e=useLocation(),lt;if(s){var at;let zt=typeof s=="string"?parsePath(s):s;$==="/"||(at=zt.pathname)!=null&&at.startsWith($)||invariant(!1),lt=zt}else lt=_e;let it=lt.pathname||"/",ct=it;if($!=="/"){let zt=$.replace(/^\//,"").split("/");ct="/"+it.replace(/^\//,"").split("/").slice(zt.length).join("/")}let mt=matchRoutes(e,{pathname:ct}),pt=_renderMatches(mt&&mt.map(zt=>Object.assign({},zt,{params:Object.assign({},g,zt.params),pathname:joinPaths([$,d.encodeLocation?d.encodeLocation(zt.pathname).pathname:zt.pathname]),pathnameBase:zt.pathnameBase==="/"?$:joinPaths([$,d.encodeLocation?d.encodeLocation(zt.pathnameBase).pathname:zt.pathnameBase])})),h,i,c);return s&&pt?reactExports.createElement(LocationContext.Provider,{value:{location:_extends({pathname:"/",search:"",hash:"",state:null,key:"default"},lt),navigationType:Action.Pop}},pt):pt}function DefaultErrorComponent(){let e=useRouteError(),s=isRouteErrorResponse(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),i=e instanceof Error?e.stack:null,d={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},s),i?reactExports.createElement("pre",{style:d},i):null,null)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,i){return i.location!==s.location||i.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:i.error,location:i.location,revalidation:s.revalidation||i.revalidation}}componentDidCatch(s,i){console.error("React Router caught the following error during render",s,i)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(e){let{routeContext:s,match:i,children:c}=e,d=reactExports.useContext(DataRouterContext);return d&&d.static&&d.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(d.staticContext._deepestRenderedBoundaryId=i.route.id),reactExports.createElement(RouteContext.Provider,{value:s},c)}function _renderMatches(e,s,i,c){var d;if(s===void 0&&(s=[]),i===void 0&&(i=null),c===void 0&&(c=null),e==null){var h;if(!i)return null;if(i.errors)e=i.matches;else if((h=c)!=null&&h.v7_partialHydration&&s.length===0&&!i.initialized&&i.matches.length>0)e=i.matches;else return null}let _=e,g=(d=i)==null?void 0:d.errors;if(g!=null){let lt=_.findIndex(at=>at.route.id&&(g==null?void 0:g[at.route.id])!==void 0);lt>=0||invariant(!1),_=_.slice(0,Math.min(_.length,lt+1))}let $=!1,_e=-1;if(i&&c&&c.v7_partialHydration)for(let lt=0;lt<_.length;lt++){let at=_[lt];if((at.route.HydrateFallback||at.route.hydrateFallbackElement)&&(_e=lt),at.route.id){let{loaderData:it,errors:ct}=i,mt=at.route.loader&&it[at.route.id]===void 0&&(!ct||ct[at.route.id]===void 0);if(at.route.lazy||mt){$=!0,_e>=0?_=_.slice(0,_e+1):_=[_[0]];break}}}return _.reduceRight((lt,at,it)=>{let ct,mt=!1,pt=null,zt=null;i&&(ct=g&&at.route.id?g[at.route.id]:void 0,pt=at.route.errorElement||defaultErrorElement,$&&(_e<0&&it===0?(mt=!0,zt=null):_e===it&&(mt=!0,zt=at.route.hydrateFallbackElement||null)));let dt=s.concat(_.slice(0,it+1)),ft=()=>{let kt;return ct?kt=pt:mt?kt=zt:at.route.Component?kt=reactExports.createElement(at.route.Component,null):at.route.element?kt=at.route.element:kt=lt,reactExports.createElement(RenderedRoute,{match:at,routeContext:{outlet:lt,matches:dt,isDataRoute:i!=null},children:kt})};return i&&(at.route.ErrorBoundary||at.route.errorElement||it===0)?reactExports.createElement(RenderErrorBoundary,{location:i.location,revalidation:i.revalidation,component:pt,error:ct,children:ft(),routeContext:{outlet:null,matches:dt,isDataRoute:!0}}):ft()},null)}var DataRouterHook$1=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(DataRouterHook$1||{}),DataRouterStateHook$1=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(DataRouterStateHook$1||{});function useDataRouterContext(e){let s=reactExports.useContext(DataRouterContext);return s||invariant(!1),s}function useDataRouterState(e){let s=reactExports.useContext(DataRouterStateContext);return s||invariant(!1),s}function useRouteContext(e){let s=reactExports.useContext(RouteContext);return s||invariant(!1),s}function useCurrentRouteId(e){let s=useRouteContext(),i=s.matches[s.matches.length-1];return i.route.id||invariant(!1),i.route.id}function useRouteError(){var e;let s=reactExports.useContext(RouteErrorContext),i=useDataRouterState(DataRouterStateHook$1.UseRouteError),c=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return s!==void 0?s:(e=i.errors)==null?void 0:e[c]}function useNavigateStable(){let{router:e}=useDataRouterContext(DataRouterHook$1.UseNavigateStable),s=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),i=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{i.current=!0}),reactExports.useCallback(function(d,h){h===void 0&&(h={}),i.current&&(typeof d=="number"?e.navigate(d):e.navigate(d,_extends({fromRouteId:s},h)))},[e,s])}function logV6DeprecationWarnings(e,s){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Route(e){invariant(!1)}function Router(e){let{basename:s="/",children:i=null,location:c,navigationType:d=Action.Pop,navigator:h,static:_=!1,future:g}=e;useInRouterContext()&&invariant(!1);let $=s.replace(/^\/*/,"/"),_e=reactExports.useMemo(()=>({basename:$,navigator:h,static:_,future:_extends({v7_relativeSplatPath:!1},g)}),[$,g,h,_]);typeof c=="string"&&(c=parsePath(c));let{pathname:lt="/",search:at="",hash:it="",state:ct=null,key:mt="default"}=c,pt=reactExports.useMemo(()=>{let zt=stripBasename(lt,$);return zt==null?null:{location:{pathname:zt,search:at,hash:it,state:ct,key:mt},navigationType:d}},[$,lt,at,it,ct,mt,d]);return pt==null?null:reactExports.createElement(NavigationContext.Provider,{value:_e},reactExports.createElement(LocationContext.Provider,{children:i,value:pt}))}function Routes(e){let{children:s,location:i}=e;return useRoutes(createRoutesFromChildren(s),i)}new Promise(()=>{});function createRoutesFromChildren(e,s){s===void 0&&(s=[]);let i=[];return reactExports.Children.forEach(e,(c,d)=>{if(!reactExports.isValidElement(c))return;let h=[...s,d];if(c.type===reactExports.Fragment){i.push.apply(i,createRoutesFromChildren(c.props.children,h));return}c.type!==Route&&invariant(!1),!c.props.index||!c.props.children||invariant(!1);let _={id:c.props.id||h.join("-"),caseSensitive:c.props.caseSensitive,element:c.props.element,Component:c.props.Component,index:c.props.index,path:c.props.path,loader:c.props.loader,action:c.props.action,errorElement:c.props.errorElement,ErrorBoundary:c.props.ErrorBoundary,hasErrorBoundary:c.props.ErrorBoundary!=null||c.props.errorElement!=null,shouldRevalidate:c.props.shouldRevalidate,handle:c.props.handle,lazy:c.props.lazy};c.props.children&&(_.children=createRoutesFromChildren(c.props.children,h)),i.push(_)}),i}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const REACT_ROUTER_VERSION="6";try{window.__reactRouterVersion=REACT_ROUTER_VERSION}catch{}const START_TRANSITION="startTransition",startTransitionImpl=React[START_TRANSITION];function BrowserRouter(e){let{basename:s,children:i,future:c,window:d}=e,h=reactExports.useRef();h.current==null&&(h.current=createBrowserHistory({window:d,v5Compat:!0}));let _=h.current,[g,$]=reactExports.useState({action:_.action,location:_.location}),{v7_startTransition:_e}=c||{},lt=reactExports.useCallback(at=>{_e&&startTransitionImpl?startTransitionImpl(()=>$(at)):$(at)},[$,_e]);return reactExports.useLayoutEffect(()=>_.listen(lt),[_,lt]),reactExports.useEffect(()=>logV6DeprecationWarnings(c),[c]),reactExports.createElement(Router,{basename:s,children:i,location:g.location,navigationType:g.action,navigator:_,future:c})}var DataRouterHook;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));const LanguageContext=reactExports.createContext(void 0),staticTranslations={hi:{"Choose Your Class":"  ","Select your grade to start learning":"       ","Choose a Subject":" ",Back:"","Coming Soon":"   ",Class:"","Start with Class 5":" 5   ","Learn Maths, Language, and more with AI-powered explanations in simple language. More classes coming soon!":"   AI-    ,          !","Your personal AI tutor that works without internet. Learn anytime, anywhere!":"  AI          ,   !","AI Sathi":"AI ","Works Offline":"   ","NCERT Aligned":"NCERT  ","Free Forever":" ","Powered by AI  Designed for Indian Students  Made with ":"AI                ","Hello! I'm your AI tutor. Ask me anything about your lesson or share your doubts!":"!   AI          !","Type your question...":"  ...","Maths Chapters":"  ","Numbers and Operations":"  ","Learn about numbers, addition, and subtraction":",       ","Shapes and Patterns":"  ","Identify shapes and create patterns":"     ",Measurement:"","Learn about length, weight, and capacity":",       ","Time and Money":"  ","Tell time and understand money":"     ","Science Chapters":"  ","The Human Body":" ","Learn about body parts and their functions":"         ","Plants Around Us":"    ","Understand plant parts and their importance":"       ","Animal Life":" ","Discover different animals and their habitats":"       ","Weather and Climate":"  ","Explore weather patterns and seasons":"       "},kn:{"Choose Your Class":"  ","Select your grade to start learning":"    ","Choose a Subject":" ",Back:"","Coming Soon":" ",Class:"","Start with Class 5":" 5  ","Learn Maths, Language, and more with AI-powered explanations in simple language. More classes coming soon!":"  AI-  ,    .    !","Your personal AI tutor that works without internet. Learn anytime, anywhere!":"      AI .  ,  !","AI Sathi":"AI ","Works Offline":"  ","NCERT Aligned":"NCERT ","Free Forever":" ","Powered by AI  Designed for Indian Students  Made with ":"AI          ","Hello! I'm your AI tutor. Ask me anything about your lesson or share your doubts!":"!   AI .      !","Type your question...":"  ...","Maths Chapters":" ","Numbers and Operations":"  ","Learn about numbers, addition, and subtraction":",     ","Shapes and Patterns":"  ","Identify shapes and create patterns":"    ",Measurement:"","Learn about length, weight, and capacity":",     ","Time and Money":"  ","Tell time and understand money":"    ","Science Chapters":" ","The Human Body":" ","Learn about body parts and their functions":"      ","Plants Around Us":"  ","Understand plant parts and their importance":"     ","Animal Life":" ","Discover different animals and their habitats":"     ","Weather and Climate":"  ","Explore weather patterns and seasons":"    "},en:{}},LanguageProvider=({children:e})=>{const[s,i]=reactExports.useState("en"),[c,d]=reactExports.useState(null),h=g=>{var $;return s==="en"?g:(($=staticTranslations[s])==null?void 0:$[g])||g},_=async(g,$)=>{const _e=$||s;if(_e==="en"||!g)return g;if(c)try{const it=[{role:"system",content:`Translate the following text to ${{hi:"Hindi",kn:"Kannada",en:"English"}[_e]}. Only provide the translation, nothing else.`},{role:"user",content:g}],mt=(await c.chat.completions.create({messages:it,max_tokens:200,temperature:.3})).choices[0].message.content||g,pt=mt.match(/Translation:\s*(.+)/s);return pt?pt[1].trim():mt.trim()}catch(lt){return console.error("Translation error:",lt),g}return staticTranslations[_e][g]||g};return jsxRuntimeExports.jsx(LanguageContext.Provider,{value:{language:s,setLanguage:i,translate:_,t:h,aiPipeline:c,setAiPipeline:d},children:e})},useLanguage=()=>{const e=reactExports.useContext(LanguageContext);if(e===void 0)throw new Error("useLanguage must be used within a LanguageProvider");return e};var PROGRESS_NAME="Progress",DEFAULT_MAX=100,[createProgressContext,createProgressScope]=createContextScope(PROGRESS_NAME),[ProgressProvider,useProgressContext]=createProgressContext(PROGRESS_NAME),Progress$1=reactExports.forwardRef((e,s)=>{const{__scopeProgress:i,value:c=null,max:d,getValueLabel:h=defaultGetValueLabel,..._}=e;(d||d===0)&&!isValidMaxNumber(d)&&console.error(getInvalidMaxError(`${d}`,"Progress"));const g=isValidMaxNumber(d)?d:DEFAULT_MAX;c!==null&&!isValidValueNumber(c,g)&&console.error(getInvalidValueError(`${c}`,"Progress"));const $=isValidValueNumber(c,g)?c:null,_e=isNumber($)?h($,g):void 0;return jsxRuntimeExports.jsx(ProgressProvider,{scope:i,value:$,max:g,children:jsxRuntimeExports.jsx(Primitive.div,{"aria-valuemax":g,"aria-valuemin":0,"aria-valuenow":isNumber($)?$:void 0,"aria-valuetext":_e,role:"progressbar","data-state":getProgressState($,g),"data-value":$??void 0,"data-max":g,..._,ref:s})})});Progress$1.displayName=PROGRESS_NAME;var INDICATOR_NAME="ProgressIndicator",ProgressIndicator=reactExports.forwardRef((e,s)=>{const{__scopeProgress:i,...c}=e,d=useProgressContext(INDICATOR_NAME,i);return jsxRuntimeExports.jsx(Primitive.div,{"data-state":getProgressState(d.value,d.max),"data-value":d.value??void 0,"data-max":d.max,...c,ref:s})});ProgressIndicator.displayName=INDICATOR_NAME;function defaultGetValueLabel(e,s){return`${Math.round(e/s*100)}%`}function getProgressState(e,s){return e==null?"indeterminate":e===s?"complete":"loading"}function isNumber(e){return typeof e=="number"}function isValidMaxNumber(e){return isNumber(e)&&!isNaN(e)&&e>0}function isValidValueNumber(e,s){return isNumber(e)&&!isNaN(e)&&e<=s&&e>=0}function getInvalidMaxError(e,s){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${s}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${DEFAULT_MAX}\`.`}function getInvalidValueError(e,s){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${s}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${DEFAULT_MAX} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Root=Progress$1,Indicator=ProgressIndicator;const Progress=reactExports.forwardRef(({className:e,value:s,...i},c)=>jsxRuntimeExports.jsx(Root,{ref:c,className:cn("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...i,children:jsxRuntimeExports.jsx(Indicator,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(s||0)}%)`}})}));Progress.displayName=Root.displayName;const backends=new Map,backendsSortedByPriority=[],registerBackend=(e,s,i)=>{if(s&&typeof s.init=="function"&&typeof s.createInferenceSessionHandler=="function"){const c=backends.get(e);if(c===void 0)backends.set(e,{backend:s,priority:i});else{if(c.priority>i)return;if(c.priority===i&&c.backend!==s)throw new Error(`cannot register backend "${e}" using priority ${i}`)}if(i>=0){const d=backendsSortedByPriority.indexOf(e);d!==-1&&backendsSortedByPriority.splice(d,1);for(let h=0;h<backendsSortedByPriority.length;h++)if(backends.get(backendsSortedByPriority[h]).priority<=i){backendsSortedByPriority.splice(h,0,e);return}backendsSortedByPriority.push(e)}return}throw new TypeError("not a valid backend")},tryResolveAndInitializeBackend=async e=>{const s=backends.get(e);if(!s)return"backend not found.";if(s.initialized)return s.backend;if(s.aborted)return s.error;{const i=!!s.initPromise;try{return i||(s.initPromise=s.backend.init(e)),await s.initPromise,s.initialized=!0,s.backend}catch(c){return i||(s.error=`${c}`,s.aborted=!0),s.error}finally{delete s.initPromise}}},resolveBackendAndExecutionProviders=async e=>{const s=e.executionProviders||[],i=s.map($=>typeof $=="string"?$:$.name),c=i.length===0?backendsSortedByPriority:i;let d;const h=[],_=new Set;for(const $ of c){const _e=await tryResolveAndInitializeBackend($);typeof _e=="string"?h.push({name:$,err:_e}):(d||(d=_e),d===_e&&_.add($))}if(!d)throw new Error(`no available backend found. ERR: ${h.map($=>`[${$.name}] ${$.err}`).join(", ")}`);for(const{name:$,err:_e}of h)i.includes($)&&console.warn(`removing requested execution provider "${$}" from session options because it is not available: ${_e}`);const g=s.filter($=>_.has(typeof $=="string"?$:$.name));return[d,new Proxy(e,{get:($,_e)=>_e==="executionProviders"?g:Reflect.get($,_e)})]},version="1.21.0";let logLevelValue="warning";const env$1={wasm:{},webgl:{},webgpu:{},versions:{common:version},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);logLevelValue=e}},get logLevel(){return logLevelValue}};Object.defineProperty(env$1,"logLevel",{enumerable:!0});const env=env$1,tensorToDataURL=(e,s)=>{const i=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);i.width=e.dims[3],i.height=e.dims[2];const c=i.getContext("2d");if(c!=null){let d,h;(s==null?void 0:s.tensorLayout)!==void 0&&s.tensorLayout==="NHWC"?(d=e.dims[2],h=e.dims[3]):(d=e.dims[3],h=e.dims[2]);const _=(s==null?void 0:s.format)!==void 0?s.format:"RGB",g=s==null?void 0:s.norm;let $,_e;g===void 0||g.mean===void 0?$=[255,255,255,255]:typeof g.mean=="number"?$=[g.mean,g.mean,g.mean,g.mean]:($=[g.mean[0],g.mean[1],g.mean[2],0],g.mean[3]!==void 0&&($[3]=g.mean[3])),g===void 0||g.bias===void 0?_e=[0,0,0,0]:typeof g.bias=="number"?_e=[g.bias,g.bias,g.bias,g.bias]:(_e=[g.bias[0],g.bias[1],g.bias[2],0],g.bias[3]!==void 0&&(_e[3]=g.bias[3]));const lt=h*d;let at=0,it=lt,ct=lt*2,mt=-1;_==="RGBA"?(at=0,it=lt,ct=lt*2,mt=lt*3):_==="RGB"?(at=0,it=lt,ct=lt*2):_==="RBG"&&(at=0,ct=lt,it=lt*2);for(let pt=0;pt<h;pt++)for(let zt=0;zt<d;zt++){const dt=(e.data[at++]-_e[0])*$[0],ft=(e.data[it++]-_e[1])*$[1],kt=(e.data[ct++]-_e[2])*$[2],St=mt===-1?255:(e.data[mt++]-_e[3])*$[3];c.fillStyle="rgba("+dt+","+ft+","+kt+","+St+")",c.fillRect(zt,pt,1,1)}if("toDataURL"in i)return i.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},tensorToImageData=(e,s)=>{const i=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");let c;if(i!=null){let d,h,_;(s==null?void 0:s.tensorLayout)!==void 0&&s.tensorLayout==="NHWC"?(d=e.dims[2],h=e.dims[1],_=e.dims[3]):(d=e.dims[3],h=e.dims[2],_=e.dims[1]);const g=s!==void 0&&s.format!==void 0?s.format:"RGB",$=s==null?void 0:s.norm;let _e,lt;$===void 0||$.mean===void 0?_e=[255,255,255,255]:typeof $.mean=="number"?_e=[$.mean,$.mean,$.mean,$.mean]:(_e=[$.mean[0],$.mean[1],$.mean[2],255],$.mean[3]!==void 0&&(_e[3]=$.mean[3])),$===void 0||$.bias===void 0?lt=[0,0,0,0]:typeof $.bias=="number"?lt=[$.bias,$.bias,$.bias,$.bias]:(lt=[$.bias[0],$.bias[1],$.bias[2],0],$.bias[3]!==void 0&&(lt[3]=$.bias[3]));const at=h*d;if(s!==void 0&&(s.format!==void 0&&_===4&&s.format!=="RGBA"||_===3&&s.format!=="RGB"&&s.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");const it=4;let ct=0,mt=1,pt=2,zt=3,dt=0,ft=at,kt=at*2,St=-1;g==="RGBA"?(dt=0,ft=at,kt=at*2,St=at*3):g==="RGB"?(dt=0,ft=at,kt=at*2):g==="RBG"&&(dt=0,kt=at,ft=at*2),c=i.createImageData(d,h);for(let Lt=0;Lt<h*d;ct+=it,mt+=it,pt+=it,zt+=it,Lt++)c.data[ct]=(e.data[dt++]-lt[0])*_e[0],c.data[mt]=(e.data[ft++]-lt[1])*_e[1],c.data[pt]=(e.data[kt++]-lt[2])*_e[2],c.data[zt]=St===-1?255:(e.data[St++]-lt[3])*_e[3]}else throw new Error("Can not access image data");return c},bufferToTensor=(e,s)=>{if(e===void 0)throw new Error("Image buffer must be defined");if(s.height===void 0||s.width===void 0)throw new Error("Image height and width must be defined");if(s.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");const{height:i,width:c}=s,d=s.norm??{mean:255,bias:0};let h,_;typeof d.mean=="number"?h=[d.mean,d.mean,d.mean,d.mean]:h=[d.mean[0],d.mean[1],d.mean[2],d.mean[3]??255],typeof d.bias=="number"?_=[d.bias,d.bias,d.bias,d.bias]:_=[d.bias[0],d.bias[1],d.bias[2],d.bias[3]??0];const g=s.format!==void 0?s.format:"RGBA",$=s.tensorFormat!==void 0&&s.tensorFormat!==void 0?s.tensorFormat:"RGB",_e=i*c,lt=$==="RGBA"?new Float32Array(_e*4):new Float32Array(_e*3);let at=4,it=0,ct=1,mt=2,pt=3,zt=0,dt=_e,ft=_e*2,kt=-1;g==="RGB"&&(at=3,it=0,ct=1,mt=2,pt=-1),$==="RGBA"?kt=_e*3:$==="RBG"?(zt=0,ft=_e,dt=_e*2):$==="BGR"&&(ft=0,dt=_e,zt=_e*2);for(let Lt=0;Lt<_e;Lt++,it+=at,mt+=at,ct+=at,pt+=at)lt[zt++]=(e[it]+_[0])/h[0],lt[dt++]=(e[ct]+_[1])/h[1],lt[ft++]=(e[mt]+_[2])/h[2],kt!==-1&&pt!==-1&&(lt[kt++]=(e[pt]+_[3])/h[3]);return $==="RGBA"?new Tensor$1("float32",lt,[1,4,i,c]):new Tensor$1("float32",lt,[1,3,i,c])},tensorFromImage=async(e,s)=>{const i=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,c=typeof ImageData<"u"&&e instanceof ImageData,d=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,h=typeof e=="string";let _,g=s??{};const $=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},_e=lt=>typeof HTMLCanvasElement<"u"&&lt instanceof HTMLCanvasElement||lt instanceof OffscreenCanvas?lt.getContext("2d"):null;if(i){const lt=$();lt.width=e.width,lt.height=e.height;const at=_e(lt);if(at!=null){let it=e.height,ct=e.width;if(s!==void 0&&s.resizedHeight!==void 0&&s.resizedWidth!==void 0&&(it=s.resizedHeight,ct=s.resizedWidth),s!==void 0){if(g=s,s.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");g.tensorFormat="RGBA",g.height=it,g.width=ct}else g.tensorFormat="RGBA",g.height=it,g.width=ct;at.drawImage(e,0,0),_=at.getImageData(0,0,ct,it).data}else throw new Error("Can not access image data")}else if(c){let lt,at;if(s!==void 0&&s.resizedWidth!==void 0&&s.resizedHeight!==void 0?(lt=s.resizedHeight,at=s.resizedWidth):(lt=e.height,at=e.width),s!==void 0&&(g=s),g.format="RGBA",g.height=lt,g.width=at,s!==void 0){const it=$();it.width=at,it.height=lt;const ct=_e(it);if(ct!=null)ct.putImageData(e,0,0),_=ct.getImageData(0,0,at,lt).data;else throw new Error("Can not access image data")}else _=e.data}else if(d){if(s===void 0)throw new Error("Please provide image config with format for Imagebitmap");const lt=$();lt.width=e.width,lt.height=e.height;const at=_e(lt);if(at!=null){const it=e.height,ct=e.width;return at.drawImage(e,0,0,ct,it),_=at.getImageData(0,0,ct,it).data,g.height=it,g.width=ct,bufferToTensor(_,g)}else throw new Error("Can not access image data")}else{if(h)return new Promise((lt,at)=>{const it=$(),ct=_e(it);if(!e||!ct)return at();const mt=new Image;mt.crossOrigin="Anonymous",mt.src=e,mt.onload=()=>{it.width=mt.width,it.height=mt.height,ct.drawImage(mt,0,0,it.width,it.height);const pt=ct.getImageData(0,0,it.width,it.height);g.height=it.height,g.width=it.width,lt(bufferToTensor(pt.data,g))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(_!==void 0)return bufferToTensor(_,g);throw new Error("Input data provided is not supported - aborted tensor creation")},tensorFromTexture=(e,s)=>{const{width:i,height:c,download:d,dispose:h}=s,_=[1,c,i,4];return new Tensor$1({location:"texture",type:"float32",texture:e,dims:_,download:d,dispose:h})},tensorFromGpuBuffer=(e,s)=>{const{dataType:i,dims:c,download:d,dispose:h}=s;return new Tensor$1({location:"gpu-buffer",type:i??"float32",gpuBuffer:e,dims:c,download:d,dispose:h})},tensorFromMLTensor=(e,s)=>{const{dataType:i,dims:c,download:d,dispose:h}=s;return new Tensor$1({location:"ml-tensor",type:i??"float32",mlTensor:e,dims:c,download:d,dispose:h})},tensorFromPinnedBuffer=(e,s,i)=>new Tensor$1({location:"cpu-pinned",type:e,data:s,dims:i??[s.length]}),NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]);let isTypedArrayChecked=!1;const checkTypedArray=()=>{if(!isTypedArrayChecked){isTypedArrayChecked=!0;const e=typeof BigInt64Array<"u"&&BigInt64Array.from,s=typeof BigUint64Array<"u"&&BigUint64Array.from,i=globalThis.Float16Array,c=typeof i<"u"&&i.from;e&&(NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.set("int64",BigInt64Array),NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.set(BigInt64Array,"int64")),s&&(NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.set("uint64",BigUint64Array),NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.set(BigUint64Array,"uint64")),c?(NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.set("float16",i),NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.set(i,"float16")):NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.set("float16",Uint16Array)}},calculateSize=e=>{let s=1;for(let i=0;i<e.length;i++){const c=e[i];if(typeof c!="number"||!Number.isSafeInteger(c))throw new TypeError(`dims[${i}] must be an integer, got: ${c}`);if(c<0)throw new RangeError(`dims[${i}] must be a non-negative integer, got: ${c}`);s*=c}return s},tensorReshape=(e,s)=>{switch(e.location){case"cpu":return new Tensor$1(e.type,e.data,s);case"cpu-pinned":return new Tensor$1({location:"cpu-pinned",data:e.data,type:e.type,dims:s});case"texture":return new Tensor$1({location:"texture",texture:e.texture,type:e.type,dims:s});case"gpu-buffer":return new Tensor$1({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:s});case"ml-tensor":return new Tensor$1({location:"ml-tensor",mlTensor:e.mlTensor,type:e.type,dims:s});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}};let Tensor$1=class{constructor(s,i,c){checkTypedArray();let d,h;if(typeof s=="object"&&"location"in s)switch(this.dataLocation=s.location,d=s.type,h=s.dims,s.location){case"cpu-pinned":{const g=NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.get(d);if(!g)throw new TypeError(`unsupported type "${d}" to create tensor from pinned buffer`);if(!(s.data instanceof g))throw new TypeError(`buffer should be of type ${g.name}`);this.cpuData=s.data;break}case"texture":{if(d!=="float32")throw new TypeError(`unsupported type "${d}" to create tensor from texture`);this.gpuTextureData=s.texture,this.downloader=s.download,this.disposer=s.dispose;break}case"gpu-buffer":{if(d!=="float32"&&d!=="float16"&&d!=="int32"&&d!=="int64"&&d!=="uint32"&&d!=="uint8"&&d!=="bool"&&d!=="uint4"&&d!=="int4")throw new TypeError(`unsupported type "${d}" to create tensor from gpu buffer`);this.gpuBufferData=s.gpuBuffer,this.downloader=s.download,this.disposer=s.dispose;break}case"ml-tensor":{if(d!=="float32"&&d!=="float16"&&d!=="int32"&&d!=="int64"&&d!=="uint32"&&d!=="uint64"&&d!=="int8"&&d!=="uint8"&&d!=="bool"&&d!=="uint4"&&d!=="int4")throw new TypeError(`unsupported type "${d}" to create tensor from MLTensor`);this.mlTensorData=s.mlTensor,this.downloader=s.download,this.disposer=s.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let g,$;if(typeof s=="string")if(d=s,$=c,s==="string"){if(!Array.isArray(i))throw new TypeError("A string tensor's data must be a string array.");g=i}else{const _e=NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.get(s);if(_e===void 0)throw new TypeError(`Unsupported tensor type: ${s}.`);if(Array.isArray(i)){if(s==="float16"&&_e===Uint16Array||s==="uint4"||s==="int4")throw new TypeError(`Creating a ${s} tensor from number array is not supported. Please use ${_e.name} as data.`);s==="uint64"||s==="int64"?g=_e.from(i,BigInt):g=_e.from(i)}else if(i instanceof _e)g=i;else if(i instanceof Uint8ClampedArray)if(s==="uint8")g=Uint8Array.from(i);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else if(s==="float16"&&i instanceof Uint16Array&&_e!==Uint16Array)g=new globalThis.Float16Array(i.buffer,i.byteOffset,i.length);else throw new TypeError(`A ${d} tensor's data must be type of ${_e}`)}else if($=i,Array.isArray(s)){if(s.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");const _e=typeof s[0];if(_e==="string")d="string",g=s;else if(_e==="boolean")d="bool",g=Uint8Array.from(s);else throw new TypeError(`Invalid element type of data array: ${_e}.`)}else if(s instanceof Uint8ClampedArray)d="uint8",g=Uint8Array.from(s);else{const _e=NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.get(s.constructor);if(_e===void 0)throw new TypeError(`Unsupported type for tensor data: ${s.constructor}.`);d=_e,g=s}if($===void 0)$=[g.length];else if(!Array.isArray($))throw new TypeError("A tensor's dims must be a number array");h=$,this.cpuData=g,this.dataLocation="cpu"}const _=calculateSize(h);if(this.cpuData&&_!==this.cpuData.length&&!((d==="uint4"||d==="int4")&&Math.ceil(_/2)===this.cpuData.length))throw new Error(`Tensor's size(${_}) does not match data length(${this.cpuData.length}).`);this.type=d,this.dims=h,this.size=_}static async fromImage(s,i){return tensorFromImage(s,i)}static fromTexture(s,i){return tensorFromTexture(s,i)}static fromGpuBuffer(s,i){return tensorFromGpuBuffer(s,i)}static fromMLTensor(s,i){return tensorFromMLTensor(s,i)}static fromPinnedBuffer(s,i,c){return tensorFromPinnedBuffer(s,i,c)}toDataURL(s){return tensorToDataURL(this,s)}toImageData(s){return tensorToImageData(this,s)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(s){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;const i=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=i,s&&this.disposer&&(this.disposer(),this.disposer=void 0),i}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(s){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return tensorReshape(this,s)}};const Tensor=Tensor$1,TRACE=(e,s)=>{(typeof env$1.trace>"u"?!env$1.wasm.trace:!env$1.trace)||console.timeStamp(`${e}::ORT::${s}`)},TRACE_FUNC=(e,s)=>{var d;const i=((d=new Error().stack)==null?void 0:d.split(/\r\n|\r|\n/g))||[];let c=!1;for(let h=0;h<i.length;h++){if(c&&!i[h].includes("TRACE_FUNC")){let _=`FUNC_${e}::${i[h].trim().split(" ")[1]}`;s&&(_+=`::${s}`),TRACE("CPU",_);return}i[h].includes("TRACE_FUNC")&&(c=!0)}},TRACE_FUNC_BEGIN=e=>{(typeof env$1.trace>"u"?!env$1.wasm.trace:!env$1.trace)||TRACE_FUNC("BEGIN",e)},TRACE_FUNC_END=e=>{(typeof env$1.trace>"u"?!env$1.wasm.trace:!env$1.trace)||TRACE_FUNC("END",e)};let InferenceSession$1=class VP{constructor(s){this.handler=s}async run(s,i,c){TRACE_FUNC_BEGIN();const d={};let h={};if(typeof s!="object"||s===null||s instanceof Tensor||Array.isArray(s))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let _=!0;if(typeof i=="object"){if(i===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(i instanceof Tensor)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(i)){if(i.length===0)throw new TypeError("'fetches' cannot be an empty array.");_=!1;for(const _e of i){if(typeof _e!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(_e)===-1)throw new RangeError(`'fetches' contains invalid output name: ${_e}.`);d[_e]=null}if(typeof c=="object"&&c!==null)h=c;else if(typeof c<"u")throw new TypeError("'options' must be an object.")}else{let _e=!1;const lt=Object.getOwnPropertyNames(i);for(const at of this.outputNames)if(lt.indexOf(at)!==-1){const it=i[at];(it===null||it instanceof Tensor)&&(_e=!0,_=!1,d[at]=it)}if(_e){if(typeof c=="object"&&c!==null)h=c;else if(typeof c<"u")throw new TypeError("'options' must be an object.")}else h=i}}else if(typeof i<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(const _e of this.inputNames)if(typeof s[_e]>"u")throw new Error(`input '${_e}' is missing in 'feeds'.`);if(_)for(const _e of this.outputNames)d[_e]=null;const g=await this.handler.run(s,d,h),$={};for(const _e in g)if(Object.hasOwnProperty.call(g,_e)){const lt=g[_e];lt instanceof Tensor?$[_e]=lt:$[_e]=new Tensor(lt.type,lt.data,lt.dims)}return TRACE_FUNC_END(),$}async release(){return this.handler.dispose()}static async create(s,i,c,d){TRACE_FUNC_BEGIN();let h,_={};if(typeof s=="string"){if(h=s,typeof i=="object"&&i!==null)_=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else if(s instanceof Uint8Array){if(h=s,typeof i=="object"&&i!==null)_=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else if(s instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&s instanceof SharedArrayBuffer){const lt=s;let at=0,it=s.byteLength;if(typeof i=="object"&&i!==null)_=i;else if(typeof i=="number"){if(at=i,!Number.isSafeInteger(at))throw new RangeError("'byteOffset' must be an integer.");if(at<0||at>=lt.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${lt.byteLength}).`);if(it=s.byteLength-at,typeof c=="number"){if(it=c,!Number.isSafeInteger(it))throw new RangeError("'byteLength' must be an integer.");if(it<=0||at+it>lt.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${lt.byteLength-at}].`);if(typeof d=="object"&&d!==null)_=d;else if(typeof d<"u")throw new TypeError("'options' must be an object.")}else if(typeof c<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof i<"u")throw new TypeError("'options' must be an object.");h=new Uint8Array(lt,at,it)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");const[g,$]=await resolveBackendAndExecutionProviders(_),_e=await g.createInferenceSessionHandler(h,$);return TRACE_FUNC_END(),new VP(_e)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}};const InferenceSession=InferenceSession$1,__WEBPACK_EXTERNAL_MODULE_onnxruntime_common_82b39e9f__=Object.freeze(Object.defineProperty({__proto__:null,InferenceSession,TRACE,TRACE_FUNC_BEGIN,TRACE_FUNC_END,Tensor,env,registerBackend},Symbol.toStringTag,{value:"Module"}));/*!
 * ONNX Runtime Web v1.22.0-dev.20250409-89f8206ba4
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */var zn=Object.defineProperty,Up=Object.getOwnPropertyDescriptor,Np=Object.getOwnPropertyNames,Vp=Object.prototype.hasOwnProperty,On=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(s,i)=>(typeof require<"u"?require:s)[i]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),U=(e,s)=>()=>(e&&(s=e(e=0)),s),Dt=(e,s)=>{for(var i in s)zn(e,i,{get:s[i],enumerable:!0})},Wp=(e,s,i,c)=>{if(s&&typeof s=="object"||typeof s=="function")for(let d of Np(s))!Vp.call(e,d)&&d!==i&&zn(e,d,{get:()=>s[d],enumerable:!(c=Up(s,d))||c.enumerable});return e},Ft=e=>Wp(zn({},"__esModule",{value:!0}),e),fr,vt,$t,Lp,Fi,Bn=U(()=>{fr=new Map,vt=[],$t=(e,s,i)=>{if(s&&typeof s.init=="function"&&typeof s.createInferenceSessionHandler=="function"){let c=fr.get(e);if(c===void 0)fr.set(e,{backend:s,priority:i});else{if(c.priority>i)return;if(c.priority===i&&c.backend!==s)throw new Error(`cannot register backend "${e}" using priority ${i}`)}if(i>=0){let d=vt.indexOf(e);d!==-1&&vt.splice(d,1);for(let h=0;h<vt.length;h++)if(fr.get(vt[h]).priority<=i){vt.splice(h,0,e);return}vt.push(e)}return}throw new TypeError("not a valid backend")},Lp=async e=>{let s=fr.get(e);if(!s)return"backend not found.";if(s.initialized)return s.backend;if(s.aborted)return s.error;{let i=!!s.initPromise;try{return i||(s.initPromise=s.backend.init(e)),await s.initPromise,s.initialized=!0,s.backend}catch(c){return i||(s.error=`${c}`,s.aborted=!0),s.error}finally{delete s.initPromise}}},Fi=async e=>{let s=e.executionProviders||[],i=s.map($=>typeof $=="string"?$:$.name),c=i.length===0?vt:i,d,h=[],_=new Set;for(let $ of c){let _e=await Lp($);typeof _e=="string"?h.push({name:$,err:_e}):(d||(d=_e),d===_e&&_.add($))}if(!d)throw new Error(`no available backend found. ERR: ${h.map($=>`[${$.name}] ${$.err}`).join(", ")}`);for(let{name:$,err:_e}of h)i.includes($)&&console.warn(`removing requested execution provider "${$}" from session options because it is not available: ${_e}`);let g=s.filter($=>_.has(typeof $=="string"?$:$.name));return[d,new Proxy(e,{get:($,_e)=>_e==="executionProviders"?g:Reflect.get($,_e)})]}}),qi=U(()=>{Bn()}),ji,Ki=U(()=>{ji="1.22.0-dev.20250409-89f8206ba4"}),Zi,Me,Dn=U(()=>{Ki(),Zi="warning",Me={wasm:{},webgl:{},webgpu:{},versions:{common:ji},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);Zi=e}},get logLevel(){return Zi}},Object.defineProperty(Me,"logLevel",{enumerable:!0})}),ge,Qi=U(()=>{Dn(),ge=Me}),Yi,Xi,Ji=U(()=>{Yi=(e,s)=>{let i=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);i.width=e.dims[3],i.height=e.dims[2];let c=i.getContext("2d");if(c!=null){let d,h;(s==null?void 0:s.tensorLayout)!==void 0&&s.tensorLayout==="NHWC"?(d=e.dims[2],h=e.dims[3]):(d=e.dims[3],h=e.dims[2]);let _=(s==null?void 0:s.format)!==void 0?s.format:"RGB",g=s==null?void 0:s.norm,$,_e;g===void 0||g.mean===void 0?$=[255,255,255,255]:typeof g.mean=="number"?$=[g.mean,g.mean,g.mean,g.mean]:($=[g.mean[0],g.mean[1],g.mean[2],0],g.mean[3]!==void 0&&($[3]=g.mean[3])),g===void 0||g.bias===void 0?_e=[0,0,0,0]:typeof g.bias=="number"?_e=[g.bias,g.bias,g.bias,g.bias]:(_e=[g.bias[0],g.bias[1],g.bias[2],0],g.bias[3]!==void 0&&(_e[3]=g.bias[3]));let lt=h*d,at=0,it=lt,ct=lt*2,mt=-1;_==="RGBA"?(at=0,it=lt,ct=lt*2,mt=lt*3):_==="RGB"?(at=0,it=lt,ct=lt*2):_==="RBG"&&(at=0,ct=lt,it=lt*2);for(let pt=0;pt<h;pt++)for(let zt=0;zt<d;zt++){let dt=(e.data[at++]-_e[0])*$[0],ft=(e.data[it++]-_e[1])*$[1],kt=(e.data[ct++]-_e[2])*$[2],St=mt===-1?255:(e.data[mt++]-_e[3])*$[3];c.fillStyle="rgba("+dt+","+ft+","+kt+","+St+")",c.fillRect(zt,pt,1,1)}if("toDataURL"in i)return i.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},Xi=(e,s)=>{let i=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),c;if(i!=null){let d,h,_;(s==null?void 0:s.tensorLayout)!==void 0&&s.tensorLayout==="NHWC"?(d=e.dims[2],h=e.dims[1],_=e.dims[3]):(d=e.dims[3],h=e.dims[2],_=e.dims[1]);let g=s!==void 0&&s.format!==void 0?s.format:"RGB",$=s==null?void 0:s.norm,_e,lt;$===void 0||$.mean===void 0?_e=[255,255,255,255]:typeof $.mean=="number"?_e=[$.mean,$.mean,$.mean,$.mean]:(_e=[$.mean[0],$.mean[1],$.mean[2],255],$.mean[3]!==void 0&&(_e[3]=$.mean[3])),$===void 0||$.bias===void 0?lt=[0,0,0,0]:typeof $.bias=="number"?lt=[$.bias,$.bias,$.bias,$.bias]:(lt=[$.bias[0],$.bias[1],$.bias[2],0],$.bias[3]!==void 0&&(lt[3]=$.bias[3]));let at=h*d;if(s!==void 0&&(s.format!==void 0&&_===4&&s.format!=="RGBA"||_===3&&s.format!=="RGB"&&s.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let it=4,ct=0,mt=1,pt=2,zt=3,dt=0,ft=at,kt=at*2,St=-1;g==="RGBA"?(dt=0,ft=at,kt=at*2,St=at*3):g==="RGB"?(dt=0,ft=at,kt=at*2):g==="RBG"&&(dt=0,kt=at,ft=at*2),c=i.createImageData(d,h);for(let Lt=0;Lt<h*d;ct+=it,mt+=it,pt+=it,zt+=it,Lt++)c.data[ct]=(e.data[dt++]-lt[0])*_e[0],c.data[mt]=(e.data[ft++]-lt[1])*_e[1],c.data[pt]=(e.data[kt++]-lt[2])*_e[2],c.data[zt]=St===-1?255:(e.data[St++]-lt[3])*_e[3]}else throw new Error("Can not access image data");return c}}),Mn,ea,ta,ra,na,oa,ia=U(()=>{hr(),Mn=(e,s)=>{if(e===void 0)throw new Error("Image buffer must be defined");if(s.height===void 0||s.width===void 0)throw new Error("Image height and width must be defined");if(s.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:i,width:c}=s,d=s.norm??{mean:255,bias:0},h,_;typeof d.mean=="number"?h=[d.mean,d.mean,d.mean,d.mean]:h=[d.mean[0],d.mean[1],d.mean[2],d.mean[3]??255],typeof d.bias=="number"?_=[d.bias,d.bias,d.bias,d.bias]:_=[d.bias[0],d.bias[1],d.bias[2],d.bias[3]??0];let g=s.format!==void 0?s.format:"RGBA",$=s.tensorFormat!==void 0&&s.tensorFormat!==void 0?s.tensorFormat:"RGB",_e=i*c,lt=$==="RGBA"?new Float32Array(_e*4):new Float32Array(_e*3),at=4,it=0,ct=1,mt=2,pt=3,zt=0,dt=_e,ft=_e*2,kt=-1;g==="RGB"&&(at=3,it=0,ct=1,mt=2,pt=-1),$==="RGBA"?kt=_e*3:$==="RBG"?(zt=0,ft=_e,dt=_e*2):$==="BGR"&&(ft=0,dt=_e,zt=_e*2);for(let St=0;St<_e;St++,it+=at,mt+=at,ct+=at,pt+=at)lt[zt++]=(e[it]+_[0])/h[0],lt[dt++]=(e[ct]+_[1])/h[1],lt[ft++]=(e[mt]+_[2])/h[2],kt!==-1&&pt!==-1&&(lt[kt++]=(e[pt]+_[3])/h[3]);return $==="RGBA"?new Pe("float32",lt,[1,4,i,c]):new Pe("float32",lt,[1,3,i,c])},ea=async(e,s)=>{let i=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,c=typeof ImageData<"u"&&e instanceof ImageData,d=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,h=typeof e=="string",_,g=s??{},$=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},_e=lt=>typeof HTMLCanvasElement<"u"&&lt instanceof HTMLCanvasElement||lt instanceof OffscreenCanvas?lt.getContext("2d"):null;if(i){let lt=$();lt.width=e.width,lt.height=e.height;let at=_e(lt);if(at!=null){let it=e.height,ct=e.width;if(s!==void 0&&s.resizedHeight!==void 0&&s.resizedWidth!==void 0&&(it=s.resizedHeight,ct=s.resizedWidth),s!==void 0){if(g=s,s.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");g.tensorFormat="RGBA",g.height=it,g.width=ct}else g.tensorFormat="RGBA",g.height=it,g.width=ct;at.drawImage(e,0,0),_=at.getImageData(0,0,ct,it).data}else throw new Error("Can not access image data")}else if(c){let lt,at;if(s!==void 0&&s.resizedWidth!==void 0&&s.resizedHeight!==void 0?(lt=s.resizedHeight,at=s.resizedWidth):(lt=e.height,at=e.width),s!==void 0&&(g=s),g.format="RGBA",g.height=lt,g.width=at,s!==void 0){let it=$();it.width=at,it.height=lt;let ct=_e(it);if(ct!=null)ct.putImageData(e,0,0),_=ct.getImageData(0,0,at,lt).data;else throw new Error("Can not access image data")}else _=e.data}else if(d){if(s===void 0)throw new Error("Please provide image config with format for Imagebitmap");let lt=$();lt.width=e.width,lt.height=e.height;let at=_e(lt);if(at!=null){let it=e.height,ct=e.width;return at.drawImage(e,0,0,ct,it),_=at.getImageData(0,0,ct,it).data,g.height=it,g.width=ct,Mn(_,g)}else throw new Error("Can not access image data")}else{if(h)return new Promise((lt,at)=>{let it=$(),ct=_e(it);if(!e||!ct)return at();let mt=new Image;mt.crossOrigin="Anonymous",mt.src=e,mt.onload=()=>{it.width=mt.width,it.height=mt.height,ct.drawImage(mt,0,0,it.width,it.height);let pt=ct.getImageData(0,0,it.width,it.height);g.height=it.height,g.width=it.width,lt(Mn(pt.data,g))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(_!==void 0)return Mn(_,g);throw new Error("Input data provided is not supported - aborted tensor creation")},ta=(e,s)=>{let{width:i,height:c,download:d,dispose:h}=s,_=[1,c,i,4];return new Pe({location:"texture",type:"float32",texture:e,dims:_,download:d,dispose:h})},ra=(e,s)=>{let{dataType:i,dims:c,download:d,dispose:h}=s;return new Pe({location:"gpu-buffer",type:i??"float32",gpuBuffer:e,dims:c,download:d,dispose:h})},na=(e,s)=>{let{dataType:i,dims:c,download:d,dispose:h}=s;return new Pe({location:"ml-tensor",type:i??"float32",mlTensor:e,dims:c,download:d,dispose:h})},oa=(e,s,i)=>new Pe({location:"cpu-pinned",type:e,data:s,dims:i??[s.length]})}),xt,qt,aa,sa,ua=U(()=>{xt=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),qt=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),aa=!1,sa=()=>{if(!aa){aa=!0;let e=typeof BigInt64Array<"u"&&BigInt64Array.from,s=typeof BigUint64Array<"u"&&BigUint64Array.from,i=globalThis.Float16Array,c=typeof i<"u"&&i.from;e&&(xt.set("int64",BigInt64Array),qt.set(BigInt64Array,"int64")),s&&(xt.set("uint64",BigUint64Array),qt.set(BigUint64Array,"uint64")),c?(xt.set("float16",i),qt.set(i,"float16")):xt.set("float16",Uint16Array)}}}),da,la,ca=U(()=>{hr(),da=e=>{let s=1;for(let i=0;i<e.length;i++){let c=e[i];if(typeof c!="number"||!Number.isSafeInteger(c))throw new TypeError(`dims[${i}] must be an integer, got: ${c}`);if(c<0)throw new RangeError(`dims[${i}] must be a non-negative integer, got: ${c}`);s*=c}return s},la=(e,s)=>{switch(e.location){case"cpu":return new Pe(e.type,e.data,s);case"cpu-pinned":return new Pe({location:"cpu-pinned",data:e.data,type:e.type,dims:s});case"texture":return new Pe({location:"texture",texture:e.texture,type:e.type,dims:s});case"gpu-buffer":return new Pe({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:s});case"ml-tensor":return new Pe({location:"ml-tensor",mlTensor:e.mlTensor,type:e.type,dims:s});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}}}),Pe,hr=U(()=>{Ji(),ia(),ua(),ca(),Pe=class{constructor(e,s,i){sa();let c,d;if(typeof e=="object"&&"location"in e)switch(this.dataLocation=e.location,c=e.type,d=e.dims,e.location){case"cpu-pinned":{let _=xt.get(c);if(!_)throw new TypeError(`unsupported type "${c}" to create tensor from pinned buffer`);if(!(e.data instanceof _))throw new TypeError(`buffer should be of type ${_.name}`);this.cpuData=e.data;break}case"texture":{if(c!=="float32")throw new TypeError(`unsupported type "${c}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break}case"gpu-buffer":{if(c!=="float32"&&c!=="float16"&&c!=="int32"&&c!=="int64"&&c!=="uint32"&&c!=="uint8"&&c!=="bool"&&c!=="uint4"&&c!=="int4")throw new TypeError(`unsupported type "${c}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break}case"ml-tensor":{if(c!=="float32"&&c!=="float16"&&c!=="int32"&&c!=="int64"&&c!=="uint32"&&c!=="uint64"&&c!=="int8"&&c!=="uint8"&&c!=="bool"&&c!=="uint4"&&c!=="int4")throw new TypeError(`unsupported type "${c}" to create tensor from MLTensor`);this.mlTensorData=e.mlTensor,this.downloader=e.download,this.disposer=e.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let _,g;if(typeof e=="string")if(c=e,g=i,e==="string"){if(!Array.isArray(s))throw new TypeError("A string tensor's data must be a string array.");_=s}else{let $=xt.get(e);if($===void 0)throw new TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(s)){if(e==="float16"&&$===Uint16Array||e==="uint4"||e==="int4")throw new TypeError(`Creating a ${e} tensor from number array is not supported. Please use ${$.name} as data.`);e==="uint64"||e==="int64"?_=$.from(s,BigInt):_=$.from(s)}else if(s instanceof $)_=s;else if(s instanceof Uint8ClampedArray)if(e==="uint8")_=Uint8Array.from(s);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else if(e==="float16"&&s instanceof Uint16Array&&$!==Uint16Array)_=new globalThis.Float16Array(s.buffer,s.byteOffset,s.length);else throw new TypeError(`A ${c} tensor's data must be type of ${$}`)}else if(g=s,Array.isArray(e)){if(e.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let $=typeof e[0];if($==="string")c="string",_=e;else if($==="boolean")c="bool",_=Uint8Array.from(e);else throw new TypeError(`Invalid element type of data array: ${$}.`)}else if(e instanceof Uint8ClampedArray)c="uint8",_=Uint8Array.from(e);else{let $=qt.get(e.constructor);if($===void 0)throw new TypeError(`Unsupported type for tensor data: ${e.constructor}.`);c=$,_=e}if(g===void 0)g=[_.length];else if(!Array.isArray(g))throw new TypeError("A tensor's dims must be a number array");d=g,this.cpuData=_,this.dataLocation="cpu"}let h=da(d);if(this.cpuData&&h!==this.cpuData.length&&!((c==="uint4"||c==="int4")&&Math.ceil(h/2)===this.cpuData.length))throw new Error(`Tensor's size(${h}) does not match data length(${this.cpuData.length}).`);this.type=c,this.dims=d,this.size=h}static async fromImage(e,s){return ea(e,s)}static fromTexture(e,s){return ta(e,s)}static fromGpuBuffer(e,s){return ra(e,s)}static fromMLTensor(e,s){return na(e,s)}static fromPinnedBuffer(e,s,i){return oa(e,s,i)}toDataURL(e){return Yi(this,e)}toImageData(e){return Xi(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let s=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=s,e&&this.disposer&&(this.disposer(),this.disposer=void 0),s}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return la(this,e)}}}),Ge,Rn=U(()=>{hr(),Ge=Pe}),gr,pa,Re,Oe,Un=U(()=>{Dn(),gr=(e,s)=>{(typeof Me.trace>"u"?!Me.wasm.trace:!Me.trace)||console.timeStamp(`${e}::ORT::${s}`)},pa=(e,s)=>{var d;let i=((d=new Error().stack)==null?void 0:d.split(/\r\n|\r|\n/g))||[],c=!1;for(let h=0;h<i.length;h++){if(c&&!i[h].includes("TRACE_FUNC")){let _=`FUNC_${e}::${i[h].trim().split(" ")[1]}`;s&&(_+=`::${s}`),gr("CPU",_);return}i[h].includes("TRACE_FUNC")&&(c=!0)}},Re=e=>{(typeof Me.trace>"u"?!Me.wasm.trace:!Me.trace)||pa("BEGIN",e)},Oe=e=>{(typeof Me.trace>"u"?!Me.wasm.trace:!Me.trace)||pa("END",e)}}),br,ma=U(()=>{Bn(),Rn(),Un(),br=class WP{constructor(s){this.handler=s}async run(s,i,c){Re();let d={},h={};if(typeof s!="object"||s===null||s instanceof Ge||Array.isArray(s))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let _=!0;if(typeof i=="object"){if(i===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(i instanceof Ge)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(i)){if(i.length===0)throw new TypeError("'fetches' cannot be an empty array.");_=!1;for(let _e of i){if(typeof _e!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(_e)===-1)throw new RangeError(`'fetches' contains invalid output name: ${_e}.`);d[_e]=null}if(typeof c=="object"&&c!==null)h=c;else if(typeof c<"u")throw new TypeError("'options' must be an object.")}else{let _e=!1,lt=Object.getOwnPropertyNames(i);for(let at of this.outputNames)if(lt.indexOf(at)!==-1){let it=i[at];(it===null||it instanceof Ge)&&(_e=!0,_=!1,d[at]=it)}if(_e){if(typeof c=="object"&&c!==null)h=c;else if(typeof c<"u")throw new TypeError("'options' must be an object.")}else h=i}}else if(typeof i<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let _e of this.inputNames)if(typeof s[_e]>"u")throw new Error(`input '${_e}' is missing in 'feeds'.`);if(_)for(let _e of this.outputNames)d[_e]=null;let g=await this.handler.run(s,d,h),$={};for(let _e in g)if(Object.hasOwnProperty.call(g,_e)){let lt=g[_e];lt instanceof Ge?$[_e]=lt:$[_e]=new Ge(lt.type,lt.data,lt.dims)}return Oe(),$}async release(){return this.handler.dispose()}static async create(s,i,c,d){Re();let h,_={};if(typeof s=="string"){if(h=s,typeof i=="object"&&i!==null)_=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else if(s instanceof Uint8Array){if(h=s,typeof i=="object"&&i!==null)_=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else if(s instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&s instanceof SharedArrayBuffer){let lt=s,at=0,it=s.byteLength;if(typeof i=="object"&&i!==null)_=i;else if(typeof i=="number"){if(at=i,!Number.isSafeInteger(at))throw new RangeError("'byteOffset' must be an integer.");if(at<0||at>=lt.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${lt.byteLength}).`);if(it=s.byteLength-at,typeof c=="number"){if(it=c,!Number.isSafeInteger(it))throw new RangeError("'byteLength' must be an integer.");if(it<=0||at+it>lt.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${lt.byteLength-at}].`);if(typeof d=="object"&&d!==null)_=d;else if(typeof d<"u")throw new TypeError("'options' must be an object.")}else if(typeof c<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof i<"u")throw new TypeError("'options' must be an object.");h=new Uint8Array(lt,at,it)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[g,$]=await Fi(_),_e=await g.createInferenceSessionHandler(h,$);return Oe(),new WP(_e)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}get inputMetadata(){return this.handler.inputMetadata}get outputMetadata(){return this.handler.outputMetadata}}}),Gp,fa=U(()=>{ma(),Gp=br}),ha=U(()=>{}),ga=U(()=>{}),ba=U(()=>{}),ya=U(()=>{}),Nn={};Dt(Nn,{InferenceSession:()=>Gp,TRACE:()=>gr,TRACE_FUNC_BEGIN:()=>Re,TRACE_FUNC_END:()=>Oe,Tensor:()=>Ge,env:()=>ge,registerBackend:()=>$t});var We=U(()=>{qi(),Qi(),fa(),Rn(),ha(),ga(),Un(),ba(),ya()}),yr=U(()=>{}),$a={};Dt($a,{default:()=>Hp});var wa,va,Hp,xa=U(()=>{var e;Vn(),ht(),_r(),wa="ort-wasm-proxy-worker",va=((e=globalThis.self)==null?void 0:e.name)===wa,va&&(self.onmessage=s=>{let{type:i,in:c}=s.data;try{switch(i){case"init-wasm":wr(c.wasm).then(()=>{vr(c).then(()=>{postMessage({type:i})},d=>{postMessage({type:i,err:d})})},d=>{postMessage({type:i,err:d})});break;case"init-ep":{let{epName:d,env:h}=c;$r(h,d).then(()=>{postMessage({type:i})},_=>{postMessage({type:i,err:_})});break}case"copy-from":{let{buffer:d}=c,h=jt(d);postMessage({type:i,out:h});break}case"create":{let{model:d,options:h}=c;xr(d,h).then(_=>{postMessage({type:i,out:_})},_=>{postMessage({type:i,err:_})});break}case"release":Sr(c),postMessage({type:i});break;case"run":{let{sessionId:d,inputIndices:h,inputs:_,outputIndices:g,options:$}=c;Tr(d,h,_,g,new Array(g.length).fill(null),$).then(_e=>{_e.some(lt=>lt[3]!=="cpu")?postMessage({type:i,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:i,out:_e},Cr([..._,..._e]))},_e=>{postMessage({type:i,err:_e})});break}case"end-profiling":Ir(c),postMessage({type:i});break;default:}}catch(d){postMessage({type:i,err:d})}}),Hp=va?null:s=>new Worker(s??Ue,{type:"module",name:wa})}),Ta={};Dt(Ta,{default:()=>Fp});var Wn,Sa,Fp,qp,Ia=U(()=>{var e,s;Sa=(Wn=import.meta.url,async function(i={}){var Ry;var c,d,h=i,_=new Promise((Pt,sr)=>{c=Pt,d=sr}),g=typeof window=="object",$=typeof WorkerGlobalScope<"u",_e=$&&((Ry=self.name)==null?void 0:Ry.startsWith("em-pthread"));h.mountExternalData=(Pt,sr)=>{Pt.startsWith("./")&&(Pt=Pt.substring(2)),(h.Eb||(h.Eb=new Map)).set(Pt,sr)},h.unmountExternalData=()=>{delete h.Eb};var lt=globalThis.SharedArrayBuffer??new WebAssembly.Memory({initial:0,maximum:0,pc:!0}).buffer.constructor;let at=Pt=>async(...sr)=>{var pr;try{if(h.Fb)throw Error("Session already started");let xn=h.Fb={dc:sr[0],errors:[]},Pn=await Pt(...sr);if(h.Fb!==xn)throw Error("Session mismatch");(pr=h.Jb)==null||pr.flush();let Bo=xn.errors;if(0<Bo.length){let rp=await Promise.all(Bo);if(rp=rp.filter(cp=>cp),0<rp.length)throw Error(rp.join(`
`))}return Pn}finally{h.Fb=null}};h.jsepInit=(Pt,sr)=>{if(Pt==="webgpu"){[h.Jb,h.Ub,h.Yb,h.Kb,h.Xb,h.jb,h.Zb,h.ac,h.Vb,h.Wb,h.$b]=sr;let pr=h.Jb;h.jsepRegisterBuffer=(xn,Pn,Bo,rp)=>pr.registerBuffer(xn,Pn,Bo,rp),h.jsepGetBuffer=xn=>pr.getBuffer(xn),h.jsepCreateDownloader=(xn,Pn,Bo)=>pr.createDownloader(xn,Pn,Bo),h.jsepOnCreateSession=xn=>{pr.onCreateSession(xn)},h.jsepOnReleaseSession=xn=>{pr.onReleaseSession(xn)},h.jsepOnRunStart=xn=>pr.onRunStart(xn),h.bc=(xn,Pn)=>{pr.upload(xn,Pn)}}else if(Pt==="webnn"){let pr=sr[0];[h.nc,h.Nb,h.webnnEnsureTensor,h.Ob,h.webnnDownloadTensor]=sr.slice(1),h.webnnReleaseTensorId=h.Nb,h.webnnUploadTensor=h.Ob,h.webnnOnRunStart=xn=>pr.onRunStart(xn),h.webnnOnRunEnd=pr.onRunEnd.bind(pr),h.webnnRegisterMLContext=(xn,Pn)=>{pr.registerMLContext(xn,Pn)},h.webnnOnReleaseSession=xn=>{pr.onReleaseSession(xn)},h.webnnCreateMLTensorDownloader=(xn,Pn)=>pr.createMLTensorDownloader(xn,Pn),h.webnnRegisterMLTensor=(xn,Pn,Bo,rp)=>pr.registerMLTensor(xn,Pn,Bo,rp),h.webnnCreateMLContext=xn=>pr.createMLContext(xn),h.webnnRegisterMLConstant=(xn,Pn,Bo,rp,cp,vp)=>pr.registerMLConstant(xn,Pn,Bo,rp,cp,h.Eb,vp),h.webnnRegisterGraphInput=pr.registerGraphInput.bind(pr),h.webnnIsGraphInput=pr.isGraphInput.bind(pr),h.webnnCreateTemporaryTensor=pr.createTemporaryTensor.bind(pr),h.webnnIsInt64Supported=pr.isInt64Supported.bind(pr)}};let it=()=>{let Pt=(sr,pr,xn)=>(...Pn)=>{let Bo=Z_,rp=pr==null?void 0:pr();Pn=sr(...Pn);let cp=pr==null?void 0:pr();return rp!==cp&&(sr=cp,xn(rp),pr=xn=null),Z_!=Bo?new Promise((vp,Sp)=>{$x={resolve:vp,reject:Sp}}):Pn};(()=>{for(let sr of["_OrtAppendExecutionProvider","_OrtCreateSession","_OrtRun","_OrtRunWithBinding","_OrtBindInput"])h[sr]=Pt(h[sr],()=>h[sr],pr=>h[sr]=pr)})(),at!==void 0&&(h._OrtRun=at(h._OrtRun),h._OrtRunWithBinding=at(h._OrtRunWithBinding)),it=void 0};h.asyncInit=()=>{it==null||it()};var ct,mt,pt=Object.assign({},h),zt=(Pt,sr)=>{throw sr},dt="";(g||$)&&($?dt=self.location.href:typeof document<"u"&&document.currentScript&&(dt=document.currentScript.src),Wn&&(dt=Wn),dt=dt.startsWith("blob:")?"":dt.slice(0,dt.replace(/[?#].*/,"").lastIndexOf("/")+1),$&&(mt=Pt=>{var sr=new XMLHttpRequest;return sr.open("GET",Pt,!1),sr.responseType="arraybuffer",sr.send(null),new Uint8Array(sr.response)}),ct=async Pt=>{if(or(Pt))return new Promise((pr,xn)=>{var Pn=new XMLHttpRequest;Pn.open("GET",Pt,!0),Pn.responseType="arraybuffer",Pn.onload=()=>{Pn.status==200||Pn.status==0&&Pn.response?pr(Pn.response):xn(Pn.status)},Pn.onerror=xn,Pn.send(null)});var sr=await fetch(Pt,{credentials:"same-origin"});if(sr.ok)return sr.arrayBuffer();throw Error(sr.status+" : "+sr.url)});var ft=console.log.bind(console),kt=console.error.bind(console),St=ft,Lt=kt;Object.assign(h,pt),pt=null;var Gt,Bt,nr,cr,ur,yn,hn,_n,gn,vn,Tn,kn,bn,Sn=h.wasmBinary,fn=!1,or=Pt=>Pt.startsWith("file://");function lr(){return Gt.buffer!=cr.buffer&&mr(),cr}function pn(){return Gt.buffer!=cr.buffer&&mr(),ur}function Cn(){return Gt.buffer!=cr.buffer&&mr(),yn}function Lo(){return Gt.buffer!=cr.buffer&&mr(),hn}function Mo(){return Gt.buffer!=cr.buffer&&mr(),_n}function Ro(){return Gt.buffer!=cr.buffer&&mr(),gn}function qo(){return Gt.buffer!=cr.buffer&&mr(),vn}function tp(){return Gt.buffer!=cr.buffer&&mr(),bn}if(_e){let Pt=function(sr){try{var pr=sr.data,xn=pr.Bb;if(xn==="load"){let Pn=[];self.onmessage=Bo=>Pn.push(Bo),self.startWorker=()=>{postMessage({Bb:"loaded"});for(let Bo of Pn)Pt(Bo);self.onmessage=Pt};for(let Bo of pr.Rb)h[Bo]&&!h[Bo].proxy||(h[Bo]=(...rp)=>{postMessage({Bb:"callHandler",Qb:Bo,args:rp})},Bo=="print"&&(St=h[Bo]),Bo=="printErr"&&(Lt=h[Bo]));Gt=pr.kc,mr(),Wo(pr.lc)}else if(xn==="run"){zx(pr.Ab),Sw(pr.Ab,0,0,1,0,0),hx(),Uo(pr.Ab),En||(Ty(),En=!0);try{qx(pr.fc,pr.Hb)}catch(Pn){if(Pn!="unwind")throw Pn}}else pr.target!=="setimmediate"&&(xn==="checkMailbox"?En&&bu():xn&&(Lt(`worker: received unknown command ${xn}`),Lt(pr)))}catch(Pn){throw ky(),Pn}};var Wo,En=!1;Lt=function(...sr){sr=sr.join(" "),console.error(sr)},self.alert=function(...sr){postMessage({Bb:"alert",text:sr.join(" "),ic:dw()})},self.onunhandledrejection=sr=>{throw sr.reason||sr},self.onmessage=Pt}function mr(){var Pt=Gt.buffer;h.HEAP8=cr=new Int8Array(Pt),h.HEAP16=yn=new Int16Array(Pt),h.HEAPU8=ur=new Uint8Array(Pt),h.HEAPU16=hn=new Uint16Array(Pt),h.HEAP32=_n=new Int32Array(Pt),h.HEAPU32=gn=new Uint32Array(Pt),h.HEAPF32=vn=new Float32Array(Pt),h.HEAPF64=bn=new Float64Array(Pt),h.HEAP64=Tn=new BigInt64Array(Pt),h.HEAPU64=kn=new BigUint64Array(Pt)}function Do(){_e?startWorker(h):Op.Ca()}_e||(Gt=new WebAssembly.Memory({initial:256,maximum:65536,shared:!0}),mr());var Go,Jo=0,_i=null;function Ho(){if(--Jo==0&&_i){var Pt=_i;_i=null,Pt()}}function _c(Pt){throw Lt(Pt="Aborted("+Pt+")"),fn=!0,Pt=new WebAssembly.RuntimeError(Pt+". Build with -sASSERTIONS for more info."),d(Pt),Pt}function Qo(){return{a:{L:_p,Aa:lp,b:X_,$:r_,A:ir,pa:In,X:No,Z:Yo,qa:sp,na:Cp,ga:n_,ma:zp,J:i_,Y:kp,V:h_,oa:$_,W:xx,va:lx,E:Xx,Q:jx,O:wx,D:pp,u:$p,r:P_,P:nw,z:dr,R:$n,ja:jo,T:mp,aa:xp,M:Tp,F:s_,ia:Uo,sa:v_,t:T_,Ba:Y_,w:Lx,o:V_,l:Mx,c:Bx,n:Yx,j:Uy,v:Vy,p:cw,f:Wy,s:Gy,m:Hy,e:Ky,k:qy,i:uw,g:Qy,d:Xy,da:Yy,ea:Jy,fa:Zy,ba:Ww,ca:hy,N:Gw,xa:Fv,ua:_y,h:rv,C:nv,G:sv,ta:tv,x:ov,ra:av,U:iv,q:ev,y:lv,K:cv,S:gy,za:uv,ya:xy,ka:wy,la:pv,_:Ap,B:yy,I:qw,ha:vy,H:by,a:Gt,wa:fp}}}var ep={829644:(Pt,sr,pr,xn,Pn)=>{if(h===void 0||!h.Eb)return 1;if((Pt=m_(Number(Pt>>>0))).startsWith("./")&&(Pt=Pt.substring(2)),!(Pt=h.Eb.get(Pt)))return 2;if(sr=Number(sr>>>0),pr=Number(pr>>>0),xn=Number(xn>>>0),sr+pr>Pt.byteLength)return 3;try{let Bo=Pt.subarray(sr,sr+pr);switch(Pn){case 0:pn().set(Bo,xn>>>0);break;case 1:h.mc?h.mc(xn,Bo):h.bc(xn,Bo);break;default:return 4}return 0}catch{return 4}},830468:(Pt,sr,pr)=>{h.Ob(Pt,pn().subarray(sr>>>0,sr+pr>>>0))},830532:()=>h.nc(),830574:Pt=>{h.Nb(Pt)},830611:()=>{h.Vb()},830642:()=>{h.Wb()},830671:()=>{h.$b()},830696:Pt=>h.Ub(Pt),830729:Pt=>h.Yb(Pt),830761:(Pt,sr,pr)=>{h.Kb(Number(Pt),Number(sr),Number(pr),!0)},830824:(Pt,sr,pr)=>{h.Kb(Number(Pt),Number(sr),Number(pr))},830881:()=>typeof wasmOffsetConverter<"u",830938:Pt=>{h.jb("Abs",Pt,void 0)},830989:Pt=>{h.jb("Neg",Pt,void 0)},831040:Pt=>{h.jb("Floor",Pt,void 0)},831093:Pt=>{h.jb("Ceil",Pt,void 0)},831145:Pt=>{h.jb("Reciprocal",Pt,void 0)},831203:Pt=>{h.jb("Sqrt",Pt,void 0)},831255:Pt=>{h.jb("Exp",Pt,void 0)},831306:Pt=>{h.jb("Erf",Pt,void 0)},831357:Pt=>{h.jb("Sigmoid",Pt,void 0)},831412:(Pt,sr,pr)=>{h.jb("HardSigmoid",Pt,{alpha:sr,beta:pr})},831491:Pt=>{h.jb("Log",Pt,void 0)},831542:Pt=>{h.jb("Sin",Pt,void 0)},831593:Pt=>{h.jb("Cos",Pt,void 0)},831644:Pt=>{h.jb("Tan",Pt,void 0)},831695:Pt=>{h.jb("Asin",Pt,void 0)},831747:Pt=>{h.jb("Acos",Pt,void 0)},831799:Pt=>{h.jb("Atan",Pt,void 0)},831851:Pt=>{h.jb("Sinh",Pt,void 0)},831903:Pt=>{h.jb("Cosh",Pt,void 0)},831955:Pt=>{h.jb("Asinh",Pt,void 0)},832008:Pt=>{h.jb("Acosh",Pt,void 0)},832061:Pt=>{h.jb("Atanh",Pt,void 0)},832114:Pt=>{h.jb("Tanh",Pt,void 0)},832166:Pt=>{h.jb("Not",Pt,void 0)},832217:(Pt,sr,pr)=>{h.jb("Clip",Pt,{min:sr,max:pr})},832286:Pt=>{h.jb("Clip",Pt,void 0)},832338:(Pt,sr)=>{h.jb("Elu",Pt,{alpha:sr})},832396:Pt=>{h.jb("Gelu",Pt,void 0)},832448:Pt=>{h.jb("Relu",Pt,void 0)},832500:(Pt,sr)=>{h.jb("LeakyRelu",Pt,{alpha:sr})},832564:(Pt,sr)=>{h.jb("ThresholdedRelu",Pt,{alpha:sr})},832634:(Pt,sr)=>{h.jb("Cast",Pt,{to:sr})},832692:Pt=>{h.jb("Add",Pt,void 0)},832743:Pt=>{h.jb("Sub",Pt,void 0)},832794:Pt=>{h.jb("Mul",Pt,void 0)},832845:Pt=>{h.jb("Div",Pt,void 0)},832896:Pt=>{h.jb("Pow",Pt,void 0)},832947:Pt=>{h.jb("Equal",Pt,void 0)},833e3:Pt=>{h.jb("Greater",Pt,void 0)},833055:Pt=>{h.jb("GreaterOrEqual",Pt,void 0)},833117:Pt=>{h.jb("Less",Pt,void 0)},833169:Pt=>{h.jb("LessOrEqual",Pt,void 0)},833228:(Pt,sr,pr,xn,Pn)=>{h.jb("ReduceMean",Pt,{keepDims:!!sr,noopWithEmptyAxes:!!pr,axes:xn?Array.from(Mo().subarray(Number(xn)>>>0,Number(Pn)>>>0)):[]})},833403:(Pt,sr,pr,xn,Pn)=>{h.jb("ReduceMax",Pt,{keepDims:!!sr,noopWithEmptyAxes:!!pr,axes:xn?Array.from(Mo().subarray(Number(xn)>>>0,Number(Pn)>>>0)):[]})},833577:(Pt,sr,pr,xn,Pn)=>{h.jb("ReduceMin",Pt,{keepDims:!!sr,noopWithEmptyAxes:!!pr,axes:xn?Array.from(Mo().subarray(Number(xn)>>>0,Number(Pn)>>>0)):[]})},833751:(Pt,sr,pr,xn,Pn)=>{h.jb("ReduceProd",Pt,{keepDims:!!sr,noopWithEmptyAxes:!!pr,axes:xn?Array.from(Mo().subarray(Number(xn)>>>0,Number(Pn)>>>0)):[]})},833926:(Pt,sr,pr,xn,Pn)=>{h.jb("ReduceSum",Pt,{keepDims:!!sr,noopWithEmptyAxes:!!pr,axes:xn?Array.from(Mo().subarray(Number(xn)>>>0,Number(Pn)>>>0)):[]})},834100:(Pt,sr,pr,xn,Pn)=>{h.jb("ReduceL1",Pt,{keepDims:!!sr,noopWithEmptyAxes:!!pr,axes:xn?Array.from(Mo().subarray(Number(xn)>>>0,Number(Pn)>>>0)):[]})},834273:(Pt,sr,pr,xn,Pn)=>{h.jb("ReduceL2",Pt,{keepDims:!!sr,noopWithEmptyAxes:!!pr,axes:xn?Array.from(Mo().subarray(Number(xn)>>>0,Number(Pn)>>>0)):[]})},834446:(Pt,sr,pr,xn,Pn)=>{h.jb("ReduceLogSum",Pt,{keepDims:!!sr,noopWithEmptyAxes:!!pr,axes:xn?Array.from(Mo().subarray(Number(xn)>>>0,Number(Pn)>>>0)):[]})},834623:(Pt,sr,pr,xn,Pn)=>{h.jb("ReduceSumSquare",Pt,{keepDims:!!sr,noopWithEmptyAxes:!!pr,axes:xn?Array.from(Mo().subarray(Number(xn)>>>0,Number(Pn)>>>0)):[]})},834803:(Pt,sr,pr,xn,Pn)=>{h.jb("ReduceLogSumExp",Pt,{keepDims:!!sr,noopWithEmptyAxes:!!pr,axes:xn?Array.from(Mo().subarray(Number(xn)>>>0,Number(Pn)>>>0)):[]})},834983:Pt=>{h.jb("Where",Pt,void 0)},835036:(Pt,sr,pr)=>{h.jb("Transpose",Pt,{perm:sr?Array.from(Mo().subarray(Number(sr)>>>0,Number(pr)>>>0)):[]})},835160:(Pt,sr,pr,xn)=>{h.jb("DepthToSpace",Pt,{blocksize:sr,mode:m_(pr),format:xn?"NHWC":"NCHW"})},835293:(Pt,sr,pr,xn)=>{h.jb("DepthToSpace",Pt,{blocksize:sr,mode:m_(pr),format:xn?"NHWC":"NCHW"})},835426:(Pt,sr,pr,xn,Pn,Bo,rp,cp,vp,Sp,l_,y_,M_,sx,aw)=>{h.jb("ConvTranspose",Pt,{format:vp?"NHWC":"NCHW",autoPad:sr,dilations:[pr],group:xn,kernelShape:[Pn],pads:[Bo,rp],strides:[cp],wIsConst:()=>!!lr()[Sp>>>0],outputPadding:l_?Array.from(Mo().subarray(Number(l_)>>>0,Number(y_)>>>0)):[],outputShape:M_?Array.from(Mo().subarray(Number(M_)>>>0,Number(sx)>>>0)):[],activation:m_(aw)})},835859:(Pt,sr,pr,xn,Pn,Bo,rp,cp,vp,Sp,l_,y_,M_,sx)=>{h.jb("ConvTranspose",Pt,{format:cp?"NHWC":"NCHW",autoPad:sr,dilations:Array.from(Mo().subarray(Number(pr)>>>0,2+(Number(pr)>>>0)>>>0)),group:xn,kernelShape:Array.from(Mo().subarray(Number(Pn)>>>0,2+(Number(Pn)>>>0)>>>0)),pads:Array.from(Mo().subarray(Number(Bo)>>>0,4+(Number(Bo)>>>0)>>>0)),strides:Array.from(Mo().subarray(Number(rp)>>>0,2+(Number(rp)>>>0)>>>0)),wIsConst:()=>!!lr()[vp>>>0],outputPadding:Sp?Array.from(Mo().subarray(Number(Sp)>>>0,Number(l_)>>>0)):[],outputShape:y_?Array.from(Mo().subarray(Number(y_)>>>0,Number(M_)>>>0)):[],activation:m_(sx)})},836520:(Pt,sr,pr,xn,Pn,Bo,rp,cp,vp,Sp,l_,y_,M_,sx,aw)=>{h.jb("ConvTranspose",Pt,{format:vp?"NHWC":"NCHW",autoPad:sr,dilations:[pr],group:xn,kernelShape:[Pn],pads:[Bo,rp],strides:[cp],wIsConst:()=>!!lr()[Sp>>>0],outputPadding:l_?Array.from(Mo().subarray(Number(l_)>>>0,Number(y_)>>>0)):[],outputShape:M_?Array.from(Mo().subarray(Number(M_)>>>0,Number(sx)>>>0)):[],activation:m_(aw)})},836953:(Pt,sr,pr,xn,Pn,Bo,rp,cp,vp,Sp,l_,y_,M_,sx)=>{h.jb("ConvTranspose",Pt,{format:cp?"NHWC":"NCHW",autoPad:sr,dilations:Array.from(Mo().subarray(Number(pr)>>>0,2+(Number(pr)>>>0)>>>0)),group:xn,kernelShape:Array.from(Mo().subarray(Number(Pn)>>>0,2+(Number(Pn)>>>0)>>>0)),pads:Array.from(Mo().subarray(Number(Bo)>>>0,4+(Number(Bo)>>>0)>>>0)),strides:Array.from(Mo().subarray(Number(rp)>>>0,2+(Number(rp)>>>0)>>>0)),wIsConst:()=>!!lr()[vp>>>0],outputPadding:Sp?Array.from(Mo().subarray(Number(Sp)>>>0,Number(l_)>>>0)):[],outputShape:y_?Array.from(Mo().subarray(Number(y_)>>>0,Number(M_)>>>0)):[],activation:m_(sx)})},837614:(Pt,sr)=>{h.jb("GlobalAveragePool",Pt,{format:sr?"NHWC":"NCHW"})},837705:(Pt,sr,pr,xn,Pn,Bo,rp,cp,vp,Sp,l_,y_,M_,sx)=>{h.jb("AveragePool",Pt,{format:sx?"NHWC":"NCHW",auto_pad:sr,ceil_mode:pr,count_include_pad:xn,storage_order:Pn,dilations:Bo?Array.from(Mo().subarray(Number(Bo)>>>0,Number(rp)>>>0)):[],kernel_shape:cp?Array.from(Mo().subarray(Number(cp)>>>0,Number(vp)>>>0)):[],pads:Sp?Array.from(Mo().subarray(Number(Sp)>>>0,Number(l_)>>>0)):[],strides:y_?Array.from(Mo().subarray(Number(y_)>>>0,Number(M_)>>>0)):[]})},838184:(Pt,sr)=>{h.jb("GlobalAveragePool",Pt,{format:sr?"NHWC":"NCHW"})},838275:(Pt,sr,pr,xn,Pn,Bo,rp,cp,vp,Sp,l_,y_,M_,sx)=>{h.jb("AveragePool",Pt,{format:sx?"NHWC":"NCHW",auto_pad:sr,ceil_mode:pr,count_include_pad:xn,storage_order:Pn,dilations:Bo?Array.from(Mo().subarray(Number(Bo)>>>0,Number(rp)>>>0)):[],kernel_shape:cp?Array.from(Mo().subarray(Number(cp)>>>0,Number(vp)>>>0)):[],pads:Sp?Array.from(Mo().subarray(Number(Sp)>>>0,Number(l_)>>>0)):[],strides:y_?Array.from(Mo().subarray(Number(y_)>>>0,Number(M_)>>>0)):[]})},838754:(Pt,sr)=>{h.jb("GlobalMaxPool",Pt,{format:sr?"NHWC":"NCHW"})},838841:(Pt,sr,pr,xn,Pn,Bo,rp,cp,vp,Sp,l_,y_,M_,sx)=>{h.jb("MaxPool",Pt,{format:sx?"NHWC":"NCHW",auto_pad:sr,ceil_mode:pr,count_include_pad:xn,storage_order:Pn,dilations:Bo?Array.from(Mo().subarray(Number(Bo)>>>0,Number(rp)>>>0)):[],kernel_shape:cp?Array.from(Mo().subarray(Number(cp)>>>0,Number(vp)>>>0)):[],pads:Sp?Array.from(Mo().subarray(Number(Sp)>>>0,Number(l_)>>>0)):[],strides:y_?Array.from(Mo().subarray(Number(y_)>>>0,Number(M_)>>>0)):[]})},839316:(Pt,sr)=>{h.jb("GlobalMaxPool",Pt,{format:sr?"NHWC":"NCHW"})},839403:(Pt,sr,pr,xn,Pn,Bo,rp,cp,vp,Sp,l_,y_,M_,sx)=>{h.jb("MaxPool",Pt,{format:sx?"NHWC":"NCHW",auto_pad:sr,ceil_mode:pr,count_include_pad:xn,storage_order:Pn,dilations:Bo?Array.from(Mo().subarray(Number(Bo)>>>0,Number(rp)>>>0)):[],kernel_shape:cp?Array.from(Mo().subarray(Number(cp)>>>0,Number(vp)>>>0)):[],pads:Sp?Array.from(Mo().subarray(Number(Sp)>>>0,Number(l_)>>>0)):[],strides:y_?Array.from(Mo().subarray(Number(y_)>>>0,Number(M_)>>>0)):[]})},839878:(Pt,sr,pr,xn,Pn)=>{h.jb("Gemm",Pt,{alpha:sr,beta:pr,transA:xn,transB:Pn})},839982:Pt=>{h.jb("MatMul",Pt,void 0)},840036:(Pt,sr,pr,xn)=>{h.jb("ArgMax",Pt,{keepDims:!!sr,selectLastIndex:!!pr,axis:xn})},840144:(Pt,sr,pr,xn)=>{h.jb("ArgMin",Pt,{keepDims:!!sr,selectLastIndex:!!pr,axis:xn})},840252:(Pt,sr)=>{h.jb("Softmax",Pt,{axis:sr})},840315:(Pt,sr)=>{h.jb("Concat",Pt,{axis:sr})},840375:(Pt,sr,pr,xn,Pn)=>{h.jb("Split",Pt,{axis:sr,numOutputs:pr,splitSizes:xn?Array.from(Mo().subarray(Number(xn)>>>0,Number(Pn)>>>0)):[]})},840531:Pt=>{h.jb("Expand",Pt,void 0)},840585:(Pt,sr)=>{h.jb("Gather",Pt,{axis:Number(sr)})},840656:(Pt,sr)=>{h.jb("GatherElements",Pt,{axis:Number(sr)})},840735:(Pt,sr)=>{h.jb("GatherND",Pt,{batch_dims:Number(sr)})},840814:(Pt,sr,pr,xn,Pn,Bo,rp,cp,vp,Sp,l_)=>{h.jb("Resize",Pt,{antialias:sr,axes:pr?Array.from(Mo().subarray(Number(pr)>>>0,Number(xn)>>>0)):[],coordinateTransformMode:m_(Pn),cubicCoeffA:Bo,excludeOutside:rp,extrapolationValue:cp,keepAspectRatioPolicy:m_(vp),mode:m_(Sp),nearestMode:m_(l_)})},841176:(Pt,sr,pr,xn,Pn,Bo,rp)=>{h.jb("Slice",Pt,{starts:sr?Array.from(Mo().subarray(Number(sr)>>>0,Number(pr)>>>0)):[],ends:xn?Array.from(Mo().subarray(Number(xn)>>>0,Number(Pn)>>>0)):[],axes:Bo?Array.from(Mo().subarray(Number(Bo)>>>0,Number(rp)>>>0)):[]})},841440:Pt=>{h.jb("Tile",Pt,void 0)},841492:(Pt,sr,pr)=>{h.jb("InstanceNormalization",Pt,{epsilon:sr,format:pr?"NHWC":"NCHW"})},841606:(Pt,sr,pr)=>{h.jb("InstanceNormalization",Pt,{epsilon:sr,format:pr?"NHWC":"NCHW"})},841720:Pt=>{h.jb("Range",Pt,void 0)},841773:(Pt,sr)=>{h.jb("Einsum",Pt,{equation:m_(sr)})},841854:(Pt,sr,pr,xn,Pn)=>{h.jb("Pad",Pt,{mode:sr,value:pr,pads:xn?Array.from(Mo().subarray(Number(xn)>>>0,Number(Pn)>>>0)):[]})},841997:(Pt,sr,pr,xn,Pn,Bo)=>{h.jb("BatchNormalization",Pt,{epsilon:sr,momentum:pr,spatial:!!Pn,trainingMode:!!xn,format:Bo?"NHWC":"NCHW"})},842166:(Pt,sr,pr,xn,Pn,Bo)=>{h.jb("BatchNormalization",Pt,{epsilon:sr,momentum:pr,spatial:!!Pn,trainingMode:!!xn,format:Bo?"NHWC":"NCHW"})},842335:(Pt,sr,pr)=>{h.jb("CumSum",Pt,{exclusive:Number(sr),reverse:Number(pr)})},842432:(Pt,sr,pr)=>{h.jb("DequantizeLinear",Pt,{axis:sr,blockSize:pr})},842522:(Pt,sr,pr,xn,Pn)=>{h.jb("GridSample",Pt,{align_corners:sr,mode:m_(pr),padding_mode:m_(xn),format:Pn?"NHWC":"NCHW"})},842692:(Pt,sr,pr,xn,Pn)=>{h.jb("GridSample",Pt,{align_corners:sr,mode:m_(pr),padding_mode:m_(xn),format:Pn?"NHWC":"NCHW"})},842862:(Pt,sr)=>{h.jb("ScatterND",Pt,{reduction:m_(sr)})},842947:(Pt,sr,pr,xn,Pn,Bo,rp,cp,vp)=>{h.jb("Attention",Pt,{numHeads:sr,isUnidirectional:pr,maskFilterValue:xn,scale:Pn,doRotary:Bo,qkvHiddenSizes:rp?Array.from(Mo().subarray(Number(cp)>>>0,Number(cp)+rp>>>0)):[],pastPresentShareBuffer:!!vp})},843219:Pt=>{h.jb("BiasAdd",Pt,void 0)},843274:Pt=>{h.jb("BiasSplitGelu",Pt,void 0)},843335:Pt=>{h.jb("FastGelu",Pt,void 0)},843391:(Pt,sr,pr,xn,Pn,Bo,rp,cp,vp,Sp,l_,y_,M_,sx,aw,Oy)=>{h.jb("Conv",Pt,{format:y_?"NHWC":"NCHW",auto_pad:sr,dilations:pr?Array.from(Mo().subarray(Number(pr)>>>0,Number(xn)>>>0)):[],group:Pn,kernel_shape:Bo?Array.from(Mo().subarray(Number(Bo)>>>0,Number(rp)>>>0)):[],pads:cp?Array.from(Mo().subarray(Number(cp)>>>0,Number(vp)>>>0)):[],strides:Sp?Array.from(Mo().subarray(Number(Sp)>>>0,Number(l_)>>>0)):[],w_is_const:()=>!!lr()[Number(M_)>>>0],activation:m_(sx),activation_params:aw?Array.from(qo().subarray(Number(aw)>>>0,Number(Oy)>>>0)):[]})},843975:Pt=>{h.jb("Gelu",Pt,void 0)},844027:(Pt,sr,pr,xn,Pn,Bo,rp,cp,vp)=>{h.jb("GroupQueryAttention",Pt,{numHeads:sr,kvNumHeads:pr,scale:xn,softcap:Pn,doRotary:Bo,rotaryInterleaved:rp,smoothSoftmax:cp,localWindowSize:vp})},844244:(Pt,sr,pr,xn)=>{h.jb("LayerNormalization",Pt,{axis:sr,epsilon:pr,simplified:!!xn})},844355:(Pt,sr,pr,xn)=>{h.jb("LayerNormalization",Pt,{axis:sr,epsilon:pr,simplified:!!xn})},844466:(Pt,sr,pr,xn,Pn,Bo)=>{h.jb("MatMulNBits",Pt,{k:sr,n:pr,accuracyLevel:xn,bits:Pn,blockSize:Bo})},844593:(Pt,sr,pr,xn,Pn,Bo)=>{h.jb("MultiHeadAttention",Pt,{numHeads:sr,isUnidirectional:pr,maskFilterValue:xn,scale:Pn,doRotary:Bo})},844752:(Pt,sr)=>{h.jb("QuickGelu",Pt,{alpha:sr})},844816:(Pt,sr,pr,xn,Pn)=>{h.jb("RotaryEmbedding",Pt,{interleaved:!!sr,numHeads:pr,rotaryEmbeddingDim:xn,scale:Pn})},844955:(Pt,sr,pr)=>{h.jb("SkipLayerNormalization",Pt,{epsilon:sr,simplified:!!pr})},845057:(Pt,sr,pr)=>{h.jb("SkipLayerNormalization",Pt,{epsilon:sr,simplified:!!pr})},845159:(Pt,sr,pr,xn)=>{h.jb("GatherBlockQuantized",Pt,{gatherAxis:sr,quantizeAxis:pr,blockSize:xn})},845280:Pt=>{h.Zb(Pt)},845314:(Pt,sr)=>h.ac(Number(Pt),Number(sr),h.Fb.dc,h.Fb.errors)};function lp(Pt,sr,pr){return px(async()=>{await h.Xb(Number(Pt),Number(sr),Number(pr))})}function _p(){return typeof wasmOffsetConverter<"u"}class Zo{constructor(sr){Oo(this,"name","ExitStatus");this.message=`Program terminated with exit(${sr})`,this.status=sr}}var bp=Pt=>{Pt.terminate(),Pt.onmessage=()=>{}},gp=[],Mp=Pt=>{u_.length==0&&(H_(),S_(u_[0]));var sr=u_.pop();if(!sr)return 6;Ip.push(sr),G_[Pt.Ab]=sr,sr.Ab=Pt.Ab;var pr={Bb:"run",fc:Pt.ec,Hb:Pt.Hb,Ab:Pt.Ab};return sr.postMessage(pr,Pt.Mb),0},wp=0,ip=(Pt,sr,...pr)=>{for(var xn=2*pr.length,Pn=Jw(),Bo=Iw(8*xn),rp=Bo>>>3,cp=0;cp<pr.length;cp++){var vp=pr[cp];typeof vp=="bigint"?(Tn[rp+2*cp]=1n,Tn[rp+2*cp+1]=vp):(Tn[rp+2*cp]=0n,tp()[rp+2*cp+1>>>0]=vp)}return Pt=$y(Pt,0,xn,Bo,sr),Aw(Pn),Pt};function fp(Pt){if(_e)return ip(0,1,Pt);if(nr=Pt,!(0<wp)){for(var sr of Ip)bp(sr);for(sr of u_)bp(sr);u_=[],Ip=[],G_={},fn=!0}zt(0,new Zo(Pt))}function Rp(Pt){if(_e)return ip(1,0,Pt);Ap(Pt)}var Ap=Pt=>{if(nr=Pt,_e)throw Rp(Pt),"unwind";fp(Pt)},u_=[],Ip=[],C_=[],G_={},z_=Pt=>{var sr=Pt.Ab;delete G_[sr],u_.push(Pt),Ip.splice(Ip.indexOf(Pt),1),Pt.Ab=0,Qw(sr)};function hx(){C_.forEach(Pt=>Pt())}var S_=Pt=>new Promise(sr=>{Pt.onmessage=Pn=>{var Bo=(Pn=Pn.data).Bb;if(Pn.Gb&&Pn.Gb!=dw()){var rp=G_[Pn.Gb];rp?rp.postMessage(Pn,Pn.Mb):Lt(`Internal error! Worker sent a message "${Bo}" to target pthread ${Pn.Gb}, but that thread no longer exists!`)}else Bo==="checkMailbox"?bu():Bo==="spawnThread"?Mp(Pn):Bo==="cleanupThread"?z_(G_[Pn.hc]):Bo==="loaded"?(Pt.loaded=!0,sr(Pt)):Bo==="alert"?alert(`Thread ${Pn.ic}: ${Pn.text}`):Pn.target==="setimmediate"?Pt.postMessage(Pn):Bo==="callHandler"?h[Pn.Qb](...Pn.args):Bo&&Lt(`worker sent an unknown command ${Bo}`)},Pt.onerror=Pn=>{throw Lt(`worker sent an error! ${Pn.filename}:${Pn.lineno}: ${Pn.message}`),Pn};var pr,xn=[];for(pr of[])h.propertyIsEnumerable(pr)&&xn.push(pr);Pt.postMessage({Bb:"load",Rb:xn,kc:Gt,lc:Bt})});function H_(){var Pt=new Worker((()=>{let sr=URL;return import.meta.url>"file:"&&import.meta.url<"file;"?new sr("ort.bundle.min.mjs",import.meta.url):new URL(import.meta.url)})(),{type:"module",workerData:"em-pthread",name:"em-pthread"});u_.push(Pt)}var zx=Pt=>{mr();var sr=Ro()[Pt+52>>>2>>>0];Pt=Ro()[Pt+56>>>2>>>0],Cy(sr,sr-Pt),Aw(sr)},qx=(Pt,sr)=>{wp=0,Pt=Sy(Pt,sr),0<wp?nr=Pt:Xw(Pt)};class Ix{constructor(sr){this.Ib=sr-24}}function X_(Pt,sr,pr){var xn=new Ix(Pt>>>=0);throw sr>>>=0,pr>>>=0,Ro()[xn.Ib+16>>>2>>>0]=0,Ro()[xn.Ib+4>>>2>>>0]=sr,Ro()[xn.Ib+8>>>2>>>0]=pr,Pt}function e_(Pt,sr,pr,xn){return _e?ip(2,1,Pt,sr,pr,xn):r_(Pt,sr,pr,xn)}function r_(Pt,sr,pr,xn){if(Pt>>>=0,pr>>>=0,xn>>>=0,lt===void 0)return 6;var Pn=[];return _e&&Pn.length===0?e_(Pt,sr>>>=0,pr,xn):(Pt={ec:pr,Ab:Pt,Hb:xn,Mb:Pn},_e?(Pt.Bb="spawnThread",postMessage(Pt,Pn),0):Mp(Pt))}var g_=typeof TextDecoder<"u"?new TextDecoder:void 0,Pp=(Pt,sr=0,pr=NaN)=>{var xn=(sr>>>=0)+pr;for(pr=sr;Pt[pr]&&!(pr>=xn);)++pr;if(16<pr-sr&&Pt.buffer&&g_)return g_.decode(Pt.buffer instanceof ArrayBuffer?Pt.subarray(sr,pr):Pt.slice(sr,pr));for(xn="";sr<pr;){var Pn=Pt[sr++];if(128&Pn){var Bo=63&Pt[sr++];if((224&Pn)==192)xn+=String.fromCharCode((31&Pn)<<6|Bo);else{var rp=63&Pt[sr++];65536>(Pn=(240&Pn)==224?(15&Pn)<<12|Bo<<6|rp:(7&Pn)<<18|Bo<<12|rp<<6|63&Pt[sr++])?xn+=String.fromCharCode(Pn):(Pn-=65536,xn+=String.fromCharCode(55296|Pn>>10,56320|1023&Pn))}}else xn+=String.fromCharCode(Pn)}return xn},m_=(Pt,sr)=>(Pt>>>=0)?Pp(pn(),Pt,sr):"";function ir(Pt,sr,pr){return _e?ip(3,1,Pt,sr,pr):0}function In(Pt,sr){if(_e)return ip(4,1,Pt,sr)}var wn=Pt=>{for(var sr=0,pr=0;pr<Pt.length;++pr){var xn=Pt.charCodeAt(pr);127>=xn?sr++:2047>=xn?sr+=2:55296<=xn&&57343>=xn?(sr+=4,++pr):sr+=3}return sr},An=(Pt,sr,pr)=>{var xn=pn();if(sr>>>=0,0<pr){var Pn=sr;pr=sr+pr-1;for(var Bo=0;Bo<Pt.length;++Bo){var rp=Pt.charCodeAt(Bo);if(55296<=rp&&57343>=rp&&(rp=65536+((1023&rp)<<10)|1023&Pt.charCodeAt(++Bo)),127>=rp){if(sr>=pr)break;xn[sr++>>>0]=rp}else{if(2047>=rp){if(sr+1>=pr)break;xn[sr++>>>0]=192|rp>>6}else{if(65535>=rp){if(sr+2>=pr)break;xn[sr++>>>0]=224|rp>>12}else{if(sr+3>=pr)break;xn[sr++>>>0]=240|rp>>18,xn[sr++>>>0]=128|rp>>12&63}xn[sr++>>>0]=128|rp>>6&63}xn[sr++>>>0]=128|63&rp}}xn[sr>>>0]=0,Pt=sr-Pn}else Pt=0;return Pt};function No(Pt,sr){if(_e)return ip(5,1,Pt,sr)}function Yo(Pt,sr,pr){if(_e)return ip(6,1,Pt,sr,pr)}function sp(Pt,sr,pr){return _e?ip(7,1,Pt,sr,pr):0}function Cp(Pt,sr){if(_e)return ip(8,1,Pt,sr)}function n_(Pt,sr,pr){if(_e)return ip(9,1,Pt,sr,pr)}function zp(Pt,sr,pr,xn){if(_e)return ip(10,1,Pt,sr,pr,xn)}function i_(Pt,sr,pr,xn){if(_e)return ip(11,1,Pt,sr,pr,xn)}function kp(Pt,sr,pr,xn){if(_e)return ip(12,1,Pt,sr,pr,xn)}function h_(Pt){if(_e)return ip(13,1,Pt)}function $_(Pt,sr){if(_e)return ip(14,1,Pt,sr)}function xx(Pt,sr,pr){if(_e)return ip(15,1,Pt,sr,pr)}var bx,N_,lx=()=>_c(""),B_=Pt=>{for(var sr="";pn()[Pt>>>0];)sr+=bx[pn()[Pt++>>>0]];return sr},Rx={},Ox={};function ux(Pt,sr,pr={}){return function(xn,Pn,Bo={}){var rp=Pn.name;if(!xn)throw new N_(`type "${rp}" must have a positive integer typeid pointer`);if(Ox.hasOwnProperty(xn)){if(Bo.Sb)return;throw new N_(`Cannot register type '${rp}' twice`)}Ox[xn]=Pn,Rx.hasOwnProperty(xn)&&(Pn=Rx[xn],delete Rx[xn],Pn.forEach(cp=>cp()))}(Pt,sr,pr)}var Qx=(Pt,sr,pr)=>{switch(sr){case 1:return pr?xn=>lr()[xn>>>0]:xn=>pn()[xn>>>0];case 2:return pr?xn=>Cn()[xn>>>1>>>0]:xn=>Lo()[xn>>>1>>>0];case 4:return pr?xn=>Mo()[xn>>>2>>>0]:xn=>Ro()[xn>>>2>>>0];case 8:return pr?xn=>Tn[xn>>>3]:xn=>kn[xn>>>3];default:throw new TypeError(`invalid integer width (${sr}): ${Pt}`)}};function Xx(Pt,sr,pr){pr>>>=0,ux(Pt>>>=0,{name:sr=B_(sr>>>0),fromWireType:xn=>xn,toWireType:function(xn,Pn){if(typeof Pn!="bigint"&&typeof Pn!="number")throw Pn=Pn===null?"null":(xn=typeof Pn)=="object"||xn==="array"||xn==="function"?Pn.toString():""+Pn,new TypeError(`Cannot convert "${Pn}" to ${this.name}`);return typeof Pn=="number"&&(Pn=BigInt(Pn)),Pn},Cb:rx,readValueFromPointer:Qx(sr,pr,sr.indexOf("u")==-1),Db:null})}var rx=8;function jx(Pt,sr,pr,xn){ux(Pt>>>=0,{name:sr=B_(sr>>>0),fromWireType:function(Pn){return!!Pn},toWireType:function(Pn,Bo){return Bo?pr:xn},Cb:rx,readValueFromPointer:function(Pn){return this.fromWireType(pn()[Pn>>>0])},Db:null})}var kx=[],_x=[];function Bx(Pt){9<(Pt>>>=0)&&--_x[Pt+1]==0&&(_x[Pt]=void 0,kx.push(Pt))}var K_=Pt=>{if(!Pt)throw new N_("Cannot use deleted val. handle = "+Pt);return _x[Pt]},L_=Pt=>{switch(Pt){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let sr=kx.pop()||_x.length;return _x[sr]=Pt,_x[sr+1]=1,sr}};function Nx(Pt){return this.fromWireType(Ro()[Pt>>>2>>>0])}var rw={name:"emscripten::val",fromWireType:Pt=>{var sr=K_(Pt);return Bx(Pt),sr},toWireType:(Pt,sr)=>L_(sr),Cb:rx,readValueFromPointer:Nx,Db:null};function wx(Pt){return ux(Pt>>>0,rw)}var dp=(Pt,sr)=>{switch(sr){case 4:return function(pr){return this.fromWireType(qo()[pr>>>2>>>0])};case 8:return function(pr){return this.fromWireType(tp()[pr>>>3>>>0])};default:throw new TypeError(`invalid float width (${sr}): ${Pt}`)}};function pp(Pt,sr,pr){pr>>>=0,ux(Pt>>>=0,{name:sr=B_(sr>>>0),fromWireType:xn=>xn,toWireType:(xn,Pn)=>Pn,Cb:rx,readValueFromPointer:dp(sr,pr),Db:null})}function $p(Pt,sr,pr,xn,Pn){if(Pt>>>=0,pr>>>=0,sr=B_(sr>>>0),Pn===-1&&(Pn=4294967295),Pn=cp=>cp,xn===0){var Bo=32-8*pr;Pn=cp=>cp<<Bo>>>Bo}var rp=sr.includes("unsigned")?function(cp,vp){return vp>>>0}:function(cp,vp){return vp};ux(Pt,{name:sr,fromWireType:Pn,toWireType:rp,Cb:rx,readValueFromPointer:Qx(sr,pr,xn!==0),Db:null})}function P_(Pt,sr,pr){function xn(Bo){var rp=Ro()[Bo>>>2>>>0];return Bo=Ro()[Bo+4>>>2>>>0],new Pn(lr().buffer,Bo,rp)}var Pn=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][sr];ux(Pt>>>=0,{name:pr=B_(pr>>>0),fromWireType:xn,Cb:rx,readValueFromPointer:xn},{Sb:!0})}function nw(Pt,sr){ux(Pt>>>=0,{name:sr=B_(sr>>>0),fromWireType:function(pr){for(var xn,Pn=Ro()[pr>>>2>>>0],Bo=pr+4,rp=Bo,cp=0;cp<=Pn;++cp){var vp=Bo+cp;cp!=Pn&&pn()[vp>>>0]!=0||(rp=m_(rp,vp-rp),xn===void 0?xn=rp:(xn+="\0",xn+=rp),rp=vp+1)}return Sx(pr),xn},toWireType:function(pr,xn){xn instanceof ArrayBuffer&&(xn=new Uint8Array(xn));var Pn=typeof xn=="string";if(!(Pn||xn instanceof Uint8Array||xn instanceof Uint8ClampedArray||xn instanceof Int8Array))throw new N_("Cannot pass non-string to std::string");var Bo=Pn?wn(xn):xn.length,rp=Cw(4+Bo+1),cp=rp+4;if(Ro()[rp>>>2>>>0]=Bo,Pn)An(xn,cp,Bo+1);else if(Pn)for(Pn=0;Pn<Bo;++Pn){var vp=xn.charCodeAt(Pn);if(255<vp)throw Sx(rp),new N_("String has UTF-16 code units that do not fit in 8 bits");pn()[cp+Pn>>>0]=vp}else for(Pn=0;Pn<Bo;++Pn)pn()[cp+Pn>>>0]=xn[Pn];return pr!==null&&pr.push(Sx,rp),rp},Cb:rx,readValueFromPointer:Nx,Db(pr){Sx(pr)}})}var Ux=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Px=(Pt,sr)=>{for(var pr=Pt>>1,xn=pr+sr/2;!(pr>=xn)&&Lo()[pr>>>0];)++pr;if(32<(pr<<=1)-Pt&&Ux)return Ux.decode(pn().slice(Pt,pr));for(pr="",xn=0;!(xn>=sr/2);++xn){var Pn=Cn()[Pt+2*xn>>>1>>>0];if(Pn==0)break;pr+=String.fromCharCode(Pn)}return pr},vw=(Pt,sr,pr)=>{if(pr??(pr=2147483647),2>pr)return 0;var xn=sr;pr=(pr-=2)<2*Pt.length?pr/2:Pt.length;for(var Pn=0;Pn<pr;++Pn){var Bo=Pt.charCodeAt(Pn);Cn()[sr>>>1>>>0]=Bo,sr+=2}return Cn()[sr>>>1>>>0]=0,sr-xn},bw=Pt=>2*Pt.length,Mw=(Pt,sr)=>{for(var pr=0,xn="";!(pr>=sr/4);){var Pn=Mo()[Pt+4*pr>>>2>>>0];if(Pn==0)break;++pr,65536<=Pn?(Pn-=65536,xn+=String.fromCharCode(55296|Pn>>10,56320|1023&Pn)):xn+=String.fromCharCode(Pn)}return xn},Ew=(Pt,sr,pr)=>{if(sr>>>=0,pr??(pr=2147483647),4>pr)return 0;var xn=sr;pr=xn+pr-4;for(var Pn=0;Pn<Pt.length;++Pn){var Bo=Pt.charCodeAt(Pn);if(55296<=Bo&&57343>=Bo&&(Bo=65536+((1023&Bo)<<10)|1023&Pt.charCodeAt(++Pn)),Mo()[sr>>>2>>>0]=Bo,(sr+=4)+4>pr)break}return Mo()[sr>>>2>>>0]=0,sr-xn},Vo=Pt=>{for(var sr=0,pr=0;pr<Pt.length;++pr){var xn=Pt.charCodeAt(pr);55296<=xn&&57343>=xn&&++pr,sr+=4}return sr};function dr(Pt,sr,pr){if(Pt>>>=0,sr>>>=0,pr=B_(pr>>>=0),sr===2)var xn=Px,Pn=vw,Bo=bw,rp=cp=>Lo()[cp>>>1>>>0];else sr===4&&(xn=Mw,Pn=Ew,Bo=Vo,rp=cp=>Ro()[cp>>>2>>>0]);ux(Pt,{name:pr,fromWireType:cp=>{for(var vp,Sp=Ro()[cp>>>2>>>0],l_=cp+4,y_=0;y_<=Sp;++y_){var M_=cp+4+y_*sr;y_!=Sp&&rp(M_)!=0||(l_=xn(l_,M_-l_),vp===void 0?vp=l_:(vp+="\0",vp+=l_),l_=M_+sr)}return Sx(cp),vp},toWireType:(cp,vp)=>{if(typeof vp!="string")throw new N_(`Cannot pass non-string to C++ string type ${pr}`);var Sp=Bo(vp),l_=Cw(4+Sp+sr);return Ro()[l_>>>2>>>0]=Sp/sr,Pn(vp,l_+4,Sp+sr),cp!==null&&cp.push(Sx,l_),l_},Cb:rx,readValueFromPointer:Nx,Db(cp){Sx(cp)}})}function $n(Pt,sr){ux(Pt>>>=0,{Tb:!0,name:sr=B_(sr>>>0),Cb:0,fromWireType:()=>{},toWireType:()=>{}})}function jo(Pt){Sw(Pt>>>0,!$,1,!g,131072,!1),hx()}var zo=Pt=>{if(!fn)try{if(Pt(),!(0<wp))try{_e?Xw(nr):Ap(nr)}catch(sr){sr instanceof Zo||sr=="unwind"||zt(0,sr)}}catch(sr){sr instanceof Zo||sr=="unwind"||zt(0,sr)}};function Uo(Pt){Pt>>>=0,typeof Atomics.jc=="function"&&(Atomics.jc(Mo(),Pt>>>2,Pt).value.then(bu),Pt+=128,Atomics.store(Mo(),Pt>>>2,1))}var bu=()=>{var Pt=dw();Pt&&(Uo(Pt),zo(Yw))};function mp(Pt,sr){(Pt>>>=0)==sr>>>0?setTimeout(bu):_e?postMessage({Gb:Pt,Bb:"checkMailbox"}):(Pt=G_[Pt])&&Pt.postMessage({Bb:"checkMailbox"})}var yp=[];function xp(Pt,sr,pr,xn,Pn){for(sr>>>=0,xn/=2,yp.length=xn,pr=Pn>>>0>>>3,Pn=0;Pn<xn;Pn++)yp[Pn]=Tn[pr+2*Pn]?Tn[pr+2*Pn+1]:tp()[pr+2*Pn+1>>>0];return(sr?ep[sr]:mv[Pt])(...yp)}var Tp=()=>{wp=0};function s_(Pt){Pt>>>=0,_e?postMessage({Bb:"cleanupThread",hc:Pt}):z_(G_[Pt])}function v_(Pt){}var w_=(Pt,sr)=>{var pr=Ox[Pt];if(pr===void 0)throw Pt=Ey(Pt),pr=B_(Pt),Sx(Pt),new N_(`${sr} has unknown type ${pr}`);return pr},I_=(Pt,sr,pr)=>{var xn=[];return Pt=Pt.toWireType(xn,pr),xn.length&&(Ro()[sr>>>2>>>0]=L_(xn)),Pt};function T_(Pt,sr,pr){return sr>>>=0,pr>>>=0,Pt=K_(Pt>>>0),sr=w_(sr,"emval::as"),I_(sr,pr,Pt)}function Y_(Pt,sr){return sr>>>=0,Pt=K_(Pt>>>0),(sr=w_(sr,"emval::as")).toWireType(null,Pt)}var J_=Pt=>{try{Pt()}catch(sr){_c(sr)}},U_=0,Z_=null,nx=0,Cx=[],A_={},ex={},dx=0,$x=null,Vx=[];function px(Pt){return function(sr){if(!fn){if(U_===0){var pr=!1,xn=!1;sr((Pn=0)=>{if(!fn&&(nx=Pn,pr=!0,xn)){U_=2,J_(()=>Iy(Z_)),typeof MainLoop<"u"&&MainLoop.Pb&&MainLoop.resume(),Pn=!1;try{var Bo=function(){var vp=Mo()[Z_+8>>>2>>>0];return vp=Op[ex[vp]],--wp,vp()}()}catch(vp){Bo=vp,Pn=!0}var rp=!1;if(!Z_){var cp=$x;cp&&($x=null,(Pn?cp.reject:cp.resolve)(Bo),rp=!0)}if(Pn&&!rp)throw Bo}}),xn=!0,pr||(U_=1,Z_=function(){var Pn=Cw(65548),Bo=Pn+12;Ro()[Pn>>>2>>>0]=Bo,Ro()[Pn+4>>>2>>>0]=Bo+65536,Bo=Cx[0];var rp=A_[Bo];return rp===void 0&&(rp=dx++,A_[Bo]=rp,ex[rp]=Bo),Bo=rp,Mo()[Pn+8>>>2>>>0]=Bo,Pn}(),typeof MainLoop<"u"&&MainLoop.Pb&&MainLoop.pause(),J_(()=>Zw(Z_)))}else U_===2?(U_=0,J_(ey),Sx(Z_),Z_=null,Vx.forEach(zo)):_c(`invalid state: ${U_}`);return nx}}(sr=>{Pt().then(sr)})}function Lx(Pt){return Pt>>>=0,px(async()=>{var sr=await K_(Pt);return L_(sr)})}var F_=[];function V_(Pt,sr,pr,xn){return pr>>>=0,xn>>>=0,(Pt=F_[Pt>>>0])(null,sr=K_(sr>>>0),pr,xn)}var q_={},R_=Pt=>{var sr=q_[Pt];return sr===void 0?B_(Pt):sr};function Mx(Pt,sr,pr,xn,Pn){return pr>>>=0,xn>>>=0,Pn>>>=0,(Pt=F_[Pt>>>0])(sr=K_(sr>>>0),sr[pr=R_(pr)],xn,Pn)}var sw=()=>typeof globalThis=="object"?globalThis:Function("return this")();function Yx(Pt){return(Pt>>>=0)==0?L_(sw()):(Pt=R_(Pt),L_(sw()[Pt]))}var zy=Pt=>{var sr=F_.length;return F_.push(Pt),sr},By=(Pt,sr)=>{for(var pr=Array(Pt),xn=0;xn<Pt;++xn)pr[xn]=w_(Ro()[sr+4*xn>>>2>>>0],"parameter "+xn);return pr},py=(Pt,sr)=>Object.defineProperty(sr,"name",{value:Pt});function Uy(Pt,sr,pr){var xn=(sr=By(Pt,sr>>>0)).shift();Pt--;var Pn=`return function (obj, func, destructorsRef, args) {
`,Bo=0,rp=[];pr===0&&rp.push("obj");for(var cp=["retType"],vp=[xn],Sp=0;Sp<Pt;++Sp)rp.push("arg"+Sp),cp.push("argType"+Sp),vp.push(sr[Sp]),Pn+=`  var arg${Sp} = argType${Sp}.readValueFromPointer(args${Bo?"+"+Bo:""});
`,Bo+=sr[Sp].Cb;return Pn+=`  var rv = ${pr===1?"new func":"func.call"}(${rp.join(", ")});
`,xn.Tb||(cp.push("emval_returnValue"),vp.push(I_),Pn+=`  return emval_returnValue(retType, destructorsRef, rv);
`),cp.push(Pn+`};
`),Pt=function(l_){var y_=Function;if(!(y_ instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof y_} which is not a function`);var M_=py(y_.name||"unknownFunctionName",function(){});return M_.prototype=y_.prototype,M_=new M_,(l_=y_.apply(M_,l_))instanceof Object?l_:M_}(cp)(...vp),pr=`methodCaller<(${sr.map(l_=>l_.name).join(", ")}) => ${xn.name}>`,zy(py(pr,Pt))}function Vy(Pt){return Pt=R_(Pt>>>0),L_(h[Pt])}function cw(Pt,sr){return sr>>>=0,Pt=K_(Pt>>>0),sr=K_(sr),L_(Pt[sr])}function Wy(Pt){9<(Pt>>>=0)&&(_x[Pt+1]+=1)}function Gy(){return L_([])}function Hy(Pt){Pt=K_(Pt>>>0);for(var sr=Array(Pt.length),pr=0;pr<Pt.length;pr++)sr[pr]=Pt[pr];return L_(sr)}function Ky(Pt){return L_(R_(Pt>>>0))}function qy(){return L_({})}function uw(Pt){for(var sr=K_(Pt>>>=0);sr.length;){var pr=sr.pop();sr.pop()(pr)}Bx(Pt)}function Qy(Pt,sr,pr){sr>>>=0,pr>>>=0,Pt=K_(Pt>>>0),sr=K_(sr),pr=K_(pr),Pt[sr]=pr}function Xy(Pt,sr){return sr>>>=0,Pt=(Pt=w_(Pt>>>0,"_emval_take_value")).readValueFromPointer(sr),L_(Pt)}function Yy(Pt,sr){Pt=-9007199254740992>Pt||9007199254740992<Pt?NaN:Number(Pt),sr>>>=0,Pt=new Date(1e3*Pt),Mo()[sr>>>2>>>0]=Pt.getUTCSeconds(),Mo()[sr+4>>>2>>>0]=Pt.getUTCMinutes(),Mo()[sr+8>>>2>>>0]=Pt.getUTCHours(),Mo()[sr+12>>>2>>>0]=Pt.getUTCDate(),Mo()[sr+16>>>2>>>0]=Pt.getUTCMonth(),Mo()[sr+20>>>2>>>0]=Pt.getUTCFullYear()-1900,Mo()[sr+24>>>2>>>0]=Pt.getUTCDay(),Pt=(Pt.getTime()-Date.UTC(Pt.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,Mo()[sr+28>>>2>>>0]=Pt}var fy=Pt=>Pt%4==0&&(Pt%100!=0||Pt%400==0),my=[0,31,60,91,121,152,182,213,244,274,305,335],Vw=[0,31,59,90,120,151,181,212,243,273,304,334];function Jy(Pt,sr){Pt=-9007199254740992>Pt||9007199254740992<Pt?NaN:Number(Pt),sr>>>=0,Pt=new Date(1e3*Pt),Mo()[sr>>>2>>>0]=Pt.getSeconds(),Mo()[sr+4>>>2>>>0]=Pt.getMinutes(),Mo()[sr+8>>>2>>>0]=Pt.getHours(),Mo()[sr+12>>>2>>>0]=Pt.getDate(),Mo()[sr+16>>>2>>>0]=Pt.getMonth(),Mo()[sr+20>>>2>>>0]=Pt.getFullYear()-1900,Mo()[sr+24>>>2>>>0]=Pt.getDay();var pr=(fy(Pt.getFullYear())?my:Vw)[Pt.getMonth()]+Pt.getDate()-1|0;Mo()[sr+28>>>2>>>0]=pr,Mo()[sr+36>>>2>>>0]=-60*Pt.getTimezoneOffset(),pr=new Date(Pt.getFullYear(),6,1).getTimezoneOffset();var xn=new Date(Pt.getFullYear(),0,1).getTimezoneOffset();Pt=0|(pr!=xn&&Pt.getTimezoneOffset()==Math.min(xn,pr)),Mo()[sr+32>>>2>>>0]=Pt}function Zy(Pt){Pt>>>=0;var sr=new Date(Mo()[Pt+20>>>2>>>0]+1900,Mo()[Pt+16>>>2>>>0],Mo()[Pt+12>>>2>>>0],Mo()[Pt+8>>>2>>>0],Mo()[Pt+4>>>2>>>0],Mo()[Pt>>>2>>>0],0),pr=Mo()[Pt+32>>>2>>>0],xn=sr.getTimezoneOffset(),Pn=new Date(sr.getFullYear(),6,1).getTimezoneOffset(),Bo=new Date(sr.getFullYear(),0,1).getTimezoneOffset(),rp=Math.min(Bo,Pn);return 0>pr?Mo()[Pt+32>>>2>>>0]=+(Pn!=Bo&&rp==xn):0<pr!=(rp==xn)&&(Pn=Math.max(Bo,Pn),sr.setTime(sr.getTime()+6e4*((0<pr?rp:Pn)-xn))),Mo()[Pt+24>>>2>>>0]=sr.getDay(),pr=(fy(sr.getFullYear())?my:Vw)[sr.getMonth()]+sr.getDate()-1|0,Mo()[Pt+28>>>2>>>0]=pr,Mo()[Pt>>>2>>>0]=sr.getSeconds(),Mo()[Pt+4>>>2>>>0]=sr.getMinutes(),Mo()[Pt+8>>>2>>>0]=sr.getHours(),Mo()[Pt+12>>>2>>>0]=sr.getDate(),Mo()[Pt+16>>>2>>>0]=sr.getMonth(),Mo()[Pt+20>>>2>>>0]=sr.getYear(),Pt=sr.getTime(),BigInt(isNaN(Pt)?-1:Pt/1e3)}function Ww(Pt,sr,pr,xn,Pn,Bo,rp){return _e?ip(16,1,Pt,sr,pr,xn,Pn,Bo,rp):-52}function hy(Pt,sr,pr,xn,Pn,Bo){if(_e)return ip(17,1,Pt,sr,pr,xn,Pn,Bo)}var ow={},ev=()=>performance.timeOrigin+performance.now();function Gw(Pt,sr){if(_e)return ip(18,1,Pt,sr);if(ow[Pt]&&(clearTimeout(ow[Pt].id),delete ow[Pt]),!sr)return 0;var pr=setTimeout(()=>{delete ow[Pt],zo(()=>Py(Pt,performance.timeOrigin+performance.now()))},sr);return ow[Pt]={id:pr,qc:sr},0}function Fv(Pt,sr,pr,xn){Pt>>>=0,sr>>>=0,pr>>>=0,xn>>>=0;var Pn=new Date().getFullYear(),Bo=new Date(Pn,0,1).getTimezoneOffset();Pn=new Date(Pn,6,1).getTimezoneOffset();var rp=Math.max(Bo,Pn);Ro()[Pt>>>2>>>0]=60*rp,Mo()[sr>>>2>>>0]=+(Bo!=Pn),Pt=(sr=cp=>{var vp=Math.abs(cp);return`UTC${0<=cp?"-":"+"}${String(Math.floor(vp/60)).padStart(2,"0")}${String(vp%60).padStart(2,"0")}`})(Bo),sr=sr(Pn),Pn<Bo?(An(Pt,pr,17),An(sr,xn,17)):(An(Pt,xn,17),An(sr,pr,17))}var tv=()=>Date.now();function _y(Pt,sr,pr){return 0<=Pt&&3>=Pt?(Pt===0?Pt=Date.now():Pt=performance.timeOrigin+performance.now(),Tn[pr>>>0>>>3]=BigInt(Math.round(1e6*Pt)),0):28}var Tw=[],kw=(Pt,sr)=>{Tw.length=0;for(var pr;pr=pn()[Pt++>>>0];){var xn=pr!=105;sr+=(xn&=pr!=112)&&sr%8?4:0,Tw.push(pr==112?Ro()[sr>>>2>>>0]:pr==106?Tn[sr>>>3]:pr==105?Mo()[sr>>>2>>>0]:tp()[sr>>>3>>>0]),sr+=xn?8:4}return Tw};function rv(Pt,sr,pr){return Pt>>>=0,sr=kw(sr>>>0,pr>>>0),ep[Pt](...sr)}function nv(Pt,sr,pr){return Pt>>>=0,sr=kw(sr>>>0,pr>>>0),ep[Pt](...sr)}var sv=()=>{};function ov(Pt,sr){return Lt(m_(Pt>>>0,sr>>>0))}var av=()=>{throw wp+=1,"unwind"};function iv(){return 4294901760}var lv=()=>navigator.hardwareConcurrency;function cv(){return _c("Cannot use emscripten_pc_get_function without -sUSE_OFFSET_CONVERTER"),0}function gy(Pt){Pt>>>=0;var sr=pn().length;if(Pt<=sr||4294901760<Pt)return!1;for(var pr=1;4>=pr;pr*=2){var xn=sr*(1+.2/pr);xn=Math.min(xn,Pt+100663296);e:{xn=(Math.min(4294901760,65536*Math.ceil(Math.max(Pt,xn)/65536))-Gt.buffer.byteLength+65535)/65536|0;try{Gt.grow(xn),mr();var Pn=1;break e}catch{}Pn=void 0}if(Pn)return!0}return!1}var $w=()=>(_c("Cannot use convertFrameToPC (needed by __builtin_return_address) without -sUSE_OFFSET_CONVERTER"),0),Jx={},Hw=Pt=>{Pt.forEach(sr=>{$w()})};function uv(){var Pt=Error().stack.toString().split(`
`);return Pt[0]=="Error"&&Pt.shift(),Hw(Pt),Jx.Lb=$w(),Jx.cc=Pt,Jx.Lb}function xy(Pt,sr,pr){if(Pt>>>=0,sr>>>=0,Jx.Lb==Pt)var xn=Jx.cc;else(xn=Error().stack.toString().split(`
`))[0]=="Error"&&xn.shift(),Hw(xn);for(var Pn=3;xn[Pn]&&$w()!=Pt;)++Pn;for(Pt=0;Pt<pr&&xn[Pt+Pn];++Pt)Mo()[sr+4*Pt>>>2>>>0]=$w();return Pt}var Wx,Kw={},dv=()=>{if(!Wx){var Pt,sr={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:"./this.program"};for(Pt in Kw)Kw[Pt]===void 0?delete sr[Pt]:sr[Pt]=Kw[Pt];var pr=[];for(Pt in sr)pr.push(`${Pt}=${sr[Pt]}`);Wx=pr}return Wx};function wy(Pt,sr){if(_e)return ip(19,1,Pt,sr);Pt>>>=0,sr>>>=0;var pr=0;return dv().forEach((xn,Pn)=>{var Bo=sr+pr;for(Pn=Ro()[Pt+4*Pn>>>2>>>0]=Bo,Bo=0;Bo<xn.length;++Bo)lr()[Pn++>>>0]=xn.charCodeAt(Bo);lr()[Pn>>>0]=0,pr+=xn.length+1}),0}function pv(Pt,sr){if(_e)return ip(20,1,Pt,sr);Pt>>>=0,sr>>>=0;var pr=dv();Ro()[Pt>>>2>>>0]=pr.length;var xn=0;return pr.forEach(Pn=>xn+=Pn.length+1),Ro()[sr>>>2>>>0]=xn,0}function yy(Pt){return _e?ip(21,1,Pt):52}function qw(Pt,sr,pr,xn){return _e?ip(22,1,Pt,sr,pr,xn):52}function vy(Pt,sr,pr,xn){return _e?ip(23,1,Pt,sr,pr,xn):70}var fv=[null,[],[]];function by(Pt,sr,pr,xn){if(_e)return ip(24,1,Pt,sr,pr,xn);sr>>>=0,pr>>>=0,xn>>>=0;for(var Pn=0,Bo=0;Bo<pr;Bo++){var rp=Ro()[sr>>>2>>>0],cp=Ro()[sr+4>>>2>>>0];sr+=8;for(var vp=0;vp<cp;vp++){var Sp=pn()[rp+vp>>>0],l_=fv[Pt];Sp===0||Sp===10?((Pt===1?St:Lt)(Pp(l_)),l_.length=0):l_.push(Sp)}Pn+=cp}return Ro()[xn>>>2>>>0]=Pn,0}_e||function(){for(var Pt=h.numThreads-1;Pt--;)H_();gp.unshift(()=>{Jo++,function(sr){_e?sr():Promise.all(u_.map(S_)).then(sr)}(()=>Ho())})}();for(var My=Array(256),Pw=0;256>Pw;++Pw)My[Pw]=String.fromCharCode(Pw);bx=My,N_=h.BindingError=class extends Error{constructor(Pt){super(Pt),this.name="BindingError"}},h.InternalError=class extends Error{constructor(Pt){super(Pt),this.name="InternalError"}},_x.push(0,1,void 0,1,null,1,!0,1,!1,1),h.count_emval_handles=()=>_x.length/2-5-kx.length;var Op,mv=[fp,Rp,e_,ir,In,No,Yo,sp,Cp,n_,zp,i_,kp,h_,$_,xx,Ww,hy,Gw,wy,pv,yy,qw,vy,by];(async function(){function Pt(xn,Pn){return Op=xn.exports,Op=function(){var Bo=Op,rp={};for(let[cp,vp]of Object.entries(Bo))rp[cp]=typeof vp=="function"?(...Sp)=>{Cx.push(cp);try{return vp(...Sp)}finally{fn||(Cx.pop(),Z_&&U_===1&&Cx.length===0&&(U_=0,wp+=1,J_(Ay),typeof Fibers<"u"&&Fibers.rc()))}}:vp;return rp}(),Op=function(){var Bo=Op,rp=vp=>Sp=>vp(Sp)>>>0,cp=vp=>()=>vp()>>>0;return(Bo=Object.assign({},Bo)).Da=rp(Bo.Da),Bo.fb=cp(Bo.fb),Bo.hb=rp(Bo.hb),Bo.tb=rp(Bo.tb),Bo.ub=cp(Bo.ub),Bo.__cxa_get_exception_ptr=rp(Bo.__cxa_get_exception_ptr),Bo}(),C_.push(Op.ib),Bt=Pn,Ho(),Op}Jo++;var sr=Qo();if(h.instantiateWasm)return new Promise(xn=>{h.instantiateWasm(sr,(Pn,Bo)=>{Pt(Pn,Bo),xn(Pn.exports)})});if(_e)return new Promise(xn=>{Wo=Pn=>{var Bo=new WebAssembly.Instance(Pn,Qo());xn(Pt(Bo,Pn))}});Go??(Go=h.locateFile?h.locateFile?h.locateFile("ort-wasm-simd-threaded.jsep.wasm",dt):dt+"ort-wasm-simd-threaded.jsep.wasm":new URL("/assets/ort-wasm-simd-threaded.jsep-B0T3yYHD.wasm",import.meta.url).href);try{var pr=await async function(xn){var Pn=Go;if(!Sn&&typeof WebAssembly.instantiateStreaming=="function"&&!or(Pn))try{var Bo=fetch(Pn,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(Bo,xn)}catch(rp){Lt(`wasm streaming compile failed: ${rp}`),Lt("falling back to ArrayBuffer instantiation")}return async function(rp,cp){try{var vp=await async function(Sp){if(!Sn)try{var l_=await ct(Sp);return new Uint8Array(l_)}catch{}if(Sp==Go&&Sn)Sp=new Uint8Array(Sn);else{if(!mt)throw"both async and sync fetching of the wasm failed";Sp=mt(Sp)}return Sp}(rp);return await WebAssembly.instantiate(vp,cp)}catch(Sp){Lt(`failed to asynchronously prepare wasm: ${Sp}`),_c(Sp)}}(Pn,xn)}(sr);return Pt(pr.instance,pr.module)}catch(xn){return d(xn),Promise.reject(xn)}})();var Ey=Pt=>(Ey=Op.Da)(Pt),Ty=()=>(Ty=Op.Ea)();h._OrtInit=(Pt,sr)=>(h._OrtInit=Op.Fa)(Pt,sr),h._OrtGetLastError=(Pt,sr)=>(h._OrtGetLastError=Op.Ga)(Pt,sr),h._OrtCreateSessionOptions=(Pt,sr,pr,xn,Pn,Bo,rp,cp,vp,Sp)=>(h._OrtCreateSessionOptions=Op.Ha)(Pt,sr,pr,xn,Pn,Bo,rp,cp,vp,Sp),h._OrtAppendExecutionProvider=(Pt,sr,pr,xn,Pn)=>(h._OrtAppendExecutionProvider=Op.Ia)(Pt,sr,pr,xn,Pn),h._OrtAddFreeDimensionOverride=(Pt,sr,pr)=>(h._OrtAddFreeDimensionOverride=Op.Ja)(Pt,sr,pr),h._OrtAddSessionConfigEntry=(Pt,sr,pr)=>(h._OrtAddSessionConfigEntry=Op.Ka)(Pt,sr,pr),h._OrtReleaseSessionOptions=Pt=>(h._OrtReleaseSessionOptions=Op.La)(Pt),h._OrtCreateSession=(Pt,sr,pr)=>(h._OrtCreateSession=Op.Ma)(Pt,sr,pr),h._OrtReleaseSession=Pt=>(h._OrtReleaseSession=Op.Na)(Pt),h._OrtGetInputOutputCount=(Pt,sr,pr)=>(h._OrtGetInputOutputCount=Op.Oa)(Pt,sr,pr),h._OrtGetInputOutputMetadata=(Pt,sr,pr,xn)=>(h._OrtGetInputOutputMetadata=Op.Pa)(Pt,sr,pr,xn),h._OrtFree=Pt=>(h._OrtFree=Op.Qa)(Pt),h._OrtCreateTensor=(Pt,sr,pr,xn,Pn,Bo)=>(h._OrtCreateTensor=Op.Ra)(Pt,sr,pr,xn,Pn,Bo),h._OrtGetTensorData=(Pt,sr,pr,xn,Pn)=>(h._OrtGetTensorData=Op.Sa)(Pt,sr,pr,xn,Pn),h._OrtReleaseTensor=Pt=>(h._OrtReleaseTensor=Op.Ta)(Pt),h._OrtCreateRunOptions=(Pt,sr,pr,xn)=>(h._OrtCreateRunOptions=Op.Ua)(Pt,sr,pr,xn),h._OrtAddRunConfigEntry=(Pt,sr,pr)=>(h._OrtAddRunConfigEntry=Op.Va)(Pt,sr,pr),h._OrtReleaseRunOptions=Pt=>(h._OrtReleaseRunOptions=Op.Wa)(Pt),h._OrtCreateBinding=Pt=>(h._OrtCreateBinding=Op.Xa)(Pt),h._OrtBindInput=(Pt,sr,pr)=>(h._OrtBindInput=Op.Ya)(Pt,sr,pr),h._OrtBindOutput=(Pt,sr,pr,xn)=>(h._OrtBindOutput=Op.Za)(Pt,sr,pr,xn),h._OrtClearBoundOutputs=Pt=>(h._OrtClearBoundOutputs=Op._a)(Pt),h._OrtReleaseBinding=Pt=>(h._OrtReleaseBinding=Op.$a)(Pt),h._OrtRunWithBinding=(Pt,sr,pr,xn,Pn)=>(h._OrtRunWithBinding=Op.ab)(Pt,sr,pr,xn,Pn),h._OrtRun=(Pt,sr,pr,xn,Pn,Bo,rp,cp)=>(h._OrtRun=Op.bb)(Pt,sr,pr,xn,Pn,Bo,rp,cp),h._OrtEndProfiling=Pt=>(h._OrtEndProfiling=Op.cb)(Pt),h._JsepOutput=(Pt,sr,pr)=>(h._JsepOutput=Op.db)(Pt,sr,pr),h._JsepGetNodeName=Pt=>(h._JsepGetNodeName=Op.eb)(Pt);var dw=()=>(dw=Op.fb)(),Sx=h._free=Pt=>(Sx=h._free=Op.gb)(Pt),Cw=h._malloc=Pt=>(Cw=h._malloc=Op.hb)(Pt),Sw=(Pt,sr,pr,xn,Pn,Bo)=>(Sw=Op.kb)(Pt,sr,pr,xn,Pn,Bo),ky=()=>(ky=Op.lb)(),$y=(Pt,sr,pr,xn,Pn)=>($y=Op.mb)(Pt,sr,pr,xn,Pn),Qw=Pt=>(Qw=Op.nb)(Pt),Xw=Pt=>(Xw=Op.ob)(Pt),Py=(Pt,sr)=>(Py=Op.pb)(Pt,sr),Yw=()=>(Yw=Op.qb)(),Cy=(Pt,sr)=>(Cy=Op.rb)(Pt,sr),Aw=Pt=>(Aw=Op.sb)(Pt),Iw=Pt=>(Iw=Op.tb)(Pt),Jw=()=>(Jw=Op.ub)(),Sy=h.dynCall_ii=(Pt,sr)=>(Sy=h.dynCall_ii=Op.vb)(Pt,sr),Zw=Pt=>(Zw=Op.wb)(Pt),Ay=()=>(Ay=Op.xb)(),Iy=Pt=>(Iy=Op.yb)(Pt),ey=()=>(ey=Op.zb)();return h.stackSave=()=>Jw(),h.stackRestore=Pt=>Aw(Pt),h.stackAlloc=Pt=>Iw(Pt),h.setValue=function(Pt,sr,pr="i8"){switch(pr.endsWith("*")&&(pr="*"),pr){case"i1":case"i8":lr()[Pt>>>0]=sr;break;case"i16":Cn()[Pt>>>1>>>0]=sr;break;case"i32":Mo()[Pt>>>2>>>0]=sr;break;case"i64":Tn[Pt>>>3]=BigInt(sr);break;case"float":qo()[Pt>>>2>>>0]=sr;break;case"double":tp()[Pt>>>3>>>0]=sr;break;case"*":Ro()[Pt>>>2>>>0]=sr;break;default:_c(`invalid type for setValue: ${pr}`)}},h.getValue=function(Pt,sr="i8"){switch(sr.endsWith("*")&&(sr="*"),sr){case"i1":case"i8":return lr()[Pt>>>0];case"i16":return Cn()[Pt>>>1>>>0];case"i32":return Mo()[Pt>>>2>>>0];case"i64":return Tn[Pt>>>3];case"float":return qo()[Pt>>>2>>>0];case"double":return tp()[Pt>>>3>>>0];case"*":return Ro()[Pt>>>2>>>0];default:_c(`invalid type for getValue: ${sr}`)}},h.UTF8ToString=m_,h.stringToUTF8=An,h.lengthBytesUTF8=wn,function Pt(){if(0<Jo)_i=Pt;else if(_e)c(h),Do();else{for(;0<gp.length;)gp.shift()(h);0<Jo?_i=Pt:(h.calledRun=!0,fn||(Do(),c(h)))}}(),h.PTR_SIZE=4,_}),Fp=Sa,qp=(s=(e=globalThis.self)==null?void 0:e.name)==null?void 0:s.startsWith("em-pthread"),qp&&Sa()}),Ea,Gn,jp,Ue,ka,Ln,Kp,Zp,Pa,Qp,Ca,za,Aa,Oa,_r=U(()=>{yr(),Ea=typeof location>"u"?void 0:location.origin,Gn=import.meta.url>"file:"&&import.meta.url<"file;",jp=()=>{{if(Gn){let e=URL;return new URL(new e("ort.bundle.min.mjs",import.meta.url).href,Ea).href}return import.meta.url}},Ue=jp(),ka=()=>{if(Ue&&!Ue.startsWith("blob:"))return Ue.substring(0,Ue.lastIndexOf("/")+1)},Ln=(e,s)=>{try{let i=s??Ue;return(i?new URL(e,i):new URL(e)).origin===Ea}catch{return!1}},Kp=(e,s)=>{let i=s??Ue;try{return(i?new URL(e,i):new URL(e)).href}catch{return}},Zp=(e,s)=>`${s??"./"}${e}`,Pa=async e=>{let s=await(await fetch(e,{credentials:"same-origin"})).blob();return URL.createObjectURL(s)},Qp=async e=>(await import(e)).default,Ca=(xa(),Ft($a)).default,za=async()=>{if(!Ue)throw new Error("Failed to load proxy worker: cannot determine the script source URL.");if(Ln(Ue))return[void 0,Ca()];let e=await Pa(Ue);return[e,Ca(e)]},Aa=(Ia(),Ft(Ta)).default,Oa=async(e,s,i)=>{if(!e&&!s&&Aa&&Ue&&Ln(Ue))return[void 0,Aa];{let c="ort-wasm-simd-threaded.jsep.mjs",d=e??Kp(c,s),h=i&&d&&!Ln(d,s),_=h?await Pa(d):d??Zp(c,s);return[h?_:void 0,await Qp(_)]}}}),Hn,Fn,Ar,Ba,Yp,Xp,Jp,wr,fe,ht=U(()=>{_r(),Fn=!1,Ar=!1,Ba=!1,Yp=()=>{if(typeof SharedArrayBuffer>"u")return!1;try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},Xp=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},Jp=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,19,1,17,0,65,1,253,15,65,2,253,15,65,3,253,15,253,147,2,11]))}catch{return!1}},wr=async e=>{if(Fn)return Promise.resolve();if(Ar)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(Ba)throw new Error("previous call to 'initializeWebAssembly()' failed.");Ar=!0;let s=e.initTimeout,i=e.numThreads;if(e.simd!==!1){if(e.simd==="relaxed"){if(!Jp())throw new Error("Relaxed WebAssembly SIMD is not supported in the current environment.")}else if(!Xp())throw new Error("WebAssembly SIMD is not supported in the current environment.")}let c=Yp();i>1&&!c&&(typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+i+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),console.warn("WebAssembly multi-threading is not supported in the current environment. Falling back to single-threading."),e.numThreads=i=1);let d=e.wasmPaths,h=typeof d=="string"?d:void 0,_=d==null?void 0:d.mjs,g=(_==null?void 0:_.href)??_,$=d==null?void 0:d.wasm,_e=($==null?void 0:$.href)??$,lt=e.wasmBinary,[at,it]=await Oa(g,h,i>1),ct=!1,mt=[];if(s>0&&mt.push(new Promise(pt=>{setTimeout(()=>{ct=!0,pt()},s)})),mt.push(new Promise((pt,zt)=>{let dt={numThreads:i};if(lt)dt.wasmBinary=lt;else if(_e||h)dt.locateFile=ft=>_e??h+ft;else if(g&&g.indexOf("blob:")!==0)dt.locateFile=ft=>new URL(ft,g).href;else if(at){let ft=ka();ft&&(dt.locateFile=kt=>ft+kt)}it(dt).then(ft=>{Ar=!1,Fn=!0,Hn=ft,pt(),at&&URL.revokeObjectURL(at)},ft=>{Ar=!1,Ba=!0,zt(ft)})})),await Promise.race(mt),ct)throw new Error(`WebAssembly backend initializing failed due to timeout: ${s}ms`)},fe=()=>{if(Fn&&Hn)return Hn;throw new Error("WebAssembly is not initialized yet.")}}),Ne,Kt,pe,Er=U(()=>{ht(),Ne=(e,s)=>{let i=fe(),c=i.lengthBytesUTF8(e)+1,d=i._malloc(c);return i.stringToUTF8(e,d,c),s.push(d),d},Kt=(e,s,i,c)=>{if(typeof e=="object"&&e!==null){if(i.has(e))throw new Error("Circular reference in options");i.add(e)}Object.entries(e).forEach(([d,h])=>{let _=s?s+d:d;if(typeof h=="object")Kt(h,_+".",i,c);else if(typeof h=="string"||typeof h=="number")c(_,h.toString());else if(typeof h=="boolean")c(_,h?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof h}`)})},pe=e=>{let s=fe(),i=s.stackSave();try{let c=s.PTR_SIZE,d=s.stackAlloc(2*c);s._OrtGetLastError(d,d+c);let h=Number(s.getValue(d,c===4?"i32":"i64")),_=s.getValue(d+c,"*"),g=_?s.UTF8ToString(_):"";throw new Error(`${e} ERROR_CODE: ${h}, ERROR_MESSAGE: ${g}`)}finally{s.stackRestore(i)}}}),Da,Ma=U(()=>{ht(),Er(),Da=e=>{let s=fe(),i=0,c=[],d=e||{};try{if((e==null?void 0:e.logSeverityLevel)===void 0)d.logSeverityLevel=2;else if(typeof e.logSeverityLevel!="number"||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if((e==null?void 0:e.logVerbosityLevel)===void 0)d.logVerbosityLevel=0;else if(typeof e.logVerbosityLevel!="number"||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);(e==null?void 0:e.terminate)===void 0&&(d.terminate=!1);let h=0;return(e==null?void 0:e.tag)!==void 0&&(h=Ne(e.tag,c)),i=s._OrtCreateRunOptions(d.logSeverityLevel,d.logVerbosityLevel,!!d.terminate,h),i===0&&pe("Can't create run options."),(e==null?void 0:e.extra)!==void 0&&Kt(e.extra,"",new WeakSet,(_,g)=>{let $=Ne(_,c),_e=Ne(g,c);s._OrtAddRunConfigEntry(i,$,_e)!==0&&pe(`Can't set a run config entry: ${_} - ${g}.`)}),[i,c]}catch(h){throw i!==0&&s._OrtReleaseRunOptions(i),c.forEach(_=>s._free(_)),h}}}),em,tm,rm,kr,nm,Ra,Ua=U(()=>{ht(),Er(),em=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},tm=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},rm=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let s=e.extra.session;s.use_ort_model_bytes_directly||(s.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(i=>(typeof i=="string"?i:i.name)==="webgpu")&&(e.enableMemPattern=!1)},kr=(e,s,i,c)=>{let d=Ne(s,c),h=Ne(i,c);fe()._OrtAddSessionConfigEntry(e,d,h)!==0&&pe(`Can't set a session config entry: ${s} - ${i}.`)},nm=async(e,s,i)=>{for(let c of s){let d=typeof c=="string"?c:c.name,h=[];switch(d){case"webnn":if(d="WEBNN",typeof c!="string"){let lt=c==null?void 0:c.deviceType;lt&&kr(e,"deviceType",lt,i)}break;case"webgpu":if(d="JS",typeof c!="string"){let lt=c;if(lt!=null&&lt.preferredLayout){if(lt.preferredLayout!=="NCHW"&&lt.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${lt.preferredLayout}`);kr(e,"preferredLayout",lt.preferredLayout,i)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${d}`)}let _=Ne(d,i),g=h.length,$=0,_e=0;if(g>0){$=fe()._malloc(g*fe().PTR_SIZE),i.push($),_e=fe()._malloc(g*fe().PTR_SIZE),i.push(_e);for(let lt=0;lt<g;lt++)fe().setValue($+lt*fe().PTR_SIZE,h[lt][0],"*"),fe().setValue(_e+lt*fe().PTR_SIZE,h[lt][1],"*")}await fe()._OrtAppendExecutionProvider(e,_,$,_e,g)!==0&&pe(`Can't append execution provider: ${d}.`)}},Ra=async e=>{let s=fe(),i=0,c=[],d=e||{};rm(d);try{let h=em(d.graphOptimizationLevel??"all"),_=tm(d.executionMode??"sequential"),g=typeof d.logId=="string"?Ne(d.logId,c):0,$=d.logSeverityLevel??2;if(!Number.isInteger($)||$<0||$>4)throw new Error(`log serverity level is not valid: ${$}`);let _e=d.logVerbosityLevel??0;if(!Number.isInteger(_e)||_e<0||_e>4)throw new Error(`log verbosity level is not valid: ${_e}`);let lt=typeof d.optimizedModelFilePath=="string"?Ne(d.optimizedModelFilePath,c):0;if(i=s._OrtCreateSessionOptions(h,!!d.enableCpuMemArena,!!d.enableMemPattern,_,!!d.enableProfiling,0,g,$,_e,lt),i===0&&pe("Can't create session options."),d.executionProviders&&await nm(i,d.executionProviders,c),d.enableGraphCapture!==void 0){if(typeof d.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${d.enableGraphCapture}`);kr(i,"enableGraphCapture",d.enableGraphCapture.toString(),c)}if(d.freeDimensionOverrides)for(let[at,it]of Object.entries(d.freeDimensionOverrides)){if(typeof at!="string")throw new Error(`free dimension override name must be a string: ${at}`);if(typeof it!="number"||!Number.isInteger(it)||it<0)throw new Error(`free dimension override value must be a non-negative integer: ${it}`);let ct=Ne(at,c);s._OrtAddFreeDimensionOverride(i,ct,it)!==0&&pe(`Can't set a free dimension override: ${at} - ${it}.`)}return d.extra!==void 0&&Kt(d.extra,"",new WeakSet,(at,it)=>{kr(i,at,it,c)}),[i,c]}catch(h){throw i!==0&&s._OrtReleaseSessionOptions(i)!==0&&pe("Can't release session options."),c.forEach(_=>s._free(_)),h}}}),Mt,Ye,gt,Pr,Zt,zr,Or,qn,ee=U(()=>{Mt=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;case"int4":return 22;case"uint4":return 21;default:throw new Error(`unsupported data type: ${e}`)}},Ye=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";case 22:return"int4";case 21:return"uint4";default:throw new Error(`unsupported data type: ${e}`)}},gt=(e,s)=>{let i=[-1,4,1,1,2,2,4,8,-1,1,2,8,4,8,-1,-1,-1,-1,-1,-1,-1,.5,.5][e],c=typeof s=="number"?s:s.reduce((d,h)=>d*h,1);return i>0?Math.ceil(c*i):void 0},Pr=e=>{switch(e){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},Zt=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},zr=e=>e==="float32"||e==="float16"||e==="int32"||e==="int64"||e==="uint32"||e==="uint8"||e==="bool"||e==="uint4"||e==="int4",Or=e=>e==="float32"||e==="float16"||e==="int32"||e==="int64"||e==="uint32"||e==="uint64"||e==="int8"||e==="uint8"||e==="bool"||e==="uint4"||e==="int4",qn=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;case"ml-tensor":return 5;default:throw new Error(`unsupported data location: ${e}`)}}}),Qt,jn=U(()=>{yr(),Qt=async e=>{if(typeof e=="string"){let s=await fetch(e);if(!s.ok)throw new Error(`failed to load external data file: ${e}`);let i=s.headers.get("Content-Length"),c=i?parseInt(i,10):0;if(c<1073741824)return new Uint8Array(await s.arrayBuffer());{if(!s.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let d=s.body.getReader(),h;try{h=new ArrayBuffer(c)}catch(g){if(g instanceof RangeError){let $=Math.ceil(c/65536);h=new WebAssembly.Memory({initial:$,maximum:$}).buffer}else throw g}let _=0;for(;;){let{done:g,value:$}=await d.read();if(g)break;let _e=$.byteLength;new Uint8Array(h,_,_e).set($),_+=_e}return new Uint8Array(h,0,c)}}else return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e)}}),om,im,Na,Va,Br,am,se,Xe=U(()=>{ee(),om=["V","I","W","E","F"],im=(e,s)=>{console.log(`[${om[e]},${new Date().toISOString()}]${s}`)},Br=(e,s)=>{Na=e,Va=s},am=(e,s)=>{let i=Zt(e),c=Zt(Na);i>=c&&im(i,typeof s=="function"?s():s)},se=(...e)=>{Va&&am(...e)}}),Kn,Je,k,Tt,Dr,Wa,La,ne=U(()=>{Kn=class{static calcMatMulShape(e,s){return e[1]!==s[0]?void 0:[e[0],s[1]]}},Je=class{static calcShape(e,s,i=!1){let c=e.length,d=s.length;if(c===0)return s;if(d===0)return e;let h=Math.max(e.length,s.length),_=new Array(h);if(i){if(c<2||d<2)return;let g=Kn.calcMatMulShape([e[c-2],e[c-1]],[s[d-2],s[d-1]]);if(g===void 0)return;[_[h-2],_[h-1]]=g}for(let g=i?3:1;g<=h;g++){let $=c-g<0?1:e[c-g],_e=d-g<0?1:s[d-g];if($!==_e&&$>1&&_e>1)return;let lt=Math.max($,_e);if($&&_e)_[h-g]=Math.max($,_e);else{if(lt>1)return;_[h-g]=0}}return _}static isValidBroadcast(e,s){let i=e.length,c=s.length;if(i>c)return!1;for(let d=1;d<=i;d++)if(e[i-d]!==1&&e[i-d]!==s[c-d])return!1;return!0}},k=class Lv{static size(s){return Lv.getSizeFromDimensionRange(s,0,s.length)}static convertShape(s,i=4){let c=s.length;if(c===0)return[];let d=new Array(c),h=c-1;for(;h>=0;){if(s[h]%i===0){d[h]=s[h]/i;break}if(i%s[h]!==0)throw new Error("cannot convert shape");d[h]=1,i/=s[h],h--}for(h--;h>=0;h--)d[h]=s[h];return d}static sizeFromDimension(s,i){if(i<0||i>s.length)throw new Error(`invalid dimension of ${i} for sizeFromDimension as Tensor has ${s.length} dimensions.`);return Lv.getSizeFromDimensionRange(s,i,s.length)}static sizeToDimension(s,i){if(i<0||i>s.length)throw new Error(`invalid dimension of ${i} for sizeToDimension as Tensor has ${s.length} dimensions.`);return Lv.getSizeFromDimensionRange(s,0,i)}static getSizeFromDimensionRange(s,i,c){let d=1;for(let h=i;h<c;h++){if(s[h]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");d*=Number(s[h])}return d}static computeStrides(s){let i=s.length;if(i===0)return[];if(i===1)return[1];let c=new Array(i);c[i-1]=1,c[i-2]=s[i-1];for(let d=i-3;d>=0;--d)c[d]=c[d+1]*s[d+1];return c}static normalizeAxis(s,i){if(s<-i&&s>=i)throw new Error("unsupported axis for this operation.");return s<0?s+i:s}static normalizeAxes(s,i){return s.map(c=>this.normalizeAxis(c,i??s.length))}static sortBasedOnPerm(s,i){return i?i.map(c=>s[c]):s.slice().reverse()}static padShape(s,i){let c=s.length;return s.map((d,h)=>d+i[h]+i[h+c])}static areEqual(s,i){return s.length!==i.length?!1:s.every((c,d)=>c===i[d])}},Tt=class Ly{static adjustPoolAttributes(s,i,c,d,h,_){if(!s&&c.length!==i.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(s)for(let g=0;g<i.length-2;g++)g>=c.length?c.push(i[g+2]):c[g]=i[g+2];for(let g=0;g<c.length;g++)if(g<d.length){if(d[g]<0)throw new Error("strides should be greater than or equal to 1")}else d.push(1);for(let g=0;g<c.length;g++)if(g<h.length){if(h[g]<0)throw new Error("dilations should be greater than or equal to 1")}else h.push(1);for(let g=0;g<c.length*2;g++)if(g<_.length){if(_[g]<0)throw new Error("pad should be greater than or equal to 1")}else _.push(0);for(let g=0;g<c.length;g++){if(c[g]<=0)throw new Error("kernel shapes need to be greater than 0");if(_[g]>=c[g]||_[g+c.length]>=c[g])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(s,i,c,d,h,_,g){if(g){if(h.length!==2*(s.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(i.length!==s.length-2)throw new Error("length of strides should be the length of data dimensions");if(d.length!==s.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let $=0;$<s.length-2;$++)Ly.adjustPadAndReturnShape(s[$+(_?1:2)],i[$],c[$],d[$],h,$,$+s.length-2,g)}}static computePoolOutputShape(s,i,c,d,h,_,g){if(i.length<=0)throw new Error("input shape must be of size greater than 0");let $=[i[0],i[1]];return Ly.computeShapeHelper(s,i,$,c,d,h,_,g),$}static computeConvOutputShape(s,i,c,d,h,_,g){if(s.length<=0||i.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let $=[s[0],i[0]];return Ly.computeShapeHelper(!1,s,$,c,d,h,_,g),$}static computeShapeHelper(s,i,c,d,h,_,g,$){if(s)for(let _e=0;_e<i.length-2;_e++)c.push(1);else for(let _e=0;_e<i.length-2;_e++)c.push(Ly.adjustPadAndReturnShape(i[_e+2],d[_e],h[_e],_[_e],g,_e,_e+i.length-2,$))}static adjustPadAndReturnShape(s,i,c,d,h,_,g,$){let _e=c*(d-1)+1;if($&&$!=="NOTSET")switch($){case"VALID":return h[_]=0,h[g]=0,Math.floor((s-_e)/i+1);case"SAME_LOWER":case"SAME_UPPER":if(c!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let lt=((s+i-1)/i-1)*i+d-s;return h[_]=Math.floor($==="SAME_LOWER"?(lt+1)/2:lt/2),h[g]=lt-h[_],Math.floor((s+lt-d)/i+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((s+h[_]+h[g]-_e)/i+1)}},Dr=class{static getShapeOfGemmResult(e,s,i,c,d){if(e.length!==2||i.length!==2)throw new Error("shape need to be of size 2");let h,_,g;s?(h=e[1],_=e[0]):(h=e[0],_=e[1]);let $=-1;if(c?(g=i[0],$=1):(g=i[1],$=0),i[$]!==_)throw new Error("dimension mismatch");if(h<=0||g<=0||_<=0)throw new Error("invalid shape specified");if(d&&!Je.isValidBroadcast(d,[h,g]))throw new Error("gemm: invalid bias shape for broadcast");return[h,g,_]}},Wa=-34028234663852886e22,La=34028234663852886e22}),Mr,Zn=U(()=>{ee(),Mr=(e,s)=>new(Pr(s))(e)}),Yn,Ha,sm,Ga,um,Fa,Rr,Ur,Qn,qa,ja=U(()=>{Xe(),Yn=(e,s=!0)=>{if(e.byteLength%8!==0)throw new Error("Invalid Uint8Array length - must be a multiple of 8 (BigInt).");let i=e.byteLength/8,c=new BigInt64Array(e.buffer,e.byteOffset,i),d=new Int32Array(i);for(let h=0;h<i;h++){let _=c[h];if(_>2147483647n||_<-2147483648n)throw new Error(`Overflow occurred when converting BigInt to Int32 at index ${h}: ${_}`);d[h]=Number(_)}return s?new Uint8Array(d.buffer):d},Ha=(e,s=!0)=>{if(e.byteLength%4!==0)throw new Error("Invalid Uint8Array length - must be a multiple of 4 (Int32).");let i=e.byteLength/4,c=new Int32Array(e.buffer,e.byteOffset,i),d=BigInt64Array.from(c,BigInt);return s?new Uint8Array(d.buffer):d},sm=1,Ga=()=>sm++,um=new Map([["float32",32],["float16",16],["int32",32],["uint32",32],["int64",64],["uint64",64],["int8",8],["uint8",8],["int4",4],["uint4",4]]),Fa=(e,s)=>{let i=um.get(e);if(!i)throw new Error("Unsupported data type.");return s.length>0?Math.ceil(s.reduce((c,d)=>c*d)*i/8):0},Rr=class{constructor(e){this.shouldConvertInt64toInt32=!1,this.isInt64ToInt32Converted=!1;let{sessionId:s,context:i,tensor:c,dataType:d,shape:h,shouldConvertInt64toInt32:_=!1}=e;this.sessionId=s,this.mlContext=i,this.mlTensor=c,this.dataType=d,this.tensorShape=h,this.shouldConvertInt64toInt32=_}get tensor(){return this.mlTensor}get type(){return this.dataType}get shape(){return this.tensorShape}get byteLength(){return Fa(this.dataType,this.tensorShape)}destroy(){se("verbose",()=>"[WebNN] TensorWrapper.destroy"),this.mlTensor.destroy()}write(e){this.mlContext.writeTensor(this.mlTensor,e)}async read(e,s){if(e){let i=await this.mlContext.readTensor(this.mlTensor),c=Ha(new Uint8Array(i));if(s){(s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer,s.byteOffset,s.byteLength)).set(c);return}else return c.buffer}else return s?this.mlContext.readTensor(this.mlTensor,s):this.mlContext.readTensor(this.mlTensor)}canReuseTensor(e,s,i){return this.mlContext===e&&this.dataType===s&&this.tensorShape.length===i.length&&this.tensorShape.every((c,d)=>c===i[d])}setIsInt64ToInt32Converted(e){this.isInt64ToInt32Converted=e}},Ur=class{constructor(e,s){this.tensorManager=e,this.wrapper=s}get tensorWrapper(){return this.wrapper}releaseTensor(){this.tensorWrapper&&(this.tensorManager.releaseTensor(this.tensorWrapper),this.wrapper=void 0)}async ensureTensor(e,s,i,c){let d=s,h=this.tensorManager.getMLContext(e),_=d==="int64"&&!h.opSupportLimits().input.dataTypes.includes("int64");if(_&&(d="int32",se("verbose",()=>"[WebNN] TensorIdTracker.ensureTensor: convert dataType from int64 to int32")),this.wrapper){if(this.wrapper.canReuseTensor(h,d,i))return this.wrapper.tensor;if(c){if(this.wrapper.byteLength!==Fa(d,i))throw new Error("Unable to copy data to tensor with different size.");this.activeUpload=new Uint8Array(await this.wrapper.read())}this.tensorManager.releaseTensor(this.wrapper)}let g=typeof MLTensorUsage>"u"?void 0:MLTensorUsage.READ|MLTensorUsage.WRITE;return this.wrapper=await this.tensorManager.getCachedTensor(e,d,i,g,!0,!0,_),c&&this.activeUpload&&(this.wrapper.write(this.activeUpload),this.activeUpload=void 0),this.wrapper.tensor}upload(e){let s=e;if(this.wrapper)if(this.wrapper.shouldConvertInt64toInt32&&(s=Yn(e,!0),this.wrapper.setIsInt64ToInt32Converted(!0)),s.byteLength===this.wrapper.byteLength){this.wrapper.write(s);return}else se("verbose",()=>"Data size does not match tensor size. Releasing tensor."),this.releaseTensor();this.activeUpload?this.activeUpload.set(s):this.activeUpload=new Uint8Array(s)}async download(e){var s,i,c;if(this.activeUpload){let d=(s=this.wrapper)!=null&&s.isInt64ToInt32Converted?Ha(this.activeUpload):this.activeUpload;if(e){e instanceof ArrayBuffer?new Uint8Array(e).set(d):new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(d);return}else return d.buffer}if(!this.wrapper)throw new Error("Tensor has not been created.");return e?this.wrapper.read((i=this.wrapper)==null?void 0:i.shouldConvertInt64toInt32,e):this.wrapper.read((c=this.wrapper)==null?void 0:c.shouldConvertInt64toInt32)}},Qn=class{constructor(e){this.backend=e,this.tensorTrackersById=new Map,this.freeTensors=[],this.externalTensors=new Set}getMLContext(e){let s=this.backend.getMLContext(e);if(!s)throw new Error("MLContext not found for session.");return s}reserveTensorId(){let e=Ga();return this.tensorTrackersById.set(e,new Ur(this)),e}releaseTensorId(e){let s=this.tensorTrackersById.get(e);s&&(this.tensorTrackersById.delete(e),s.tensorWrapper&&this.releaseTensor(s.tensorWrapper))}async ensureTensor(e,s,i,c,d){se("verbose",()=>`[WebNN] TensorManager.ensureTensor {tensorId: ${s}, dataType: ${i}, shape: ${c}, copyOld: ${d}}`);let h=this.tensorTrackersById.get(s);if(!h)throw new Error("Tensor not found.");return h.ensureTensor(e,i,c,d)}upload(e,s){let i=this.tensorTrackersById.get(e);if(!i)throw new Error("Tensor not found.");i.upload(s)}async download(e,s){se("verbose",()=>`[WebNN] TensorManager.download {tensorId: ${e}, dstBuffer: ${s==null?void 0:s.byteLength}}`);let i=this.tensorTrackersById.get(e);if(!i)throw new Error("Tensor not found.");return i.download(s)}releaseTensorsForSession(e){for(let s of this.freeTensors)s.sessionId===e&&s.destroy();this.freeTensors=this.freeTensors.filter(s=>s.sessionId!==e)}registerTensor(e,s,i,c){let d=this.getMLContext(e),h=Ga(),_=new Rr({sessionId:e,context:d,tensor:s,dataType:i,shape:c});return this.tensorTrackersById.set(h,new Ur(this,_)),this.externalTensors.add(_),h}async getCachedTensor(e,s,i,c,d,h,_=!1){let g=this.getMLContext(e);for(let[_e,lt]of this.freeTensors.entries())if(lt.canReuseTensor(g,s,i)){se("verbose",()=>`[WebNN] Reusing tensor {dataType: ${s}, shape: ${i}}`);let at=this.freeTensors.splice(_e,1)[0];return at.sessionId=e,at}se("verbose",()=>`[WebNN] MLContext.createTensor {dataType: ${s}, shape: ${i}}`);let $=await g.createTensor({dataType:s,shape:i,dimensions:i,usage:c,writable:d,readable:h});return new Rr({sessionId:e,context:g,tensor:$,dataType:s,shape:i,shouldConvertInt64toInt32:_})}releaseTensor(e){this.externalTensors.has(e)&&this.externalTensors.delete(e),this.freeTensors.push(e)}},qa=(...e)=>new Qn(...e)}),Xn,dm,Nr,Ka=U(()=>{ee(),ht(),Zn(),ja(),Xe(),Xn=new Map([[1,"float32"],[10,"float16"],[6,"int32"],[12,"uint32"],[7,"int64"],[13,"uint64"],[22,"int4"],[21,"uint4"],[3,"int8"],[2,"uint8"],[9,"uint8"]]),dm=(e,s)=>{if(e===s)return!0;if(e===void 0||s===void 0)return!1;let i=Object.keys(e).sort(),c=Object.keys(s).sort();return i.length===c.length&&i.every((d,h)=>d===c[h]&&e[d]===s[d])},Nr=class{constructor(e){this.tensorManager=qa(this),this.mlContextBySessionId=new Map,this.sessionIdsByMLContext=new Map,this.mlContextCache=[],this.sessionGraphInputs=new Map,this.temporaryGraphInputs=[],this.temporarySessionTensorIds=new Map,Br(e.logLevel,!!e.debug)}get currentSessionId(){if(this.activeSessionId===void 0)throw new Error("No active session");return this.activeSessionId}onRunStart(e){se("verbose",()=>`[WebNN] onRunStart {sessionId: ${e}}`),this.activeSessionId=e}onRunEnd(e){se("verbose",()=>`[WebNN] onRunEnd {sessionId: ${e}}`);let s=this.temporarySessionTensorIds.get(e);if(s){for(let i of s)se("verbose",()=>`[WebNN] releasing temporary tensor {tensorId: ${i}}`),this.tensorManager.releaseTensorId(i);this.temporarySessionTensorIds.delete(e),this.activeSessionId=void 0}}async createMLContext(e){if(e instanceof GPUDevice){let i=this.mlContextCache.findIndex(c=>c.gpuDevice===e);if(i!==-1)return this.mlContextCache[i].mlContext;{let c=await navigator.ml.createContext(e);return this.mlContextCache.push({gpuDevice:e,mlContext:c}),c}}else if(e===void 0){let i=this.mlContextCache.findIndex(c=>c.options===void 0&&c.gpuDevice===void 0);if(i!==-1)return this.mlContextCache[i].mlContext;{let c=await navigator.ml.createContext();return this.mlContextCache.push({mlContext:c}),c}}let s=this.mlContextCache.findIndex(i=>dm(i.options,e));if(s!==-1)return this.mlContextCache[s].mlContext;{let i=await navigator.ml.createContext(e);return this.mlContextCache.push({options:e,mlContext:i}),i}}registerMLContext(e,s){this.mlContextBySessionId.set(e,s);let i=this.sessionIdsByMLContext.get(s);i||(i=new Set,this.sessionIdsByMLContext.set(s,i)),i.add(e),this.temporaryGraphInputs.length>0&&(this.sessionGraphInputs.set(e,this.temporaryGraphInputs),this.temporaryGraphInputs=[])}onReleaseSession(e){this.sessionGraphInputs.delete(e);let s=this.mlContextBySessionId.get(e);if(!s)return;this.tensorManager.releaseTensorsForSession(e),this.mlContextBySessionId.delete(e);let i=this.sessionIdsByMLContext.get(s);if(i.delete(e),i.size===0){this.sessionIdsByMLContext.delete(s);let c=this.mlContextCache.findIndex(d=>d.mlContext===s);c!==-1&&this.mlContextCache.splice(c,1)}}getMLContext(e){return this.mlContextBySessionId.get(e)}reserveTensorId(){return this.tensorManager.reserveTensorId()}releaseTensorId(e){se("verbose",()=>`[WebNN] releaseTensorId {tensorId: ${e}}`),this.tensorManager.releaseTensorId(e)}async ensureTensor(e,s,i,c,d){let h=Xn.get(i);if(!h)throw new Error(`Unsupported ONNX data type: ${i}`);return this.tensorManager.ensureTensor(e??this.currentSessionId,s,h,c,d)}async createTemporaryTensor(e,s,i){se("verbose",()=>`[WebNN] createTemporaryTensor {onnxDataType: ${s}, shape: ${i}}`);let c=Xn.get(s);if(!c)throw new Error(`Unsupported ONNX data type: ${s}`);let d=this.tensorManager.reserveTensorId();await this.tensorManager.ensureTensor(e,d,c,i,!1);let h=this.temporarySessionTensorIds.get(e);return h?h.push(d):this.temporarySessionTensorIds.set(e,[d]),d}uploadTensor(e,s){if(!fe().shouldTransferToMLTensor)throw new Error("Trying to upload to a MLTensor while shouldTransferToMLTensor is false");se("verbose",()=>`[WebNN] uploadTensor {tensorId: ${e}, data: ${s.byteLength}}`),this.tensorManager.upload(e,s)}async downloadTensor(e,s){return this.tensorManager.download(e,s)}createMLTensorDownloader(e,s){return async()=>{let i=await this.tensorManager.download(e);return Mr(i,s)}}registerMLTensor(e,s,i,c){let d=Xn.get(i);if(!d)throw new Error(`Unsupported ONNX data type: ${i}`);let h=this.tensorManager.registerTensor(e,s,d,c);return se("verbose",()=>`[WebNN] registerMLTensor {tensor: ${s}, dataType: ${d}, dimensions: ${c}} -> {tensorId: ${h}}`),h}registerMLConstant(e,s,i,c,d,h,_=!1){if(!h)throw new Error("External mounted files are not available.");let g=e;e.startsWith("./")&&(g=e.substring(2));let $=h.get(g);if(!$)throw new Error(`File with name ${g} not found in preloaded files.`);if(s+i>$.byteLength)throw new Error("Out of bounds: data offset and length exceed the external file data size.");let _e=$.slice(s,s+i).buffer,lt;switch(d.dataType){case"float32":lt=new Float32Array(_e);break;case"float16":lt=typeof Float16Array<"u"&&Float16Array.from?new Float16Array(_e):new Uint16Array(_e);break;case"int32":lt=new Int32Array(_e);break;case"uint32":lt=new Uint32Array(_e);break;case"int64":_?(lt=Yn(new Uint8Array(_e),!1),d.dataType="int32"):lt=new BigInt64Array(_e);break;case"uint64":lt=new BigUint64Array(_e);break;case"int8":lt=new Int8Array(_e);break;case"int4":case"uint4":case"uint8":lt=new Uint8Array(_e);break;default:throw new Error(`Unsupported data type: ${d.dataType} in creating WebNN Constant from external data.`)}return se("verbose",()=>`[WebNN] registerMLConstant {dataType: ${d.dataType}, shape: ${d.shape}}} ${_?"(Note: it was int64 data type and registered to int32 as workaround)":""}`),c.constant(d,lt)}registerGraphInput(e){this.temporaryGraphInputs.push(e)}isGraphInput(e,s){let i=this.sessionGraphInputs.get(e);return i?i.includes(s):!1}isInt64Supported(e){var s;return!!((s=this.mlContextBySessionId.get(e))!=null&&s.opSupportLimits().input.dataTypes.includes("int64"))}flush(){}}}),Vr=U(()=>{}),Za,Jn,eo,lm,cm,Qa,ro,to,Xa,Ja=U(()=>{Xe(),Vr(),Za=new Map([[64,250],[128,200],[256,200],[512,200],[2048,230],[4096,200],[8192,50],[16384,50],[32768,50],[65536,50],[131072,50],[262144,50],[524288,50],[1048576,50],[2097152,30],[4194304,20],[8388608,10],[12582912,10],[16777216,10],[26214400,15],[33554432,22],[44236800,2],[58982400,6],[67108864,6],[134217728,6],[167772160,6]]),Jn=[],eo=e=>Math.ceil(Number(e)/16)*16,lm=e=>{for(let s=0;s<Jn.length;s++){let i=Jn[s];if(e<=i)return i}return Math.ceil(e/16)*16},cm=1,Qa=()=>cm++,ro=async(e,s,i,c)=>{let d=eo(i),h=e.device.createBuffer({size:d,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let _=e.getCommandEncoder();e.endComputePass(),_.copyBufferToBuffer(s,0,h,0,d),e.flush(),await h.mapAsync(GPUMapMode.READ);let g=h.getMappedRange();if(c){let $=c();return $.set(new Uint8Array(g,0,i)),$}else return new Uint8Array(g.slice(0,i))}finally{h.destroy()}},to=class{constructor(e){this.backend=e,this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersPending=[],this.capturedPendingBuffers=new Map;for(let[s]of Za)Jn.push(s),this.freeBuffers.set(s,[]),this.freeUniformBuffers.set(s,[]);this.sessionCount=0}upload(e,s){let i=s.buffer,c=s.byteOffset,d=s.byteLength,h=eo(d),_=this.storageCache.get(e);if(!_)throw new Error("gpu data for uploading does not exist");if(Number(_.originalSize)!==d)throw new Error(`inconsistent data size. gpu data size=${_.originalSize}, data size=${d}`);let g=this.backend.device.createBuffer({mappedAtCreation:!0,size:h,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),$=g.getMappedRange();new Uint8Array($).set(new Uint8Array(i,c,d)),g.unmap();let _e=this.backend.device.createCommandEncoder();_e.copyBufferToBuffer(g,0,_.gpuData.buffer,0,h),this.backend.device.queue.submit([_e.finish()]),g.destroy(),se("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${e})`)}memcpy(e,s){let i=this.storageCache.get(e);if(!i)throw new Error("source gpu data for memcpy does not exist");let c=this.storageCache.get(s);if(!c)throw new Error("destination gpu data for memcpy does not exist");if(i.originalSize!==c.originalSize)throw new Error("inconsistent source and destination gpu data size");let d=eo(i.originalSize),h=this.backend.getCommandEncoder();this.backend.endComputePass(),h.copyBufferToBuffer(i.gpuData.buffer,0,c.gpuData.buffer,0,d)}registerExternalBuffer(e,s,i){let c;if(i){if(c=i[0],e===i[1])return se("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${s}) => id=${c}, buffer is the same, skip.`),c;if(this.backend.capturedCommandList.has(this.backend.currentSessionId))throw new Error(`Registering a different external buffer under graph capture mode is not supported yet.
             Please use the previous external buffer!`)}else c=Qa();return this.storageCache.set(c,{gpuData:{id:c,type:0,buffer:e},originalSize:s}),se("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${s}) => id=${c}, registered.`),c}unregisterExternalBuffer(e){e!==void 0&&(this.storageCache.delete(e),se("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${e}`))}create(e,s=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let i=lm(e),c,d=(s&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,h=(s&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(d||h){let g=(d?this.freeBuffers:this.freeUniformBuffers).get(i);g?g.length>0?c=g.pop():c=this.backend.device.createBuffer({size:i,usage:s}):c=this.backend.device.createBuffer({size:i,usage:s})}else c=this.backend.device.createBuffer({size:i,usage:s});let _={id:Qa(),type:0,buffer:c};return this.storageCache.set(_.id,{gpuData:_,originalSize:Number(e)}),se("verbose",()=>`[WebGPU] GpuDataManager.create(size=${e}) => id=${_.id}`),_}get(e){var s;return(s=this.storageCache.get(e))==null?void 0:s.gpuData}release(e){let s=typeof e=="bigint"?Number(e):e,i=this.storageCache.get(s);if(!i){if(this.storageCache.size===0)return 0;throw new Error("releasing data does not exist")}return se("verbose",()=>`[WebGPU] GpuDataManager.release(id=${s}), gpuDataId=${i.gpuData.id}`),this.storageCache.delete(s),this.buffersPending.push(i.gpuData.buffer),i.originalSize}async download(e,s){let i=this.storageCache.get(Number(e));if(!i)throw new Error("data does not exist");await ro(this.backend,i.gpuData.buffer,i.originalSize,s)}refreshPendingBuffers(){if(this.buffersPending.length!==0)if(this.backend.sessionStatus==="default"){for(let e of this.buffersPending){let s=Za.get(e.size);if((e.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE){let i=this.freeBuffers.get(e.size)||[];s===void 0||i.length>=s?e.destroy():i.push(e)}else if((e.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM){let i=this.freeUniformBuffers.get(e.size)||[];s===void 0||i.length>=s?e.destroy():i.push(e)}else e.destroy()}this.buffersPending=[]}else{let e=this.capturedPendingBuffers.get(this.backend.currentSessionId);e||(e=[],this.capturedPendingBuffers.set(this.backend.currentSessionId,e));for(let s of this.buffersPending)e.push(s);this.buffersPending=[]}}dispose(){this.freeBuffers.forEach(e=>{e.forEach(s=>{s.destroy()})}),this.freeUniformBuffers.forEach(e=>{e.forEach(s=>{s.destroy()})}),this.storageCache.forEach(e=>{e.gpuData.buffer.destroy()}),this.capturedPendingBuffers.forEach(e=>{e.forEach(s=>{s.destroy()})}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.capturedPendingBuffers=new Map}onCreateSession(){this.sessionCount+=1}onReleaseSession(e){let s=this.capturedPendingBuffers.get(e);s&&(s.forEach(i=>{i.destroy()}),this.capturedPendingBuffers.delete(e)),this.sessionCount-=1,this.sessionCount===0&&(se("warning",()=>"[WebGPU] Clearing webgpu buffer cache"),this.storageCache.forEach(i=>{i.gpuData.buffer.destroy()}),this.storageCache=new Map)}},Xa=(...e)=>new to(...e)}),no,J,Se=U(()=>{no=class{constructor(e){Object.assign(this,e)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(e=>`${this[e]}`).join(";")),this.key}},J=e=>new no(e)}),It,io,be,Ae,N,ce,ao,Ct,He,F,Wr,P,M,es,Lr,oo,ts,ie=U(()=>{ee(),ne(),It=64,io=(e,s)=>{if(s===3)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(Number(e)){case 10:return s>1?`vec${s}<f16>`:"f16";case 1:return s>1?`vec${s}<f32>`:"f32";case 6:return s>1?`vec${s}<i32>`:"i32";case 12:return s>1?`vec${s}<u32>`:"u32";case 7:if(s>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(s>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(s!==4)throw new Error("bool must be vec4");return["u32","vec4<bool>"];case 22:return"i32";case 21:return"u32";default:throw new Error(`Unknown data type: ${e}`)}},be=(e,s=1)=>{let i=io(e,s);return typeof i=="string"?i:i[0]},Ae=(e,s=1)=>{let i=io(e,s);return typeof i=="string"?i:i[1]},N=(...e)=>{let s=[];return e.forEach(i=>{i.length!==0&&s.push({type:12,data:i},{type:12,data:k.computeStrides(i)})}),s},ce=e=>e%4===0?4:e%2===0?2:1,ao=(e="f32",s,i="0")=>!s||s===1?`${e}(${i})`:`vec${s}<${e}>(${i})`,Ct=(e,s,i)=>e==="f32"?i:s===1?`f32(${i})`:`vec${s}<f32>(${i})`,He=(e,s)=>s===4?`(${e}.x + ${e}.y + ${e}.z + ${e}.w)`:s===2?`(${e}.x + ${e}.y)`:s===3?`(${e}.x + ${e}.y + ${e}.z)`:e,F=(e,s,i,c)=>e.startsWith("uniforms.")&&i>4?typeof s=="string"?c==="f16"?`${e}[(${s}) / 8][(${s}) % 8 / 4][(${s}) % 8 % 4]`:`${e}[(${s}) / 4][(${s}) % 4]`:c==="f16"?`${e}[${Math.floor(s/8)}][${Math.floor(s%8/4)}][${s%8%4}]`:`${e}[${Math.floor(s/4)}][${s%4}]`:i>1?`${e}[${s}]`:e,Wr=(e,s,i,c,d)=>{let h=typeof i=="number",_=h?i:i.length,g=[...new Array(_).keys()],$=_<2?"u32":_<=4?`vec${_}<u32>`:`array<u32, ${_}>`,_e=io(s,d),lt=typeof _e=="string"?_e:_e[1],at=typeof _e=="string"?_e:_e[0],it={indices:$,value:lt,storage:at,tensor:s},ct=or=>typeof or=="string"?or:`${or}u`,mt={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},pt=h?"uniforms.":"",zt=`${pt}${e}_shape`,dt=`${pt}${e}_strides`,ft="";for(let or=0;or<_-1;or++)ft+=`
    let dim${or} = current / ${F(dt,or,_)};
    let rest${or} = current % ${F(dt,or,_)};
    indices[${or}] = dim${or};
    current = rest${or};
    `;ft+=`indices[${_-1}] = current;`;let kt=_<2?"":`
  fn o2i_${e}(offset: u32) -> ${it.indices} {
    var indices: ${it.indices};
    var current = offset;
    ${ft}
    return indices;
  }`,St=or=>(mt.offsetToIndices=!0,_<2?or:`o2i_${e}(${or})`),Lt=[];if(_>=2)for(let or=_-1;or>=0;or--)Lt.push(`${F(dt,or,_)} * (indices[${or}])`);let Gt=_<2?"":`
  fn i2o_${e}(indices: ${it.indices}) -> u32 {
    return ${Lt.join("+")};
  }`,Bt=or=>(mt.indicesToOffset=!0,_<2?or:`i2o_${e}(${or})`),nr=(...or)=>_===0?"0u":`${it.indices}(${or.map(ct).join(",")})`,cr=(or,lr)=>_<2?`${or}`:`${F(or,lr,_)}`,ur=(or,lr,pn)=>_<2?`${or}=${pn};`:`${F(or,lr,_)}=${pn};`,yn={},hn=(or,lr)=>{mt.broadcastedIndicesToOffset=!0;let pn=`${lr.name}broadcastedIndicesTo${e}Offset`;if(pn in yn)return`${pn}(${or})`;let Cn=[];for(let Lo=_-1;Lo>=0;Lo--){let Mo=lr.indicesGet("outputIndices",Lo+lr.rank-_);Cn.push(`${cr(dt,Lo)} * (${Mo} % ${cr(zt,Lo)})`)}return yn[pn]=`fn ${pn}(outputIndices: ${lr.type.indices}) -> u32 {
             return ${Cn.length>0?Cn.join("+"):"0u"};
           }`,`${pn}(${or})`},_n=(or,lr)=>(()=>{if(it.storage===it.value)return`${e}[${or}]=${lr};`;if(it.storage==="vec2<u32>"&&it.value==="i32")return`${e}[${or}]=vec2<u32>(u32(${lr}), select(0u, 0xFFFFFFFFu, ${lr} < 0));`;if(it.storage==="vec2<u32>"&&it.value==="u32")return`${e}[${or}]=vec2<u32>(u32(${lr}), 0u);`;if(it.storage==="u32"&&it.value==="vec4<bool>")return`${e}[${or}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${lr}));`;throw new Error(`not supported combination of storage type ${it.storage} and value type ${it.value} yet`)})(),gn=or=>(()=>{if(it.storage===it.value)return`${e}[${or}]`;if(it.storage==="vec2<u32>"&&it.value==="i32")return`i32(${e}[${or}].x)`;if(it.storage==="vec2<u32>"&&it.value==="u32")return`u32(${e}[${or}].x)`;if(it.storage==="u32"&&it.value==="vec4<bool>")return`vec4<bool>(bool(${e}[${or}] & 0xFFu), bool(${e}[${or}] & 0xFF00u), bool(${e}[${or}] & 0xFF0000u), bool(${e}[${or}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${it.storage} and value type ${it.value} yet`)})(),vn=_<2?"":`
  fn get_${e}ByIndices(indices: ${it.indices}) -> ${lt} {
    return ${gn(`i2o_${e}(indices)`)};
  }`,Tn=_<2?"":(()=>{let or=g.map(pn=>`d${pn}: u32`).join(", "),lr=g.map(pn=>`d${pn}`).join(", ");return`
  fn get_${e}(${or}) -> ${lt} {
    return get_${e}ByIndices(${nr(lr)});
  }`})(),kn=(...or)=>{if(or.length!==_)throw new Error(`indices length must be ${_}`);let lr=or.map(ct).join(",");return _===0?gn("0u"):_===1?gn(lr[0]):(mt.get=!0,mt.getByIndices=!0,mt.indicesToOffset=!0,`get_${e}(${lr})`)},bn=or=>_<2?gn(or):(mt.getByIndices=!0,mt.indicesToOffset=!0,`get_${e}ByIndices(${or})`),Sn=_<2?"":`
  fn set_${e}ByIndices(indices: ${it.indices}, value: ${lt}) {
    ${_n(`i2o_${e}(indices)`,"value")}
  }`,fn=_<2?"":(()=>{let or=g.map(pn=>`d${pn}: u32`).join(", "),lr=g.map(pn=>`d${pn}`).join(", ");return`
  fn set_${e}(${or}, value: ${lt}) {
    set_${e}ByIndices(${nr(lr)}, value);
  }`})();return{impl:()=>{let or=[],lr=!1;return mt.offsetToIndices&&(or.push(kt),lr=!0),mt.indicesToOffset&&(or.push(Gt),lr=!0),mt.broadcastedIndicesToOffset&&(Object.values(yn).forEach(pn=>or.push(pn)),lr=!0),mt.set&&(or.push(fn),lr=!0),mt.setByIndices&&(or.push(Sn),lr=!0),mt.get&&(or.push(Tn),lr=!0),mt.getByIndices&&(or.push(vn),lr=!0),!h&&lr&&or.unshift(`const ${zt} = ${it.indices}(${i.join(",")});`,`const ${dt} = ${it.indices}(${k.computeStrides(i).join(",")});`),or.join(`
`)},type:it,offsetToIndices:St,indicesToOffset:Bt,broadcastedIndicesToOffset:hn,indices:nr,indicesGet:cr,indicesSet:ur,set:(...or)=>{if(or.length!==_+1)throw new Error(`indices length must be ${_}`);let lr=or[_];if(typeof lr!="string")throw new Error("value must be string");let pn=or.slice(0,_).map(ct).join(",");return _===0?_n("0u",lr):_===1?_n(pn[0],lr):(mt.set=!0,mt.setByIndices=!0,mt.indicesToOffset=!0,`set_${e}(${pn}, ${lr})`)},setByOffset:_n,setByIndices:(or,lr)=>_<2?_n(or,lr):(mt.setByIndices=!0,mt.indicesToOffset=!0,`set_${e}ByIndices(${or}, ${lr});`),get:kn,getByOffset:gn,getByIndices:bn,usage:c,name:e,strides:dt,shape:zt,rank:_}},P=(e,s,i,c=1)=>Wr(e,s,i,"input",c),M=(e,s,i,c=1)=>Wr(e,s,i,"output",c),es=(e,s,i)=>Wr(e,s,i,"atomicOutput",1),Lr=(e,s,i,c=1)=>Wr(e,s,i,"internal",c),oo=class{constructor(e,s){this.normalizedDispatchGroup=e,this.limits=s,this.internalVariables=[],this.variables=[],this.uniforms=[],this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(e){return`if (global_idx >= ${typeof e=="number"?`${e}u`:e}) { return; }`}mainStart(e=It){let s=typeof e=="number"?e:e[0],i=typeof e=="number"?1:e[1],c=typeof e=="number"?1:e[2];if(s>this.limits.maxComputeWorkgroupSizeX||i>this.limits.maxComputeWorkgroupSizeY||c>this.limits.maxComputeWorkgroupSizeZ)throw new Error(`workgroup size [${s}, ${i}, ${c}] exceeds the maximum workgroup size [${this.limits.maxComputeWorkgroupSizeX}, ${this.limits.maxComputeWorkgroupSizeY}, ${this.limits.maxComputeWorkgroupSizeZ}].`);if(s*i*c>this.limits.maxComputeInvocationsPerWorkgroup)throw new Error(`workgroup size [${s}, ${i}, ${c}] exceeds the maximum workgroup invocations ${this.limits.maxComputeInvocationsPerWorkgroup}.`);let d=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1,h=d?`@builtin(global_invocation_id) global_id : vec3<u32>,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(global_invocation_id) global_id : vec3<u32>,
                                             @builtin(local_invocation_id) local_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(num_workgroups) num_workgroups : vec3<u32>`,_=d?`let global_idx = global_id.x;
         let workgroup_index = workgroup_id.x;`:`let workgroup_index = workgroup_id.z * num_workgroups[0] * num_workgroups[1] +
             workgroup_id.y * num_workgroups[0] + workgroup_id.x;
         let global_idx = workgroup_index * ${s*i*c}u + local_idx;`;return`@compute @workgroup_size(${s}, ${i}, ${c})
  fn main(${h}) {
    ${_}
  `}appendVariableUniforms(e){e.rank!==0&&(e.shape.startsWith("uniforms.")&&this.uniforms.push({name:e.shape.replace("uniforms.",""),type:"u32",length:e.rank}),e.strides.startsWith("uniforms.")&&this.uniforms.push({name:e.strides.replace("uniforms.",""),type:"u32",length:e.rank}))}declareVariable(e,s){if(e.usage==="internal")throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(e),this.appendVariableUniforms(e);let i=e.usage==="input"?"read":"read_write",c=e.usage==="atomicOutput"?"atomic<i32>":e.type.storage;return`@group(0) @binding(${s}) var<storage, ${i}> ${e.name}: array<${c}>;`}declareVariables(...e){return e.map(s=>this.declareVariable(s,this.variableIndex++)).join(`
`)}registerInternalVariable(e){if(e.usage!=="internal")throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(e),this.appendVariableUniforms(e)}registerInternalVariables(...e){return e.forEach(s=>this.registerInternalVariable(s)),this}registerUniform(e,s,i=1){return this.uniforms.push({name:e,type:s,length:i}),this}registerUniforms(e){return this.uniforms=this.uniforms.concat(e),this}uniformDeclaration(){if(this.uniforms.length===0)return"";let e=[];for(let{name:s,type:i,length:c}of this.uniforms)if(c&&c>4)i==="f16"?e.push(`@align(16) ${s}:array<mat2x4<${i}>, ${Math.ceil(c/8)}>`):e.push(`${s}:array<vec4<${i}>, ${Math.ceil(c/4)}>`);else{let d=c==null||c===1?i:`vec${c}<${i}>`;e.push(`${s}:${d}`)}return`
      struct Uniforms { ${e.join(", ")} };
      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(e=>e.impl()).join(`
`)+this.internalVariables.map(e=>e.impl()).join(`
`)}get variablesInfo(){if(this.uniforms.length===0)return;let e=s=>[12,10,1,6][["u32","f16","f32","i32"].indexOf(s)];return this.uniforms.map(s=>[e(s.type),s.length??1])}},ts=(e,s)=>new oo(e,s)}),pm,rs,mm,fm,hm,gm,Ee,ns,os,st=U(()=>{ee(),ne(),Se(),ie(),pm=(e,s)=>{if(!e||e.length!==1)throw new Error("Transpose requires 1 input.");if(s.length!==0&&s.length!==e[0].dims.length)throw new Error(`perm size ${s.length} does not match input rank ${e[0].dims.length}`)},rs=(e,s)=>s.length!==0?s:[...new Array(e).keys()].reverse(),mm=(e,s)=>k.sortBasedOnPerm(e,rs(e.length,s)),fm=(e,s,i,c)=>{let d=`fn perm(i: ${c.type.indices}) -> ${i.type.indices} {
    var a: ${i.type.indices};`;for(let h=0;h<s;++h)d+=`a[${e[h]}]=i[${h}];`;return d+="return a;}"},hm=(e,s)=>{let i=[],c=[];for(let d=0;d<e.length;++d)e[d]!==1&&i.push(e[d]),e[s[d]]!==1&&c.push(s[d]);return{newShape:i,newPerm:c}},gm=(e,s)=>{let i=0;for(let c=0;c<e.length;++c)if(s[e[c]]!==1){if(e[c]<i)return!1;i=e[c]}return!0},Ee=(e,s)=>{let i=e.dataType,c=e.dims.length,d=rs(c,s),h=mm(e.dims,d),_=e.dims,g=h,$=c<2||gm(d,e.dims),_e;if($)return _e=mt=>{let pt=P("input",i,_,4),zt=M("output",i,g,4);return`
  ${mt.registerUniform("output_size","u32").declareVariables(pt,zt)}
  ${mt.mainStart()}
    ${mt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    output[global_idx] = input[global_idx];
  }`},{name:"TransposeCopy",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let mt=k.size(h);return{outputs:[{dims:h,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(mt/64/4)},programUniforms:[{type:12,data:Math.ceil(mt/4)}]}},getShaderSource:_e};let{newShape:lt,newPerm:at}=hm(e.dims,d),it=k.areEqual(at,[2,3,1]),ct=k.areEqual(at,[3,1,2]);if(lt.length===2||it||ct){_=it?[lt[0],lt[1]*lt[2]]:ct?[lt[0]*lt[1],lt[2]]:lt,g=[_[1],_[0]];let mt=16;return _e=pt=>{let zt=P("a",i,_.length),dt=M("output",i,g.length);return`
  ${pt.registerUniform("output_size","u32").declareVariables(zt,dt)}
  var<workgroup> tile : array<array<${dt.type.value}, ${mt+1}>, ${mt}>;
  ${pt.mainStart([mt,mt,1])}
    let stride = (uniforms.output_shape[1] - 1) / ${mt} + 1;
    let workgroup_id_x = workgroup_index % stride;
    let workgroup_id_y = workgroup_index / stride;
    let input_col = workgroup_id_y * ${mt}u + local_id.x;
    let input_row = workgroup_id_x * ${mt}u + local_id.y;
    if (input_row < uniforms.a_shape[0] && input_col < uniforms.a_shape[1]) {
      tile[local_id.y][local_id.x] = ${zt.getByIndices(`${zt.type.indices}(input_row, input_col)`)};
    }
    workgroupBarrier();

    let output_col = workgroup_id_x * ${mt}u + local_id.x;
    let output_row = workgroup_id_y * ${mt}u + local_id.y;
    if (output_row < uniforms.output_shape[0] && output_col < uniforms.output_shape[1]) {
      ${dt.setByIndices(`${dt.type.indices}(output_row, output_col)`,"tile[local_id.x][local_id.y]")}
    }
  }`},{name:"TransposeShared",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let pt=k.size(h);return{outputs:[{dims:h,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(g[1]/mt),y:Math.ceil(g[0]/mt)},programUniforms:[{type:12,data:pt},...N(_,g)]}},getShaderSource:_e}}return _e=mt=>{let pt=P("a",i,_.length),zt=M("output",i,g.length);return`
  ${mt.registerUniform("output_size","u32").declareVariables(pt,zt)}

  ${fm(d,c,pt,zt)}

  ${mt.mainStart()}
    ${mt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${zt.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${zt.setByOffset("global_idx",pt.getByIndices("aIndices"))}
  }`},{name:"Transpose",shaderCache:{hint:`${s}`,inputDependencies:["rank"]},getRunData:()=>{let mt=k.size(h);return{outputs:[{dims:h,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(mt/64)},programUniforms:[{type:12,data:mt},...N(_,g)]}},getShaderSource:_e}},ns=(e,s)=>{pm(e.inputs,s.perm),e.compute(Ee(e.inputs[0],s.perm))},os=e=>J({perm:e.perm})}),bm,ym,_m,wm,vm,$m,xm,Sm,Tm,Im,et,is,as,ss,us,ds,ls,cs,ps,ms,fs,hs=U(()=>{ee(),ne(),ie(),Gr(),st(),bm={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},ym={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},_m={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},wm={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},vm=(e,s)=>{let i=[];for(let c=s-e;c<s;++c)i.push(c);return i},$m=(e,s)=>{let i=[],c=e.length;for(let h=0;h<c;h++)s.indexOf(h)===-1&&i.push(e[h]);let d=s.map(h=>e[h]);return[i,d]},xm=(e,s)=>{let i=e.length+s.length,c=[],d=0;for(let h=0;h<i;h++)s.indexOf(h)===-1?c.push(e[d++]):c.push(1);return c},Sm=(e,s)=>{for(let i=0;i<e.length;++i)if(e[e.length-i-1]!==s-1-i)return!1;return!0},Tm=(e,s)=>{let i=[];if(!Sm(e,s)){for(let c=0;c<s;++c)e.indexOf(c)===-1&&i.push(c);e.forEach(c=>i.push(c))}return i},Im=(e,s,i,c,d,h,_)=>{let g=i[0].dims,$=k.size(h),_e=k.size(_),lt=P("_A",i[0].dataType,g),at=M("output",d,h),it=64;$===1&&(it=256);let ct=`
          var<workgroup> aBestValues : array<f32, ${it}>;
       `,mt=pt=>`
        ${pt.registerUniform("reduceSize","u32").declareVariables(lt,at)}
        ${ct}
        fn DIV_CEIL(a : u32, b : u32) -> u32 {
          return ((a - 1u) / b + 1u);
         }
         ${pt.mainStart(it)}

          let outputIndex = global_idx / ${it};
          let offset = outputIndex * uniforms.reduceSize;

          var bestValue = f32(${_m[c]});
          let Length = uniforms.reduceSize;
          for (var k = local_idx; k < Length; k = k + ${it}) {
           let candidate = f32(${lt.getByOffset("offset + k")});
           bestValue = ${bm[c]};
          }
          aBestValues[local_idx] = bestValue;
          workgroupBarrier();

         var reduceSize = min(Length, ${it}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (local_idx < currentSize) {
            let candidate = aBestValues[local_idx + interval];
            bestValue = ${ym[c]};
            aBestValues[local_idx] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (local_idx == 0u) {
          ${at.setByOffset("outputIndex",`${c==="mean"?`${at.type.storage}(bestValue / f32(uniforms.reduceSize))`:`${at.type.storage}(${wm[c]})`}`)};
         }
        }`;return{name:e,shaderCache:{hint:`${s};${it}`,inputDependencies:["type"]},getShaderSource:mt,getRunData:()=>({outputs:[{dims:h,dataType:d}],dispatchGroup:{x:$},programUniforms:[{type:12,data:_e}]})}},et=(e,s,i,c)=>{let d=e.inputs.length===1?i:so(e.inputs,i),h=d.axes;h.length===0&&!d.noopWithEmptyAxes&&(h=e.inputs[0].dims.map((ct,mt)=>mt));let _=k.normalizeAxes(h,e.inputs[0].dims.length),g=_,$=e.inputs[0],_e=Tm(g,e.inputs[0].dims.length);_e.length>0&&($=e.compute(Ee(e.inputs[0],_e),{inputs:[0],outputs:[-1]})[0],g=vm(g.length,$.dims.length));let[lt,at]=$m($.dims,g),it=lt;d.keepDims&&(it=xm(lt,_)),e.compute(Im(s,d.cacheKey,[$],c,e.inputs[0].dataType,it,at),{inputs:[$]})},is=(e,s)=>{et(e,"ReduceMeanShared",s,"mean")},as=(e,s)=>{et(e,"ReduceL1Shared",s,"l1")},ss=(e,s)=>{et(e,"ReduceL2Shared",s,"l2")},us=(e,s)=>{et(e,"ReduceLogSumExpShared",s,"logSumExp")},ds=(e,s)=>{et(e,"ReduceMaxShared",s,"max")},ls=(e,s)=>{et(e,"ReduceMinShared",s,"min")},cs=(e,s)=>{et(e,"ReduceProdShared",s,"prod")},ps=(e,s)=>{et(e,"ReduceSumShared",s,"sum")},ms=(e,s)=>{et(e,"ReduceSumSquareShared",s,"sumSquare")},fs=(e,s)=>{et(e,"ReduceLogSumShared",s,"logSum")}}),tt,Cm,Hr,so,rt,Am,Em,km,Pm,zm,Om,Bm,Dm,Mm,Rm,nt,gs,bs,ys,_s,ws,vs,$s,xs,Ss,Ts,Gr=U(()=>{ee(),ne(),Se(),ie(),hs(),tt=e=>{if(!e||e.length===0||e.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(e.length===2&&e[1].dims.length!==1)throw new Error("Invalid axes input dims.")},Cm=e=>["","",`var value = ${e.getByIndices("input_indices")};`,""],Hr=(e,s,i,c,d,h,_=!1,g=!1)=>{let $=[],_e=i[0].dims,lt=_e.length,at=k.normalizeAxes(d,lt),it=!g&&at.length===0;_e.forEach((pt,zt)=>{it||at.indexOf(zt)>=0?_&&$.push(1):$.push(pt)});let ct=$.length,mt=k.size($);return{name:e,shaderCache:s,getShaderSource:pt=>{let zt=[],dt=P("_A",i[0].dataType,lt),ft=M("output",h,ct),kt=c(dt,ft,at),St=kt[2];for(let Lt=0,Gt=0;Lt<lt;Lt++)it||at.indexOf(Lt)>=0?(_&&Gt++,St=`for(var j${Lt}: u32 = 0; j${Lt} < ${_e[Lt]}; j${Lt}++) {
                  ${kt[2].includes("last_index")?`let last_index = j${Lt};`:""}
                  ${dt.indicesSet("input_indices",Lt,`j${Lt}`)}
                  ${St}
                }`):(zt.push(`${dt.indicesSet("input_indices",Lt,ft.indicesGet("output_indices",Gt))};`),Gt++);return`

        ${pt.registerUniform("output_size","u32").declareVariables(dt,ft)}

        ${pt.mainStart()}
          ${pt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          var input_indices: ${dt.type.indices};
          let output_indices = ${ft.offsetToIndices("global_idx")};

          ${zt.join(`
`)}
          ${kt[0]}       // init ops for reduce max/min
          ${kt[1]}
          ${St}
          ${kt[3]}
          ${kt.length===4?ft.setByOffset("global_idx","value"):kt.slice(4).join(`
`)}
        }`},getRunData:()=>({outputs:[{dims:$,dataType:h}],dispatchGroup:{x:Math.ceil(mt/64)},programUniforms:[{type:12,data:mt},...N(_e,$)]})}},so=(e,s)=>{let i=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach(c=>i.push(Number(c))),J({axes:i,keepDims:s.keepDims,noopWithEmptyAxes:s.noopWithEmptyAxes})},rt=(e,s,i,c)=>{let d=e.inputs,h=d.length===1?i:so(d,i);e.compute(Hr(s,{hint:h.cacheKey,inputDependencies:["rank"]},[d[0]],h.noopWithEmptyAxes&&h.axes.length===0?Cm:c,h.axes,d[0].dataType,h.keepDims,h.noopWithEmptyAxes),{inputs:[0]})},Am=(e,s)=>{tt(e.inputs),rt(e,"ReduceLogSum",s,(i,c)=>[`var value = ${c.type.storage}(0);`,"",`value += ${i.getByIndices("input_indices")};`,"value = log(value);"])},Em=(e,s)=>{tt(e.inputs),rt(e,"ReduceL1",s,(i,c)=>[`var value = ${c.type.storage}(0);`,"",`value += abs(${i.getByIndices("input_indices")});`,""])},km=(e,s)=>{tt(e.inputs),rt(e,"ReduceL2",s,(i,c)=>[`var t = ${c.type.value}(0); var value = ${c.type.value}(0);`,"",`t = ${i.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},Pm=(e,s)=>{tt(e.inputs),rt(e,"ReduceLogSumExp",s,(i,c)=>[`var value = ${c.type.storage}(0);`,"",`value += exp(${i.getByIndices("input_indices")});`,"value = log(value);"])},zm=(e,s)=>{tt(e.inputs),rt(e,"ReduceMax",s,(i,c,d)=>{let h=[];for(let _=0;_<i.rank;_++)(d.indexOf(_)>=0||d.length===0)&&h.push(i.indicesSet("input_indices",_,0));return[`${h.join(`
`)}`,`var value = ${i.getByIndices("input_indices")};`,`value = max(value, ${i.getByIndices("input_indices")});`,""]})},Om=(e,s)=>{tt(e.inputs),rt(e,"ReduceMean",s,(i,c,d)=>{let h=1;for(let _=0;_<i.rank;_++)(d.indexOf(_)>=0||d.length===0)&&(h*=e.inputs[0].dims[_]);return["var sum = f32(0);","",`sum += f32(${i.getByIndices("input_indices")});`,`let value = ${c.type.value}(sum / ${h});`]})},Bm=(e,s)=>{tt(e.inputs),rt(e,"ReduceMin",s,(i,c,d)=>{let h=[];for(let _=0;_<i.rank;_++)(d.indexOf(_)>=0||d.length===0)&&h.push(`input_indices[${_}] = 0;`);return[`${h.join(`
`)}`,`var value = ${i.getByIndices("input_indices")};`,`value = min(value, ${i.getByIndices("input_indices")});`,""]})},Dm=(e,s)=>{tt(e.inputs),rt(e,"ReduceProd",s,(i,c)=>[`var value = ${c.type.storage}(1);`,"",`value *= ${i.getByIndices("input_indices")};`,""])},Mm=(e,s)=>{tt(e.inputs),rt(e,"ReduceSum",s,(i,c)=>[`var value = ${c.type.storage}(0);`,"",`value += ${i.getByIndices("input_indices")};`,""])},Rm=(e,s)=>{tt(e.inputs),rt(e,"ReduceSumSquare",s,(i,c)=>[`var t = ${c.type.value}(0); var value = ${c.type.value}(0);`,"",`t = ${i.getByIndices("input_indices")}; value += t * t;`,""])},nt=(e,s,i)=>{if(s.length===0)return i;let c=1,d=1;for(let h=0;h<s.length;h++)s.indexOf(h)===-1?c*=e[h]:d*=e[h];return d<32&&c>1024},gs=(e,s)=>{nt(e.inputs[0].dims,s.axes,s.noopWithEmptyAxes)?Om(e,s):is(e,s)},bs=(e,s)=>{nt(e.inputs[0].dims,s.axes,s.noopWithEmptyAxes)?Em(e,s):as(e,s)},ys=(e,s)=>{nt(e.inputs[0].dims,s.axes,s.noopWithEmptyAxes)?km(e,s):ss(e,s)},_s=(e,s)=>{nt(e.inputs[0].dims,s.axes,s.noopWithEmptyAxes)?Pm(e,s):us(e,s)},ws=(e,s)=>{nt(e.inputs[0].dims,s.axes,s.noopWithEmptyAxes)?zm(e,s):ds(e,s)},vs=(e,s)=>{nt(e.inputs[0].dims,s.axes,s.noopWithEmptyAxes)?Bm(e,s):ls(e,s)},$s=(e,s)=>{nt(e.inputs[0].dims,s.axes,s.noopWithEmptyAxes)?Dm(e,s):cs(e,s)},xs=(e,s)=>{nt(e.inputs[0].dims,s.axes,s.noopWithEmptyAxes)?Mm(e,s):ps(e,s)},Ss=(e,s)=>{nt(e.inputs[0].dims,s.axes,s.noopWithEmptyAxes)?Rm(e,s):ms(e,s)},Ts=(e,s)=>{nt(e.inputs[0].dims,s.axes,s.noopWithEmptyAxes)?Am(e,s):fs(e,s)}}),Is,Cs,As,uo,Es=U(()=>{ee(),Se(),Gr(),Is=e=>{if(!e||e.length===0||e.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(e[0].dataType!==1)throw new Error("Invalid input type.")},Cs=(e,s)=>{Is(e.inputs);let i=(c,d,h)=>{let _=[];for(let g=0;g<c.rank;g++)(h.indexOf(g)>=0||h.length===0)&&_.push(`input_indices[${g}] = 0;`);return[`${_.join(`
`)}`,`var value = ${c.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${c.getByIndices("input_indices")} ${s.selectLastIndex>0?"<=":"<"} value) {
         value = ${c.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",d.setByOffset("global_idx","best_index")]};e.compute(Hr("ArgMin",{hint:s.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],i,[s.axis],7,s.keepDims),{inputs:[0]})},As=(e,s)=>{Is(e.inputs);let i=(c,d,h)=>{let _=[];for(let g=0;g<c.rank;g++)(h.indexOf(g)>=0||h.length===0)&&_.push(`input_indices[${g}] = 0;`);return[`${_.join(`
`)}`,`var value = ${c.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${c.getByIndices("input_indices")} ${s.selectLastIndex>0?">=":">"} value) {
         value = ${c.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",d.setByOffset("global_idx","best_index")]};e.compute(Hr("argMax",{hint:s.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],i,[s.axis],7,s.keepDims),{inputs:[0]})},uo=e=>J(e)}),Um,lo,Nm,Vm,Wm,Rt,Lm,ks,Fr=U(()=>{ee(),ne(),Vr(),ie(),Um=(e,s)=>{let i=e[0],c=e[1],d=e[2],h=e[3],_=e[4],g=e[5];if(_&&g)throw new Error("Attention cannot have both past and attention_bias");if(i.dims.length!==3)throw new Error('Input "input" must have 3 dimensions');let $=i.dims[0],_e=i.dims[1],lt=i.dims[2];if(d.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimensions');if(c.dims.length!==2)throw new Error('Input "weights" is expected to have 2 dimensions');if(c.dims[0]!==lt)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(d.dims[0]!==c.dims[1])throw new Error('Input "bias" dimension 0 should have same length as dimension 1 of input "weights"');let at=d.dims[0]/3,it=at,ct=it;if(s.qkvHiddenSizes.length>0){if(s.qkvHiddenSizes.length!==3)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let kt of s.qkvHiddenSizes)if(kt%s.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");at=s.qkvHiddenSizes[0],it=s.qkvHiddenSizes[1],ct=s.qkvHiddenSizes[2]}let mt=_e;if(at!==it)throw new Error("qkv_hidden_sizes first element should be same as the second");if(d.dims[0]!==at+it+ct)throw new Error('Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes');let pt=0;if(_){if(it!==ct)throw new Error('Input "past" expect k_hidden_size == v_hidden_size');if(_.dims.length!==5)throw new Error('Input "past" must have 5 dimensions');if(_.dims[0]!==2)throw new Error('Input "past" first dimension must be 2');if(_.dims[1]!==$)throw new Error('Input "past" second dimension must be batch_size');if(_.dims[2]!==s.numHeads)throw new Error('Input "past" third dimension must be num_heads');if(_.dims[4]!==it/s.numHeads)throw new Error('Input "past" fifth dimension must be k_hidden_size / num_heads');s.pastPresentShareBuffer||(pt=_.dims[3])}let zt=mt+pt,dt=-1,ft=0;if(h)throw new Error("Mask not supported");if(_)throw new Error("past is not supported");if(g){if(g.dims.length!==4)throw new Error('Input "attention_bias" must have 4 dimensions');if(g.dims[0]!==$||g.dims[1]!==s.numHeads||g.dims[2]!==_e||g.dims[3]!==zt)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:$,sequenceLength:_e,pastSequenceLength:pt,kvSequenceLength:mt,totalSequenceLength:zt,maxSequenceLength:dt,inputHiddenSize:lt,hiddenSize:at,vHiddenSize:ct,headSize:Math.floor(at/s.numHeads),vHeadSize:Math.floor(ct/s.numHeads),numHeads:s.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:s.maskFilterValue,maskType:ft,scale:s.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},lo=(e,s,i)=>s&&e?`
      let total_sequence_length_input = u32(${s.getByOffset("0")});
      let present_sequence_length = max(total_sequence_length_input, uniforms.past_sequence_length);
      let is_subsequent_prompt: bool = sequence_length > 1 && sequence_length != total_sequence_length_input;
      let is_first_prompt: bool = is_subsequent_prompt == false && sequence_length == total_sequence_length_input;
      total_sequence_length = u32(${e==null?void 0:e.getByOffset("batchIdx")}) + 1;
      var past_sequence_length: u32 = 0;
      if (is_first_prompt == false) {
        past_sequence_length = total_sequence_length - sequence_length;
      }
       `:`
    ${i?"let past_sequence_length = uniforms.past_sequence_length":""};
    let present_sequence_length = total_sequence_length;
    `,Nm=(e,s,i,c,d,h,_,g)=>{let $=ce(_?1:h),_e=64,lt=h/$;lt<_e&&(_e=32);let at=Math.ceil(h/$/_e),it=[{type:12,data:s},{type:12,data:i},{type:12,data:c},{type:12,data:d},{type:12,data:lt},{type:12,data:at}],ct=be(e.dataType,$),mt=Ae(1,$),pt=["type"];_&&pt.push("type"),g&&pt.push("type");let zt=dt=>{let ft=M("x",e.dataType,e.dims,$),kt=[ft],St=_?P("seq_lens",_.dataType,_.dims):void 0;St&&kt.push(St);let Lt=g?P("total_sequence_length_input",g.dataType,g.dims):void 0;Lt&&kt.push(Lt);let Gt=Ae(e.dataType),Bt=[{name:"batch_size",type:"u32"},{name:"num_heads",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"sequence_length",type:"u32"},{name:"total_sequence_length",type:"u32"},{name:"elements_per_thread",type:"u32"}];return`
  var<workgroup> thread_max: array<f32, ${_e}>;
  var<workgroup> thread_sum: array<f32, ${_e}>;
  ${dt.registerUniforms(Bt).declareVariables(...kt)}
  ${dt.mainStart([_e,1,1])}
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let sequence_length = uniforms.sequence_length;
    var total_sequence_length = uniforms.total_sequence_length;
    ${lo(St,Lt,!1)}
    let local_offset = local_idx * uniforms.elements_per_thread;
    let offset = (global_idx / ${_e}) * uniforms.total_sequence_length + local_offset;
    let seq_causal_length = ${_?"u32(past_sequence_length + workgroup_id.y + 1)":"total_sequence_length"};
    var thread_max_vector = ${mt}(-3.402823e+38f);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      thread_max_vector = max(${mt}(x[offset + i]), thread_max_vector);
    }
    thread_max[local_idx] = ${(()=>{switch($){case 1:return"thread_max_vector";case 2:return"max(thread_max_vector.x, thread_max_vector.y)";case 4:return"max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))";default:throw new Error(`Unsupported components: ${$}`)}})()};
    workgroupBarrier();

    var max_value =  f32(-3.402823e+38f);
    for (var i = 0u; i < ${_e}; i++) {
      max_value = max(thread_max[i], max_value);
    }

    var sum_vector = ${mt}(0);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      sum_vector += exp(${mt}(x[offset + i]) - max_value);
    }
    thread_sum[local_idx] = ${(()=>{switch($){case 1:return"sum_vector";case 2:return"sum_vector.x + sum_vector.y";case 4:return"sum_vector.x + sum_vector.y + sum_vector.z + sum_vector.w";default:throw new Error(`Unsupported components: ${$}`)}})()};
    workgroupBarrier();

    var sum: f32 = 0;
    for (var i = 0u; i < ${_e}; i++) {
      sum += thread_sum[i];
    }

    if (sum == 0) {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        x[offset + i] = ${ft.type.value}(${Gt}(1.0) / ${Gt}(seq_causal_length));
      }
    } else {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        var f32input = ${mt}(x[offset + i]);
        x[offset + i] = ${ft.type.value}(exp(f32input - max_value) / sum);
      }
    }
      ${_?`
        for (var total_seq_id: u32 = seq_causal_length; total_seq_id + local_offset < uniforms.total_sequence_length; total_seq_id++) {
          x[offset + total_seq_id] = ${ft.type.value}(${Gt}(0));
        }`:""};
  }`};return{name:"AttentionProbsSoftmax",shaderCache:{hint:`${_e};${ct};${$}`,inputDependencies:pt},getShaderSource:zt,getRunData:()=>({outputs:[],dispatchGroup:{x:1,y:d,z:s*i},programUniforms:it})}},Vm=(e,s,i,c,d,h,_,g,$)=>{let _e=_+h.kvSequenceLength,lt=[h.batchSize,h.numHeads,h.sequenceLength,_e],at=e>1&&c,it=h.kvNumHeads?h.kvNumHeads:h.numHeads,ct=at?[h.batchSize,it,_e,h.headSize]:void 0,mt=h.nReps?h.nReps:1,pt=h.scale===0?1/Math.sqrt(h.headSize):h.scale,zt=ce(h.headSize),dt=h.headSize/zt,ft=12,kt={x:Math.ceil(_e/ft),y:Math.ceil(h.sequenceLength/ft),z:h.batchSize*h.numHeads},St=[{type:12,data:h.sequenceLength},{type:12,data:dt},{type:12,data:_e},{type:12,data:h.numHeads},{type:12,data:h.headSize},{type:1,data:pt},{type:12,data:_},{type:12,data:h.kvSequenceLength},{type:12,data:mt}],Lt=at&&c&&k.size(c.dims)>0,Gt=["type","type"];Lt&&Gt.push("type"),d&&Gt.push("type"),g&&Gt.push("type"),$&&Gt.push("type");let Bt=[{dims:lt,dataType:s.dataType,gpuDataType:0}];at&&Bt.push({dims:ct,dataType:s.dataType,gpuDataType:0});let nr=cr=>{let ur=P("q",s.dataType,s.dims,zt),yn=P("key",i.dataType,i.dims,zt),hn=[ur,yn];if(Lt){let Sn=P("past_key",c.dataType,c.dims,zt);hn.push(Sn)}d&&hn.push(P("attention_bias",d.dataType,d.dims));let _n=g?P("seq_lens",g.dataType,g.dims):void 0;_n&&hn.push(_n);let gn=$?P("total_sequence_length_input",$.dataType,$.dims):void 0;gn&&hn.push(gn);let vn=M("output",s.dataType,lt),Tn=[vn];at&&Tn.push(M("present_key",s.dataType,ct,zt));let kn=Ae(1,zt),bn=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"alpha",type:"f32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${ft}u;

  var<workgroup> tileQ: array<${ur.type.storage}, ${ft*ft}>;
  var<workgroup> tileK: array<${ur.type.storage}, ${ft*ft}>;
  ${cr.registerUniforms(bn).declareVariables(...hn,...Tn)}
  ${cr.mainStart([ft,ft,1])}
    // x holds the N and y holds the M
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let kvHeadIdx = ${mt===1?"headIdx":"headIdx / uniforms.n_reps"};
    let kv_num_heads = ${mt===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let m = workgroup_id.y * TILE_SIZE;
    let n = workgroup_id.x * TILE_SIZE;
    let sequence_length = uniforms.M;
    var total_sequence_length = uniforms.N;
    ${lo(_n,gn,!0)}
    let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx;
    let qOffset = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
    ${Lt&&at?"let pastKeyOffset = absKvHeadIdx * uniforms.past_sequence_length * uniforms.K;":""};
    let kOffset = absKvHeadIdx * uniforms.kv_sequence_length * uniforms.K;
    ${at?"let presentKeyOffset = absKvHeadIdx * uniforms.N * uniforms.K;":""}
    var value = ${kn}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (global_id.y < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];
      }
      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
      ${Lt&&at?`
              if (n + local_id.y < past_sequence_length) {
                tileK[idx] = past_key[pastKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
              } else if (n + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
                tileK[idx] = key[kOffset + (n + local_id.y - past_sequence_length) * uniforms.K + w + local_id.x];
              }`:`
          if (n + local_id.y < uniforms.kv_sequence_length) {
            tileK[idx] = key[kOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
          }`}
      ${at?`if (n + local_id.y < present_sequence_length) {
        present_key[presentKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x] = tileK[idx];
      }`:""}
      }
      workgroupBarrier();

      for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {
          value += ${kn}(tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k]);
      }

      workgroupBarrier();
    }

    if (global_id.y < uniforms.M && global_id.x < total_sequence_length) {
      let headOffset = workgroup_id.z * uniforms.M * uniforms.N;
      let outputIdx = headOffset + global_id.y * uniforms.N + global_id.x;
      var sum: f32 = ${(()=>{switch(zt){case 1:return"value";case 2:return"value.x + value.y";case 4:return"value.x + value.y + value.z + value.w";default:throw new Error(`Unsupported components: ${zt}`)}})()};
        output[outputIdx] = ${vn.type.value} (sum * uniforms.alpha) + ${d?"attention_bias[outputIdx]":"0.0"};
    }
  }`};return{name:"AttentionProbs",shaderCache:{hint:`${zt};${d!==void 0};${c!==void 0};${e}`,inputDependencies:Gt},getRunData:()=>({outputs:Bt,dispatchGroup:kt,programUniforms:St}),getShaderSource:nr}},Wm=(e,s,i,c,d,h,_=void 0,g=void 0)=>{let $=h+d.kvSequenceLength,_e=d.nReps?d.nReps:1,lt=d.vHiddenSize*_e,at=e>1&&c,it=d.kvNumHeads?d.kvNumHeads:d.numHeads,ct=at?[d.batchSize,it,$,d.headSize]:void 0,mt=[d.batchSize,d.sequenceLength,lt],pt=12,zt={x:Math.ceil(d.vHeadSize/pt),y:Math.ceil(d.sequenceLength/pt),z:d.batchSize*d.numHeads},dt=[{type:12,data:d.sequenceLength},{type:12,data:$},{type:12,data:d.vHeadSize},{type:12,data:d.numHeads},{type:12,data:d.headSize},{type:12,data:lt},{type:12,data:h},{type:12,data:d.kvSequenceLength},{type:12,data:_e}],ft=at&&c&&k.size(c.dims)>0,kt=["type","type"];ft&&kt.push("type"),_&&kt.push("type"),g&&kt.push("type");let St=[{dims:mt,dataType:s.dataType,gpuDataType:0}];at&&St.push({dims:ct,dataType:s.dataType,gpuDataType:0});let Lt=Gt=>{let Bt=P("probs",s.dataType,s.dims),nr=P("v",i.dataType,i.dims),cr=[Bt,nr];ft&&cr.push(P("past_value",c.dataType,c.dims));let ur=_?P("seq_lens",_.dataType,_.dims):void 0;_&&cr.push(ur);let yn=g?P("total_sequence_length_input",g.dataType,g.dims):void 0;g&&cr.push(yn);let hn=[M("output",s.dataType,mt)];at&&hn.push(M("present_value",s.dataType,ct));let _n=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"v_hidden_size",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${pt}u;
  var<workgroup> tileQ: array<${Bt.type.value}, ${pt*pt}>;
  var<workgroup> tileV: array<${Bt.type.value}, ${pt*pt}>;
  ${Gt.registerUniforms(_n).declareVariables(...cr,...hn)}
  ${Gt.mainStart([pt,pt,1])}
   let headIdx = workgroup_id.z % uniforms.num_heads;
   let batchIdx = workgroup_id.z / uniforms.num_heads;
   let kvHeadIdx = ${_e===1?"headIdx":"headIdx / uniforms.n_reps"};
   let kv_num_heads = ${_e===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
   let m = global_id.y;
   let n = global_id.x;
   let sequence_length = uniforms.M;
   var total_sequence_length = uniforms.K;
   ${lo(ur,yn,!0)}
   let offsetA = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
   let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx; // kvHeadIdx is relative to the batch
   ${ft&&at?"let pastValueOffset = absKvHeadIdx * uniforms.N * uniforms.past_sequence_length + n;":""};
   let vOffset = absKvHeadIdx * uniforms.N * uniforms.kv_sequence_length + n;
   ${at?"let presentValueOffset = absKvHeadIdx * uniforms.N * uniforms.K + n;":""}
   var value = ${Bt.type.storage}(0);
   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
        ${ft&&at?`
        if (w + local_id.y < past_sequence_length) {
          tileV[idx] = past_value[pastValueOffset + (w + local_id.y) * uniforms.N];
        } else if (w + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
          tileV[idx] = v[vOffset + (w + local_id.y - past_sequence_length) * uniforms.N];
        }
      `:`
            if (w + local_id.y < uniforms.kv_sequence_length) {
              tileV[idx] = v[vOffset + (w + local_id.y) * uniforms.N];
            }`}
        ${at?`
            if (w + local_id.y < present_sequence_length) {
          present_value[presentValueOffset + (w + local_id.y) * uniforms.N] = tileV[idx];
        }`:""}
      }
     workgroupBarrier();
     for (var k: u32 = 0u; k < TILE_SIZE && w+k < total_sequence_length; k++) {
       value += tileQ[TILE_SIZE * local_id.y + k] * tileV[TILE_SIZE * k + local_id.x];
     }
     workgroupBarrier();
   }

   // we need to transpose output from BNSH_v to BSND_v
   if (m < uniforms.M && n < uniforms.N) {
     let outputIdx = batchIdx * uniforms.M * uniforms.v_hidden_size + m * uniforms.v_hidden_size
       + headIdx * uniforms.N + n;
     output[outputIdx] = value;
   }
  }`};return{name:"AttentionScore",shaderCache:{hint:`${c!==void 0};${e}`,inputDependencies:kt},getRunData:()=>({outputs:St,dispatchGroup:zt,programUniforms:dt}),getShaderSource:Lt}},Rt=(e,s,i,c,d,h,_,g,$,_e,lt=void 0,at=void 0)=>{let it=Math.min(e.outputCount,1+(_?1:0)+(g?1:0)),ct=it>1?_e.pastSequenceLength:0,mt=ct+_e.kvSequenceLength,pt=$&&k.size($.dims)>0?$:void 0,zt=[s,i];it>1&&_&&k.size(_.dims)>0&&zt.push(_),pt&&zt.push(pt),lt&&zt.push(lt),at&&zt.push(at);let dt=e.compute(Vm(it,s,i,_,pt,_e,ct,lt,at),{inputs:zt,outputs:it>1?[-1,1]:[-1]})[0];e.compute(Nm(dt,_e.batchSize,_e.numHeads,ct,_e.sequenceLength,mt,lt,at),{inputs:lt&&at?[dt,lt,at]:[dt],outputs:[]});let ft=[dt,c];it>1&&g&&k.size(g.dims)>0&&ft.push(g),lt&&ft.push(lt),at&&ft.push(at),e.compute(Wm(it,dt,c,g,_e,ct,lt,at),{inputs:ft,outputs:it>1?[0,2]:[0]})},Lm=(e,s)=>{let i=[s.batchSize,s.numHeads,s.sequenceLength,s.headSize],c=s.sequenceLength,d=s.inputHiddenSize,h=s.headSize,_=12,g={x:Math.ceil(s.headSize/_),y:Math.ceil(s.sequenceLength/_),z:s.batchSize*s.numHeads},$=[e.inputs[0],e.inputs[1],e.inputs[2]],_e=[{type:12,data:c},{type:12,data:d},{type:12,data:h},{type:12,data:s.numHeads},{type:12,data:s.headSize},{type:12,data:s.hiddenSize},{type:12,data:s.hiddenSize+s.hiddenSize+s.vHiddenSize}],lt=at=>{let it=M("output_q",$[0].dataType,i),ct=M("output_k",$[0].dataType,i),mt=M("output_v",$[0].dataType,i),pt=P("input",$[0].dataType,$[0].dims),zt=P("weight",$[1].dataType,$[1].dims),dt=P("bias",$[2].dataType,$[2].dims),ft=pt.type.storage,kt=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`
  const TILE_SIZE = ${_}u;
  var<workgroup> tileInput: array<${ft}, ${_*_}>;
  var<workgroup> tileWeightQ: array<${ft}, ${_*_}>;
  var<workgroup> tileWeightK: array<${ft}, ${_*_}>;
  var<workgroup> tileWeightV: array<${ft}, ${_*_}>;
  ${at.registerUniforms(kt).declareVariables(pt,zt,dt,it,ct,mt)}
  ${at.mainStart([_,_,1])}
    let batchIndex = workgroup_id.z / uniforms.num_heads;
    let headNumber = workgroup_id.z % uniforms.num_heads;
    let m = global_id.y;
    let n = global_id.x;

    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;
    let biasOffsetQ = headNumber * uniforms.head_size;
    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;
    let biasOffsetV = uniforms.hidden_size + biasOffsetK;

    var valueQ = ${ft}(0);
    var valueK = ${ft}(0);
    var valueV = ${ft}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        let offset = n + (w + local_id.y) * uniforms.ldb;
        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];
        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];
        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];
      }
      workgroupBarrier();
      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {
        let inputTileOffset = TILE_SIZE * local_id.y + k;
        let weightTileOffset = TILE_SIZE * k + local_id.x;
        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];
        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];
        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];
      }

      workgroupBarrier();
    }

    let headOffset = (m * uniforms.N + n) % uniforms.head_size;
    valueQ += bias[headOffset + biasOffsetQ];
    valueK += bias[headOffset + biasOffsetK];
    valueV += bias[headOffset + biasOffsetV];

    let offset = workgroup_id.z * uniforms.M * uniforms.N;
    if (m < uniforms.M && n < uniforms.N) {
      let outputIdx = offset + m * uniforms.N + n;
      output_q[outputIdx] = valueQ;
      output_k[outputIdx] = valueK;
      output_v[outputIdx] = valueV;
    }
  }`};return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:i,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:i,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:i,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:g,programUniforms:_e}),getShaderSource:lt},{inputs:$,outputs:[-1,-1,-1]})},ks=(e,s)=>{let i=Um(e.inputs,s),[c,d,h]=Lm(e,i);return Rt(e,c,d,h,e.inputs[4],void 0,void 0,void 0,e.inputs[5],i)}}),Gm,Hm,Fm,Ps,zs=U(()=>{We(),ee(),ne(),Se(),ie(),Gm=(e,s)=>{if(!e||e.length!==5)throw new Error("BatchNormalization requires 5 inputs");let i=(c,d,h)=>{let _=d.length;if(_!==c.length)throw new Error(`${h}: num dimensions != ${_}`);d.forEach((g,$)=>{if(g!==c[$])throw new Error(`${h}: dim[${$}] do not match`)})};if(e[0].dims.length>1){let c=s.format==="NHWC"?s.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,s.spatial?2:void 0);i(e[1].dims,c,"Invalid input scale"),i(e[2].dims,c,"Invalid input B"),i(e[3].dims,c,"Invalid input mean"),i(e[4].dims,c,"Invalid input var")}else i(e[1].dims,[1],"Invalid input scale"),i(e[2].dims,[1],"Invalid input B"),i(e[3].dims,[1],"Invalid input mean"),i(e[4].dims,[1],"Invalid input var")},Hm=(e,s)=>{let{epsilon:i,spatial:c,format:d}=s,h=e[0].dims,_=c?ce(h[h.length-1]):1,g=d==="NHWC"&&h.length>1?_:1,$=k.size(h)/_,_e=c,lt=_e?h.length:h,at=P("x",e[0].dataType,e[0].dims,_),it=P("scale",e[1].dataType,e[1].dims,g),ct=P("bias",e[2].dataType,e[2].dims,g),mt=P("inputMean",e[3].dataType,e[3].dims,g),pt=P("inputVar",e[4].dataType,e[4].dims,g),zt=M("y",e[0].dataType,lt,_),dt=()=>{let kt="";if(c)kt=`let cOffset = ${h.length===1?"0u":d==="NHWC"?`outputIndices[${h.length-1}] / ${_}`:"outputIndices[1]"};`;else if(d==="NCHW")kt=`
            ${zt.indicesSet("outputIndices","0","0")}
            let cOffset = ${zt.indicesToOffset("outputIndices")};`;else{kt=`var cIndices = ${it.type.indices}(0);
                       cIndices[0] = outputIndices[${h.length-1}];`;for(let St=1;St<it.rank;St++)kt+=`cIndices[${St}] = outputIndices[${St}];`;kt+=`let cOffset = ${it.indicesToOffset("cIndices")};`}return kt},ft=kt=>`
  const epsilon = ${i};
  ${kt.registerUniform("outputSize","u32").declareVariables(at,it,ct,mt,pt,zt)}
  ${kt.mainStart()}
  ${kt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
    var outputIndices = ${zt.offsetToIndices(`global_idx * ${_}`)};
    ${dt()}
    let scale = ${it.getByOffset("cOffset")};
    let bias = ${ct.getByOffset("cOffset")};
    let inputMean = ${mt.getByOffset("cOffset")};
    let inputVar = ${pt.getByOffset("cOffset")};
    let x = ${at.getByOffset("global_idx")};
    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;
    ${zt.setByOffset("global_idx","value")}
  }`;return{name:"BatchNormalization",shaderCache:{hint:`${s.epsilon}_${s.format}_${c}_${_}`,inputDependencies:_e?["rank","type","type","type","type"]:void 0},getShaderSource:ft,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil($/64)},programUniforms:_e?[{type:12,data:$},...N(h)]:[{type:12,data:$}]})}},Fm=e=>J(e),Ps=(e,s)=>{let{inputs:i,outputCount:c}=e,d=Fm({...s,outputCount:c});if(ge.webgpu.validateInputContent&&Gm(i,d),s.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");e.compute(Hm(i,d))}}),qm,jm,Os,Bs=U(()=>{ne(),ie(),qm=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},jm=e=>{let s=e[0].dims,i=e[0].dims[2],c=k.size(s)/4,d=e[0].dataType,h=P("input",d,s,4),_=P("bias",d,[i],4),g=P("residual",d,s,4),$=M("output",d,s,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:s,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)}}),getShaderSource:_e=>`
  const channels = ${i}u / 4;
  ${_e.declareVariables(h,_,g,$)}

  ${_e.mainStart()}
    ${_e.guardAgainstOutOfBoundsWorkgroupSizes(c)}
    let value = ${h.getByOffset("global_idx")}
      + ${_.getByOffset("global_idx % channels")} + ${g.getByOffset("global_idx")};
    ${$.setByOffset("global_idx","value")}
  }`}},Os=e=>{qm(e.inputs),e.compute(jm(e.inputs))}}),Km,me,Ds,Ms,Rs,Us,Ns,Vs,Ws,Ls,Gs,Zm,Hs,Fs,qs,js,Yt,Ks,qr,Zs,Qs,Ys,Xs,Js,eu,tu,ru,nu,ou,iu,au,su,uu,du,lu,cu,pu,co,po,mu,fu,hu,Qm,Ym,gu,jr=U(()=>{ee(),ne(),Se(),ie(),Km=(e,s,i,c,d,h,_)=>{let g=Math.ceil(s/4),$="";typeof d=="string"?$=`${d}(a)`:$=d("a");let _e=P("inputData",i,[g],4),lt=M("outputData",c,[g],4),at=[{name:"vec_size",type:"u32"}];return _&&at.push(..._),`
      ${e.registerUniforms(at).declareVariables(_e,lt)}

  ${h??""}

  ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}

    let a = ${_e.getByOffset("global_idx")};
    ${lt.setByOffset("global_idx",$)}
  }`},me=(e,s,i,c,d,h=e.dataType,_,g)=>{let $=[{type:12,data:Math.ceil(k.size(e.dims)/4)}];return _&&$.push(..._),{name:s,shaderCache:{hint:d,inputDependencies:["type"]},getShaderSource:_e=>Km(_e,k.size(e.dims),e.dataType,h,i,c,g),getRunData:_e=>({outputs:[{dims:e.dims,dataType:h}],dispatchGroup:{x:Math.ceil(k.size(_e[0].dims)/64/4)},programUniforms:$})}},Ds=e=>{e.compute(me(e.inputs[0],"Abs","abs"))},Ms=e=>{e.compute(me(e.inputs[0],"Acos","acos"))},Rs=e=>{e.compute(me(e.inputs[0],"Acosh","acosh"))},Us=e=>{e.compute(me(e.inputs[0],"Asin","asin"))},Ns=e=>{e.compute(me(e.inputs[0],"Asinh","asinh"))},Vs=e=>{e.compute(me(e.inputs[0],"Atan","atan"))},Ws=e=>{e.compute(me(e.inputs[0],"Atanh","atanh"))},Ls=e=>J(e),Gs=(e,s)=>{let i;switch(s.to){case 10:i="vec4<f16>";break;case 1:i="vec4<f32>";break;case 12:i="vec4<u32>";break;case 6:i="vec4<i32>";break;case 9:i="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute 'to' from 'Cast' operator): ${s.to}`)}e.compute(me(e.inputs[0],"Cast",i,void 0,s.cacheKey,s.to))},Zm=e=>{let s,i,c=e.length>=2&&e[1].data!==0,d=e.length>=3&&e[2].data!==0;switch(e[0].dataType){case 1:s=c?e[1].getFloat32Array()[0]:-34028234663852886e22,i=d?e[2].getFloat32Array()[0]:34028234663852886e22;break;case 10:s=c?e[1].getUint16Array()[0]:64511,i=d?e[2].getUint16Array()[0]:31743;break;default:throw new Error("Unsupport data type")}return J({min:s,max:i})},Hs=(e,s)=>{let i=s||Zm(e.inputs),c=Ae(e.inputs[0].dataType);e.compute(me(e.inputs[0],"Clip",d=>`clamp(${d}, vec4<${c}>(uniforms.min), vec4<${c}>(uniforms.max))`,void 0,i.cacheKey,void 0,[{type:e.inputs[0].dataType,data:i.min},{type:e.inputs[0].dataType,data:i.max}],[{name:"min",type:c},{name:"max",type:c}]),{inputs:[0]})},Fs=e=>{e.compute(me(e.inputs[0],"Ceil","ceil"))},qs=e=>{e.compute(me(e.inputs[0],"Cos","cos"))},js=e=>{e.compute(me(e.inputs[0],"Cosh","cosh"))},Yt=e=>J(e),Ks=(e,s)=>{let i=Ae(e.inputs[0].dataType);e.compute(me(e.inputs[0],"Elu",c=>`elu_vf32(${c})`,`
  const elu_alpha_ = ${i}(${s.alpha});

  fn elu_f32(a: ${i}) -> ${i} {
  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);
  }

  fn elu_vf32(v: vec4<${i}>) -> vec4<${i}> {
  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));
  }`,s.cacheKey))},qr=(e="f32")=>`
const r0: ${e} = 0.3275911;
const r1: ${e} = 0.254829592;
const r2: ${e} = -0.284496736;
const r3: ${e} = 1.421413741;
const r4: ${e} = -1.453152027;
const r5: ${e} = 1.061405429;

fn erf_vf32(v: vec4<${e}>) -> vec4<${e}> {
  let absv = abs(v);
  let x = 1.0 / (1.0 + r0 * absv);
  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));
}`,Zs=e=>{let s=Ae(e.inputs[0].dataType);e.compute(me(e.inputs[0],"Erf",i=>`erf_vf32(${i})`,qr(s)))},Qs=e=>{e.compute(me(e.inputs[0],"Exp","exp"))},Ys=e=>{e.compute(me(e.inputs[0],"Floor","floor"))},Xs=e=>{let s=Ae(e.inputs[0].dataType);e.compute(me(e.inputs[0],"Gelu",i=>`0.5 * ${i} * (1.0 + erf_vf32(${i} * 0.7071067811865475))`,qr(s)))},Js=(e,s)=>{let i=Ae(e.inputs[0].dataType);e.compute(me(e.inputs[0],"LeakyRelu",c=>`select(leaky_relu_alpha_ * ${c}, ${c}, ${c} >= vec4<${i}>(0.0))`,`const leaky_relu_alpha_ = ${i}(${s.alpha});`,s.cacheKey))},eu=e=>{e.compute(me(e.inputs[0],"Not",s=>`!${s}`))},tu=e=>{e.compute(me(e.inputs[0],"Neg",s=>`-${s}`))},ru=e=>{e.compute(me(e.inputs[0],"Reciprocal",s=>`1.0/${s}`))},nu=e=>{let s=Ae(e.inputs[0].dataType);e.compute(me(e.inputs[0],"Relu",i=>`select(vec4<${s}>(0.0), ${i}, ${i} > vec4<${s}>(0.0))`))},ou=e=>{e.compute(me(e.inputs[0],"Sigmoid",s=>`(1.0 / (1.0 + exp(-${s})))`))},iu=e=>J(e),au=(e,s)=>{let i=Ae(e.inputs[0].dataType);e.compute(me(e.inputs[0],"HardSigmoid",c=>`max(vec4<${i}>(0.0), min(vec4<${i}>(1.0), ${s.alpha} * ${c} + vec4<${i}>(${s.beta})))`,void 0,s.cacheKey))},su=e=>{e.compute(me(e.inputs[0],"Sin","sin"))},uu=e=>{e.compute(me(e.inputs[0],"Sinh","sinh"))},du=e=>{e.compute(me(e.inputs[0],"Sqrt","sqrt"))},lu=e=>{e.compute(me(e.inputs[0],"Tan","tan"))},cu=e=>`sign(${e}) * (1 - exp(-2 * abs(${e}))) / (1 + exp(-2 * abs(${e})))`,pu=e=>{e.compute(me(e.inputs[0],"Tanh",cu))},co=(e="f32")=>`
const fast_gelu_a: ${e} = 0.5;
const fast_gelu_b: ${e} = 0.7978845608028654;
const fast_gelu_c: ${e} = 0.035677408136300125;

fn tanh_v(v: vec4<${e}>) -> vec4<${e}> {
  return ${cu("v")};
}
`,po=e=>`(fast_gelu_a + fast_gelu_a * tanh_v(${e} * (fast_gelu_c * ${e} * ${e} + fast_gelu_b))) * ${e}`,mu=e=>{let s=Ae(e.inputs[0].dataType);e.compute(me(e.inputs[0],"FastGelu",po,co(s),void 0,e.inputs[0].dataType))},fu=(e,s)=>{let i=Ae(e.inputs[0].dataType);return e.compute(me(e.inputs[0],"ThresholdedRelu",c=>`select(vec4<${i}>(0.0), ${c}, ${c} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${i}>(${s.alpha});`,s.cacheKey)),0},hu=e=>{e.compute(me(e.inputs[0],"Log","log"))},Qm=(e,s)=>`
const alpha = vec4<${e}>(${s});
const one = ${e}(1.0);
const zero = ${e}(0.0);

fn quick_gelu_impl(x: vec4<${e}>) -> vec4<${e}> {
  let v = x *alpha;
  var x1 : vec4<${e}>;
  for (var i = 0; i < 4; i = i + 1) {
    if (v[i] >= zero) {
      x1[i] = one / (one + exp(-v[i]));
    } else {
      x1[i] = one - one / (one + exp(v[i]));
    }
  }
  return x * x1;
}
`,Ym=e=>`quick_gelu_impl(${e})`,gu=(e,s)=>{let i=Ae(e.inputs[0].dataType);e.compute(me(e.inputs[0],"QuickGelu",Ym,Qm(i,s.alpha),s.cacheKey,e.inputs[0].dataType))}}),Xm,Jm,yu,_u=U(()=>{ne(),ie(),jr(),Xm=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},Jm=e=>{let s=e[0].dims.slice();s[2]=s[2]/2;let i=P("input",e[0].dataType,e[0].dims,4),c=P("bias",e[0].dataType,[e[0].dims[2]],4),d=M("output",e[0].dataType,s,4),h=k.size(s)/4,_=be(e[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:s,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)}}),getShaderSource:g=>`
  const M_SQRT2 = sqrt(2.0);
  const halfChannels = ${e[0].dims[2]/4/2}u;

  ${g.declareVariables(i,c,d)}

  ${qr(_)}

  ${g.mainStart()}
    ${g.guardAgainstOutOfBoundsWorkgroupSizes(h)}
    let biasIdx = global_idx % halfChannels;
    let batchIndex = global_idx / halfChannels;
    let inputOffset = biasIdx + batchIndex * halfChannels * 2;
    let valueLeft = input[inputOffset] + bias[biasIdx];
    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];
    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);

    ${d.setByOffset("global_idx","valueLeft * geluRight")}
  }`}},yu=e=>{Xm(e.inputs),e.compute(Jm(e.inputs))}}),ef,tf,ot,wu,vu,$u,xu,Su,Tu,Iu,Cu,Au,Eu,ku=U(()=>{ee(),ne(),ie(),ef=(e,s,i,c,d,h,_,g,$,_e,lt,at)=>{let it,ct;typeof g=="string"?it=ct=(ft,kt)=>`${g}((${ft}),(${kt}))`:typeof g=="function"?it=ct=g:(it=g.scalar,ct=g.vector);let mt=M("outputData",lt,c.length,4),pt=P("aData",$,s.length,4),zt=P("bData",_e,i.length,4),dt;if(d)if(h){let ft=k.size(s)===1,kt=k.size(i)===1,St=s.length>0&&s[s.length-1]%4===0,Lt=i.length>0&&i[i.length-1]%4===0;ft||kt?dt=mt.setByOffset("global_idx",ct(ft?`${pt.type.value}(${pt.getByOffset("0")}.x)`:pt.getByOffset("global_idx"),kt?`${zt.type.value}(${zt.getByOffset("0")}.x)`:zt.getByOffset("global_idx"))):dt=`
            let outputIndices = ${mt.offsetToIndices("global_idx * 4u")};
            let offsetA = ${pt.broadcastedIndicesToOffset("outputIndices",mt)};
            let offsetB = ${zt.broadcastedIndicesToOffset("outputIndices",mt)};
            ${mt.setByOffset("global_idx",ct(_||St?pt.getByOffset("offsetA / 4u"):`${pt.type.value}(${pt.getByOffset("offsetA / 4u")}[offsetA % 4u])`,_||Lt?zt.getByOffset("offsetB / 4u"):`${zt.type.value}(${zt.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}
          `}else dt=mt.setByOffset("global_idx",ct(pt.getByOffset("global_idx"),zt.getByOffset("global_idx")));else{if(!h)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let ft=(kt,St,Lt="")=>{let Gt=`aData[indexA${St}][componentA${St}]`,Bt=`bData[indexB${St}][componentB${St}]`;return`
            let outputIndices${St} = ${mt.offsetToIndices(`global_idx * 4u + ${St}u`)};
            let offsetA${St} = ${pt.broadcastedIndicesToOffset(`outputIndices${St}`,mt)};
            let offsetB${St} = ${zt.broadcastedIndicesToOffset(`outputIndices${St}`,mt)};
            let indexA${St} = offsetA${St} / 4u;
            let indexB${St} = offsetB${St} / 4u;
            let componentA${St} = offsetA${St} % 4u;
            let componentB${St} = offsetB${St} % 4u;
            ${kt}[${St}] = ${Lt}(${it(Gt,Bt)});
          `};lt===9?dt=`
            var data = vec4<u32>(0);
            ${ft("data",0,"u32")}
            ${ft("data",1,"u32")}
            ${ft("data",2,"u32")}
            ${ft("data",3,"u32")}
            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:dt=`
            ${ft("outputData[global_idx]",0)}
            ${ft("outputData[global_idx]",1)}
            ${ft("outputData[global_idx]",2)}
            ${ft("outputData[global_idx]",3)}
          `}return`
        ${e.registerUniform("vec_size","u32").declareVariables(pt,zt,mt)}

        ${at??""}

        ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${dt}
      }`},tf=(e,s,i,c,d,h,_=i.dataType)=>{let g=i.dims.map(pt=>Number(pt)??1),$=c.dims.map(pt=>Number(pt)??1),_e=!k.areEqual(g,$),lt=g,at=k.size(g),it=!1,ct=!1,mt=[_e];if(_e){let pt=Je.calcShape(g,$,!1);if(!pt)throw new Error("Can't perform binary op on the given tensors");lt=pt.slice(),at=k.size(lt);let zt=k.size(g)===1,dt=k.size($)===1,ft=g.length>0&&g[g.length-1]%4===0,kt=$.length>0&&$[$.length-1]%4===0;mt.push(zt),mt.push(dt),mt.push(ft),mt.push(kt);let St=1;for(let Lt=1;Lt<lt.length;Lt++){let Gt=g[g.length-Lt],Bt=$[$.length-Lt];if(Gt===Bt)St*=Gt;else break}St%4===0?(ct=!0,it=!0):(zt||dt||ft||kt)&&(it=!0)}else it=!0;return mt.push(it),{name:e,shaderCache:{hint:s+mt.map(pt=>pt.toString()).join("_"),inputDependencies:["rank","rank"]},getShaderSource:pt=>ef(pt,g,$,lt,it,_e,ct,d,i.dataType,c.dataType,_,h),getRunData:()=>({outputs:[{dims:lt,dataType:_}],dispatchGroup:{x:Math.ceil(at/64/4)},programUniforms:[{type:12,data:Math.ceil(k.size(lt)/4)},...N(g,$,lt)]})}},ot=(e,s,i,c,d,h)=>{e.compute(tf(s,d??"",e.inputs[0],e.inputs[1],i,c,h))},wu=e=>{ot(e,"Add",(s,i)=>`${s}+${i}`)},vu=e=>{ot(e,"Div",(s,i)=>`${s}/${i}`)},$u=e=>{ot(e,"Equal",{scalar:(s,i)=>`u32(${s}==${i})`,vector:(s,i)=>`vec4<u32>(${s}==${i})`},void 0,void 0,9)},xu=e=>{ot(e,"Mul",(s,i)=>`${s}*${i}`)},Su=e=>{let s=P("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;ot(e,"Pow",{scalar:(i,c)=>`pow_custom(${i},${c})`,vector:(i,c)=>`pow_vector_custom(${i},${c})`},`
    fn pow_custom(a : ${s}, b : ${s}) -> ${s} {
      if (b == ${s}(0.0)) {
        return ${s}(1.0);
      } else if (a < ${s}(0.0) && f32(b) != floor(f32(b))) {
        return ${s}(pow(f32(a), f32(b))); // NaN
      }
      return select(sign(a), ${s}(1.0), round(f32(abs(b) % ${s}(2.0))) != 1.0) * ${s}(${s==="i32"?"round":""}(pow(f32(abs(a)), f32(b))));
    }
    fn pow_vector_custom(a : vec4<${s}>, b : vec4<${s}>) -> vec4<${s}> {
      // TODO: implement vectorized pow
      return vec4<${s}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));
    }
      `)},Tu=e=>{ot(e,"Sub",(s,i)=>`${s}-${i}`)},Iu=e=>{ot(e,"Greater",{scalar:(s,i)=>`u32(${s}>${i})`,vector:(s,i)=>`vec4<u32>(${s}>${i})`},void 0,void 0,9)},Cu=e=>{ot(e,"Less",{scalar:(s,i)=>`u32(${s}<${i})`,vector:(s,i)=>`vec4<u32>(${s}<${i})`},void 0,void 0,9)},Au=e=>{ot(e,"GreaterOrEqual",{scalar:(s,i)=>`u32(${s}>=${i})`,vector:(s,i)=>`vec4<u32>(${s}>=${i})`},void 0,void 0,9)},Eu=e=>{ot(e,"LessOrEqual",{scalar:(s,i)=>`u32(${s}<=${i})`,vector:(s,i)=>`vec4<u32>(${s}<=${i})`},void 0,void 0,9)}}),nf,of,af,sf,Pu,zu,Ou=U(()=>{ee(),ne(),Se(),ie(),nf=(e,s)=>{if(!e||e.length<1)throw new Error("too few inputs");let i=0,c=e[i],d=c.dataType,h=c.dims.length;e.forEach((_,g)=>{if(g!==i){if(_.dataType!==d)throw new Error("input tensors should be one type");if(_.dims.length!==h)throw new Error("input tensors should have the same shape");_.dims.forEach(($,_e)=>{if(_e!==s&&$!==c.dims[_e])throw new Error("non concat dimensions must match")})}})},of=(e,s)=>`
  fn calculateInputIndex(index: u32) -> u32 {
    let sizeInConcatAxis = array<u32, ${e}u>(${s});
    for (var i: u32 = 0u; i < ${e}; i += 1u ) {
      if (index < sizeInConcatAxis[i]) {
        return i;
      }
    }
    return ${e}u;
  }`,af=(e,s)=>{let i=e.length,c=[];for(let d=0;d<i;++d){let h=s.setByOffset("global_idx",e[d].getByIndices("indices"));i===1?c.push(h):d===0?c.push(`if (inputIndex == ${d}u) { ${h} }`):d===i-1?c.push(`else { ${h} }`):c.push(`else if (inputIndex == ${d}) { ${h} }`)}return c.join(`
`)},sf=(e,s,i,c)=>{let d=k.size(i),h=new Array(e.length),_=new Array(e.length),g=0,$=[],_e=[],lt=[{type:12,data:d}];for(let pt=0;pt<e.length;++pt)g+=e[pt].dims[s],h[pt]=g,_e.push(e[pt].dims.length),_[pt]=P(`input${pt}`,c,_e[pt]),$.push("rank"),lt.push({type:12,data:h[pt]});for(let pt=0;pt<e.length;++pt)lt.push(...N(e[pt].dims));lt.push(...N(i));let at=M("output",c,i.length),it=at.indicesGet("indices",s),ct=Array.from(Array(h.length).keys()).map(pt=>`uniforms.sizeInConcatAxis${pt}`).join(","),mt=pt=>`

  ${(()=>{pt.registerUniform("outputSize","u32");for(let zt=0;zt<e.length;zt++)pt.registerUniform(`sizeInConcatAxis${zt}`,"u32");return pt.declareVariables(..._,at)})()}

  ${of(h.length,ct)}

  ${pt.mainStart()}
    ${pt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

    var indices = ${at.offsetToIndices("global_idx")};

    let inputIndex = calculateInputIndex(${it});
    if (inputIndex != 0u) {
      let sizeInConcatAxis = array<u32, ${h.length}u>(${ct});
      ${it} -= sizeInConcatAxis[inputIndex - 1u];
    }

    ${af(_,at)}
  }`;return{name:"Concat",shaderCache:{hint:`${s}`,inputDependencies:$},getRunData:()=>({outputs:[{dims:i,dataType:c}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:lt}),getShaderSource:mt}},Pu=(e,s)=>{let i=e.inputs,c=i[0].dims,d=k.normalizeAxis(s.axis,c.length);nf(i,d);let h=c.slice();h[d]=i.reduce((g,$)=>g+($.dims.length>d?$.dims[d]:0),0);let _=i.filter(g=>k.size(g.dims)>0);e.compute(sf(_,d,h,i[0].dataType),{inputs:_})},zu=e=>J({axis:e.axis})}),Fe,qe,je,Kr,bt=U(()=>{ee(),ne(),Fe=(e,s,i="f32")=>{switch(e.activation){case"Relu":return`value = max(value, ${s}(0.0));`;case"Sigmoid":return`value = (${s}(1.0) / (${s}(1.0) + exp(-value)));`;case"Clip":return`value = clamp(value, ${s}(${i}(uniforms.clip_min)), ${s}(${i}(uniforms.clip_max)));`;case"HardSigmoid":return`value = max(${s}(0.0), min(${s}(1.0), ${i}(uniforms.alpha) * value + ${i}(uniforms.beta)));`;case"LeakyRelu":return`value = select(${i}(uniforms.alpha) * value, value, value >= ${s}(0.0));`;case"Tanh":return`let e2x = exp(-2.0 * abs(value));
              value = sign(value) * (1.0 - e2x) / (1.0 + e2x);
        `;case"":return"";default:throw new Error(`Unsupported activation ${e.activation}`)}},qe=(e,s)=>{e.activation==="Clip"?s.push({type:1,data:e.clipMax},{type:1,data:e.clipMin}):e.activation==="HardSigmoid"?s.push({type:1,data:e.alpha},{type:1,data:e.beta}):e.activation==="LeakyRelu"&&s.push({type:1,data:e.alpha})},je=(e,s)=>{e.activation==="Clip"?s.push({name:"clip_max",type:"f32"},{name:"clip_min",type:"f32"}):e.activation==="HardSigmoid"?s.push({name:"alpha",type:"f32"},{name:"beta",type:"f32"}):e.activation==="LeakyRelu"&&s.push({name:"alpha",type:"f32"})},Kr=e=>{let s=(e==null?void 0:e.activation)||"";if(s==="HardSigmoid"){let[i,c]=(e==null?void 0:e.activation_params)||[.2,.5];return{activation:s,alpha:i,beta:c}}else if(s==="Clip"){let[i,c]=(e==null?void 0:e.activation_params)||[Wa,La];return{activation:s,clipMax:c,clipMin:i}}else if(s==="LeakyRelu"){let[i]=(e==null?void 0:e.activation_params)||[.01];return{activation:s,alpha:i}}return{activation:s}}}),Ie,Bu,Zr=U(()=>{Ie=(e,s)=>{switch(e){case 1:return s;case 2:return`vec2<${s}>`;case 3:return`vec3<${s}>`;case 4:return`vec4<${s}>`;default:throw new Error(`${e}-component is not supported.`)}},Bu=e=>`
      ${e?"value = value + getBiasByOutputCoords(coords);":""}
      `}),Du,Mu=U(()=>{Du=e=>`
fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
}
fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
    i32(${e}.x), i32(${e}.y), i32(${e}.z), 1));
}
`}),Xt,Qr,Yr=U(()=>{ee(),ne(),ie(),bt(),Xt=(e,s,i,c,d)=>{let h=c-i;return`
      ${Array.from({length:i}).map((_,g)=>`
      if (${F(s.shape,g,s.rank)} != 1) {
        ${s.indicesSet(e,g,F(d,g+h,c))}
      } else {
        ${s.indicesSet(e,g,0)}
      }`).join("")}
`},Qr=(e,s,i,c,d=!1,h)=>{let _=e[0].dims,g=e[1].dims,$=_[_.length-2],_e=g[g.length-1],lt=_[_.length-1],at=ce(_e),it=ce(lt),ct=ce($),mt=k.size(i)/at/ct,pt=e.length>2,zt=c?c.slice(0,-2):i.slice(0,-2),dt=[k.size(zt),$,_e],ft=[{type:12,data:mt},{type:12,data:$},{type:12,data:_e},{type:12,data:lt}];qe(s,ft),ft.push(...N(zt,_,g)),pt&&ft.push(...N(e[2].dims)),ft.push(...N(dt));let kt=St=>{let Lt=Lr("batch_dims",e[0].dataType,zt.length),Gt=P("a",e[0].dataType,_.length,it),Bt=P("b",e[1].dataType,g.length,at),nr=M("output",e[0].dataType,dt.length,at),cr=be(nr.type.tensor),ur=Fe(s,nr.type.value,cr),yn=[Gt,Bt],hn="";if(pt){let vn=d?at:1;yn.push(P("bias",e[2].dataType,e[2].dims.length,vn)),hn=`${d?`value += bias[col / ${vn}];`:`value += ${nr.type.value}(bias[row + i]);`}`}let _n=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"}];je(s,_n);let gn=()=>{let vn=`var a_data: ${Gt.type.value};`;for(let Tn=0;Tn<it;Tn++)vn+=`
              let b_data${Tn} = b[(b_offset + (k + ${Tn}) * uniforms.N + col) / ${at}];`;for(let Tn=0;Tn<ct;Tn++){vn+=`a_data = a[(a_offset + (row + ${Tn}) * uniforms.K + k) / ${it}];`;for(let kn=0;kn<it;kn++)vn+=`
            values[${Tn}] = fma(${Bt.type.value}(a_data${it===1?"":`[${kn}]`}), b_data${kn}, values[${Tn}]);
`}return vn};return`
  ${St.registerUniforms(_n).registerInternalVariables(Lt).declareVariables(...yn,nr)}
  ${St.mainStart()}
    ${St.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let col = (global_idx % (uniforms.N / ${at})) * ${at};
    var index1 = global_idx / (uniforms.N / ${at});
    let stride1 = uniforms.M / ${ct};
    let row = (index1 % stride1) * ${ct};
    let batch = index1 / stride1;

    ${i.length===2?"":`let batch_indices = ${Lt.offsetToIndices("batch")};`}

    var a_indices: ${Gt.type.indices};
    ${Xt("a_indices",Gt,Gt.rank-2,Lt.rank,"batch_indices")}
    ${Gt.indicesSet("a_indices",Gt.rank-2,0)}
    ${Gt.indicesSet("a_indices",Gt.rank-1,0)}
    let a_offset = ${Gt.indicesToOffset("a_indices")};

    var b_indices: ${Bt.type.indices};
    ${Xt("b_indices",Bt,Bt.rank-2,Lt.rank,"batch_indices")}
    ${Bt.indicesSet("b_indices",Bt.rank-2,0)}
    ${Bt.indicesSet("b_indices",Bt.rank-1,0)}
    let b_offset = ${Bt.indicesToOffset("b_indices")};
    var values: array<${nr.type.value}, ${ct}>;
    for (var k: u32 = 0u; k < uniforms.K; k = k + ${it}) {
      ${gn()}
    }
    for (var i = 0u; i < ${ct}u; i++) {
      var value = values[i];
      ${hn}
      ${ur}
      let cur_indices = ${nr.type.indices}(batch, row + i, col);
      let offset = ${nr.indicesToOffset("cur_indices")};
      ${nr.setByOffset(`offset / ${at}`,"value")};
    }
  }
  `};return{name:"MatMulNaive",shaderCache:{hint:`${s.activation};${at};${it};${ct};${d}`,inputDependencies:pt?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:h?h(i):i,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(mt/64)},programUniforms:ft}),getShaderSource:kt}}}),uf,df,mo,Ru,lf,fo,cf,Jt,Xr=U(()=>{ee(),ne(),ie(),bt(),Yr(),Zr(),uf=(e,s)=>e?`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          kStart + inputRow,
          globalRowStart / innerElementSize + inputCol${s?", batchIndices":""});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          globalRow + innerRow,
          kStart / innerElementSize + inputCol${s?", batchIndices":""});
        `,df=(e,s)=>e?`
        let ACached0 = mm_Asub[k * innerElementSize][localRow];
        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];
        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];
        ${s===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}
        for (var i = 0; i < rowPerThread; i = i + 1) {
          acc[i] = BCached0 * ACached0[i] + acc[i];
          acc[i] = BCached1 * ACached1[i] + acc[i];
          acc[i] = BCached2 * ACached2[i] + acc[i];
          ${s===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}
        }`:`
        for (var i = 0; i < rowPerThread; i = i + 1) {
          let ACached = mm_Asub[tileRow + i][k];
          acc[i] = BCached0 * ACached.x + acc[i];
          acc[i] = BCached1 * ACached.y + acc[i];
          acc[i] = BCached2 * ACached.z + acc[i];
          ${s===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}
        }`,mo=(e,s,i="f32",c,d=!1,h=32,_=!1,g=32)=>{let $=s[1]*e[1],_e=s[0]*e[0],lt=d?$:h,at=d?h:$,it=lt/s[0],ct=h/s[1];if(!((d&&it===4&&e[1]===4||!d&&(it===3||it===4))&&lt%s[0]===0&&h%s[1]===0&&e[0]===4))throw new Error(`If transposeA ${d} is true, innerElementSize ${it} and workPerThread[1] ${e[1]} must be 4.
      Otherwise, innerElementSize ${it} must be 3 or 4.
  tileAWidth ${lt} must be divisible by workgroupSize[0]${s[0]}. tileInner ${h} must be divisible by workgroupSize[1] ${s[1]}. colPerThread ${e[0]} must be 4.`);return`
var<workgroup> mm_Asub: array<array<vec${it}<${i}>, ${lt/it}>, ${at}>;
var<workgroup> mm_Bsub: array<array<vec4<${i}>, ${_e/e[0]}>, ${h}>;

const rowPerThread = ${e[1]};
const colPerThread = ${e[0]};
const innerElementSize = ${it};
const tileInner = ${h};

@compute @workgroup_size(${s[0]}, ${s[1]}, ${s[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
  let localRow = i32(localId.y);
  let tileRow = localRow * rowPerThread;
  let tileCol = i32(localId.x);

  let globalRow =i32(globalId.y) * rowPerThread;
  let globalCol = i32(globalId.x);
  let batch = ${_?"0":"i32(globalId.z)"};
  ${c?`let batchIndices = ${c.offsetToIndices("u32(batch)")};`:""}
  let globalRowStart = i32(workgroupId.y) * ${$};

  let num_tiles = ${_?`${Math.ceil(g/h)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
  var kStart = ${_?`i32(globalId.z) * ${g}`:"0"};

  var acc: array<vec4<${i}>, rowPerThread>;

  // Loop over shared dimension.
  let tileRowB = localRow * ${ct};
  for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let inputRow = tileRow + innerRow;
          let inputCol = tileCol;
          ${uf(d,c)}
      }

      // Load one tile of B into local memory.
      for (var innerRow = 0; innerRow < ${ct}; innerRow = innerRow + 1) {
          let inputRow = tileRowB + innerRow;
          let inputCol = tileCol;
          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${c?", batchIndices":""});
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {
          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];
          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];
          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];
          ${it===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}

          ${df(d,it)}
      }

      workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
  }
}`},Ru=(e,s)=>e?`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              kStart + inputRow,
              globalRowStart + inputCol${s?", batchIndices":""});
            `:`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              globalRowStart + inputRow,
              kStart + inputCol${s?", batchIndices":""});
            `,lf=e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",fo=(e,s,i="f32",c,d=!1,h=32,_=!1,g=32,$=!1)=>{let _e=e[1]*s[1],lt=e[0]*s[0],at=d?_e:h,it=d?h:_e;if(!(it%s[1]===0&&at%s[0]===0&&h%s[1]===0))throw new Error(`tileAHight ${it} must be divisible by workgroupSize[1]${s[1]}, tileAWidth ${at} must be divisible by workgroupSize[0]${s[0]}, tileInner ${h} must be divisible by workgroupSize[1]${s[1]}`);let ct=it/s[1],mt=at/s[0],pt=h/s[1],zt=$?`
    let localRow = i32(localId.y);
    let localCol = i32(localId.x);
    let globalRowStart = i32(workgroupId.y) * ${_e};
    let globalColStart = i32(workgroupId.x) * ${lt};

    // Loop over shared dimension.
    for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var inputRow = localRow; inputRow < ${it}; inputRow = inputRow + ${s[1]}) {
        for (var inputCol = localCol; inputCol < ${at}; inputCol = inputCol + ${s[0]}) {
          ${Ru(d,c)}
        }
      }
      // Load one tile of B into local memory.
      for (var inputRow = localRow; inputRow < ${h}; inputRow = inputRow + ${s[1]}) {
            for (var inputCol = localCol; inputCol < ${lt}; inputCol = inputCol + ${s[0]}) {
          mm_Bsub[inputRow][inputCol] = mm_readB(batch,
            kStart + inputRow,
            globalColStart + inputCol${c?", batchIndices":""});
        }
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      var BCached : array<${i}, colPerThread>;
      for (var k = 0; k < tileInner; k = k + 1) {
        for (var inner = 0; inner < colPerThread; inner = inner + 1) {
          BCached[inner] = mm_Bsub[k][localCol + inner * ${s[0]}];
        }
        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let ACached = ${d?`mm_Asub[k][localRow + innerRow * ${s[1]}];`:`mm_Asub[localRow + innerRow * ${s[1]}][k];`}
          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
            acc[innerRow][innerCol] = acc[innerRow][innerCol] +
                ACached * BCached[innerCol];
          }
        }
      }
      workgroupBarrier();
    }
    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      let gRow = globalRowStart + localRow + innerRow * ${s[1]};
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        let gCol = globalColStart + localCol + innerCol * ${s[0]};
        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
      }
    }
    `:`
let tileRow = i32(localId.y) * rowPerThread;
let tileCol = i32(localId.x) * colPerThread;

let globalRow = i32(globalId.y) * rowPerThread;
let globalCol = i32(globalId.x) * colPerThread;
let globalRowStart = i32(workgroupId.y) * ${_e};

let tileRowA = i32(localId.y) * ${ct};
let tileColA = i32(localId.x) * ${mt};
let tileRowB = i32(localId.y) * ${pt};
// Loop over shared dimension.
for (var t = 0; t < num_tiles; t = t + 1) {
  // Load one tile of A into local memory.
  for (var innerRow = 0; innerRow < ${ct}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < ${mt}; innerCol = innerCol + 1) {
      let inputRow = tileRowA + innerRow;
      let inputCol = tileColA + innerCol;
      ${Ru(d,c)}
    }
  }

  // Load one tile of B into local memory.
  for (var innerRow = 0; innerRow < ${pt}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
      let inputRow = tileRowB + innerRow;
      let inputCol = tileCol + innerCol;
      mm_Bsub[inputRow][inputCol] = mm_readB(batch,
        kStart + inputRow,
        globalCol + innerCol${c?", batchIndices":""});
    }
  }
  kStart = kStart + tileInner;
  workgroupBarrier();

  // Compute acc values for a single thread.
  var BCached : array<${i}, colPerThread>;
  for (var k = 0; k < tileInner; k = k + 1) {
    for (var inner = 0; inner < colPerThread; inner = inner + 1) {
      BCached[inner] = mm_Bsub[k][tileCol + inner];
    }

    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      ${lf(d)}
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];
      }
    }
  }

  workgroupBarrier();
}

for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
    mm_write(batch, globalRow + innerRow, globalCol + innerCol,
        acc[innerRow][innerCol]);
  }
}
`;return`
  var<workgroup> mm_Asub : array<array<${i}, ${at}>, ${it}>;
  var<workgroup> mm_Bsub : array<array<${i}, ${lt}>, ${h}>;
  const rowPerThread = ${e[1]};
  const colPerThread = ${e[0]};
  const tileInner = ${h};

@compute @workgroup_size(${s[0]}, ${s[1]}, ${s[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
    let batch = ${_?"0":"i32(globalId.z)"};
    ${c?`let batchIndices = ${c.offsetToIndices("u32(batch)")};`:""}
    let num_tiles = ${_?`${Math.ceil(g/h)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
    var kStart = ${_?`i32(globalId.z) * ${g}`:"0"};

    var acc : array<array<${i}, colPerThread>, rowPerThread>;
    ${zt}
  }
`},cf=(e,s,i,c,d=!1)=>{let[h,_,g,$]=c,_e=be(c[0].type.tensor);return`
    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${h.type.indices}) -> ${Ie(e,_e)} {
      var value = ${Ie(e,_e)}(0.0);
      let col = colIn * ${e};
      if(row < uniforms.dim_a_outer && col < uniforms.dim_inner)
      {
        var aIndices: ${_.type.indices};
        ${Xt("aIndices",_,_.rank-2,h.rank,"batchIndices")}
        ${_.indicesSet("aIndices",_.rank-2,"u32(row)")}
        ${_.indicesSet("aIndices",_.rank-1,"u32(colIn)")}
        value = ${_.getByIndices("aIndices")};
      }
      return value;
    }

    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${h.type.indices}) -> ${Ie(e,_e)} {
      var value = ${Ie(e,_e)}(0.0);
      let col = colIn * ${e};
      if(row < uniforms.dim_inner && col < uniforms.dim_b_outer)
      {
        var bIndices: ${g.type.indices};
        ${Xt("bIndices",g,g.rank-2,h.rank,"batchIndices")}
        ${g.indicesSet("bIndices",g.rank-2,"u32(row)")}
        ${g.indicesSet("bIndices",g.rank-1,"u32(colIn)")}
        value = ${g.getByIndices("bIndices")};
      }
      return value;
    }

    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${Ie(e,_e)}) {
      let col = colIn * ${e};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {
        var value = valueIn;
        let coords = vec3<i32>(batch, row, colIn);
        ${s?`value = value + ${d?"bias[colIn]":`${Ie(e,_e)}(bias[row])`};`:""}
        ${i}
        ${$.setByIndices("vec3<u32>(coords)","value")}
      }
    }
    `},Jt=(e,s,i,c,d=!1,h)=>{let _=e[0].dims,g=e[1].dims,$=_.slice(0,-2),_e=g.slice(0,-2),lt=c?c.slice(0,-2):i.slice(0,-2),at=k.size(lt),it=_[_.length-2],ct=_[_.length-1],mt=g[g.length-1],pt=ct%4===0&&mt%4===0,zt=it<=8?[4,1,1]:[4,4,1],dt=[8,8,1],ft=[Math.ceil(mt/dt[0]/zt[0]),Math.ceil(it/dt[1]/zt[1]),Math.ceil(at/dt[2]/zt[2])],kt=pt?4:1,St=[...$,it,ct/kt],Lt=St.length,Gt=[..._e,ct,mt/kt],Bt=Gt.length,nr=[at,it,mt/kt],cr=[{type:6,data:it},{type:6,data:mt},{type:6,data:ct}];qe(s,cr),cr.push(...N(lt,St,Gt));let ur=["rank","rank"],yn=e.length>2;yn&&(cr.push(...N(e[2].dims)),ur.push("rank")),cr.push(...N(nr));let hn=_n=>{let gn=lt.length,vn=Lr("batchDims",e[0].dataType,gn,1),Tn=be(e[0].dataType),kn=P("a",e[0].dataType,Lt,kt),bn=P("b",e[1].dataType,Bt,kt),Sn=M("result",e[0].dataType,nr.length,kt),fn=[kn,bn];if(yn){let Lo=d?kt:1;fn.push(P("bias",e[2].dataType,e[2].dims.length,Lo))}let or=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"}];je(s,or);let lr=be(Sn.type.tensor),pn=Fe(s,Sn.type.value,lr),Cn=cf(kt,yn,pn,[vn,kn,bn,Sn],d);return`
  ${_n.registerUniforms(or).registerInternalVariables(vn).declareVariables(...fn,Sn)}
  ${Cn}
  ${pt?mo(zt,dt,Tn,vn):fo(zt,dt,Tn,vn)}
                   `};return{name:"MatMul",shaderCache:{hint:`${zt};${s.activation};${pt};${d}`,inputDependencies:ur},getRunData:()=>({outputs:[{dims:h?h(i):i,dataType:e[0].dataType}],dispatchGroup:{x:ft[0],y:ft[1],z:ft[2]},programUniforms:cr}),getShaderSource:hn}}}),pf,Uu,Nu=U(()=>{ee(),Xe(),ie(),bt(),Zr(),Mu(),Xr(),pf=(e,s,i,c,d=!1,h,_=4,g=4,$=4,_e="f32")=>{let lt=cr=>{switch(cr){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${_e}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${cr} is not supported.`)}},at=cr=>{switch(cr){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${cr} is not supported.`)}},it=e?`
    let coord = vec4<i32>(batch, xRow, xCol, xCh);
    `:`
    let coord = vec4<i32>(batch, xCh, xRow, xCol);
    `,ct=e?`
    let coords = vec4<i32>(
      batch,
      row / outWidth,
      row % outWidth,
      col);
    `:`
    let coords = vec4<i32>(
      batch,
      row,
      col / outWidth,
      col % outWidth);
    `,mt=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",pt=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",zt=e?"row":"col",dt=e?"col":"row",ft=`
    let inChannels = i32(uniforms.w_shape[2]);
    let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
    let outRow = ${zt} / outWidth;
    let outCol = ${zt} % outWidth;

    let WRow = ${dt} / (i32(uniforms.w_shape[1]) * inChannels);
    let WCol = ${dt} / inChannels % i32(uniforms.w_shape[1]);
    let xRow = outRow * uniforms.stride[0] + uniforms.dilation[0] * WRow - uniforms.pad[0];
    let xCol = outCol * uniforms.stride[1] + uniforms.dilation[1] * WCol - uniforms.pad[1];
    let xCh = ${dt} % inChannels;
    var resData = ${Ie(_,_e)}(0.0);
    // The bounds checking is always needed since we use it to pad zero for
    // the 'same' padding type.
    if (xRow >= 0 && xRow < ${mt} && xCol >= 0 && xCol < ${pt}) {
      ${it}
      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));
      ${lt(_)}
    }
    return resData;`,kt=e?s&&c?`
    let col = colIn * ${_};
    ${ft}`:`
    let col = colIn * ${_};
    if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {
      ${ft}
    }
    return ${Ie(_,_e)}(0.0);`:c&&i?`
    let col = colIn * ${_};
    ${ft}`:`
    let col = colIn * ${_};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${ft}
    }
    return ${Ie(_,_e)}(0.0);`,St=e?c&&i?at(g):`
    let col = colIn * ${g};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${at(g)}
    }
    return ${Ie(g,_e)}(0.0);`:`
    let col = colIn * ${g};
    if (row < uniforms.dim_inner && col < uniforms.dim_a_outer) {
      ${at(g)}
    }
    return ${Ie(g,_e)}(0.0);`,Lt=Ie($,_e),Gt=Ie(e?_:g,_e),Bt=Ie(e?g:_,_e),nr=Fe(h,Lt,_e);return`
    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${Gt} {
      ${e?kt:St}
    }

    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${Bt} {
      ${e?St:kt}
    }

    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${Lt}) {
      let col = colIn * ${$};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer)
      {
      var value = valueIn;
      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
      ${ct}
      ${Bu(d)}
      ${nr}
      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
      }
    }`},Uu=(e,s,i,c,d,h,_,g,$)=>{let _e=s.format==="NHWC",lt=_e?e[0].dims[3]:e[0].dims[1],at=i[0],it=_e?i[2]:i[3],ct=_e?i[1]:i[2],mt=_e?i[3]:i[1],pt=_e&&(lt%4===0||lt%3===0)&&mt%4===0,zt=_e?mt:it*ct,dt=_e?it*ct:mt,ft=[8,8,1],kt=c<=8?[4,1,1]:[4,4,1],St=[Math.ceil(zt/ft[0]/kt[0]),Math.ceil(dt/ft[1]/kt[1]),Math.ceil(at/ft[2]/kt[2])];se("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${St}`);let Lt=pt?_e&&lt%4!==0?3:4:1,Gt=ft[1]*kt[1],Bt=ft[0]*kt[0],nr=Math.max(ft[0]*Lt,ft[1]),cr=c%Gt===0,ur=d%Bt===0,yn=h%nr===0,hn=pt?[Lt,4,4]:[1,1,1],_n=[{type:6,data:c},{type:6,data:d},{type:6,data:h},{type:6,data:[s.pads[0],s.pads[1]]},{type:6,data:s.strides},{type:6,data:s.dilations}];qe(s,_n),_n.push(...N(e[0].dims,e[1].dims));let gn=["rank","rank"];_&&(_n.push(...N(e[2].dims)),gn.push("rank")),_n.push(...N(i));let vn=Tn=>{let kn=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"pad",type:"i32",length:2},{name:"stride",type:"i32",length:2},{name:"dilation",type:"i32",length:2}];je(s,kn);let bn=pt?4:1,Sn=be(e[0].dataType),fn=`
      fn setOutputAtIndex(flatIndex : i32, value : ${pt?`vec4<${Sn}>`:Sn}) {
        result[flatIndex] = ${pt?`vec4<${Sn}>`:Sn}(value);
      }
      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${pt?`vec4<${Sn}>`:Sn}) {
        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));
        setOutputAtIndex(flatIndex ${pt?"/ 4":""}, value);
      }`,or=P("x",e[0].dataType,e[0].dims.length,Lt===3?1:Lt),lr=P("w",e[1].dataType,e[1].dims.length,bn),pn=[or,lr],Cn=M("result",e[0].dataType,i.length,bn);if(_){let Lo=P("bias",e[2].dataType,e[2].dims.length,bn);pn.push(Lo),fn+=`
        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${pt?`vec4<${Sn}>`:Sn} {
          return bias[coords.${_e?"w":"y"}${pt?"/ 4":""}];
        }`}return`
        ${Du("uniforms.result_strides")}
        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,
        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,
        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };
        ${Tn.registerUniforms(kn).declareVariables(...pn,Cn)}
        ${fn}
        ${pf(_e,cr,ur,yn,_,s,hn[0],hn[1],hn[2],Sn)}
        ${pt?mo(kt,ft,Sn,void 0,!_e,nr):fo(kt,ft,Sn,void 0,!_e,nr,!1,void 0,g)}`};return{name:"Conv2DMatMul",shaderCache:{hint:`${s.cacheKey};${Lt};${pt};${cr};${ur};${yn};${Gt};${Bt};${nr}`,inputDependencies:gn},getRunData:()=>({outputs:[{dims:$?$(i):i,dataType:e[0].dataType}],dispatchGroup:{x:St[0],y:St[1],z:St[2]},programUniforms:_n}),getShaderSource:vn}}}),mf,Vu,Jr,ff,Wu,hf,Lu,Gu,Hu=U(()=>{ee(),Xe(),ne(),ie(),bt(),Zr(),mf=e=>{let s=1;for(let i=0;i<e.length;i++)s*=e[i];return s},Vu=e=>typeof e=="number"?[e,e,e]:e,Jr=(e,s)=>s<=1?e:e+(e-1)*(s-1),ff=(e,s,i,c=1)=>{let d=Jr(s,c);return Math.floor((e[0]*(i-1)-i+d)/2)},Wu=(e,s,i,c,d)=>{d==null&&(d=ff(e,s[0],c[0]));let h=[0,0,0,i];for(let _=0;_<3;_++)e[_]+2*d>=s[_]&&(h[_]=Math.trunc((e[_]-s[_]+2*d)/c[_]+1));return h},hf=(e,s,i,c,d,h,_,g,$,_e)=>{let lt,at,it,ct;if(e==="VALID"&&(e=0),typeof e=="number"){lt={top:e,bottom:e,left:e,right:e,front:e,back:e};let mt=Wu([s,i,c,1],[g,$,_e],1,[d,h,_],e);at=mt[0],it=mt[1],ct=mt[2]}else if(Array.isArray(e)){if(!e.every((pt,zt,dt)=>pt===dt[0]))throw Error(`Unsupported padding parameter: ${e}`);lt={top:e[0],bottom:e[1],left:e[2],right:e[3],front:e[4],back:e[5]};let mt=Wu([s,i,c,1],[g,$,_e],1,[d,h,_],e[0]);at=mt[0],it=mt[1],ct=mt[2]}else if(e==="SAME_UPPER"){at=Math.ceil(s/d),it=Math.ceil(i/h),ct=Math.ceil(c/_);let mt=(at-1)*d+g-s,pt=(it-1)*h+$-i,zt=(ct-1)*_+_e-c,dt=Math.floor(mt/2),ft=mt-dt,kt=Math.floor(pt/2),St=pt-kt,Lt=Math.floor(zt/2),Gt=zt-Lt;lt={top:kt,bottom:St,left:Lt,right:Gt,front:dt,back:ft}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:lt,outDepth:at,outHeight:it,outWidth:ct}},Lu=(e,s,i,c,d,h=!1,_="channelsLast")=>{let g,$,_e,lt,at;if(_==="channelsLast")[g,$,_e,lt,at]=e;else if(_==="channelsFirst")[g,at,$,_e,lt]=e;else throw new Error(`Unknown dataFormat ${_}`);let[it,,ct,mt,pt]=s,[zt,dt,ft]=Vu(i),[kt,St,Lt]=Vu(c),Gt=Jr(ct,kt),Bt=Jr(mt,St),nr=Jr(pt,Lt),{padInfo:cr,outDepth:ur,outHeight:yn,outWidth:hn}=hf(d,$,_e,lt,zt,dt,ft,Gt,Bt,nr),_n=h?it*at:it,gn=[0,0,0,0,0];return _==="channelsFirst"?gn=[g,_n,ur,yn,hn]:_==="channelsLast"&&(gn=[g,ur,yn,hn,_n]),{batchSize:g,dataFormat:_,inDepth:$,inHeight:_e,inWidth:lt,inChannels:at,outDepth:ur,outHeight:yn,outWidth:hn,outChannels:_n,padInfo:cr,strideDepth:zt,strideHeight:dt,strideWidth:ft,filterDepth:ct,filterHeight:mt,filterWidth:pt,effectiveFilterDepth:Gt,effectiveFilterHeight:Bt,effectiveFilterWidth:nr,dilationDepth:kt,dilationHeight:St,dilationWidth:Lt,inShape:e,outShape:gn,filterShape:s}},Gu=(e,s,i,c,d,h)=>{let _=h==="channelsLast";_?e[0].dims[3]:e[0].dims[1];let g=[64,1,1],$={x:i.map((zt,dt)=>dt)},_e=[Math.ceil(mf($.x.map(zt=>i[zt]))/g[0]),1,1];se("verbose",()=>`[conv3d_naive_webgpu] dispatch = ${_e}`);let lt=1,at=k.size(i),it=[{type:12,data:at},{type:12,data:c},{type:12,data:d},{type:12,data:s.strides},{type:12,data:s.dilations}];qe(s,it),it.push(...N(e[0].dims,e[1].dims));let ct=["rank","rank"],mt=e.length===3;mt&&(it.push(...N(e[2].dims)),ct.push("rank")),it.push(...N(i));let pt=zt=>{let dt=[{name:"output_size",type:"u32"},{name:"filter_dims",type:"u32",length:c.length},{name:"pads",type:"u32",length:d.length},{name:"strides",type:"u32",length:s.strides.length},{name:"dilations",type:"u32",length:s.dilations.length}];je(s,dt);let ft=1,kt=be(e[0].dataType),St=P("x",e[0].dataType,e[0].dims.length,lt),Lt=P("W",e[1].dataType,e[1].dims.length,ft),Gt=[St,Lt],Bt=M("result",e[0].dataType,i.length,ft),nr="";if(mt){let yn=P("bias",e[2].dataType,e[2].dims.length,ft);Gt.push(yn),nr+=`
        fn getBiasByOutputCoords(coords : array<u32, 5>) -> ${kt} {
          return bias[${_?F("coords",4,5):F("coords",1,5)}];
        }`}let cr=Ie(lt,kt),ur=Fe(s,cr,kt);return`
            ${nr}
            fn getX(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${St.getByIndices("aIndices")};
            }
            fn getW(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${Lt.getByIndices("aIndices")};
            }
          ${zt.registerUniforms(dt).declareVariables(...Gt,Bt)}
          ${zt.mainStart()}
          ${zt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
              let coords = ${Bt.offsetToIndices("global_idx")};
              let batch = ${F("coords",0,St.rank)};
              let d2 = ${_?F("coords",St.rank-1,St.rank):F("coords",1,St.rank)};
              let xFRCCorner = vec3<u32>(${_?F("coords",1,St.rank):F("coords",2,St.rank)},
              ${_?F("coords",2,St.rank):F("coords",3,St.rank)},
              ${_?F("coords",3,St.rank):F("coords",4,St.rank)}) * uniforms.strides - uniforms.pads;
              let xFCorner = xFRCCorner.x;
              let xRCorner = xFRCCorner.y;
              let xCCorner = xFRCCorner.z;
              let xShapeY = ${_?F("uniforms.x_shape",1,St.rank):F("uniforms.x_shape",2,St.rank)};
              let xShapeZ = ${_?F("uniforms.x_shape",2,St.rank):F("uniforms.x_shape",3,St.rank)};
              let xShapeW = ${_?F("uniforms.x_shape",3,St.rank):F("uniforms.x_shape",4,St.rank)};
              let xShapeU = ${_?F("uniforms.x_shape",4,St.rank):F("uniforms.x_shape",1,St.rank)};
              let inputDepthNearestVec4 = (xShapeU / 4) * 4;
              let inputDepthVec4Remainder = xShapeU % 4;

              var value = 0.0;
              for (var wF = 0u; wF < uniforms.filter_dims[0]; wF++) {
                let xF = xFCorner + wF * uniforms.dilations[0];
                if (xF < 0 || xF >= xShapeY) {
                  continue;
                }

                for (var wR = 0u; wR < uniforms.filter_dims[1]; wR++) {
                  let xR = xRCorner + wR * uniforms.dilations[1];
                  if (xR < 0 || xR >= xShapeZ) {
                    continue;
                  }

                  for (var wC = 0u; wC < uniforms.filter_dims[2]; wC++) {
                    let xC = xCCorner + wC * uniforms.dilations[2];
                    if (xC < 0 || xC >= xShapeW) {
                      continue;
                    }

                    for (var d1 = 0u; d1 < inputDepthNearestVec4; d1 += 4) {
                      ${_?`let xValues = vec4<f32>(
                               getX(batch, xF, xR, xC, d1),
                               getX(batch, xF, xR, xC, d1 + 1),
                               getX(batch, xF, xR, xC, d1 + 2),
                               getX(batch, xF, xR, xC, d1 + 3));
                            `:`let xValues = vec4<f32>(
                               getX(batch, d1, xF, xR, xC),
                               getX(batch, d1 + 1, xF, xR, xC),
                               getX(batch, d1 + 2, xF, xR, xC),
                               getX(batch, d1 + 3, xF, xR, xC));
                            `}
                            let wValues = vec4<f32>(
                              getW(d2, d1, wF, wR, wC),
                              getW(d2, d1 + 1, wF, wR, wC),
                              getW(d2, d1 + 2, wF, wR, wC),
                              getW(d2, d1 + 3, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                    if (inputDepthVec4Remainder == 1) {
                        ${_?`value += getX(batch, xF, xR, xC, inputDepthNearestVec4)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`:`value += getX(batch, inputDepthNearestVec4, xF, xR, xC)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`}
                    } else if (inputDepthVec4Remainder == 2) {
                      ${_?`let xValues = vec2<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1));
                      `:`let xValues = vec2<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC));
                    `}
                    let wValues = vec2<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC));
                      value += dot(xValues, wValues);
                    } else if (inputDepthVec4Remainder == 3) {
                      ${_?`let xValues = vec3<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2));
                      `:`let xValues = vec3<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 2, xF, xR, xC));
                    `}
                    let wValues = vec3<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 2, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                  }
                }
              }
              ${mt?"value = value + getBiasByOutputCoords(coords)":""};
              ${ur}
              result[global_idx] = f32(value);
          }`};return{name:"Conv3DNaive",shaderCache:{hint:`${s.cacheKey};${_};${lt};${mt}`,inputDependencies:ct},getRunData:()=>({outputs:[{dims:i,dataType:e[0].dataType}],dispatchGroup:{x:_e[0],y:_e[1],z:_e[2]},programUniforms:it}),getShaderSource:pt}}}),Fu,qu,ju=U(()=>{ee(),ne(),ie(),bt(),Fu=(e,s,i,c)=>{let d=e.length>2,h=d?"value += b[output_channel];":"",_=e[0].dims,g=e[1].dims,$=s.format==="NHWC",_e=$?i[3]:i[1],lt=_e/s.group,at=$&&lt>=4?ce(_e):1,it=k.size(i)/at,ct=[{type:12,data:it},{type:12,data:s.dilations},{type:12,data:[s.strides[0],s.strides[1]]},{type:12,data:[s.pads[0],s.pads[1]]},{type:12,data:lt}];qe(s,ct),ct.push(...N(_,[g[0],g[1],g[2],g[3]/at]));let mt=d?["rank","rank","rank"]:["rank","rank"];ct.push(...N([i[0],i[1],i[2],i[3]/at]));let pt=zt=>{let dt=M("output",e[0].dataType,i.length,at),ft=be(dt.type.tensor),kt=Fe(s,dt.type.value,ft),St=P("x",e[0].dataType,_.length),Lt=P("w",e[1].dataType,g.length,at),Gt=[St,Lt];d&&Gt.push(P("b",e[2].dataType,e[2].dims,at));let Bt=[{name:"output_size",type:"u32"},{name:"dilations",type:"u32",length:s.dilations.length},{name:"strides",type:"u32",length:2},{name:"pads",type:"u32",length:2},{name:"output_channels_per_group",type:"u32"}];je(s,Bt);let nr=$?`
      for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[0]; wHeight++) {
        let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

        if (xHeight < 0u || xHeight >= uniforms.x_shape[1]) {
          continue;
        }

        for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[1]; wWidth++) {
          let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
          if (xWidth < 0u || xWidth >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[2]; wInChannel++) {
            let input_channel = in_channel_offset + wInChannel;
            let xVal = ${St.get("batch","xHeight","xWidth","input_channel")};
            let wVal = ${Lt.get("wHeight","wWidth","wInChannel","output_channel")};
            value += xVal * wVal;
          }
        }
      }
      `:`
      for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[1]; wInChannel++) {
        let input_channel = in_channel_offset + wInChannel;
        for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[2]; wHeight++) {
          let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

          if (xHeight < 0u || xHeight >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[3]; wWidth++) {
            let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
            if (xWidth < 0u || xWidth >= uniforms.x_shape[3]) {
              continue;
            }

            let xVal = ${St.get("batch","input_channel","xHeight","xWidth")};
            let wVal = ${Lt.get("output_channel","wInChannel","wHeight","wWidth")};
            value += xVal * wVal;
          }
        }
      }
      `;return`
  ${zt.registerUniforms(Bt).declareVariables(...Gt,dt)}

  ${zt.mainStart()}
    ${zt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let outputIndices = ${dt.offsetToIndices("global_idx")};
    let batch: u32 = outputIndices[0];
    let output_channel: u32 = outputIndices[${$?3:1}];
    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${$?1:2}], outputIndices[${$?2:3}]) * uniforms.strides - uniforms.pads;
    let group_id: u32 = output_channel * ${at} / uniforms.output_channels_per_group;
    var in_channel_offset = group_id * uniforms.w_shape[${$?2:1}];

    var value: ${dt.type.value} = ${dt.type.value}(0);
    ${nr}
    ${h}
    ${kt}
    ${dt.setByOffset("global_idx","value")}
  }`};return{name:"GroupedConv",shaderCache:{hint:`${s.cacheKey}_${at}`,inputDependencies:mt},getRunData:()=>({outputs:[{dims:c?c(i):i,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(it/64)},programUniforms:ct}),getShaderSource:pt}},qu=(e,s,i,c)=>{let d=e.length>2,h=ce(i[3]),_=ce(i[2]),g=k.size(i)/h/_,$=[e[0].dims[0],e[0].dims[1],e[0].dims[2],e[0].dims[3]/h],_e=[e[1].dims[0],e[1].dims[1],e[1].dims[2],e[1].dims[3]/h],lt=[i[0],i[1],i[2],i[3]/h],at=[{type:12,data:g},{type:6,data:[s.strides[0],s.strides[1]]},{type:6,data:[s.pads[0],s.pads[1]]}];qe(s,at),at.push(...N($,_e,lt));let it=(_-1)*s.strides[1]+_e[1],ct=mt=>{let pt=M("output",e[0].dataType,lt.length,h),zt=be(pt.type.tensor),dt=Fe(s,pt.type.value,zt),ft=P("x",e[0].dataType,$.length,h),kt=P("w",e[1].dataType,_e.length,h),St=[ft,kt];d&&St.push(P("b",e[2].dataType,e[2].dims,h));let Lt=d?"value += b[output_channel];":"",Gt=[{name:"output_size",type:"u32"},{name:"strides",type:"i32",length:2},{name:"pads",type:"i32",length:2}];return je(s,Gt),`
  ${mt.registerUniforms(Gt).declareVariables(...St,pt)}
  ${mt.mainStart()}
    ${mt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let width0 = uniforms.output_shape[3];
    let output_channel = global_idx % width0;
    var index1 = global_idx / width0;
    let width1 = uniforms.output_shape[2] / ${_}u;
    let col = (index1 % width1) * ${_}u;
    index1 = index1 / width1;
    let row = index1 % uniforms.output_shape[1];
    let batch = index1 / uniforms.output_shape[1];

    let x_corner = vec2<i32>(i32(row), i32(col)) * uniforms.strides - uniforms.pads;

    var x_vals: array<${ft.type.value}, ${it}>;
    var values: array<${pt.type.value}, ${_}>;
    let input_channel = output_channel;
    // Use constant instead of uniform can give better performance for w's height/width.
    for (var w_height: u32 = 0u; w_height < ${_e[0]}; w_height++) {
      let x_height = x_corner.x + i32(w_height);
      if (x_height >= 0 && u32(x_height) < uniforms.x_shape[1]) {
        for (var i = 0; i < ${it}; i++) {
          let x_width = x_corner.y + i;
          if (x_width >= 0 && u32(x_width) < uniforms.x_shape[2]) {
            x_vals[i] = ${ft.get("batch","u32(x_height)","u32(x_width)","input_channel")};
          } else {
            x_vals[i] = ${ft.type.value}(0);
          }
        }
        for (var w_width: u32 = 0u; w_width < ${_e[1]}; w_width++) {
          let w_val = ${kt.get("w_height","w_width","0","output_channel")};
          for (var i = 0u; i < ${_}u; i++) {
            values[i] = fma(x_vals[i * u32(uniforms.strides[1]) + w_width], w_val, values[i]);
          }
        }
      }
    }

    for (var i = 0u; i < ${_}u; i++) {
      var value = values[i];
      ${Lt}
      ${dt}
      ${pt.set("batch","row","col + i","output_channel","value")};
    }
  }`};return{name:"GroupedConv-Vectorize",shaderCache:{hint:`${s.cacheKey};${h};${_};${it};${_e[0]};${_e[1]}`,inputDependencies:d?["rank","rank","type"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:c?c(i):i,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(g/64)},programUniforms:at}),getShaderSource:ct}}}),gf,ho,bf,go,bo,Ku,yf,_f,yo,Zu=U(()=>{ne(),Nu(),Hu(),Xr(),ju(),bt(),Yr(),st(),gf=(e,s,i,c,d,h)=>{let _=e[0],g=e.slice(h?1:2,h?3:4),$=g.length,_e=s[0],lt=s.slice(2).map((it,ct)=>it+(it-1)*(i[ct]-1)),at=g.map((it,ct)=>it+c[ct]+c[ct+$]).map((it,ct)=>Math.floor((it-lt[ct]+d[ct])/d[ct]));return at.splice(0,0,_),at.splice(h?3:1,0,_e),at},ho=[2,3,1,0],bf=(e,s)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length>5)throw new Error("greater than 5D is not supported");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let i=e[0].dims[s.format==="NHWC"?e[0].dims.length-1:1],c=e[1].dims[1]*s.group;if(i!==c)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(e.length===3&&(e[2].dims.length!==1||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let d=e[0].dims.length-2;if(s.dilations.length!==d)throw new Error(`dilations should be ${d}D`);if(s.strides.length!==d)throw new Error(`strides should be ${d}D`);if(s.pads.length!==d*2)throw new Error(`pads should be ${d*2}D`);if(s.kernelShape.length!==0&&s.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape")},go=(e,s)=>{let i=e.kernelShape.slice();i.length<s[1].dims.length-2&&i.push(...Array(s[1].dims.length-2-i.length).fill(0));for(let h=2;h<s[1].dims.length;++h)i[h-2]===0&&(i[h-2]=s[1].dims[h]);let c=e.pads.slice();Tt.adjustPadsBasedOnAutoPad(s[0].dims,e.strides,e.dilations,i,c,e.format==="NHWC",e.autoPad);let d=Object.assign({},e);return Object.assign(d,{kernelShape:i,pads:c}),d},bo=e=>{let s=Kr(e),i=e.format,c=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],d=e.dilations,h=e.group,_=e.kernel_shape,g=e.pads,$=e.strides,_e=e.w_is_const();return{autoPad:c,format:i,dilations:d,group:h,kernelShape:_,pads:g,strides:$,wIsConst:_e,...s,cacheKey:`${e.format};${s.activation};`}},Ku=(e,s,i,c)=>{let d=i.format==="NHWC",h=gf(s[0].dims,s[1].dims,i.dilations,i.pads,i.strides,d);if(i.group!==1){let Gt=[s[0]];if(d){let Bt=e.kernelCustomData.wT??e.compute(Ee(s[1],ho),{inputs:[1],outputs:[i.wIsConst?-2:-1]})[0];i.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=Bt),Gt.push(Bt)}else Gt.push(s[1]);s.length===3&&Gt.push(s[2]),!e.adapterInfo.isArchitecture("ampere")&&d&&s[1].dims[0]===i.group&&s[1].dims[1]===1&&i.dilations[0]===1&&i.dilations[1]===1?e.compute(qu(Gt,i,h,c),{inputs:Gt}):e.compute(Fu(Gt,i,h,c),{inputs:Gt});return}let _=s.length===3,g=s[0].dims[d?1:2],$=s[0].dims[d?2:3],_e=s[0].dims[d?3:1],lt=s[1].dims[2],at=s[1].dims[3],it=h[d?1:2],ct=h[d?2:3],mt=h[d?3:1],pt=d&&lt===g&&at===$&&i.pads[0]===0&&i.pads[1]===0;if(pt||lt===1&&at===1&&i.dilations[0]===1&&i.dilations[1]===1&&i.strides[0]===1&&i.strides[1]===1&&i.pads[0]===0&&i.pads[1]===0){let Gt=h[0],Bt,nr,cr,ur=[];if(d){let _n=e.kernelCustomData.wT??e.compute(Ee(s[1],ho),{inputs:[1],outputs:[i.wIsConst?-2:-1]})[0];if(i.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=_n),pt){let gn=g*$*_e;Bt=s[0].reshape([1,Gt,gn]),nr=_n.reshape([1,gn,mt]),cr=[1,Gt,mt]}else Bt=s[0].reshape([Gt,g*$,_e]),nr=_n.reshape([1,_e,mt]),cr=[Gt,it*ct,mt];ur.push(Bt),ur.push(nr)}else Bt=s[0].reshape([Gt,_e,g*$]),nr=s[1].reshape([1,mt,_e]),cr=[Gt,mt,it*ct],ur.push(nr),ur.push(Bt);_&&ur.push(s[2]);let yn=cr[2],hn=ur[0].dims[ur[0].dims.length-1];yn<8&&hn<8?e.compute(Qr(ur,i,h,cr,d,c),{inputs:ur}):e.compute(Jt(ur,i,h,cr,d,c),{inputs:ur});return}let zt=!0,dt=e.kernelCustomData.wT??e.compute(Ee(s[1],ho),{inputs:[1],outputs:[i.wIsConst?-2:-1]})[0];i.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=dt);let ft=[s[0],dt];_&&ft.push(s[2]);let kt=d?it*ct:mt,St=d?mt:it*ct,Lt=lt*at*_e;e.compute(Uu(ft,i,h,kt,St,Lt,_,zt,c),{inputs:ft})},yf=(e,s)=>{let i=s.format==="NHWC",c=[e.inputs[0].reshape(i?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&c.push(e.inputs[2]);let d=[0,s.pads[0],0,s.pads[1]],h=[1].concat(s.strides),_=[1].concat(s.dilations),g=[1].concat(s.kernelShape),$=go({...s,pads:d,strides:h,dilations:_,kernelShape:g},c);Ku(e,c,$,_e=>i?[_e[0],_e[2],_e[3]]:[_e[0],_e[1],_e[3]])},_f=(e,s,i)=>{let c=i.format==="NHWC"?"channelsLast":"channelsFirst",d=go(i,s),h=i.autoPad==="NOTSET"?i.pads:i.autoPad,_=Lu(s[0].dims,s[1].dims,i.strides,i.dilations,h,!1,c);e.compute(Gu(s,d,_.outShape,[_.filterDepth,_.filterHeight,_.filterWidth],[_.padInfo.front,_.padInfo.top,_.padInfo.left],c))},yo=(e,s)=>{if(bf(e.inputs,s),e.inputs[0].dims.length===3)yf(e,s);else if(e.inputs[0].dims.length===5)_f(e,e.inputs,s);else{let i=go(s,e.inputs);Ku(e,e.inputs,i)}}}),Qu,Yu=U(()=>{ee(),Xe(),ne(),ie(),Qu=(e,s,i)=>{let c=e.length>2,d=s.outputShape,h=s.format==="NHWC",_=s.group,g=e[1].dims,$=g[2]/_,_e=g[3],lt=h?ce($):1,at=h&&_e===1&&$>=4,it=at?Math.floor($/4)*4:Math.floor($/lt)*lt,ct=$-it,mt=h?ce(_e):1,pt=h?_e===1?lt:mt:1,zt=k.size(d)/mt,dt=[Math.ceil(zt/64),1,1];se("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${dt}`);let ft=["rank","rank"],kt=[s.strides[0],s.strides[1]],St=[s.kernelShape[h?1:2],s.kernelShape[h?2:3]],Lt=[s.dilations[0],s.dilations[1]],Gt=[St[0]+(s.dilations[0]<=1?0:(s.kernelShape[h?1:2]-1)*(s.dilations[0]-1)),St[1]+(s.dilations[1]<=1?0:(s.kernelShape[h?2:3]-1)*(s.dilations[1]-1))],Bt=[Gt[0]-1-Math.floor((s.pads[0]+s.pads[2])/2),Gt[1]-1-Math.floor((s.pads[1]+s.pads[3])/2)],nr=[{type:12,data:zt},{type:12,data:kt},{type:12,data:St},{type:12,data:Lt},{type:12,data:Gt},{type:6,data:Bt},{type:12,data:it},{type:12,data:$},{type:12,data:_e},...N(e[0].dims,e[1].dims)];c&&(nr.push(...N(e[2].dims)),ft.push("rank")),nr.push(...N(d));let cr=ur=>{let yn=[{name:"output_size",type:"u32"},{name:"strides",type:"u32",length:kt.length},{name:"filter_dims",type:"u32",length:St.length},{name:"dilations",type:"u32",length:St.length},{name:"effective_filter_dims",type:"u32",length:Gt.length},{name:"pads",type:"i32",length:Bt.length},{name:"input_channels_per_group_int",type:"u32"},{name:"input_channels_per_group",type:"u32"},{name:"output_channels_per_group",type:"u32"}],hn=be(e[0].dataType),_n=h?1:2,gn=h?2:3,vn=h?3:1,Tn=P("W",e[1].dataType,e[1].dims.length,pt),kn=P("Dy",e[0].dataType,e[0].dims.length,lt),bn=[kn,Tn];c&&bn.push(P("bias",e[2].dataType,[d[vn]].length,mt));let Sn=M("result",e[0].dataType,d.length,mt),fn=()=>{let pn="";if(at)lt===4?pn+=`
        let xValue = ${kn.getByOffset("x_offset")};
        let wValue = ${Tn.getByOffset("w_offset")};
        dotProd = dotProd + dot(xValue, wValue);
        x_offset += 1u;
        w_offset += 1u;`:lt===2?pn+=`
          dotProd = dotProd + dot(vec4<${hn}>(${kn.getByOffset("x_offset")}, ${kn.getByOffset("x_offset + 1u")}), vec4<${hn}>(${Tn.getByOffset("w_offset")}, ${Tn.getByOffset("w_offset + 1u")}));
          x_offset += 2u;
          w_offset += 2u;`:lt===1&&(pn+=`
          dotProd = dotProd + dot(vec4<${hn}>(${kn.getByOffset("x_offset")}, ${kn.getByOffset("x_offset + 1u")}, ${kn.getByOffset("x_offset + 2u")}, ${kn.getByOffset("x_offset + 3u")}), vec4<${hn}>(${Tn.getByOffset("w_offset")}, ${Tn.getByOffset("w_offset + 1u")}, ${Tn.getByOffset("w_offset + 2u")}, ${Tn.getByOffset("w_offset + 3u")}));
          x_offset += 4u;
          w_offset += 4u;`);else if(pn+=`
                  let xValue = ${h?kn.getByOffset(`${kn.indicesToOffset(`${kn.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${lt}`):kn.get("batch","inputChannel","idyR","idyC")};
        `,lt===1)pn+=`
          let w_offset = ${Tn.indicesToOffset(`${Tn.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel, wOutChannel)`)};
          let wValue = ${Tn.getByOffset(`w_offset / ${pt}`)};
          dotProd = dotProd + xValue * wValue;`;else for(let Cn=0;Cn<lt;Cn++)pn+=`
            let wValue${Cn} = ${Tn.getByOffset(`${Tn.indicesToOffset(`${Tn.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel + ${Cn}, wOutChannel)`)} / ${pt}`)};
            dotProd = dotProd + xValue[${Cn}] * wValue${Cn};`;return pn},or=()=>{if(ct===0)return"";if(!at)throw new Error(`packInputAs4 ${at} is not true.`);let pn="";if(lt===1){pn+="dotProd = dotProd";for(let Cn=0;Cn<ct;Cn++)pn+=`
            + ${kn.getByOffset(`x_offset + ${Cn}`)} * ${Tn.getByOffset(`w_offset + ${Cn}`)}`;pn+=";"}else if(lt===2){if(ct!==2)throw new Error(`Invalid inputChannelsRemainder ${ct}.`);pn+=`
          let xValue = ${kn.getByOffset("x_offset")};
          let wValue = ${Tn.getByOffset("w_offset")};
          dotProd = dotProd + dot(xValue, wValue);`}return pn},lr=`
            let outputIndices = ${Sn.offsetToIndices(`global_idx * ${mt}`)};
            let batch = ${Sn.indicesGet("outputIndices",0)};
            let d1 = ${Sn.indicesGet("outputIndices",vn)};
            let r = ${Sn.indicesGet("outputIndices",_n)};
            let c = ${Sn.indicesGet("outputIndices",gn)};
            let dyCorner = vec2<i32>(i32(r), i32(c)) - uniforms.pads;
            let dyRCorner = dyCorner.x;
            let dyCCorner = dyCorner.y;
            let groupId = d1 / uniforms.output_channels_per_group;
            let wOutChannel = d1 - groupId * uniforms.output_channels_per_group;
            // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
            // ? = to be determined. : = across all values in that axis.
            var dotProd = ${Sn.type.value}(0.0);
            var wR: u32 = 0;
            if (uniforms.dilations.x == 1) {
              // Minimum wR >= 0 that satisfies (dyRCorner + wR) % (uniforms.strides.x) == 0
              wR = u32(((dyRCorner + i32(uniforms.strides.x) - 1) / i32(uniforms.strides.x)) * i32(uniforms.strides.x) - dyRCorner);
            }
            for (; wR < uniforms.effective_filter_dims.x; wR = wR + 1) {
              if (wR % uniforms.dilations.x != 0) {
                continue;
              }
              let dyR = (${hn}(dyRCorner) + ${hn}(wR)) / ${hn}(uniforms.strides[0]);
              let wRPerm = uniforms.filter_dims.x - 1 - wR / uniforms.dilations.x;
              if (dyR < 0.0 || dyR >= ${hn}(uniforms.Dy_shape[${_n}]) || fract(dyR) > 0.0 ||
                  wRPerm < 0) {
                continue;
              }
              let idyR: u32 = u32(dyR);
              var wC: u32 = 0;
              if (uniforms.dilations.y == 1) {
                // Minimum wC >= 0 that satisfies (dyCCorner + wC) % (uniforms.strides.y) == 0
                wC = u32(((dyCCorner + i32(uniforms.strides.y) - 1) / i32(uniforms.strides.y)) * i32(uniforms.strides.y) - dyCCorner);
              }
              for (; wC < uniforms.effective_filter_dims.y; wC = wC + 1) {
                if (wC % uniforms.dilations.y != 0) {
                  continue;
                }
                let dyC = (${hn}(dyCCorner) + ${hn}(wC)) / ${hn}(uniforms.strides.y);
                let wCPerm = uniforms.filter_dims.y - 1 - wC / uniforms.dilations.y;
                if (dyC < 0.0 || dyC >= ${hn}(uniforms.Dy_shape[${gn}]) ||
                    fract(dyC) > 0.0 || wCPerm < 0) {
                  continue;
                }
                let idyC: u32 = u32(dyC);
                var inputChannel = groupId * uniforms.input_channels_per_group;
                ${at?`
                var x_offset = ${kn.indicesToOffset(`${kn.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${lt};
                var w_offset = ${Tn.indicesToOffset(`${Tn.type.indices}(wRPerm, wCPerm, inputChannel, wOutChannel)`)} / ${pt};
                  `:""}
                for (var d2: u32 = 0; d2 < uniforms.input_channels_per_group_int; d2 = d2 + ${at?4:lt}) {
                  ${fn()}
                  inputChannel = inputChannel + ${at?4:lt};
                }
                ${or()}
                wC = wC + uniforms.strides.y - 1;
              }
              wR = wR + uniforms.strides[0] - 1;
            }
            let value = dotProd${c?` + bias[d1 / ${mt}]`:""};
            ${Sn.setByOffset("global_idx","value")};
          `;return`
    ${ur.registerUniforms(yn).declareVariables(...bn,Sn)}
      ${ur.mainStart()}
      ${ur.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")};
    ${lr}}`};return{name:"ConvTranspose2D",shaderCache:{hint:`${s.cacheKey};${lt}${pt}${mt}${at}${ct}`,inputDependencies:ft},getRunData:()=>({dispatchGroup:{x:dt[0],y:dt[1],z:dt[2]},outputs:[{dims:i?i(d):d,dataType:e[0].dataType}],programUniforms:nr}),getShaderSource:cr}}}),wf,vf,$f,Xu,Ju,xf,ed,Sf,td,rd=U(()=>{Yu(),bt(),st(),wf=(e,s,i,c,d,h)=>(e-1)*s+i+(c-1)*d+1-h,vf=(e,s,i,c,d)=>{let h=Math.floor(e/2);s==="SAME_UPPER"?(i[c]=h,i[d]=e-h):s==="SAME_LOWER"&&(i[c]=e-h,i[d]=h)},$f=(e,s,i,c,d,h,_,g,$,_e)=>{let lt=e.length-2,at=_e.length===0;$.length<lt&&$.push(...Array(lt-$.length).fill(0));let it=e[0],ct=s[g?3:1]*d;for(let mt=0,pt=e.length-lt-(g?1:0);mt<lt;++mt,++pt){let zt=e[pt],dt=at?zt*_[mt]:_e[mt],ft=wf(zt,_[mt],h[mt],s[pt],i[mt],dt);vf(ft,c,h,mt,mt+lt),at&&_e.push(_[mt]*(zt-1)+$[mt]+(s[pt]-1)*i[mt]+1-h[mt]-h[mt+lt])}_e.splice(0,0,it),_e.splice(g?3:1,0,ct)},Xu=(e,s)=>{let i=e.kernelShape.slice();if(e.kernelShape.length===0||e.kernelShape.reduce((at,it)=>at*it,1)===0){i.length=0;for(let at=2;at<s[1].dims.length;++at)i.push(s[1].dims[at])}let c=e.format==="NHWC";i.splice(0,0,s[1].dims[0]),i.splice(c?3:1,0,s[1].dims[1]);let d=e.pads.slice(),h=e.outputShape.slice(),_=e.outputPadding.slice(),g=s[0].dims,$=e.dilations.slice();if($.reduce((at,it)=>at+it,0)===0){let at=s[0].dims.length-2;$=new Array(at).fill(1)}let _e=e.strides.slice();if(_e.reduce((at,it)=>at+it,0)===0){let at=s[0].dims.length-2;_e=new Array(at).fill(1)}$f(g,i,$,e.autoPad,e.group,d,_e,c,_,h);let lt=Object.assign({},e);return Object.assign(lt,{kernelShape:i,pads:d,outputPadding:_,outputShape:h,dilations:$,strides:_e}),lt},Ju=e=>{let s=Kr(e),i=e.format,c=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof e.autoPad>"u"?0:e.autoPad],d=e.dilations,h=e.group,_=e.kernelShape,g=e.pads,$=e.strides,_e=e.wIsConst(),lt=e.outputPadding,at=e.outputShape;return{autoPad:c,format:i,dilations:d,group:h,kernelShape:_,outputPadding:lt,outputShape:at,pads:g,strides:$,wIsConst:_e,...s,cacheKey:`${e.format};${s.activation};`}},xf=(e,s)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let i=e[0].dims[s.format==="NHWC"?e[0].dims.length-1:1],c=e[1].dims[0];if(i!==c)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let d=e[1].dims[1]*s.group;if(e.length===3&&(e[2].dims.length!==1||e[2].dims[0]!==d))throw new Error("invalid bias");let h=e[0].dims.length-2;if(s.dilations.reduce((_,g)=>_+g,0)>0&&s.dilations.length!==h)throw new Error(`dilations should be ${h}D`);if(s.strides.reduce((_,g)=>_+g,0)>0&&s.strides.length!==h)throw new Error(`strides should be ${h}D`);if(s.pads.reduce((_,g)=>_+g,0)>0&&s.pads.length!==h*2)throw new Error(`pads should be ${h*2}D`);if(s.outputPadding.length!==h&&s.outputPadding.length!==0)throw new Error(`output_padding should be ${h}D`);if(s.kernelShape.reduce((_,g)=>_+g,0)>0&&s.kernelShape.length!==0&&s.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(s.outputShape.length!==0&&s.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape")},ed=(e,s,i,c)=>{let d=e.kernelCustomData.wT??e.compute(Ee(s[1],[2,3,0,1]),{inputs:[1],outputs:[i.wIsConst?-2:-1]})[0];i.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=d);let h=[s[0],d];s.length===3&&h.push(s[2]),e.compute(Qu(h,i,c),{inputs:h})},Sf=(e,s)=>{let i=s.format==="NHWC",c=[e.inputs[0].reshape(i?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&c.push(e.inputs[2]);let d=s.kernelShape;(d.length===0||d[0]===0)&&(d=[e.inputs[1].dims[2]]);let h=s.dilations;(h.length===0||h[0]===0)&&(h=[1]);let _=s.strides;(_.length===0||_[0]===0)&&(_=[1]);let g=s.pads;g.length===0&&(g=[0,0]),g=[0,g[0],0,g[1]],_=[1].concat(_),h=[1].concat(h),d=[1].concat(d);let $=s.outputPadding;$=[0].concat($);let _e=Xu({...s,pads:g,strides:_,dilations:h,kernelShape:d,outputPadding:$},c);ed(e,c,_e,lt=>i?[lt[0],lt[2],lt[3]]:[lt[0],lt[1],lt[3]])},td=(e,s)=>{if(xf(e.inputs,s),e.inputs[0].dims.length===3)Sf(e,s);else{let i=Xu(s,e.inputs);ed(e,e.inputs,i)}}}),Tf,nd,od,id=U(()=>{ee(),ne(),Se(),ie(),Tf=(e,s,i,c)=>{let d=k.size(s),h=s.length,_=P("input",e,h),g=M("output",e,h),$=i.dataType===6?i.getInt32Array()[0]:Number(i.getBigInt64Array()[0]),_e=k.normalizeAxis($,h),lt=at=>{let it=` i32(${_.indicesGet("inputIndices","uniforms.axis")}) `,ct=F("uniforms.input_shape","uniforms.axis",h),mt=c.reverse?it+(c.exclusive?" + 1":""):"0",pt=c.reverse?ct:it+(c.exclusive?"":" + 1");return`
                ${at.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(_,g)}
                ${at.mainStart()}
                  ${at.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
                  var inputIndices = ${g.offsetToIndices("global_idx")};
                  var sum = ${g.type.value}(0);
                  let first : i32 = ${mt};
                  let last : i32 = ${pt};
                  for (var i : i32 = first; i < last; i++) {
                    ${_.indicesSet("inputIndices","uniforms.axis","u32(i)")};
                    sum = sum + ${_.getByIndices("inputIndices")};
                  }
                  ${g.setByOffset("global_idx","sum")};
                }`};return{name:"CumSum",shaderCache:{hint:c.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:s,dataType:e}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:[{type:12,data:d},{type:12,data:_e},...N(s,s)]}),getShaderSource:lt}},nd=(e,s)=>{let i=e.inputs[0].dims,c=e.inputs[0].dataType,d=e.inputs[1];e.compute(Tf(c,i,d,s),{inputs:[0]})},od=e=>{let s=e.exclusive===1,i=e.reverse===1;return J({exclusive:s,reverse:i})}}),If,Cf,Af,ad,sd,ud=U(()=>{ee(),ne(),Se(),ie(),If=e=>{if(!e||e.length!==1)throw new Error("DepthToSpace requires 1 input.");if(e[0].dims.length!==4)throw new Error("DepthToSpace requires 4D input.")},Cf=(e,s,i,c)=>{let d=[];d.push(`fn perm(i: ${c.type.indices}) -> ${i.type.indices} {
    var a: ${i.type.indices};`);for(let h=0;h<s;++h)d.push(i.indicesSet("a",e[h],`i[${h}]`));return d.push("return a;}"),d.join(`
`)},Af=(e,s)=>{let i,c,d,h,_,g,$=s.format==="NHWC",_e=s.blocksize,lt=s.mode==="DCR";$?([i,c,d,h]=e.dims,_=lt?[i,c,d,_e,_e,h/_e**2]:[i,c,d,h/_e**2,_e,_e],g=lt?[0,1,3,2,4,5]:[0,1,4,2,5,3]):([i,c,d,h]=[e.dims[0],e.dims[2],e.dims[3],e.dims[1]],_=lt?[i,_e,_e,h/_e**2,c,d]:[i,h/_e**2,_e,_e,c,d],g=lt?[0,3,4,1,5,2]:[0,1,4,2,5,3]);let at=e.reshape(_),it=at.dims.length,ct=e.dataType,mt=P("a",ct,it),pt=M("output",ct,it),zt=dt=>`
  ${dt.registerUniform("output_size","u32").declareVariables(mt,pt)}

  ${Cf(g,it,mt,pt)}

  ${dt.mainStart()}
    ${dt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${pt.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${pt.setByOffset("global_idx",mt.getByIndices("aIndices"))}
  }`;return{name:"DepthToSpace",shaderCache:{hint:`${e.dims};${s.blocksize};${s.mode}`,inputDependencies:["rank"]},getRunData:dt=>{let ft=$?[i,c*_e,d*_e,h/_e**2]:[i,h/_e**2,c*_e,d*_e],kt=k.size(ft),St=at.dims,Lt=k.sortBasedOnPerm(St,g);return{outputs:[{dims:ft,dataType:dt[0].dataType}],dispatchGroup:{x:Math.ceil(kt/64)},programUniforms:[{type:12,data:kt},...N(St,Lt)]}},getShaderSource:zt}},ad=(e,s)=>{If(e.inputs),e.compute(Af(e.inputs[0],s))},sd=e=>J({blocksize:e.blocksize,mode:e.mode,format:e.format})}),_o,en,dd,Ef,kf,wo,vo,ld,Pf,cd,pd,md=U(()=>{ee(),ne(),Se(),ie(),_o="[a-zA-Z]|\\.\\.\\.",en="("+_o+")+",dd="^"+en+"$",Ef="("+en+",)*"+en,kf="^"+Ef+"$",wo=class{constructor(e=-1){this.symbolToIndices=new Map,this.inputIndex=e}addSymbol(e,s){let i=this.symbolToIndices.get(e);i===void 0?i=[s]:i.push(s),this.symbolToIndices.set(e,i)}},vo=class{constructor(e,s){var d;this.equation=s,this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[i,c]=s.includes("->")?s.split("->",2):[s,""];if(!i.match(RegExp(kf)))throw new Error("Invalid LHS term");if(i.split(",").forEach((h,_)=>{let g=e[_].dims.slice();if(!h.match(RegExp(dd)))throw new Error("Invalid LHS term");let $=this.processTerm(h,!0,g,_);this.lhs.push($)}),c==="")c+=[...this.symbolToInfo.entries()].filter(([h,_])=>_.count===1||h==="...").map(([h])=>h).join("");else if(!c.match(RegExp(en)))throw new Error("Invalid RHS");(d=c.match(RegExp(_o,"g")))==null||d.forEach(h=>{if(h==="...")this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let _=this.symbolToInfo.get(h);if(_===void 0)throw new Error("Invalid RHS symbol");this.outputDims.push(_.dimValue)}}),this.rhs=this.processTerm(c,!1,this.outputDims)}addSymbol(e,s,i){let c=this.symbolToInfo.get(e);if(c!==void 0){if(c.dimValue!==s&&c.count!==1)throw new Error("Dimension mismatch");c.count++,c.inputIndices.push(i)}else c={count:1,dimValue:s,inputIndices:[i]};this.symbolToInfo.set(e,c)}processTerm(e,s,i,c=-1){let d=i.length,h=!1,_=[],g=0;if(!e.match(RegExp(dd))&&!s&&e!=="")throw new Error("Invalid LHS term");let $=e.match(RegExp(_o,"g")),_e=new wo(c);return $==null||$.forEach((lt,at)=>{if(lt==="..."){if(h)throw new Error("Only one ellipsis is allowed per input term");h=!0;let it=d-$.length+1;if(it<0)throw new Error("Ellipsis out of bounds");if(_=i.slice(g,g+it),this.hasEllipsis){if(this.ellipsisDims.length!==_.length||this.ellipsisDims.toString()!==_.toString())throw new Error("Ellipsis dimensions mismatch")}else if(s)this.hasEllipsis=!0,this.ellipsisDims=_;else throw new Error("Ellipsis must be specified in the LHS");for(let ct=0;ct<_.length;ct++){let mt=String.fromCharCode(48+ct);_e.addSymbol(mt,at+ct),this.addSymbol(mt,i[g++],c)}}else _e.addSymbol(lt,at+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(lt,i[g++],c)}),_e}},ld=e=>e+"_max",Pf=(e,s,i,c)=>{let d=e.map(_e=>_e.length).map((_e,lt)=>P(`input${lt}`,s,_e)),h=k.size(c),_=M("output",s,c.length),g=[...i.symbolToInfo.keys()].filter(_e=>!i.rhs.symbolToIndices.has(_e)),$=_e=>{let lt=[],at="var prod = 1.0;",it="var sum = 0.0;",ct="sum += prod;",mt=[],pt=[],zt=[],dt=[],ft=i.symbolToInfo.size===i.rhs.symbolToIndices.size;i.symbolToInfo.forEach((St,Lt)=>{var Gt;if(i.rhs.symbolToIndices.has(Lt)){let Bt=(Gt=i.rhs.symbolToIndices.get(Lt))==null?void 0:Gt[0];Bt!==void 0&&i.lhs.forEach((nr,cr)=>{if(St.inputIndices.includes(cr)){let ur=nr.symbolToIndices.get(Lt);if(ur===void 0)throw new Error("Invalid symbol error");ur.forEach(yn=>{lt.push(`${d[cr].indicesSet(`input${cr}Indices`,yn,_.indicesGet("outputIndices",Bt))}`)})}})}else i.lhs.forEach((Bt,nr)=>{if(St.inputIndices.includes(nr)){let cr=Bt.symbolToIndices.get(Lt);if(cr===void 0)throw new Error("Invalid symbol error");cr.forEach(ur=>{mt.push(`${d[nr].indicesSet(`input${nr}Indices`,ur,`${Lt}`)}`)}),dt.push(`prod *= ${d[nr].getByIndices(`input${nr}Indices`)};`)}}),pt.push(`for(var ${Lt}: u32 = 0; ${Lt} < uniforms.${ld(Lt)}; ${Lt}++) {`),zt.push("}")});let kt=ft?[...lt,`let sum = ${d.map((St,Lt)=>St.getByIndices(`input${Lt}Indices`)).join(" * ")};`]:[...lt,it,...pt,...mt,at,...dt,ct,...zt];return`
            ${_e.registerUniforms(g.map(St=>({name:`${ld(St)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(...d,_)}

            ${_e.mainStart()}
            ${_e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
            var outputIndices = ${_.offsetToIndices("global_idx")};
            ${d.map((St,Lt)=>`var input${Lt}Indices: ${d[Lt].type.indices};`).join(`
`)}
            ${kt.join(`
`)};
            ${_.setByOffset("global_idx","sum")};
          }`};return{name:"Einsum",shaderCache:{hint:i.equation,inputDependencies:e.map(()=>"rank")},getRunData:()=>{let _e=g.filter(at=>i.symbolToInfo.has(at)).map(at=>{var it;return{type:12,data:((it=i.symbolToInfo.get(at))==null?void 0:it.dimValue)||0}});_e.push({type:12,data:h});let lt=e.map((at,it)=>[...N(at)]).reduce((at,it)=>at.concat(it),_e);return lt.push(...N(c)),{outputs:[{dims:c,dataType:s}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:lt}},getShaderSource:$}},cd=(e,s)=>{let i=new vo(e.inputs,s.equation),c=i.outputDims,d=e.inputs.map((h,_)=>h.dims);e.compute(Pf(d,e.inputs[0].dataType,i,c))},pd=e=>{let s=e.equation.replace(/\s+/g,"");return J({equation:s})}}),zf,fd,Of,Bf,hd,gd=U(()=>{ee(),ne(),ie(),zf=e=>{if(!e||e.length!==2)throw new Error("Expand requires 2 input.");let s=e[0].dims,i=Array.from(e[1].getBigInt64Array(),Number),c=i.length<s.length?0:i.length-s.length,d=s.length<i.length?0:s.length-i.length;for(;c<i.length&&d<s.length;++c,++d)if(i[c]!==s[d]&&i[c]!==1&&s[d]!==1)throw new Error("Expand requires shape to be broadcastable to input")},fd=(e,s)=>{let i=e.length-s.length,c=[];for(let d=0;d<i;++d)c.push(e[d]);for(let d=0;d<s.length;++d)c.push(s[d]===1?e[d+i]:s[d]);return c},Of=(e,s)=>e.length>s.length?fd(e,s):fd(s,e),Bf=e=>{let s=e[0].dims,i=Array.from(e[1].getBigInt64Array(),Number),c=Of(s,i),d=e[0].dataType,h=d===9||k.size(s)===1,_=d===9||s.length>0&&s[s.length-1]%4===0?4:1,g=h||c.length>0&&c[c.length-1]%4===0?4:1,$=Math.ceil(k.size(c)/g),_e=at=>{let it=P("input",d,s.length,_),ct=M("output",d,c.length,g),mt;if(d===9){let pt=(zt,dt,ft="")=>`
          let outputIndices${dt} = ${ct.offsetToIndices(`outputOffset + ${dt}u`)};
          let offset${dt} = ${it.broadcastedIndicesToOffset(`outputIndices${dt}`,ct)};
          let index${dt} = offset${dt} / 4u;
          let component${dt} = offset${dt} % 4u;
          ${zt}[${dt}] = ${ft}(${it.getByOffset(`index${dt}`)}[component${dt}]);
        `;mt=`
        let outputOffset = global_idx * ${g};
        var data = vec4<u32>(0);
        ${pt("data",0,"u32")}
        ${pt("data",1,"u32")}
        ${pt("data",2,"u32")}
        ${pt("data",3,"u32")}
        ${ct.setByOffset("global_idx","data")}
      }`}else mt=`
        let outputIndices = ${ct.offsetToIndices(`global_idx * ${g}`)};
        let inputOffset = ${it.broadcastedIndicesToOffset("outputIndices",ct)};
        let data = ${ct.type.value}(${it.getByOffset(`inputOffset / ${_}`)});
        ${ct.setByOffset("global_idx","data")}
      }`;return`
    ${at.registerUniform("vec_size","u32").declareVariables(it,ct)}
    ${at.mainStart()}
    ${at.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
    ${mt}`},lt=[{type:12,data:$},...N(s,c)];return{name:"Expand",shaderCache:{hint:`${c.length};${_}${g}`,inputDependencies:["rank"]},getShaderSource:_e,getRunData:()=>({outputs:[{dims:c,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil($/64)},programUniforms:lt})}},hd=e=>{zf(e.inputs),e.compute(Bf(e.inputs),{inputs:[0]})}}),Df,bd,yd=U(()=>{ee(),ne(),ie(),jr(),Df=e=>{let s=e[0].dataType,i=k.size(e[0].dims),c=k.size(e[1].dims),d=c%4===0,h=_=>{let g=P("x",s,[1],4),$=P("bias",s,[1],4),_e=M("y",s,[1],4),lt=[{name:"output_vec_size",type:"u32"},{name:"bias_size",type:"u32"}],at=ct=>`
      let bias${ct}_offset: u32 = (global_idx * 4 + ${ct}) % uniforms.bias_size;
      let bias${ct} = ${$.getByOffset(`bias${ct}_offset / 4`)}[bias${ct}_offset % 4];`,it=d?`
      let bias = ${$.getByOffset("global_idx % (uniforms.bias_size / 4)")};`:`${at(0)}${at(1)}${at(2)}${at(3)}
      let bias = ${g.type.value}(bias0, bias1, bias2, bias3);`;return`${_.registerUniforms(lt).declareVariables(g,$,_e)}

    ${co(Ae(s))}

    ${_.mainStart(It)}
      ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_vec_size")}

      let x = ${g.getByOffset("global_idx")};
      ${it}
      let x_in = x + bias;
      ${_e.setByOffset("global_idx",po("x_in"))}
    }`};return{name:"FastGeluWithBias",shaderCache:{hint:`${d}`,inputDependencies:["type","type"]},getShaderSource:h,getRunData:_=>({outputs:[{dims:_[0].dims,dataType:_[0].dataType}],programUniforms:[{type:12,data:Math.ceil(i/4)},{type:12,data:c}],dispatchGroup:{x:Math.ceil(i/It/4)}})}},bd=e=>{e.inputs.length<2||k.size(e.inputs[1].dims)===0?mu(e):e.compute(Df(e.inputs))}}),Mf,Rf,_d,wd,vd=U(()=>{ee(),ne(),Se(),ie(),Mf=e=>{if(!e||e.length!==2)throw new Error("Gather requires 2 inputs.")},Rf=(e,s)=>{let i=e[0].dims,c=e[1].dims,d=i.length,h=k.normalizeAxis(s.axis,d),_=i.slice(0);_.splice(h,1,...c);let g=i[h],$=e[0].dataType===9?4:1,_e=Math.ceil(k.size(_)/$),lt=[{type:12,data:_e},{type:6,data:g},{type:12,data:h},...N(e[0].dims,e[1].dims,_)],at=it=>{let ct=P("data",e[0].dataType,e[0].dims.length,$),mt=P("inputIndices",e[1].dataType,e[1].dims.length),pt=M("output",e[0].dataType,_.length,$),zt=ft=>{let kt=c.length,St=`var indicesIndices${ft}  = ${mt.type.indices}(0);`;for(let Lt=0;Lt<kt;Lt++)St+=`${kt>1?`indicesIndices${ft}[${Lt}]`:`indicesIndices${ft}`} = ${_.length>1?`outputIndices${ft}[uniforms.axis + ${Lt}]`:`outputIndices${ft}`};`;St+=`
          var idx${ft} = ${mt.getByIndices(`indicesIndices${ft}`)};
          if (idx${ft} < 0) {
            idx${ft} = idx${ft} + uniforms.axisDimLimit;
          }
          var dataIndices${ft} : ${ct.type.indices};
        `;for(let Lt=0,Gt=0;Lt<d;Lt++)Lt===h?(St+=`${d>1?`dataIndices${ft}[${Lt}]`:`dataIndices${ft}`} = u32(idx${ft});`,Gt+=kt):(St+=`${d>1?`dataIndices${ft}[${Lt}]`:`dataIndices${ft}`} = ${_.length>1?`outputIndices${ft}[${Gt}]`:`outputIndices${ft}`};`,Gt++);return St},dt;if(e[0].dataType===9){let ft=(kt,St,Lt="")=>`
          let outputIndices${St} = ${pt.offsetToIndices(`outputOffset + ${St}u`)};
          ${zt(St)};
          let offset${St} = ${ct.indicesToOffset(`dataIndices${St}`)};
          let index${St} = offset${St} / 4u;
          let component${St} = offset${St} % 4u;
          ${kt}[${St}] = ${Lt}(${ct.getByOffset(`index${St}`)}[component${St}]);
        `;dt=`
        let outputOffset = global_idx * ${$};
        var value = vec4<u32>(0);
        ${ft("value",0,"u32")}
        ${ft("value",1,"u32")}
        ${ft("value",2,"u32")}
        ${ft("value",3,"u32")}
        ${pt.setByOffset("global_idx","value")}
      `}else dt=`
      let outputIndices = ${pt.offsetToIndices("global_idx")};
      ${zt("")};
      let value = ${ct.getByIndices("dataIndices")};
      ${pt.setByOffset("global_idx","value")};
      `;return`
      ${it.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(ct,mt,pt)}
      ${it.mainStart()}
        ${it.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        ${dt}
      }`};return{name:"Gather",shaderCache:{hint:s.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:_,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(_e/64)},programUniforms:lt}),getShaderSource:at}},_d=e=>J({axis:e.axis}),wd=(e,s)=>{let i=e.inputs;Mf(i),e.compute(Rf(e.inputs,s))}}),Uf,$d,xd,Sd=U(()=>{ee(),ne(),ie(),Uf=(e,s,i,c,d,h,_,g,$)=>{let _e=[{type:12,data:h},{type:12,data:c},{type:12,data:d},{type:12,data:i},{type:12,data:_},{type:12,data:g},{type:12,data:$}],lt=[h];_e.push(...N(s.dims,lt));let at=it=>{let ct=P("indices_data",s.dataType,s.dims.length),mt=M("input_slice_offsets_data",12,1,1),pt=[ct,mt],zt=[{name:"output_size",type:"u32"},{name:"batch_dims",type:"u32"},{name:"input_dims",type:"u32",length:d.length},{name:"sizes_from_slice_dims_data",type:"u32",length:i.length},{name:"num_slices_per_batch",type:"u32"},{name:"input_batch_stride",type:"u32"},{name:"num_slice_dims",type:"u32"}];return`
  ${it.registerUniforms(zt).declareVariables(...pt)}
  ${it.mainStart()}
    ${it.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let batch_idx = global_idx / uniforms.num_slices_per_batch;
    let base_offset = batch_idx * uniforms.input_batch_stride;

    let slice_indices_base_offset = global_idx * uniforms.num_slice_dims;
    var relative_slice_offset = 0;
    for (var dim_idx = 0u; dim_idx < uniforms.num_slice_dims; dim_idx ++) {
      var index = i32(indices_data[dim_idx + slice_indices_base_offset].x);
      let input_dim_idx = uniforms.batch_dims + dim_idx;
      if (index < 0) {
        ${d.length===1?"index += i32(uniforms.input_dims);":"index += i32(uniforms.input_dims[input_dim_idx]);"}
      }
      ${i.length===1?"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data);":"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data[dim_idx]);"}
    }

    input_slice_offsets_data[global_idx] =  base_offset + u32(relative_slice_offset);
  }`};return e.compute({name:"computeSliceOffsets",shaderCache:{hint:`${d.length}_${i.length}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:lt,dataType:e.inputs[1].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:_e}),getShaderSource:at},{inputs:[s],outputs:[-1]})[0]},$d=(e,s)=>{let i=e.inputs,c=i[0].dims,d=i[0].dataType,h=i[1].dims,_=h[h.length-1],g=k.sizeToDimension(h,h.length-1),$=k.sizeFromDimension(c,s.batchDims+_),_e=k.sizeToDimension(c,s.batchDims),lt=k.sizeFromDimension(c,s.batchDims),at=g/_e,it=new Array(_),ct=$;for(let St=0;St<_;++St)it[_-1-St]=ct,ct*=c[s.batchDims+_-1-St];let mt=Uf(e,i[1],it,s.batchDims,c,g,at,lt,_),pt=s.batchDims+_;if(pt>c.length)throw new Error("last dimension of indices must not be larger than rank of input tensor");let zt=h.slice(0,-1).concat(c.slice(pt)),dt=k.size(zt),ft=[{type:12,data:dt},{type:12,data:$},...N(i[0].dims,mt.dims,zt)],kt=St=>{let Lt=P("data",i[0].dataType,i[0].dims.length),Gt=P("slice_offsets",12,mt.dims.length),Bt=M("output",i[0].dataType,zt.length);return`
          ${St.registerUniform("output_size","u32").registerUniform("slice_size","u32").declareVariables(Lt,Gt,Bt)}
            ${St.mainStart()}
            ${St.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let slice_offset = slice_offsets[global_idx / uniforms.slice_size];
          output[global_idx] = data[u32(slice_offset) + global_idx % uniforms.slice_size];
        }`};e.compute({name:"GatherND",shaderCache:{hint:s.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:zt,dataType:d}],dispatchGroup:{x:Math.ceil(dt/64)},programUniforms:ft}),getShaderSource:kt},{inputs:[i[0],mt]})},xd=e=>({batchDims:e.batch_dims,cacheKey:""})}),Nf,Vf,Td,Id,Cd=U(()=>{ee(),ne(),Se(),ie(),Nf=(e,s)=>{if(e.length<3||e.length>4)throw new Error("GatherBlockQuantized requires 3 or 4 inputs.");let i=k.normalizeAxis(s.quantizeAxis,e[0].dims.length),c=s.blockSize,d=e[0],h=e[2],_=e.length===4?e[3]:void 0;if(h.dims.length!==d.dims.length||!d.dims.map((g,$)=>$===i?Math.ceil(g/c)===h.dims[$]:g===h.dims[$]).reduce((g,$)=>g&&$,!0))throw new Error("Scales must have the same rank as the input tensor and the dims should match except on gatherAxis.");if(_){if(_.dataType!==d.dataType)throw new Error("Zero point must have the same data type as the input tensor.");if(_.dims.length!==h.dims.length||!_.dims.map((g,$)=>g===h.dims[$]).reduce((g,$)=>g&&$,!0))throw new Error("Zero point must have the same rank as the input tensor and the dims should match except on quantizeAxis.")}},Vf=(e,s)=>{let i=e[0].dims,c=e[1].dims,d=i.length,h=k.normalizeAxis(s.gatherAxis,d),_=k.normalizeAxis(s.quantizeAxis,d),g=i.slice(0);g.splice(h,1,...c);let $=k.size(g),_e=e[2].dataType,lt=e[0].dataType===22,at=[{type:12,data:$},{type:12,data:_},{type:12,data:h},{type:12,data:s.blockSize},...N(...e.map((ct,mt)=>ct.dims),g)],it=ct=>{let mt=P("data",e[0].dataType,e[0].dims.length),pt=P("inputIndices",e[1].dataType,e[1].dims.length),zt=P("scales",e[2].dataType,e[2].dims.length),dt=e.length>3?P("zeroPoint",e[3].dataType,e[3].dims.length):void 0,ft=M("output",_e,g.length),kt=[mt,pt,zt];dt&&kt.push(dt);let St=[{name:"output_size",type:"u32"},{name:"quantize_axis",type:"u32"},{name:"gather_axis",type:"u32"},{name:"block_size",type:"u32"}];return`
        ${ct.registerUniforms(St).declareVariables(...kt,ft)}
        ${ct.mainStart()}
        let output_indices = ${ft.offsetToIndices("global_idx")};
        var indices_indices = ${pt.type.indices}(0);
        ${c.length>1?`
          for (var i: u32 = 0; i < ${c.length}; i++) {
            let index = ${ft.indicesGet("output_indices","uniforms.gather_axis + i")};
            ${pt.indicesSet("indices_indices","i","index")};
          }`:`indices_indices = ${ft.indicesGet("output_indices","uniforms.gather_axis")};`};
        var data_indices = ${mt.type.indices}(0);
        for (var i: u32 = 0; i < uniforms.gather_axis; i++) {
          let index = ${ft.indicesGet("output_indices","i")};
          ${mt.indicesSet("data_indices","i","index")};
        }
        var index_from_indices = ${pt.getByIndices("indices_indices")};
        if (index_from_indices < 0) {
          index_from_indices += ${i[h]};
        }
        ${mt.indicesSet("data_indices","uniforms.gather_axis","u32(index_from_indices)")};
        for (var i = uniforms.gather_axis + 1; i < ${g.length}; i++) {
          let index = ${ft.indicesGet("output_indices",`i + ${c.length} - 1`)};
          ${mt.indicesSet("data_indices","i","index")};
        }
        let data_offset = ${mt.indicesToOffset("data_indices")};
        let data_index = data_offset % 8;
        // Convert 4-bit packed data to 8-bit packed data.
        let packed_4bit_quantized_data = ${mt.getByOffset("data_offset / 8")};
        let packed_8bit_quantized_data = (packed_4bit_quantized_data >> (4 * (data_index % 2))) & 0x0f0f0f0f;
        let quantized_data_vec = ${lt?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_quantized_data));
        let quantized_data = quantized_data_vec[data_index / 2];
        var scale_indices = data_indices;
        let quantize_axis_index = ${zt.indicesGet("data_indices","uniforms.quantize_axis")} / uniforms.block_size;
        ${zt.indicesSet("scale_indices","uniforms.quantize_axis","quantize_axis_index")};
        var scale = ${zt.getByIndices("scale_indices")};
        ${dt?`
              let zero_point_indices = scale_indices;
              let zero_point_offset = ${dt.indicesToOffset("zero_point_indices")};
              let zero_point_index = zero_point_offset % 8;
              let packed_4bit_zero_points = ${dt.getByOffset("zero_point_offset / 8")};
              let packed_8bit_zero_points = (packed_4bit_zero_points >> (4 * (zero_point_index % 2))) & 0x0f0f0f0f;
              let zero_point_vec = ${lt?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_zero_points));
              let zero_point = zero_point_vec[zero_point_index / 2];`:"var zero_point = 0"};
        let dequantized_data = ${Ae(_e)}(quantized_data - zero_point) * scale;
        ${ft.setByOffset("global_idx","dequantized_data")};
    }`};return{name:"GatherBlockQuantized",shaderCache:{hint:`${s.cacheKey};${e.filter((ct,mt)=>mt!==1).map(ct=>ct.dims.join("_")).join(";")}`,inputDependencies:Array.from({length:e.length},(ct,mt)=>"rank")},getRunData:()=>({outputs:[{dims:g,dataType:_e}],dispatchGroup:{x:Math.ceil($/64)},programUniforms:at}),getShaderSource:it}},Td=(e,s)=>{let i=e.inputs;Nf(i,s),e.compute(Vf(e.inputs,s))},Id=e=>J({blockSize:e.blockSize,gatherAxis:e.gatherAxis,quantizeAxis:e.quantizeAxis})}),Wf,Lf,Ad,Ed,kd=U(()=>{ee(),ne(),Se(),ie(),Wf=e=>{if(!e||e.length!==2)throw new Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw new Error(`GatherElements requires that the data input and
                     indices input tensors be of same rank.`)},Lf=(e,s)=>{let i=e[0].dims,c=e[0].dataType,d=i.length,h=e[1].dims,_=e[1].dataType,g=k.normalizeAxis(s.axis,d),$=i[g],_e=h.slice(0),lt=k.size(_e),at=P("input",c,d),it=P("indicesInput",_,h.length),ct=M("output",c,_e.length),mt=[{type:12,data:lt},{type:6,data:$},{type:12,data:g}];return mt.push(...N(i,h,_e)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:_e,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(lt/64)},programUniforms:mt}),getShaderSource:pt=>`
      ${pt.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(at,it,ct)}
      ${pt.mainStart()}
      ${pt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

      let outputIndices = ${ct.offsetToIndices("global_idx")};

      var idx = ${it.getByOffset("global_idx")};
      if (idx < 0) {
        idx = idx + uniforms.axisDimLimit;
      }
      var inputIndices = ${at.type.indices}(outputIndices);
      ${at.indicesSet("inputIndices","uniforms.axis","u32(idx)")};
      let value = ${at.getByIndices("inputIndices")};

      ${ct.setByOffset("global_idx","value")};
  }`}},Ad=e=>J({axis:e.axis}),Ed=(e,s)=>{let i=e.inputs;Wf(i),e.compute(Lf(e.inputs,s))}}),Gf,Hf,Pd,zd,Od=U(()=>{ee(),ne(),ie(),Gf=e=>{if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(e.length===3&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched")},Hf=(e,s)=>{let i=e[0].dims.slice(),c=e[1].dims.slice(),[d,h,_]=Dr.getShapeOfGemmResult(i,s.transA,c,s.transB,e.length===3?e[2].dims:void 0),g=[d,h];if(!g)throw new Error("Can't use gemm on the given tensors");let $=16,_e=Math.ceil(h/$),lt=Math.ceil(d/$),at=!0,it=k.size(g),ct=[{type:12,data:at?_e:it},{type:12,data:d},{type:12,data:h},{type:12,data:_},{type:1,data:s.alpha},{type:1,data:s.beta}],mt=["type","type"];e.length===3&&(ct.push(...N(e[2].dims)),mt.push("rank")),ct.push(...N(g));let pt=dt=>{let ft="";s.transA&&s.transB?ft="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":s.transA&&!s.transB?ft="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!s.transA&&s.transB?ft="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!s.transA&&!s.transB&&(ft="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let kt=s.alpha===1?"":"value *= uniforms.alpha;",St=P("a",e[0].dataType,e[0].dims),Lt=P("b",e[1].dataType,e[1].dims),Gt=St.type.value,Bt=null,nr=[St,Lt];e.length===3&&(Bt=P("c",e[2].dataType,e[2].dims.length),nr.push(Bt));let cr=M("output",e[0].dataType,g.length);nr.push(cr);let ur=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`
  ${dt.registerUniforms(ur).declareVariables(...nr)}

  ${dt.mainStart()}
    ${dt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let m = global_idx / uniforms.N;
    let n = global_idx % uniforms.N;

    var value = ${Gt}(0);
    for (var k: u32 = 0u; k < uniforms.K; k++) {
      ${ft}
    }

    ${kt}
    ${Bt!=null?`let cOffset = ${Bt.broadcastedIndicesToOffset("vec2(m, n)",cr)}; value += ${Gt}(uniforms.beta) * ${Bt.getByOffset("cOffset")};`:""}
    output[global_idx] = value;
  }`},zt=dt=>{let ft=P("a",e[0].dataType,e[0].dims),kt=P("b",e[1].dataType,e[1].dims),St=null,Lt=[ft,kt];e.length===3&&(St=P("c",e[2].dataType,e[2].dims.length),Lt.push(St));let Gt=M("output",e[0].dataType,g.length);Lt.push(Gt);let Bt=[{name:"num_tile_n",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}],nr="",cr="";s.transA&&s.transB?(cr=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${ft.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${kt.type.value}(0);
      }
      `,nr="value += tile_a[k][local_id.y] * tile_b[local_id.x][k];"):s.transA&&!s.transB?(cr=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${ft.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${kt.type.value}(0);
      }
      `,nr="value += tile_a[k][local_id.y] * tile_b[k][local_id.x];"):!s.transA&&s.transB?(cr=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${ft.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${kt.type.value}(0);
      }
      `,nr="value += tile_a[local_id.y][k] * tile_b[local_id.x][k];"):!s.transA&&!s.transB&&(cr=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${ft.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${kt.type.value}(0);
      }
      `,nr="value += tile_a[local_id.y][k] * tile_b[k][local_id.x];");let ur=s.alpha===1?"":"value *= uniforms.alpha;";return`
  ${dt.registerUniforms(Bt).declareVariables(...Lt)}
  var<workgroup> tile_a: array<array<${ft.type.storage}, ${$}>, ${$}>;
  var<workgroup> tile_b: array<array<${kt.type.storage}, ${$}>, ${$}>;
  ${dt.mainStart([$,$,1])}
    let tile_col_start = (workgroup_index % uniforms.num_tile_n) * ${$};
    let tile_row_start = (workgroup_index / uniforms.num_tile_n) * ${$};
    let num_tiles = (uniforms.K - 1) / ${$} + 1;
    var k_start = 0u;
    var value = ${Gt.type.value}(0);
    for (var t: u32 = 0u; t < num_tiles; t++) {
      ${cr}
      k_start = k_start + ${$};
      workgroupBarrier();

      for (var k: u32 = 0u; k < ${$}; k++) {
        ${nr}
      }
      workgroupBarrier();
    }

    ${ur}
    let m = tile_row_start + local_id.y;
    let n = tile_col_start + local_id.x;
    ${St!=null?`let cOffset = ${St.broadcastedIndicesToOffset("vec2(m, n)",Gt)}; value += ${Gt.type.value}(uniforms.beta) * ${St.getByOffset("cOffset")};`:""}
    if (m < uniforms.M && n < uniforms.N) {
      output[m * uniforms.N + n] = value;
    }
  }`};return at?{name:"GemmShared",shaderCache:{hint:`${s.cacheKey}`,inputDependencies:mt},getRunData:()=>({outputs:[{dims:g,dataType:e[0].dataType}],dispatchGroup:{x:_e*lt},programUniforms:ct}),getShaderSource:zt}:{name:"Gemm",shaderCache:{hint:`${s.cacheKey}`,inputDependencies:mt},getRunData:()=>({outputs:[{dims:g,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(it/64)},programUniforms:ct}),getShaderSource:pt}},Pd=e=>{let s=e.transA,i=e.transB,c=e.alpha,d=e.beta;return{transA:s,transB:i,alpha:c,beta:d,cacheKey:`${e.transA};${e.transB};${e.alpha===1}`}},zd=(e,s)=>{Gf(e.inputs),e.compute(Hf(e.inputs,s))}}),ut,yt,Ut,Nt,Ff,qf,jf,Kf,Zf,Qf,Yf,Xf,Bd,Dd,Md=U(()=>{ee(),ne(),Se(),ie(),[ut,yt,Ut,Nt]=[0,1,2,3],Ff=e=>{if(e[0].dims.length!==4)throw new Error("only 4-D tensor is supported.");if(e[0].dims.length!==e[1].dims.length)throw new Error("input dimensions must be equal to grid dimensions");if(e[0].dims.length-2!==e[1].dims[e[1].dims.length-1])throw new Error(`last dimension of grid must be equal to ${e[0].dims.length-2}`);if(e[0].dims[0]!==e[1].dims[0])throw new Error("grid batch size must match input batch size")},qf=`
  fn gs_get_cubic_coeffs(x: f32) -> vec4<f32> {
    let cubic_alpha = -0.75f;
    let x_abs = abs(x);
    var coeffs: vec4<f32>;
    coeffs[0] = (((cubic_alpha * (x_abs + 1) - 5 * cubic_alpha) * (x_abs + 1) + 8 * cubic_alpha) * (x_abs + 1) - 4 * cubic_alpha);
    coeffs[1] = (((cubic_alpha + 2) * x_abs - (cubic_alpha + 3)) * x_abs * x_abs + 1);
    coeffs[2] = (((cubic_alpha + 2) * (1 - x_abs) - (cubic_alpha + 3)) * (1 - x_abs) * (1 - x_abs) + 1);
    coeffs[3] = (((cubic_alpha * (2 - x_abs) - 5 * cubic_alpha) * (2 - x_abs) + 8 * cubic_alpha) * (2 - x_abs) - 4 * cubic_alpha);
    return coeffs;
  }
`,jf=e=>`
  fn gs_bicubic_interpolate(p: mat4x4<${e}>, x: f32, y: f32) -> ${e} {
    var v: vec4<f32>;
    var coeffs = gs_get_cubic_coeffs(x);
    for (var i = 0; i < 4; i++) {
      v[i] = coeffs[0] * p[i][0] + coeffs[1] * p[i][1] + coeffs[2] * p[i][2] + coeffs[3] * p[i][3];
    }
    coeffs = gs_get_cubic_coeffs(y);
    let pixel = ${e}(coeffs[0] * v[0] + coeffs[1] * v[1] + coeffs[2] * v[2] + coeffs[3] * v[3]);
    return pixel;
  }
`,Kf=e=>`
  fn gs_denormalize(n: f32, length: i32) -> f32 {
    ${e.alignCorners===0?`
    // alignCorners: false => [-1, 1] to [-0.5, length - 0.5]
    return ((n + 1.0) * f32(length) - 1.0) / 2.0;
    `:`
    // alignCorners: true => [-1, 1] to [0, length - 1]
    return (n + 1.0) / 2.0 * (f32(length - 1));
    `}
  }
`,Zf=e=>`
  ${e.paddingMode==="reflection"?`
      fn gs_reflect(x: i32, x_min: f32, x_max: f32) -> u32 {
        var dx = 0.0;
        var fx = f32(x);
        let range = x_max - x_min;
        if (fx < x_min) {
          dx = x_min - fx;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_min + r;
          } else {
            fx = x_max - r;
          }
        } else if (fx > x_max) {
          dx = fx - x_max;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_max - r;
          } else {
            fx = x_min + r;
          }
        }
        return u32(fx);
      }`:""}
`,Qf=(e,s,i)=>`
  fn pixel_at_grid(r: i32, c: i32, H: i32, W: i32, batch: u32, channel: u32, border: vec4<f32>) -> ${s} {
     var pixel = ${s}(0);
     var indices = vec4<u32>(0);
     indices[${ut}] = batch;
     indices[${yt}] = channel;`+(()=>{switch(i.paddingMode){case"zeros":return`
          if (r >= 0 && r < H && c >=0 && c < W) {
            indices[${Ut}] = u32(r);
            indices[${Nt}] = u32(c);
          } else {
            return ${s}(0);
          }
        `;case"border":return`
          indices[${Ut}] = u32(clamp(r, 0, H - 1));
          indices[${Nt}] = u32(clamp(c, 0, W - 1));
        `;case"reflection":return`
          indices[${Ut}] = gs_reflect(r, border[1], border[3]);
          indices[${Nt}] = gs_reflect(c, border[0], border[2]);
        `;default:throw new Error(`padding mode ${i.paddingMode} is not supported`)}})()+`
    return ${e.getByIndices("indices")};
  }
`,Yf=(e,s,i)=>(()=>{switch(i.mode){case"nearest":return`
          let result = pixel_at_grid(i32(round(y)), i32(round(x)), H_in, W_in, indices[${ut}], indices[${yt}], border);
        `;case"bilinear":return`
          let x1 = i32(floor(x));
          let y1 = i32(floor(y));
          let x2 = x1 + 1;
          let y2 = y1 + 1;

          let p11 = pixel_at_grid(y1, x1, H_in, W_in, indices[${ut}], indices[${yt}], border);
          let p12 = pixel_at_grid(y1, x2, H_in, W_in, indices[${ut}], indices[${yt}], border);
          let p21 = pixel_at_grid(y2, x1, H_in, W_in, indices[${ut}], indices[${yt}], border);
          let p22 = pixel_at_grid(y2, x2, H_in, W_in, indices[${ut}], indices[${yt}], border);

          let dx2 = ${s}(f32(x2) - x);
          let dx1 = ${s}(x - f32(x1));
          let dy2 = ${s}(f32(y2) - y);
          let dy1 = ${s}(y - f32(y1));
          let result = dy2 * (dx2 * p11 + dx1 * p12) + dy1 * (dx2 * p21 + dx1 * p22);
        `;case"bicubic":return`
          let x0 = i32(floor(x)) - 1;
          let y0 = i32(floor(y)) - 1;
          var p: mat4x4<${s}>;
          for (var h = 0; h < 4; h++) {
            for (var w = 0; w < 4; w++) {
              p[h][w] = pixel_at_grid(h + y0, w + x0, H_in, W_in, indices[${ut}], indices[${yt}], border);
            }
          }

          let dx = x - f32(x0 + 1);
          let dy = y - f32(y0 + 1);
          let result = gs_bicubic_interpolate(p, dx, dy);
        `;default:throw new Error(`mode ${i.mode} is not supported`)}})()+`${e.setByOffset("global_idx","result")}`,Xf=(e,s)=>{let i=P("x",e[0].dataType,e[0].dims.length),c=[e[1].dims[0],e[1].dims[1],e[1].dims[2]],d=P("grid",e[1].dataType,c.length,2),h=[e[0].dims[0],e[0].dims[1],e[1].dims[1],e[1].dims[2]];s.format==="NHWC"&&(h=[e[0].dims[0],e[1].dims[1],e[1].dims[2],e[0].dims[3]],[ut,yt,Ut,Nt]=[0,3,1,2]);let _=M("output",e[0].dataType,h.length),g=i.type.value,$=k.size(h),_e=[{type:12,data:$},...N(e[0].dims,c,h)],lt=at=>`
  ${at.registerUniform("output_size","u32").declareVariables(i,d,_)}
  ${qf}
  ${jf(g)}
  ${Kf(s)}
  ${Zf(s)}
  ${Qf(i,g,s)}

  ${at.mainStart()}
    ${at.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let H_in = i32(uniforms.x_shape[${Ut}]);
      let W_in = i32(uniforms.x_shape[${Nt}]);

      ${s.alignCorners===0?`
      let x_min = -0.5;
      let x_max = f32(W_in) - 0.5;
      let y_min = -0.5;
      let y_max = f32(H_in) - 0.5;
      `:`
      let x_min = 0.0;
      let x_max = f32(W_in) - 1.0;
      let y_min = 0.0;
      let y_max = f32(H_in) - 1.0;
      `};
      let border = vec4<f32>(x_min, y_min, x_max, y_max);

      let indices = ${_.offsetToIndices("global_idx")};
      var grid_indices = vec3<u32>(indices[${ut}], indices[${Ut}], indices[${Nt}]);
      let nxy = ${d.getByIndices("grid_indices")};
      var x = gs_denormalize(f32(nxy[0]), W_in);
      var y = gs_denormalize(f32(nxy[1]), H_in);

      ${Yf(_,g,s)}
  }`;return{name:"GridSample",shaderCache:{hint:`${s.cacheKey}`,inputDependencies:["type","type"]},getRunData:at=>{let it=k.size(h);return{outputs:[{dims:h,dataType:at[0].dataType}],dispatchGroup:{x:Math.ceil(it/64)},programUniforms:_e}},getShaderSource:lt}},Bd=(e,s)=>{Ff(e.inputs),e.compute(Xf(e.inputs,s))},Dd=e=>J({alignCorners:e.align_corners,mode:e.mode,paddingMode:e.padding_mode,format:e.format})}),Be,th,Ud,Rd,rh,er,Nd,$o=U(()=>{ee(),ne(),Se(),Vr(),Fr(),ie(),st(),Be=(e,s)=>e.length>s&&e[s].dims.length>0?e[s]:void 0,th=(e,s)=>{let i=e[0],c=Be(e,1),d=Be(e,2),h=Be(e,3),_=Be(e,4),g=Be(e,5),$=Be(e,6),_e=Be(e,7);if(i.dims.length!==3&&i.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let lt=i.dims[0],at=i.dims[1],it=i.dims.length===3?i.dims[2]:s.numHeads*i.dims[4],ct=at,mt=0,pt=0,zt=Math.floor(it/s.numHeads);if($&&_e&&k.size($.dims)&&k.size(_e.dims)){if($.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if($.dims[0]!==lt||$.dims[1]!==s.numHeads||$.dims[3]!==zt)throw new Error('Input "past_key" shape (batch_size, num_heads, past_sequence_length, head_size)');if(_e.dims[0]!==lt||_e.dims[1]!==s.numHeads||_e.dims[3]!==zt)throw new Error('Input "past_value" shape (batch_size, num_heads, past_sequence_length, head_size)');if($.dims[2]!==_e.dims[2])throw new Error('Input "past_key" and "past_value" shall have same dim 2 (past_sequence_length)');if(_e.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');mt=$.dims[2],pt=$.dims[2]}else if($&&k.size($.dims)||_e&&k.size(_e.dims))throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let dt;if(c&&k.size(c.dims)>0){if(i.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(c.dims.length<3||c.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(i.dims[0]!==c.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(c.dims.length===3){if(c.dims[2]!==i.dims[2])throw new Error('Input "query" and "key" shall have same dim 2 (hidden_size)');dt=2,ct=c.dims[1]}else if(c.dims.length===5){if(c.dims[2]!==s.numHeads||c.dims[3]!==2||c.dims[4]!==zt)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(d)throw new Error('Expect "value" be none when "key" has packed kv format.');dt=5,ct=c.dims[1]}else{if(c.dims[1]!==s.numHeads||c.dims[3]!==zt)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');dt=0,ct=c.dims[2]}}else{if(i.dims.length!==5)throw new Error('Input "query" is expected to have 5 dimensions when key is empty');if(i.dims[2]!==s.numHeads||i.dims[3]!==3)throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');dt=3}if(h&&k.size(h.dims)>0){if(h.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimension');if(c&&c.dims.length===5&&c.dims[3]===2)throw new Error("bias is not allowed for packed kv.")}let ft=mt+ct,kt=0;if(_&&k.size(_.dims)>0){kt=8;let Bt=_.dims;throw Bt.length===1?Bt[0]===lt?kt=1:Bt[0]===3*lt+2&&(kt=3):Bt.length===2&&Bt[0]===lt&&Bt[1]===ft&&(kt=5),kt===8?new Error('Input "key_padding_mask" shape shall be (batch_size) or (batch_size, total_sequence_length)'):new Error("Mask not supported")}let St=!1,Lt=it;if(d&&k.size(d.dims)>0){if(d.dims.length!==3&&d.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(i.dims[0]!==d.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(d.dims.length===3){if(ct!==d.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');Lt=d.dims[2]}else{if(ct!==d.dims[2])throw new Error('Input "key" and "value" shall have the same dim 2 (kv_sequence_length)');Lt=d.dims[1]*d.dims[3],St=!0}}let Gt=!1;if(_&&k.size(_.dims)>0)throw new Error("Key padding mask is not supported");if(g&&k.size(g.dims)>0){if(g.dims.length!==4)throw new Error('Input "attention_bias" is expected to have 4 dimensions');if(g.dims[0]!==lt||g.dims[1]!==s.numHeads||g.dims[2]!==at||g.dims[3]!==ft)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:lt,sequenceLength:at,pastSequenceLength:mt,kvSequenceLength:ct,totalSequenceLength:ft,maxSequenceLength:pt,inputHiddenSize:0,hiddenSize:it,vHiddenSize:Lt,headSize:zt,vHeadSize:Math.floor(Lt/s.numHeads),numHeads:s.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:s.maskFilterValue,maskType:kt,scale:s.scale,broadcastResPosBias:Gt,passPastInKv:St,qkvFormat:dt}},Ud=e=>J({...e}),Rd=J({perm:[0,2,1,3]}),rh=(e,s,i,c,d,h,_)=>{let g=[c,d,h],$=k.size(g),_e=[{type:12,data:$},{type:12,data:_},{type:12,data:h}],lt=at=>{let it=M("qkv_with_bias",s.dataType,g),ct=P("qkv",s.dataType,g),mt=P("bias",i.dataType,g),pt=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`
  ${at.registerUniforms(pt).declareVariables(ct,mt,it)}
  ${at.mainStart()}
    ${at.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;

    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];
  }`};return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:g,dataType:s.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil($/64)},programUniforms:_e}),getShaderSource:lt},{inputs:[s,i],outputs:[-1]})[0]},er=(e,s,i,c,d,h,_,g)=>{let $=h;if(_&&k.size(_.dims)>0){if(c===1)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return $=rh(e,h,_,s,c,i*d,g),$=$.reshape([s,c,i,d]),i===1||c===1?$:e.compute(Ee($,Rd.perm),{inputs:[$],outputs:[-1]})[0]}else return h.dims.length===3&&($=h.reshape([s,c,i,d])),i===1||c===1?$:e.compute(Ee($,Rd.perm),{inputs:[$],outputs:[-1]})[0]},Nd=(e,s)=>{let i=th(e.inputs,s),c=e.inputs[0],d=Be(e.inputs,1),h=Be(e.inputs,2),_=Be(e.inputs,3),g=Be(e.inputs,4),$=Be(e.inputs,5),_e=Be(e.inputs,6),lt=Be(e.inputs,7);if(c.dims.length===5)throw new Error("Packed QKV is not implemented");if((d==null?void 0:d.dims.length)===5)throw new Error("Packed KV is not implemented");let at=d&&h&&d.dims.length===4&&h.dims.length===4,it=er(e,i.batchSize,i.numHeads,i.sequenceLength,i.headSize,c,_,0);if(at)return Rt(e,it,d,h,g,void 0,_e,lt,$,i);if(!d||!h)throw new Error("key and value must be provided");let ct=er(e,i.batchSize,i.numHeads,i.kvSequenceLength,i.headSize,d,_,i.hiddenSize),mt=er(e,i.batchSize,i.numHeads,i.kvSequenceLength,i.vHeadSize,h,_,2*i.hiddenSize);Rt(e,it,ct,mt,g,void 0,_e,lt,$,i)}}),nh,oh,ih,ah,xo,Vd,Wd,So=U(()=>{ee(),ne(),Se(),ie(),nh=e=>{if(!e||e.length<1)throw new Error("too few inputs")},oh=(e,s)=>{let i=[],c=s.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach(d=>i.push(Number(d))),c=i.length),J({numOutputs:c,axis:s.axis,splitSizes:i})},ih=e=>`
fn calculateOutputIndex(index: u32) -> u32 {
    for (var i: u32 = 0u; i < ${e}u; i += 1u ) {
    if (index < ${F("uniforms.size_in_split_axis","i",e)}) {
        return i;
    }
    }
    return ${e}u;
}`,ah=e=>{let s=e.length,i=[];for(let c=0;c<s;++c){let d=e[c].setByIndices("indices","input[global_idx]");s===1?i.push(d):c===0?i.push(`if (output_number == ${c}u) { ${d} }`):c===s-1?i.push(`else { ${d} }`):i.push(`else if (output_number == ${c}) { ${d} }`)}return`
      fn writeBufferData(output_number: u32, indices: ${e[0].type.indices}, global_idx: u32) {
        ${i.join(`
`)}
      }`},xo=(e,s)=>{let i=e[0].dims,c=k.size(i),d=e[0].dataType,h=k.normalizeAxis(s.axis,i.length),_=new Array(s.numOutputs),g=P("input",d,i.length),$=new Array(s.numOutputs),_e=[],lt=[],at=0,it=[{type:12,data:c}];for(let mt=0;mt<s.numOutputs;mt++){at+=s.splitSizes[mt],$[mt]=at;let pt=i.slice();pt[h]=s.splitSizes[mt],lt.push(pt),_[mt]=M(`output${mt}`,d,pt.length),_e.push({dims:lt[mt],dataType:e[0].dataType})}it.push({type:12,data:$},...N(i,...lt));let ct=mt=>`
  ${mt.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",$.length).declareVariables(g,..._)}
  ${ih($.length)}
  ${ah(_)}

  ${mt.mainStart()}
    ${mt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}

    var indices = ${g.offsetToIndices("global_idx")};
    var index = ${g.indicesGet("indices",h)};
    let output_number = calculateOutputIndex(index);
    if (output_number != 0) {
      index -= ${F("uniforms.size_in_split_axis","output_number - 1u",$.length)};
      ${g.indicesSet("indices",h,"index")};
    }
    writeBufferData(output_number, indices, global_idx);
  }`;return{name:"Split",shaderCache:{hint:s.cacheKey,inputDependencies:["rank"]},getShaderSource:ct,getRunData:()=>({outputs:_e,dispatchGroup:{x:Math.ceil(c/64)},programUniforms:it})}},Vd=(e,s)=>{nh(e.inputs);let i=e.inputs.length===1?s:oh(e.inputs,s);e.compute(xo(e.inputs,i),{inputs:[0]})},Wd=e=>{let s=e.axis,i=e.splitSizes,c=e.numOutputs<0?i.length:e.numOutputs;if(c!==i.length)throw new Error("numOutputs and splitSizes lengh must be equal");return J({axis:s,numOutputs:c,splitSizes:i})}}),sh,tn,Ld,To=U(()=>{ee(),ne(),Se(),ie(),sh=(e,s)=>{let[i,c,d,h]=e,{numHeads:_,rotaryEmbeddingDim:g}=s;if(i.dims.length!==3&&i.dims.length!==4)throw new Error(`Input 'x' is expected to have 3 or 4 dimensions, got ${i.dims.length}`);if(!k.areEqual(c.dims,[])&&!k.areEqual(c.dims,[1])&&c.dims.length!==2)throw new Error(`Input 'position_ids' is expected to have 0, 1, or 2 dimensions, got ${c.dims.length}`);if(d.dims.length!==2)throw new Error(`Input 'cos_cache' is expected to have 2 dimensions, got ${d.dims.length}`);if(h.dims.length!==2)throw new Error(`Input 'sin_cache' is expected to have 2 dimensions, got ${h.dims.length}`);if(!k.areEqual(d.dims,h.dims))throw new Error("Inputs 'cos_cache' and 'sin_cache' are expected to have the same shape");if(g>0&&_===0)throw new Error("num_heads must be provided if rotary_embedding_dim is specified");let $=i.dims[0],_e=i.dims[i.dims.length-2],lt=d.dims[0],at=k.sizeFromDimension(i.dims,1)/_e,it=g===0?d.dims[1]*2:at/_;if(g>it)throw new Error("rotary_embedding_dim must be less than or equal to head_size");if(c.dims.length===2){if($!==c.dims[0])throw new Error(`Input 'position_ids' dimension 0 should be of size batch_size, got ${c.dims[0]}`);if(_e!==c.dims[1])throw new Error(`Input 'position_ids' dimension 1 should be of size sequence_length, got ${c.dims[1]}`)}if(it/2!==d.dims[1]&&g/2!==d.dims[1])throw new Error(`Input 'cos_cache' dimension 1 should be same as head_size / 2 or rotary_embedding_dim / 2, got ${d.dims[1]}`);if(_e>lt)throw new Error("Updating cos_cache and sin_cache in RotaryEmbedding is not currently supported")},tn=(e,s)=>{let{interleaved:i,numHeads:c,rotaryEmbeddingDim:d,scale:h}=s,_=e[0].dims[0],g=k.sizeFromDimension(e[0].dims,1),$=e[0].dims[e[0].dims.length-2],_e=g/$,lt=e[2].dims[1],at=d===0?lt*2:_e/c,it=new Array(_,$,_e/at,at-lt),ct=k.computeStrides(it),mt=[{type:1,data:h},{type:12,data:it},{type:12,data:ct},...e[0].dims.length===3?new Array({type:12,data:[g,_e,at,1]}):[],...e[0].dims.length===4?new Array({type:12,data:[g,at,$*at,1]}):[],...N(e[0].dims,e[1].dims,e[2].dims,e[3].dims,e[0].dims)],pt=zt=>{let dt=P("input",e[0].dataType,e[0].dims.length),ft=P("position_ids",e[1].dataType,e[1].dims.length),kt=P("cos_cache",e[2].dataType,e[2].dims.length),St=P("sin_cache",e[3].dataType,e[3].dims.length),Lt=M("output",e[0].dataType,e[0].dims.length);return zt.registerUniforms([{name:"scale",type:"f32"},{name:"global_shape",type:"u32",length:it.length},{name:"global_strides",type:"u32",length:ct.length},{name:"input_output_strides",type:"u32",length:ct.length}]),`
        ${zt.declareVariables(dt,ft,kt,St,Lt)}

        ${zt.mainStart(It)}
          let half_rotary_emb_dim = uniforms.${kt.name}_shape[1];
          let bsnh = global_idx / uniforms.global_strides % uniforms.global_shape;
          let size = uniforms.global_shape[0] * uniforms.global_strides[0];
          ${zt.guardAgainstOutOfBoundsWorkgroupSizes("size")}

          if (bsnh[3] < half_rotary_emb_dim) {
            let position_ids_idx =
                ${ft.broadcastedIndicesToOffset("bsnh.xy",M("",ft.type.tensor,2))};
            let position_id =
                u32(${ft.getByOffset("position_ids_idx")}) + select(0, bsnh[1], position_ids_idx == 0);
            let i = dot(bsnh, uniforms.input_output_strides) + select(0, bsnh[3], ${i});
            let j = i + select(half_rotary_emb_dim, 1, ${i});
            let re = ${dt.getByOffset("i")} * ${kt.get("position_id","bsnh[3]")} -
                ${dt.getByOffset("j")} * ${St.get("position_id","bsnh[3]")};
            ${Lt.setByOffset("i","re")}
            let im = ${dt.getByOffset("i")} * ${St.get("position_id","bsnh[3]")} +
                ${dt.getByOffset("j")} * ${kt.get("position_id","bsnh[3]")};
            ${Lt.setByOffset("j","im")}
          } else {
            let k = dot(bsnh, uniforms.input_output_strides) + half_rotary_emb_dim;
            ${Lt.setByOffset("k",dt.getByOffset("k"))}
          }
        }`};return{name:"RotaryEmbedding",shaderCache:{hint:J({interleaved:i}).cacheKey,inputDependencies:["rank","rank","rank","rank"]},getShaderSource:pt,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(k.size(it)/It)},programUniforms:mt})}},Ld=(e,s)=>{sh(e.inputs,s),e.compute(tn(e.inputs,s))}}),uh,dh,Gd,lh,Hd,Fd=U(()=>{Se(),ee(),Fr(),$o(),So(),st(),To(),ie(),uh=(e,s)=>{if(s.doRotary&&e.length<=7)throw new Error("cos_cache and sin_cache inputs are required if do_rotary is specified");let i=e[0],c=e[1],d=e[2],h=e[3],_=e[4];if(s.doRotary!==0&&e.length<=7)throw new Error("cos_cast and sin_cache are expected if do_rotary attribute is non-zero");if(s.localWindowSize!==-1)throw new Error("Local attention is not supported");if(s.softcap!==0)throw new Error("Softcap is not supported");if(s.rotaryInterleaved!==0)throw new Error("Rotary interleaved is not supported");if(s.smoothSoftmax)throw new Error("Smooth softmax is not supported");if(i.dims.length!==3&&i.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let g=!1,$=i.dims[0],_e=i.dims[1],lt=i.dims.length===3?g?i.dims[2]/3:i.dims[2]:s.numHeads*i.dims[4],at=_e,it=0,ct=!c||c.dims.length===0,mt=Math.floor(ct?lt/(s.numHeads+2*s.kvNumHeads):lt/s.numHeads);ct&&(lt=mt*s.numHeads);let pt=h&&h.dims.length!==0,zt=_&&_.dims.length!==0;if(pt&&h.dims.length===4&&h.dims[0]===$&&h.dims[1]!==s.kvNumHeads&&h.dims[2]===s.kvNumHeads&&h.dims[3]===mt)throw new Error("BSNH pastKey/pastValue is not supported");if(pt&&zt){if(h.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(_.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');it=h.dims[2]}else if(pt||zt)throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let dt=1;if(c&&c.dims.length>0){if(i.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(c.dims.length<3||c.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(i.dims[0]!==c.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(c.dims.length===3){if(i.dims[2]%c.dims[2]!==0)throw new Error('Dimension 2 of "query" should be a multiple of "key"');at=c.dims[1]}else if(c.dims.length===5){if(c.dims[2]!==s.numHeads||c.dims[3]!==2||c.dims[4]!==mt)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(d)throw new Error('Expect "value" be none when "key" has packed kv format.');at=c.dims[1]}else{if(c.dims[1]!==s.numHeads||c.dims[3]!==mt)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');at=c.dims[2]}}else{if(i.dims.length!==3&&i.dims.length!==5)throw new Error('Input "query" is expected to have 3 or 5 dimensions when key is empty');if(i.dims.length===5&&(i.dims[2]!==s.numHeads||i.dims[3]!==3))throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');dt=3}let ft=0,kt=!1,St=s.kvNumHeads?mt*s.kvNumHeads:lt;if(d&&d.dims.length>0){if(d.dims.length!==3&&d.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(i.dims[0]!==d.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(d.dims.length===3){if(at!==d.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');St=d.dims[2]}else{if(at!==d.dims[2])throw new Error('Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)');St=d.dims[1]*d.dims[3],kt=!0}}let Lt=e.length>4?e[5]:void 0;if(Lt&&Lt.dims.length!==1&&Lt.dims[0]!==$)throw new Error('Input "seqlens" is expected to have 1 dimension and the same dim 0 as batch_size');return{batchSize:$,sequenceLength:_e,pastSequenceLength:it,kvSequenceLength:at,totalSequenceLength:-1,maxSequenceLength:-1,inputHiddenSize:0,hiddenSize:lt,vHiddenSize:St,headSize:mt,vHeadSize:Math.floor(St/s.kvNumHeads),numHeads:s.numHeads,kvNumHeads:s.kvNumHeads,nReps:s.numHeads/s.kvNumHeads,pastPresentShareBuffer:!1,maskType:ft,scale:s.scale,broadcastResPosBias:!1,passPastInKv:kt,qkvFormat:dt}},dh=J({perm:[0,2,1,3]}),Gd=(e,s,i)=>{let c=s,d=i.kvNumHeads;return s.dims.length===3&&i.kvSequenceLength!==0&&(c=s.reshape([i.batchSize,i.kvSequenceLength,d,i.headSize]),c=e.compute(Ee(c,dh.perm),{inputs:[c],outputs:[-1]})[0]),c},lh=(e,s,i,c)=>{let d=7,h=["type","type"],_=[e*s],g=e*s,$=[{type:12,data:g},{type:12,data:s},{type:12,data:e}],_e=lt=>{let at=P("seq_lens",i.dataType,i.dims),it=P("total_seq_lens",c.dataType,c.dims),ct=M("pos_ids",d,_),mt=[{name:"output_size",type:"u32"},{name:"sequence_length",type:"u32"},{name:"batch_size",type:"u32"}];return`
  ${lt.registerUniforms(mt).declareVariables(at,it,ct)}
  ${lt.mainStart()}
    ${lt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let total_sequence_length = u32(${it.getByOffset("0")});
    let is_subsequent_prompt = uniforms.sequence_length > 1 && uniforms.sequence_length != total_sequence_length;
    let is_first_prompt = !is_subsequent_prompt && uniforms.sequence_length == total_sequence_length;
    let batch_idx = global_idx / uniforms.sequence_length;
    let sequence_idx = i32(global_idx % uniforms.sequence_length);
    var pos_id: i32 = 0;
    let seqlen = ${at.getByOffset("batch_idx")};
    let total_seqlen = seqlen + 1;
    if (is_first_prompt) {
      if (sequence_idx < total_seqlen) {
        pos_id = sequence_idx;
      } else {
        pos_id = 1;
      }
      ${ct.setByOffset("global_idx","pos_id")}
    } else if (is_subsequent_prompt) {
      let past_seqlen = total_seqlen - i32(uniforms.sequence_length);
      if (past_seqlen + sequence_idx < total_seqlen) {
        pos_id = past_seqlen + sequence_idx;
      } else {
        pos_id = 1;
      }
      ${ct.setByOffset("global_idx","pos_id")}
    } else if (global_idx < uniforms.batch_size) {
      ${ct.setByOffset("global_idx","seqlen")}
    };
  }
  `};return{name:"GeneratePositionIds",shaderCache:{hint:`${e};${s}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:_,dataType:d}],dispatchGroup:{x:Math.ceil(g/64)},programUniforms:$}),getShaderSource:_e}},Hd=(e,s)=>{var St;let i=uh(e.inputs,s);if(e.inputs[0].dims.length===5)throw new Error("Packed QKV is not implemented");if(((St=e.inputs[1])==null?void 0:St.dims.length)===5)throw new Error("Packed KV is not implemented");let c=e.inputs[0],d=e.inputs[1]&&e.inputs[1].dims.length>0?e.inputs[1]:void 0,h=e.inputs[2]&&e.inputs[2].dims.length>0?e.inputs[2]:void 0,_=e.inputs[3]&&e.inputs[3].dims.length!==0?e.inputs[3]:void 0,g=e.inputs[4]&&e.inputs[4].dims.length!==0?e.inputs[4]:void 0,$=e.inputs.length>4?e.inputs[5]:void 0,_e=e.inputs.length>5?e.inputs[6]:void 0,lt=i.kvNumHeads?i.kvNumHeads:i.numHeads,at=J({axis:2,numOutputs:3,splitSizes:[i.numHeads*i.headSize,lt*i.headSize,lt*i.headSize]}),[it,ct,mt]=!d&&!h?e.compute(xo([c],at),{inputs:[c],outputs:[-1,-1,-1]}):[c,d,h],pt,zt;if(s.doRotary){let Lt=e.compute(lh(i.batchSize,i.sequenceLength,$,_e),{inputs:[$,_e],outputs:[-1]})[0],Gt=e.inputs[7],Bt=e.inputs[8],nr=J({interleaved:s.rotaryInterleaved!==0,numHeads:i.numHeads,rotaryEmbeddingDim:0,scale:s.scale}),cr=[it,Lt,Gt,Bt],ur=[-1];pt=e.compute(tn(cr,nr),{inputs:cr,outputs:ur})[0],cr.splice(0,1,ct);let yn=J({interleaved:s.rotaryInterleaved!==0,numHeads:i.kvNumHeads,rotaryEmbeddingDim:0,scale:s.scale});zt=e.compute(tn(cr,yn),{inputs:cr,outputs:ur})[0]}let dt=er(e,i.batchSize,i.numHeads,i.sequenceLength,i.headSize,s.doRotary?pt:it,void 0,0),ft=Gd(e,s.doRotary?zt:ct,i),kt=Gd(e,mt,i);Rt(e,dt,ft,kt,void 0,void 0,_,g,void 0,i,$,_e)}}),qd,ch,ph,jd,Kd=U(()=>{ee(),ne(),st(),ie(),qd=(e,s,i,c,d,h,_,g)=>{let $=ce(h),_e=$===1?"f32":`vec${$}f`,lt=$===1?"vec2f":`mat2x${$}f`,at=d*_,it=64;at===1&&(it=256);let ct=[d,_,h/$],mt=[d,_,2],pt=["rank","type","type"],zt=[];zt.push(...N(ct,mt));let dt=ft=>{let kt=P("x",s.dataType,3,$),St=P("scale",i.dataType,i.dims),Lt=P("bias",c.dataType,c.dims),Gt=M("output",1,3,2),Bt=[kt,St,Lt,Gt];return`
  var<workgroup> workgroup_shared : array<${lt}, ${it}>;
  const workgroup_size = ${it}u;
  ${ft.declareVariables(...Bt)}
  ${ft.mainStart(it)}
    let batch = workgroup_index / uniforms.x_shape[1];
    let channel = workgroup_index % uniforms.x_shape[1];
    let hight = uniforms.x_shape[2];
    // initialize workgroup memory
    var sum = ${_e}(0);
    var squared_sum = ${_e}(0);
    for (var h = local_idx; h < hight; h += workgroup_size) {
      let value = ${_e}(${kt.get("batch","channel","h")});
      sum += value;
      squared_sum += value * value;
    }
    workgroup_shared[local_idx] = ${lt}(sum, squared_sum);
    workgroupBarrier();

    for (var currSize = workgroup_size >> 1;  currSize > 0; currSize = currSize >> 1) {
      if (local_idx < currSize) {
        workgroup_shared[local_idx] = workgroup_shared[local_idx] + workgroup_shared[local_idx + currSize];
      }
      workgroupBarrier();
    }
    if (local_idx == 0) {
      let sum_final = ${He("workgroup_shared[0][0]",$)} / f32(hight * ${$});
      let squared_sum_final = ${He("workgroup_shared[0][1]",$)} / f32(hight * ${$});

      let inv_std_dev = inverseSqrt(squared_sum_final - sum_final * sum_final + f32(${g}));
      let channel_scale = inv_std_dev * f32(scale[channel]);
      let channel_shift = f32(bias[channel]) - sum_final * channel_scale;
      output[workgroup_index] = vec2f(channel_scale, channel_shift);
    }
  }`};return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${$};${g};${it}`,inputDependencies:pt},getRunData:()=>({outputs:[{dims:mt,dataType:1}],dispatchGroup:{x:at},programUniforms:zt}),getShaderSource:dt},{inputs:[s,i,c],outputs:[-1]})[0]},ch=(e,s,i)=>{let c=s[0].dims,d=c,h=2,_=c[0],g=c[1],$=k.sizeFromDimension(c,h),_e=ce($),lt=k.size(d)/_e,at=qd(e,s[0],s[1],s[2],_,$,g,i.epsilon),it=[_,g,$/_e],ct=[_,g],mt=["type","none"],pt=zt=>{let dt=P("x",s[0].dataType,it.length,_e),ft=P("scale_shift",1,ct.length,2),kt=M("output",s[0].dataType,it.length,_e),St=[dt,ft,kt];return`
  ${zt.registerUniform("output_size","u32").declareVariables(...St)}
  ${zt.mainStart()}
  ${zt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let outputIndices = ${kt.offsetToIndices("global_idx")};
      let batch = outputIndices[0];
      let channel = outputIndices[1];
      let scale_shift = ${ft.getByIndices("vec2<u32>(batch, channel)")};
      let value = ${dt.getByOffset("global_idx")} * ${kt.type.value}(scale_shift.x) + ${kt.type.value}(scale_shift.y);
      ${kt.setByOffset("global_idx","value")};
  }`};e.compute({name:"InstanceNormalization",shaderCache:{hint:`${_e}`,inputDependencies:mt},getRunData:()=>({outputs:[{dims:d,dataType:s[0].dataType}],dispatchGroup:{x:Math.ceil(lt/64)},programUniforms:[{type:12,data:lt},...N(it,ct,it)]}),getShaderSource:pt},{inputs:[s[0],at]})},ph=(e,s,i)=>{let c=s[0].dims,d=c,h=c[0],_=c[c.length-1],g=k.sizeFromDimension(c,1)/_,$=ce(_),_e=k.size(d)/$,lt=[{type:12,data:g},{type:12,data:Math.floor(_/$)}],at=["type","type"],it=!1,ct=[0,c.length-1];for(let dt=0;dt<c.length-2;dt++)it=it||c[dt+1]!==1,ct.push(dt+1);it=it&&c[c.length-1]!==1;let mt=it?e.compute(Ee(e.inputs[0],ct),{inputs:[e.inputs[0]],outputs:[-1]})[0]:e.inputs[0].reshape(Array.from({length:c.length},(dt,ft)=>c[ct[ft]])),pt=qd(e,mt,s[1],s[2],h,g,_,i.epsilon),zt=dt=>{let ft=be(s[0].dataType),kt=$===1?"vec2f":`mat${$}x2f`,St=Bt=>{let nr=Bt===0?"x":"y",cr=$===1?"f32":`vec${$}f`;switch($){case 1:return`${ft}(${cr}(scale.${nr}))`;case 2:return`vec2<${ft}>(${cr}(scale[0].${nr}, scale[1].${nr}))`;case 4:return`vec4<${ft}>(${cr}(scale[0].${nr}, scale[1].${nr}, scale[2].${nr}, scale[3].${nr}))`;default:throw new Error(`Not supported compoents ${$}`)}},Lt=P("input",s[0].dataType,s[0].dims,$),Gt=M("output",s[0].dataType,d,$);return`
  @group(0) @binding(0) var<storage, read> input : array<${Lt.type.storage}>;
  @group(0) @binding(1) var<storage, read> scale_input : array<${kt}>;
  @group(0) @binding(2) var<storage, read_write> output : array<${Gt.type.storage}>;
  struct Uniforms {H: u32, C : u32};
  @group(0) @binding(3) var<uniform> uniforms: Uniforms;

  ${dt.mainStart()}
    let current_image_number = global_idx / (uniforms.C * uniforms.H);
    let current_channel_number = global_idx % uniforms.C;

    let scale_offset = current_image_number * uniforms.C + current_channel_number;
    let scale = scale_input[scale_offset];
    output[global_idx] = fma(input[global_idx], ${St(0)}, ${St(1)});
  }`};e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${$}`,inputDependencies:at},getRunData:()=>({outputs:[{dims:d,dataType:s[0].dataType}],dispatchGroup:{x:Math.ceil(_e/64)},programUniforms:lt}),getShaderSource:zt},{inputs:[s[0],pt]})},jd=(e,s)=>{s.format==="NHWC"?ph(e,e.inputs,s):ch(e,e.inputs,s)}}),mh,fh,Zd,Qd=U(()=>{ee(),ne(),ie(),mh=e=>{if(!e||e.length<2)throw new Error("layerNorm requires at least 2 inputs.")},fh=(e,s,i)=>{let c=s.simplified,d=e[0].dims,h=e[1],_=!c&&e[2],g=d,$=k.normalizeAxis(s.axis,d.length),_e=k.sizeToDimension(d,$),lt=k.sizeFromDimension(d,$),at=k.size(h.dims),it=_?k.size(_.dims):0;if(at!==lt||_&&it!==lt)throw new Error(`Size of X.shape()[axis:] == ${lt}.
       Size of scale and bias (if provided) must match this.
       Got scale size of ${at} and bias size of ${it}`);let ct=[];for(let Lt=0;Lt<d.length;++Lt)Lt<$?ct.push(d[Lt]):ct.push(1);let mt=ce(lt),pt=["type","type"],zt=[{type:12,data:_e},{type:1,data:lt},{type:12,data:Math.floor(lt/mt)},{type:1,data:s.epsilon}];_&&pt.push("type");let dt=i>1,ft=i>2,kt=Lt=>{let Gt=be(e[0].dataType),Bt=[P("x",e[0].dataType,e[0].dims,mt),P("scale",h.dataType,h.dims,mt)];_&&Bt.push(P("bias",_.dataType,_.dims,mt)),Bt.push(M("output",e[0].dataType,g,mt)),dt&&Bt.push(M("mean_data_output",1,ct)),ft&&Bt.push(M("inv_std_output",1,ct));let nr=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`
  ${Lt.registerUniforms(nr).declareVariables(...Bt)}
  ${Lt.mainStart()}
    ${Lt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}
    let offset = global_idx * uniforms.norm_size_vectorized;
    var mean_vector = ${ao("f32",mt)};
    var mean_square_vector = ${ao("f32",mt)};

    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {
      let value = ${Ct(Gt,mt,"x[h + offset]")};
      mean_vector += value;
      mean_square_vector += value * value;
    }
    let mean = ${He("mean_vector",mt)} / uniforms.norm_size;
    let inv_std_dev = inverseSqrt(${He("mean_square_vector",mt)} / uniforms.norm_size ${c?"":"- mean * mean"} + uniforms.epsilon);

    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {
      let f32input = ${Ct(Gt,mt,"x[j + offset]")};
      let f32scale = ${Ct(Gt,mt,"scale[j]")};
      output[j + offset] = ${Bt[0].type.value}((f32input ${c?"":"- mean"}) * inv_std_dev * f32scale
        ${_?`+ ${Ct(Gt,mt,"bias[j]")}`:""}
      );
    }

    ${dt?"mean_data_output[global_idx] = mean":""};
    ${ft?"inv_std_output[global_idx] = inv_std_dev":""};
  }`},St=[{dims:g,dataType:e[0].dataType}];return dt&&St.push({dims:ct,dataType:1}),ft&&St.push({dims:ct,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${mt};${i};${c}`,inputDependencies:pt},getRunData:()=>({outputs:St,dispatchGroup:{x:Math.ceil(_e/64)},programUniforms:zt}),getShaderSource:kt}},Zd=(e,s)=>{mh(e.inputs),e.compute(fh(e.inputs,s,e.outputCount))}}),hh,Yd,Xd=U(()=>{ne(),Yr(),Xr(),hh=e=>{if(!e||e.length!==2)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.")},Yd=e=>{hh(e.inputs);let s=Je.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!s)throw new Error("Can't use matmul on the given tensors");let i=s[s.length-1],c=e.inputs[0].dims[e.inputs[0].dims.length-1];if(i<8&&c<8)e.compute(Qr(e.inputs,{activation:""},s));else{let d=s[s.length-2],h=k.size(e.inputs[0].dims.slice(0,-2)),_=k.size(e.inputs[1].dims.slice(0,-2));if(h!==1&&d===1&&_===1){let g=e.inputs[0].reshape([1,h,c]),$=e.inputs[1].reshape([1,c,i]),_e=[1,h,i],lt=[g,$];e.compute(Jt(lt,{activation:""},s,_e),{inputs:lt})}else e.compute(Jt(e.inputs,{activation:""},s))}}}),gh,bh,yh,Jd,el,tl=U(()=>{ee(),ne(),Se(),ie(),gh=(e,s)=>{if(e.length<3||e.length>4)throw new Error("MatMulNBits requires 3 or 4 inputs");let i=e[0],c=i.dims.length;if(i.dims[c-1]!==s.k)throw new Error("The last dim of input shape does not match the k value");let d=Math.floor((s.k+s.blockSize-1)/s.blockSize),h=s.blockSize/8*s.bits,_=e[1];if(!k.areEqual(_.dims,[s.n,d,h]))throw new Error("The second inputs must be 3D tensor with shape N X nBlocksPerCol X blobSize");let g=e[2].dims;if(k.size(g)!==s.n*d)throw new Error("scales input size error.");if(e.length===4){let $=e[3].dims,_e=s.bits>4?s.n*d:s.n*Math.floor((d+1)/2);if(k.size($)!==_e)throw new Error("zeroPoints input size error.")}},bh=(e,s)=>{let i=e[0].dims,c=i.length,d=i[c-2],h=s.k,_=s.n,g=i.slice(0,c-2),$=k.size(g),_e=e[1].dims[2]/4,lt=e[0].dataType,at=ce(s.k),it=ce(_e),ct=ce(_),mt=g.concat([d,_]),pt=d>1&&_/ct%2===0?2:1,zt=k.size(mt)/ct/pt,dt=64,ft=[],kt=[$,d,h/at],St=k.convertShape(e[1].dims).slice();St.splice(-1,1,_e/it),ft.push(...N(kt)),ft.push(...N(St)),ft.push(...N(e[2].dims)),e.length===4&&ft.push(...N(k.convertShape(e[3].dims)));let Lt=[$,d,_/ct];ft.push(...N(Lt));let Gt=Bt=>{let nr=kt.length,cr=P("a",e[0].dataType,nr,at),ur=P("b",12,St.length,it),yn=P("scales",e[2].dataType,e[2].dims.length),hn=[cr,ur,yn],_n=e.length===4?P("zero_points",12,e[3].dims.length):void 0;_n&&hn.push(_n);let gn=Lt.length,vn=M("output",e[0].dataType,gn,ct),Tn=be(e[0].dataType),kn=(()=>{switch(at){case 1:return`array<${Tn}, 8>`;case 2:return`mat4x2<${Tn}>`;case 4:return`mat2x4<${Tn}>`;default:throw new Error(`${at}-component is not supported.`)}})(),bn=()=>{let or=`
          // reuse a data
            var input_offset = ${cr.indicesToOffset(`${cr.type.indices}(batch, row, word_offset)`)};
            var a_data: ${kn};
            for (var j: u32 = 0; j < ${8/at}; j++) {
              a_data[j] = ${cr.getByOffset("input_offset")};
              input_offset++;
            }
          `;for(let lr=0;lr<ct*pt;lr++)or+=`
            b_value = ${it===1?`b${lr}_data`:`b${lr}_data[i]`};
            b_value_lower = unpack4xU8(b_value & b_mask);
            b_value_upper = unpack4xU8((b_value >> 4) & b_mask);
            b_quantized_values = ${kn}(${Array.from({length:4},(pn,Cn)=>`${Tn}(b_value_lower[${Cn}]), ${Tn}(b_value_upper[${Cn}])`).join(", ")});
            b_dequantized_values = ${at===1?`${kn}(${Array.from({length:8},(pn,Cn)=>`(b_quantized_values[${Cn}] - ${_n?`zero_point${lr}`:"zero_point"}) * scale${lr}`).join(", ")});`:`(b_quantized_values - ${kn}(${Array(8).fill(`${_n?`zero_point${lr}`:"zero_point"}`).join(",")})) * scale${lr};`};
            workgroup_shared[local_id.x * ${pt} + ${Math.floor(lr/ct)}]${ct>1?`[${lr%ct}]`:""} += ${Array.from({length:8/at},(pn,Cn)=>`${at===1?`a_data[${Cn}] * b_dequantized_values[${Cn}]`:`dot(a_data[${Cn}], b_dequantized_values[${Cn}])`}`).join(" + ")};
          `;return or},Sn=()=>{let or=`
            var col_index = col * ${ct};
            ${_n?`
            let zero_point_bytes_per_col = (nBlocksPerCol + 1) / 2;
            var zero_point_byte_count: u32;
            var zero_point_word_index: u32;
            var zero_point_byte_offset: u32;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            var zero_point_bits_offset: u32;
            var zero_point_word: u32;`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${Tn}(8);`}
            `;for(let lr=0;lr<ct*pt;lr++)or+=`
            let scale${lr} = ${yn.getByOffset("col_index * nBlocksPerCol + block")};
            ${_n?`
            zero_point_byte_count = col_index * zero_point_bytes_per_col + (block >> 0x1u);
            zero_point_word_index = zero_point_byte_count >> 0x2u;
            zero_point_byte_offset = zero_point_byte_count & 0x3u;
            zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            zero_point_word = ${_n.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point${lr} = ${Tn}((zero_point_word) & 0xFu);`:""}
            col_index += 1;`;return or},fn=()=>{let or=`col_index = col * ${ct};`;for(let lr=0;lr<ct*pt;lr++)or+=`
            let b${lr}_data = ${ur.getByIndices(`${ur.type.indices}(col_index, block, word)`)};
            col_index += 1;`;return or+=`
            var b_value: u32;
            let b_mask: u32 = 0x0F0F0F0Fu;
            var b_value_lower: vec4<u32>;
            var b_value_upper: vec4<u32>;
            var b_quantized_values: ${kn};
            var b_dequantized_values: ${kn};`,or};return`
        var<workgroup> workgroup_shared: array<${vn.type.value}, ${pt*dt}>;
        ${Bt.declareVariables(...hn,vn)}
        ${Bt.mainStart([dt,1,1])}
          let output_indices = ${vn.offsetToIndices(`(global_idx / ${dt}) * ${pt}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let nBlocksPerCol = uniforms.b_shape[1];

          for (var block = local_id.x; block < nBlocksPerCol; block += ${dt}) {
            //process one block
            var word_offset: u32 = block * ${s.blockSize/at};
            ${Sn()}
            for (var word: u32 = 0; word < ${_e}; word += ${it}) {
              ${fn()}
              for (var i: u32 = 0; i < ${it}; i++) {
                ${bn()}
                word_offset += ${8/at};
              }
            }
          }
          workgroupBarrier();

          if (local_id.x < ${pt}) {
            var output_value: ${vn.type.value} = ${vn.type.value}(0);
            var workgroup_shared_offset: u32 = local_id.x;
            for (var b: u32 = 0u; b < ${dt}u; b++) {
              output_value += workgroup_shared[workgroup_shared_offset];
              workgroup_shared_offset += ${pt};
            }
            ${vn.setByIndices(`${vn.type.indices}(batch, row, col + local_id.x)`,"output_value")};
          }
        }`};return{name:"MatMulNBits",shaderCache:{hint:`${s.blockSize};${s.bits};${at};${it};${ct};${pt};${dt}`,inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:mt,dataType:lt}],dispatchGroup:{x:zt},programUniforms:ft}),getShaderSource:Gt}},yh=(e,s)=>{let i=e[0].dims,c=i.length,d=i[c-2],h=s.k,_=s.n,g=i.slice(0,c-2),$=k.size(g),_e=e[1].dims[2]/4,lt=e[0].dataType,at=ce(s.k),it=ce(_e),ct=g.concat([d,_]),mt=128,pt=_%8===0?8:_%4===0?4:1,zt=mt/pt,dt=zt*it*8,ft=dt/at,kt=dt/s.blockSize,St=k.size(ct)/pt,Lt=[],Gt=[$,d,h/at],Bt=k.convertShape(e[1].dims).slice();Bt.splice(-1,1,_e/it),Lt.push(...N(Gt)),Lt.push(...N(Bt)),Lt.push(...N(e[2].dims)),e.length===4&&Lt.push(...N(k.convertShape(e[3].dims)));let nr=[$,d,_];Lt.push(...N(nr));let cr=ur=>{let yn=Gt.length,hn=P("a",e[0].dataType,yn,at),_n=P("b",12,Bt.length,it),gn=P("scales",e[2].dataType,e[2].dims.length),vn=[hn,_n,gn],Tn=e.length===4?P("zero_points",12,e[3].dims.length):void 0;Tn&&vn.push(Tn);let kn=nr.length,bn=M("output",e[0].dataType,kn),Sn=be(e[0].dataType),fn=()=>{switch(at){case 1:return`
          let a_data0 = vec4<${Sn}>(sub_a[word_offset], sub_a[word_offset + 1], sub_a[word_offset + 2], sub_a[word_offset + 3]);
          let a_data1 = vec4<${Sn}>(sub_a[word_offset + 4], sub_a[word_offset + 5], sub_a[word_offset + 6], sub_a[word_offset + 7]);`;case 2:return`
          let a_data0 = vec4<${Sn}>(sub_a[word_offset], sub_a[word_offset + 1]);
          let a_data1 = vec4<${Sn}>(sub_a[word_offset + 2], sub_a[word_offset + 3]);`;case 4:return`
          let a_data0 = sub_a[word_offset];
          let a_data1 = sub_a[word_offset + 1];`;default:throw new Error(`${at}-component is not supported.`)}};return`
        var<workgroup> sub_a: array<${hn.type.value}, ${ft}>;
        var<workgroup> inter_results: array<array<${bn.type.value}, ${zt}>, ${pt}>;
        ${ur.declareVariables(...vn,bn)}
        ${ur.mainStart([zt,pt,1])}
          let output_indices = ${bn.offsetToIndices(`workgroup_index * ${pt}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let n_blocks_per_col = uniforms.b_shape[1];
          let num_tiles =  (n_blocks_per_col - 1) / ${kt} + 1;

          // Loop over shared dimension.
          for (var tile: u32 = 0; tile < num_tiles; tile += 1) {
            let a_col_start = tile * ${ft};
            // load one tile A data into shared memory.
            for (var a_offset = local_idx; a_offset < ${ft}; a_offset += ${mt})
            {
              let a_col = a_col_start + a_offset;
              if (a_col < uniforms.a_shape[2])
              {
                sub_a[a_offset] = ${hn.getByIndices(`${hn.type.indices}(batch, row, a_col)`)};
              } else {
                sub_a[a_offset] = ${hn.type.value}(0);
              }
            }
            workgroupBarrier();

            // each thread process one block
            let b_row = col + local_id.y;
            let block = tile * ${kt} + local_id.x;
            ${Tn?`
            let zero_point_bytes_per_col = (n_blocks_per_col + 1) / 2;
            let zero_point_byte_count = b_row * zero_point_bytes_per_col + (block >> 0x1u);
            let zero_point_word_index = zero_point_byte_count >> 0x2u;
            let zero_point_byte_offset = zero_point_byte_count & 0x3u;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            let zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            let zero_point_word = ${Tn.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point = ${Sn}((zero_point_word) & 0xFu);`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${Sn}(8);`}
            let scale = ${gn.getByOffset("b_row * n_blocks_per_col + block")};
            let b_data = ${_n.getByIndices(`${_n.type.indices}(b_row, block, 0)`)};
            var word_offset = local_id.x * ${s.blockSize/at};
            for (var i: u32 = 0; i < ${it}; i++) {
              ${fn()}
              let b_value = ${it===1?"b_data":"b_data[i]"};
              let b_value_lower = unpack4xU8(b_value & 0x0F0F0F0Fu);
              let b_value_upper = unpack4xU8((b_value >> 4) & 0x0F0F0F0Fu);
              let b_quantized_values = mat2x4<${Sn}>(${Array.from({length:4},(or,lr)=>`${Sn}(b_value_lower[${lr}]), ${Sn}(b_value_upper[${lr}])`).join(", ")});
              let b_dequantized_values = (b_quantized_values - mat2x4<${Sn}>(${Array(8).fill("zero_point").join(",")})) * scale;
              inter_results[local_id.y][local_id.x] += ${Array.from({length:2},(or,lr)=>`${`dot(a_data${lr}, b_dequantized_values[${lr}])`}`).join(" + ")};
              word_offset += ${8/at};
            }
            workgroupBarrier();
          }

          if (local_idx < ${pt}) {
            var output_value: ${bn.type.value} = ${bn.type.value}(0);
            for (var b = 0u; b < ${zt}; b++) {
              output_value += inter_results[local_idx][b];
            }
            if (col + local_idx < uniforms.output_shape[2])
            {
              ${bn.setByIndices(`${bn.type.indices}(batch, row, col + local_idx)`,"output_value")}
            }
          }
        }`};return{name:"BlockwiseMatMulNBits32",shaderCache:{hint:`${s.blockSize};${at};${it};${zt};${pt}`,inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:ct,dataType:lt}],dispatchGroup:{x:St},programUniforms:Lt}),getShaderSource:cr}},Jd=(e,s)=>{gh(e.inputs,s),s.blockSize===32&&e.adapterInfo.isVendor("intel")&&e.adapterInfo.isArchitecture("gen-12lp")?e.compute(yh(e.inputs,s)):e.compute(bh(e.inputs,s))},el=e=>J(e)}),_h,wh,vh,$h,xh,Sh,Th,Ih,rl,nl=U(()=>{ee(),ne(),ie(),_h=e=>{if(!e||e.length<1)throw new Error("Too few inputs");if(e[0].dataType!==1&&e[0].dataType!==10)throw new Error("Input type must be float or float16.");if(e.length>=2){let s=e[0].dims.length*2===e[1].dims[0];if(e.length===4&&(s=e[3].dims[0]*2===e[1].dims[0]),!s)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},wh=(e,s,i)=>{let c="";for(let d=s-1;d>=0;--d)c+=`
            k = i32(${e.indicesGet("indices",d)}) - ${F("uniforms.pads",d,i)};
            if (k < 0) {
              break;
            }
            if (k >= i32(${F("uniforms.x_shape",d,s)})) {
              break;
            }
            offset += k * i32(${F("uniforms.x_strides",d,s)});
        `;return`
          value = ${e.type.value}(uniforms.constant_value);
          for (var i = 0; i < 1; i++) {
            var offset = 0;
            var k = 0;
            ${c}
            value = x[offset];
          }
      `},vh=(e,s,i)=>{let c="";for(let d=s-1;d>=0;--d)c+=`
                k = i32(${e.indicesGet("indices",d)}) - ${F("uniforms.pads",d,i)};
                if (k < 0) {
                  k = -k;
                }
                {
                  let _2n_1 = 2 * (i32(${F("uniforms.x_shape",d,s)}) - 1);
                  k = k % _2n_1;
                  if(k >= i32(${F("uniforms.x_shape",d,s)})) {
                    k = _2n_1 - k;
                  }
                }
                offset += k * i32(${F("uniforms.x_strides",d,s)});
            `;return`
              var offset = 0;
              var k = 0;
              ${c}
              value = x[offset];
          `},$h=(e,s,i)=>{let c="";for(let d=s-1;d>=0;--d)c+=`
                k = i32(${e.indicesGet("indices",d)}) - ${F("uniforms.pads",d,i)};
                if (k < 0) {
                  k = 0;
                }
                if (k >= i32(${F("uniforms.x_shape",d,s)})) {
                  k = i32(${F("uniforms.x_shape",d,s)}) - 1;
                }
                offset += k * i32(${F("uniforms.x_strides",d,s)});
            `;return`
              var offset = 0;
              var k = 0;
              ${c}
              value = x[offset];
          `},xh=(e,s,i)=>{let c="";for(let d=s-1;d>=0;--d)c+=`
                k = i32(${e.indicesGet("indices",d)}) - ${F("uniforms.pads",d,i)};
                if (k < 0)  {
                  k += i32(${F("uniforms.x_shape",d,s)}]);
                }
                if (k >= i32(${F("uniforms.x_shape",d,s)})) {
                  k -= i32(${F("uniforms.x_shape",d,s)});
                }
                offset += k * i32(${F("uniforms.x_strides",d,s)});
            `;return`
              var offset = 0;
              var k = 0;
              ${c}
              value = x[offset];
          `},Sh=(e,s,i)=>{switch(i.mode){case 0:return wh(e,s,i.pads.length);case 1:return vh(e,s,i.pads.length);case 2:return $h(e,s,i.pads.length);case 3:return xh(e,s,i.pads.length);default:throw new Error("Invalid mode")}},Th=(e,s)=>{let i=k.padShape(e[0].dims.slice(),s.pads),c=e[0].dims,d=k.size(i),h=[{type:12,data:d},{type:6,data:s.pads}],_=e.length>=3&&e[2].data;s.mode===0&&h.push({type:_?e[2].dataType:1,data:s.value}),h.push(...N(e[0].dims,i));let g=["rank"],$=_e=>{let lt=M("output",e[0].dataType,i.length),at=P("x",e[0].dataType,c.length),it=at.type.value,ct=Sh(lt,c.length,s),mt=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:s.pads.length}];return s.mode===0&&mt.push({name:"constant_value",type:_?it:"f32"}),`
            ${_e.registerUniforms(mt).declareVariables(at,lt)}
            ${_e.mainStart()}
            ${_e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

            let indices = ${lt.offsetToIndices("global_idx")};

            var value = ${it}(0);
            ${ct}
            output[global_idx] = value;
        }`};return{name:"Pad",shaderCache:{hint:`${s.mode}${_}`,inputDependencies:g},getRunData:()=>({outputs:[{dims:i,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(k.size(i)/64)},programUniforms:h}),getShaderSource:$}},Ih=(e,s)=>{if(e.length>1){let i=e[1].getBigInt64Array(),c=e.length>=3&&e[2].data?e[2].dataType===10?e[2].getUint16Array()[0]:e[2].getFloat32Array()[0]:0,d=e[0].dims.length,h=new Int32Array(2*d).fill(0);if(e.length>=4){let g=e[3].getBigInt64Array();for(let $=0;$<g.length;$++)h[Number(g[$])]=Number(i[$]),h[Number(g[$])+d]=Number(i[$+g.length])}else i.forEach((g,$)=>h[Number($)]=Number(g));let _=[];return h.forEach(g=>_.push(g)),{mode:s.mode,value:c,pads:_}}else return s},rl=(e,s)=>{_h(e.inputs);let i=Ih(e.inputs,s);e.compute(Th(e.inputs,i),{inputs:[0]})}}),rn,ol,il,al,sl,Ch,Ah,ul,dl,ll,cl,pl,ml,fl,hl,gl,bl,yl,_l,wl=U(()=>{We(),ee(),ne(),ie(),rn=e=>{if(ge.webgpu.validateInputContent&&(!e||e.length!==1))throw new Error("Pool ops requires 1 input.")},ol=(e,s,i)=>{let c=s.format==="NHWC",d=e.dims.slice();c&&d.splice(1,0,d.pop());let h=Object.hasOwnProperty.call(s,"dilations"),_=s.kernelShape.slice(),g=s.strides.slice(),$=h?s.dilations.slice():[],_e=s.pads.slice();Tt.adjustPoolAttributes(i,d,_,g,$,_e);let lt=Tt.computePoolOutputShape(i,d,g,$,_,_e,s.autoPad),at=Object.assign({},s);h?Object.assign(at,{kernelShape:_,strides:g,pads:_e,dilations:$,cacheKey:s.cacheKey}):Object.assign(at,{kernelShape:_,strides:g,pads:_e,cacheKey:s.cacheKey});let it=lt.slice();return it.push(it.splice(1,1)[0]),[at,c?it:lt]},il=(e,s)=>{let i=s.format==="NHWC",c=k.size(e),d=k.size(s.kernelShape),h=[{type:12,data:c},{type:12,data:d}],_=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(s.kernelShape.length<=2){let g=s.kernelShape[s.kernelShape.length-1],$=s.strides[s.strides.length-1],_e=s.pads[s.pads.length/2-1],lt=s.pads[s.pads.length-1],at=!!(_e+lt);h.push({type:12,data:g},{type:12,data:$},{type:12,data:_e},{type:12,data:lt}),_.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let it=!1;if(s.kernelShape.length===2){let ct=s.kernelShape[s.kernelShape.length-2],mt=s.strides[s.strides.length-2],pt=s.pads[s.pads.length/2-2],zt=s.pads[s.pads.length-2];it=!!(pt+zt),h.push({type:12,data:ct},{type:12,data:mt},{type:12,data:pt},{type:12,data:zt}),_.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[h,_,!0,at,it]}else{if(i)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let g=k.computeStrides(s.kernelShape);h.push({type:12,data:g},{type:12,data:s.pads},{type:12,data:s.strides}),_.push({name:"kernelStrides",type:"u32",length:g.length},{name:"pads",type:"u32",length:s.pads.length},{name:"strides",type:"u32",length:s.strides.length});let $=s.pads.reduce((_e,lt)=>_e+lt);return[h,_,!!$,!1,!1]}},al=(e,s,i,c,d,h,_,g,$,_e,lt,at)=>{let it=d.format==="NHWC",ct=s.type.value,mt=M("output",s.type.tensor,c);if(d.kernelShape.length<=2){let pt="",zt="",dt="",ft=i-(it?2:1);if(lt?pt=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${ft}] = indices[${ft}] * uniforms.sw - uniforms.pwStart + i;
                  if (xIndices[${ft}] < 0 || xIndices[${ft}]
                      >= uniforms.x_shape[${ft}]) {
                    pad++;
                    continue;
                  }
                  let x_val = x[${s.indicesToOffset("xIndices")}];
                  ${h}
                }`:pt=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${ft}] = indices[${ft}] * uniforms.sw - uniforms.pwStart + i;
                  let x_val = x[${s.indicesToOffset("xIndices")}];
                  ${h}
                }`,d.kernelShape.length===2){let kt=i-(it?3:2);at?zt=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${kt}] = indices[${kt}] * uniforms.sh - uniforms.phStart + j;
                  if (xIndices[${kt}] < 0 || xIndices[${kt}] >= uniforms.x_shape[${kt}]) {
                    pad += i32(uniforms.kw);
                    continue;
                  }
              `:zt=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${kt}] = indices[${kt}] * uniforms.sh - uniforms.phStart + j;
                `,dt=`
              }
            `}return`
            ${e.registerUniforms($).declareVariables(s,mt)}

            ${e.mainStart()}
              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

              let indices = ${mt.offsetToIndices("global_idx")};
              var xIndices = ${mt.offsetToIndices("global_idx")};

              var value = ${ct}(${g});
              var pad = 0;
              ${zt}
              ${pt}
              ${dt}
              ${_}

              output[global_idx] = value;
            }`}else{if(it)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let pt=d.kernelShape.length,zt=d.pads.length,dt="";return _e?dt=`
                if (xIndices[j] >= uniforms.x_shape[j]) {
                  pad++;
                  isPad = true;
                  break;
                }
              }
              if (!isPad) {
                let x_val = x[${s.indicesToOffset("xIndices")}];
                ${h}
              }`:dt=`
              }
              let x_val = x[${s.indicesToOffset("xIndices")}];
              ${h}
            `,`
            ${e.registerUniforms($).declareVariables(s,mt)}

            ${e.mainStart()}
              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
              let indices = ${mt.offsetToIndices("global_idx")};
              var xIndices = ${mt.offsetToIndices("global_idx")};

              var offsets: array<u32, ${pt}>;

              var value = ${ct}(${g});
              var pad = 0;
              var isPad = false;

              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {
                var offset = i;
                for (var j = 0u; j < ${pt-1}u; j++) {
                  offsets[j] = offset / ${F("uniforms.kernelStrides","j",pt)};
                  offset -= offsets[j] * ${F("uniforms.kernelStrides","j",pt)};
                }
                offsets[${pt-1}] = offset;

                isPad = false;
                for (var j = ${i-pt}u; j < ${i}u; j++) {
                  xIndices[j] = indices[j] * ${F("uniforms.strides",`j - ${i-pt}u`,pt)}
                    + offsets[j - ${i-pt}u] - ${F("uniforms.pads","j - 2u",zt)};
                  ${dt}
              }
              ${_}

              output[global_idx] = value;
            }`}},sl=e=>`${e.format};${e.ceilMode};${e.autoPad};${e.kernelShape.length}`,Ch=e=>`${sl(e)};${e.countIncludePad}`,Ah=e=>`${sl(e)};${e.storageOrder};${e.dilations}`,ul=e=>({format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}),dl=(e,s,i,c)=>{let[d,h]=ol(s,c,i),_=P("x",s.dataType,s.dims.length),g=_.type.value,$="value += x_val;",_e="";d.countIncludePad?_e+=`value /= ${g}(uniforms.kernelSize);`:_e+=`value /= ${g}(i32(uniforms.kernelSize) - pad);`;let[lt,at,it,ct,mt]=il(h,d);lt.push(...N(s.dims,h));let pt=["rank"];return{name:e,shaderCache:{hint:`${c.cacheKey};${it};${ct};${mt}`,inputDependencies:pt},getRunData:()=>({outputs:[{dims:h,dataType:s.dataType}],dispatchGroup:{x:Math.ceil(k.size(h)/64)},programUniforms:lt}),getShaderSource:zt=>al(zt,_,s.dims.length,h.length,d,$,_e,0,at,it,ct,mt)}},ll=e=>{let s=e.count_include_pad!==0,i=ul(e);if(i.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let c={countIncludePad:s,...i,cacheKey:""};return{...c,cacheKey:Ch(c)}},cl=(e,s)=>{rn(e.inputs),e.compute(dl("AveragePool",e.inputs[0],!1,s))},pl={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},ml=e=>{let s=e.format;return{format:s,...pl,cacheKey:s}},fl=(e,s)=>{rn(e.inputs),e.compute(dl("GlobalAveragePool",e.inputs[0],!0,s))},hl=(e,s,i,c)=>{let[d,h]=ol(s,c,i),_=`
      value = max(x_val, value);
    `,g="",$=P("x",s.dataType,s.dims.length),_e=["rank"],[lt,at,it,ct,mt]=il(h,d);return lt.push(...N(s.dims,h)),{name:e,shaderCache:{hint:`${c.cacheKey};${it};${ct};${mt}`,inputDependencies:_e},getRunData:()=>({outputs:[{dims:h,dataType:s.dataType}],dispatchGroup:{x:Math.ceil(k.size(h)/64)},programUniforms:lt}),getShaderSource:pt=>al(pt,$,s.dims.length,h.length,d,_,g,s.dataType===10?-65504:-1e5,at,it,ct,mt)}},gl=(e,s)=>{rn(e.inputs),e.compute(hl("MaxPool",e.inputs[0],!1,s))},bl=e=>{let s=e.storage_order,i=e.dilations,c=ul(e);if(s!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(c.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let d={storageOrder:s,dilations:i,...c,cacheKey:""};return{...d,cacheKey:Ah(d)}},yl=e=>{let s=e.format;return{format:s,...pl,cacheKey:s}},_l=(e,s)=>{rn(e.inputs),e.compute(hl("GlobalMaxPool",e.inputs[0],!0,s))}}),kh,Ph,vl,$l,xl=U(()=>{ee(),ne(),Se(),ie(),kh=(e,s)=>{if(e.length<2||e.length>3)throw new Error("DequantizeLinear requires 2 or 3 inputs.");if(e.length===3&&e[1].dims===e[2].dims)throw new Error("x-scale and x-zero-point must have the same shape.");if(e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(e[0].dataType===6&&e.length>2)throw new Error("In the case of dequantizing int32 there is no zero point.");if(e[1].dims.length!==0&&e[1].dims.length!==1&&e[1].dims.length!==e[0].dims.length)throw new Error("scale input must be a scalar, a 1D tensor, or have the same rank as the input tensor.");if(e.length>2){if(e[0].dataType!==e[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(e[1].dims.length!==e[2].dims.length)throw new Error("scale and zero-point inputs must have the same rank.");if(!e[1].dims.map((i,c)=>i===e[2].dims[c]).reduce((i,c)=>i&&c,!0))throw new Error("scale and zero-point inputs must have the same shape.")}if(s.blockSize>0){if(e[1].dims.length===0||e[1].dims.length===1&&e[1].dims[0]===1)throw new Error("blockSize must be set only for block quantization.");if(!e[1].dims.map((d,h)=>h===s.axis||d===e[0].dims[h]).reduce((d,h)=>d&&h,!0))throw new Error("For block qunatization, scale input shape to match the input shape except for the axis");if(e[1].dims.length!==e[0].dims.length)throw new Error("For block qunatization the scale input rank must be the same as the x rank.");let i=e[0].dims[s.axis],c=e[1].dims[s.axis];if(s.blockSize<Math.ceil(i/c)||s.blockSize>Math.ceil(i/(c-1)-1))throw new Error("blockSize must be with in the range [ceil(dI / Si), ceil(dI / (Si - 1) - 1)].")}},Ph=(e,s)=>{let i=k.normalizeAxis(s.axis,e[0].dims.length),c=e[0].dataType,d=c===3,h=e[0].dims,_=e[1].dataType,g=k.size(h),$=c===3||c===2,_e=$?[Math.ceil(k.size(e[0].dims)/4)]:e[0].dims,lt=e[1].dims,at=e.length>2?e[2]:void 0,it=at?$?[Math.ceil(k.size(at.dims)/4)]:at.dims:void 0,ct=lt.length===0||lt.length===1&&lt[0]===1,mt=ct===!1&&lt.length===1,pt=ce(g),zt=ct&&(!$||pt===4),dt=zt?pt:1,ft=zt&&!$?pt:1,kt=P("input",$?12:c,_e.length,ft),St=P("scale",_,lt.length),Lt=at?P("zero_point",$?12:c,it.length):void 0,Gt=M("output",_,h.length,dt),Bt=[kt,St];Lt&&Bt.push(Lt);let nr=[_e,lt];at&&nr.push(it);let cr=[{type:12,data:g/dt},{type:12,data:i},{type:12,data:s.blockSize},...N(...nr,h)],ur=yn=>{let hn=[{name:"output_size",type:"u32"},{name:"axis",type:"u32"},{name:"block_size",type:"u32"}];return`
      ${yn.registerUniforms(hn).declareVariables(...Bt,Gt)}
      ${yn.mainStart()}
          ${yn.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let output_indices = ${Gt.offsetToIndices("global_idx")};

          // Set input x
          ${$?`
            let input = ${kt.getByOffset("global_idx / 4")};
            let x_vec = ${d?"unpack4xI8(input)":"unpack4xU8(input)"};
            let x_value = ${dt===1?"x_vec[global_idx % 4]":"x_vec"};`:`let x_value = ${kt.getByOffset("global_idx")};`};

          // Set scale input
          ${ct?`let scale_value= ${St.getByOffset("0")}`:mt?`
            let scale_index = ${Gt.indicesGet("output_indices","uniforms.axis")};
            let scale_value= ${St.getByOffset("scale_index")};`:`
            var scale_indices: ${St.type.indices} = output_indices;
            let index = ${St.indicesGet("scale_indices","uniforms.axis")} / uniforms.block_size;
            ${St.indicesSet("scale_indices","uniforms.axis","index")};
            let scale_value= ${St.getByIndices("scale_indices")};`};

          // Set zero-point input
          ${Lt?ct?$?`
                let zero_point_input = ${Lt.getByOffset("0")};
                let zero_point_vec =  ${d?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value= zero_point_vec[0]`:`let zero_point_value = ${Lt.getByOffset("0")}`:mt?$?`
                let zero_point_index = ${Gt.indicesGet("output_indices","uniforms.axis")};
                let zero_point_input = ${Lt.getByOffset("zero_point_index / 4")};
                let zero_point_vec =  ${d?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_index % 4]`:`
                let zero_point_index = ${Gt.indicesGet("output_indices","uniforms.axis")};
                let zero_point_value = ${Lt.getByOffset("zero_point_index")};`:$?`
                let zero_point_offset = ${St.indicesToOffset("scale_indices")};
                let zero_point_input = ${Lt.getByOffset("zero_point_offset / 4")};
                let zero_point_vec = ${d?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_offset % 4];`:`let zero_point_value = ${Lt.getByIndices("scale_indices")};`:`let zero_point_value = ${$?d?"i32":"u32":kt.type.value}(0);`};
      // Compute and write output
      ${Gt.setByOffset("global_idx",`${Gt.type.value}(x_value - zero_point_value) * scale_value`)};
      }`};return{name:"DequantizeLinear",shaderCache:{hint:s.cacheKey,inputDependencies:Lt?["rank","rank","rank"]:["rank","rank"]},getShaderSource:ur,getRunData:()=>({outputs:[{dims:h,dataType:_}],dispatchGroup:{x:Math.ceil(g/dt/64),y:1,z:1},programUniforms:cr})}},vl=(e,s)=>{kh(e.inputs,s),e.compute(Ph(e.inputs,s))},$l=e=>J({axis:e.axis,blockSize:e.blockSize})}),zh,Oh,Sl,Tl=U(()=>{We(),ee(),ie(),zh=(e,s,i)=>{let c=e===s,d=e<s&&i<0,h=e>s&&i>0;if(c||d||h)throw new Error("Range these inputs' contents are invalid.")},Oh=(e,s,i,c)=>{let d=Math.abs(Math.ceil((s-e)/i)),h=[d],_=d,g=[{type:12,data:_},{type:c,data:e},{type:c,data:i},...N(h)],$=_e=>{let lt=M("output",c,h.length),at=lt.type.value,it=[{name:"outputSize",type:"u32"},{name:"start",type:at},{name:"delta",type:at}];return`
        ${_e.registerUniforms(it).declareVariables(lt)}
        ${_e.mainStart()}
        ${_e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        output[global_idx] = uniforms.start + ${at}(global_idx) * uniforms.delta;
      }`};return{name:"Range",shaderCache:{hint:`${c}`},getShaderSource:$,getRunData:()=>({outputs:[{dims:h,dataType:c}],dispatchGroup:{x:Math.ceil(_/64)},programUniforms:g})}},Sl=e=>{let s=0,i=0,c=0;e.inputs[0].dataType===6?(s=e.inputs[0].getInt32Array()[0],i=e.inputs[1].getInt32Array()[0],c=e.inputs[2].getInt32Array()[0]):e.inputs[0].dataType===1&&(s=e.inputs[0].getFloat32Array()[0],i=e.inputs[1].getFloat32Array()[0],c=e.inputs[2].getFloat32Array()[0]),ge.webgpu.validateInputContent&&zh(s,i,c),e.compute(Oh(s,i,c,e.inputs[0].dataType),{inputs:[]})}}),Bh,Il,Cl,Dh,Al,El,kl=U(()=>{ee(),ne(),Se(),ie(),Bh=(e,s,i,c)=>{if(e!=="none"&&c!=="i32"&&c!=="u32"&&c!=="f32")throw new Error(`Input ${c} is not supported with reduction ${e}.`);let d=`{
                var oldValue = 0;
                loop {
                  let newValueF32 =`,h=`;
                  let newValue = bitcast<i32>(newValueF32);
                  let res = atomicCompareExchangeWeak(&${s}, oldValue, newValue);
                  if res.exchanged {
                    break;
                  }
                  oldValue = res.old_value;
                }
              }`;switch(e){case"none":return`${s}=${i};`;case"add":return c==="i32"||c==="u32"?`atomicAdd(&${s}, bitcast<${c}>(${i}));`:`
              ${d}bitcast<${c}>(oldValue) + (${i})${h}`;case"max":return c==="i32"||c==="u32"?`atomicMax(&${s}, bitcast<${c}>(${i}));`:`
                ${d}max(bitcast<f32>(oldValue), (${i}))${h}`;case"min":return c==="i32"||c==="u32"?`atomicMin(&${s}, bitcast<${c}>(${i}));`:`${d}min(bitcast<${c}>(oldValue), (${i}))${h}`;case"mul":return`${d}(bitcast<${c}>(oldValue) * (${i}))${h}`;default:throw new Error(`Reduction ${e} is not supported.`)}},Il=(e,s)=>`${e===1?`
    let element_count_dim = uniforms.output_strides;
    let dim_value = uniforms.output_shape;`:`
    let element_count_dim = uniforms.output_strides[${s?"i - indices_start":"i"}];
    let dim_value = uniforms.output_shape[${s?"i - indices_start":"i"} + uniforms.last_index_dimension];`}
    
    if (index >= 0) {
      if (index >= i32(dim_value)) {
        index = i32(dim_value - 1);
      }
    } else {
      if (index < -i32(dim_value)) {
        index = 0;
      } else {
        index += i32(dim_value);
      }
    }
    data_offset += u32((u32(index) * element_count_dim));`,Cl=(e,s,i)=>`for (var i = 0u; i < uniforms.num_updates_elements; i++) {
        let value = updates[uniforms.num_updates_elements * ${i?"global_idx":"idx"} + i];
        ${Bh(e.reduction,"output[data_offset + i]","value",s)}
      }`,Dh=(e,s)=>{let i=e[0].dims,c=e[1].dims,d=i,h=1,_=Math.ceil(k.size(c)/h),g=c[c.length-1],$=k.sizeFromDimension(i,g),_e=k.sizeFromDimension(c,0)/g,lt=[{type:12,data:_},{type:12,data:g},{type:12,data:$},...N(e[1].dims,e[2].dims,d)],at=it=>{let ct=P("indices",e[1].dataType,e[1].dims.length),mt=P("updates",e[2].dataType,e[2].dims.length,h),pt=s.reduction!=="none"&&s.reduction!==""?es("output",e[0].dataType,d.length):M("output",e[0].dataType,d.length,h);return`
      ${it.registerUniform("output_size","u32").registerUniform("last_index_dimension","u32").registerUniform("num_updates_elements","u32").declareVariables(ct,mt,pt)}
      ${it.mainStart()}
        ${it.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
  var hasDuplicates = false;
  if (${s.reduction==="none"}) {
    for (var i = 0; i < ${_e}; i = i + 1) {
      for (var j = i + 1; j < ${_e}; j = j + 1) {
        var index_i = i32(indices[i].x);
        var index_j = i32(indices[j].x);
        if (index_i == index_j) {
          hasDuplicates = true;
          break;
        }
      }
      if (hasDuplicates) {
        break;
      }
    }
  }

  if (${s.reduction==="none"} && hasDuplicates) {
    if (global_idx != 0u) {
      return;
    }
    // Process each index-update pair individually when duplicates exist
    for (var idx = 0u; idx < ${_e}u; idx++) {
      var data_offset = 0u;
      for (var i = 0u; i < uniforms.last_index_dimension; i++) {
        var index = i32(indices[idx * uniforms.last_index_dimension + i].x);
        ${Il(i.length,!1)}
      }
      ${Cl(s,pt.type.value,!1)}
    }
    return;
  }

  var data_offset = 0u;
  var indices_start = uniforms.last_index_dimension * global_idx;
  var indices_end = indices_start + uniforms.last_index_dimension;
  for (var i = indices_start; i < indices_end; i++) {
    var index = i32(indices[i].x);
    ${Il(i.length,!0)}
  }
  ${Cl(s,pt.type.value,!0)}
  }`};return{name:"ScatterND",shaderCache:{hint:`${s.cacheKey}_${s.reduction}`,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:d,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(_/64)},programUniforms:lt}),getShaderSource:at}},Al=e=>J({reduction:e.reduction}),El=(e,s)=>{e.compute(Dh(e.inputs,s),{inputs:[e.inputs[1],e.inputs[2]],outputs:[]})}}),Mh,Rh,Uh,Pl,Nh,Vh,Wh,Lh,Gh,Hh,Fh,qh,zl,jh,Kh,Zh,Qh,Yh,Ol,Bl,Dl=U(()=>{ee(),ne(),Se(),ie(),Mh=(e,s)=>{if(e.every(i=>i>0||(()=>{throw new Error("Resize requires scales input values to be positive")})),e.length>0){if(s.mode==="linear"){if(!(e.length===2||e.length===3||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1||e.length===5&&e[0]===1&&e[1]===1))throw new Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and
            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if(s.mode==="cubic"&&!(e.length===2||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},Rh=(e,s,i)=>{s.every(d=>d>=0&&d<i||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")}));let c=new Array(i).fill(1);return s.forEach((d,h)=>c[d]=e[h]),c},Uh=(e,s,i,c,d,h)=>{let[_,g,$]=i>10?[1,2,3]:[-1,e.length>1?1:-1,-1],_e=e[0].dims.length;if(_>0&&e.length>_&&e[_].dims.length>0)e[_].getFloat32Array().forEach(lt=>h.push(lt));else if(s.coordinateTransformMode==="tf_crop_and_resize")throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(g>0&&e.length>g&&e[g].dims.length===1&&e[g].dims[0]>0){if(e[g].getFloat32Array().forEach(lt=>c.push(lt)),c.length!==0&&c.length!==_e&&i>=18&&c.length!==s.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");Mh(c,s),s.axes.length>0&&Rh(c,s.axes,_e).forEach((lt,at)=>c[at]=lt)}if($>0&&e.length>$&&e[$].dims.length===1&&e[$].dims[0]>0&&(e[$].getBigInt64Array().forEach(lt=>d.push(Number(lt))),d.length!==0&&d.length!==_e&&i>=18&&d.length!==s.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(s.axes.length>0){if(c.length!==0&&c.length!==s.axes.length)throw new Error('Resize requires "scales" input size to be of axes rank when axes attributes is specified');if(d.length!==0&&d.length!==s.axes.length)throw new Error('Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified')}if(typeof c<"u"&&typeof d<"u"&&c.length>0&&d.length>_e)throw new Error("Resize requires only of scales or sizes to be specified")},Pl=(e,s,i,c)=>`
  // The whole part and the fractional part are calculated separately due to inaccuracy of floating
  // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an
  // offset-by-one error later in floor().
  let big = (${e}) * (${s});
  let whole = ${c}(big / (${i}));
  let fract = ${c}(big % (${i})) / ${c}(${i});
  return whole + fract;
`,Nh=(e,s)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,
     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${s} { `+(()=>{switch(e){case"asymmetric":return`
          if (xScale < 1.0 || floor(xScale) != xScale) {
            return ${s}(xResized) / ${s}(xScale);
          } else {
            ${Pl("xResized","lengthOriginal","lengthResized",s)}
          }
        `;case"pytorch_half_pixel":return`if (lengthResized > 1) {
                    return (${s}(xResized) + 0.5) / ${s}(xScale) - 0.5;
                  } else {
                    return 0.0;
                  }`;case"tf_half_pixel_for_nn":return`return (${s}(xResized) + 0.5) / ${s}(xScale);`;case"align_corners":return`if (lengthResized == 1) {
                    return 0.0;
                  } else {
                    ${Pl("xResized","lengthOriginal - 1","lengthResized - 1",s)}
                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {
                    return ${s}(roiStart) * ${s}(lengthOriginal - 1) +
                        (${s}(xResized) * ${s}(roiEnd - roiStart) * ${s}(lengthOriginal - 1)) /
                        ${s}(lengthResized - 1);
                  } else {
                    return 0.5 * ${s}(roiStart + roiEnd) * ${s}(lengthOriginal - 1);
                  }`;case"half_pixel_symmetric":return`const outputWidth = ${s}xScale * ${s}(lengthResized);
                  const adjustment = ${s}(lengthResized) / outputWidth;
                  const center = ${s}(lengthOriginal) / 2;
                  const offset = center * (1 - adjustment);
                  return offset + ((${s}(xResized) + 0.5) / ${s}(xScale)) - 0.5;`;case"half_pixel":return`return ((${s}(xResized) + 0.5) / ${s}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${e} is not supported`)}})()+"}",Vh=(e,s,i)=>`fn getNearestPixelFromOriginal(xOriginal: ${i}, isDownSample: bool) -> ${i} {`+(()=>{switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";case"simple":default:if(s<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${e} is not supported`)}})()+"}",Wh=(e,s,i)=>{let c=new Array(i).fill(0).concat(new Array(i).fill(1)),d=e.length===0?c:e.slice();return s.length>0?(s.forEach((h,_)=>{c[h]=d[_],c[_+i]=d[s.length+_]}),c):d},Lh=(e,s,i,c)=>{let d=[];if(i.length>0)if(c.length>0){if(e.forEach(h=>d.push(h)),Math.max(...c)>e.length)throw new Error("axes is out of bound");c.forEach((h,_)=>d[h]=i[_])}else i.forEach(h=>d.push(h));else{if(s.length===0)throw new Error("Resize requires either scales or sizes.");d=e.map((h,_)=>Math.round(h*s[_]))}return d},Gh=(e,s,i)=>{let c=(()=>{switch(i.keepAspectRatioPolicy){case"not_larger":return i.axes.length>0?Math.min(...i.axes.map(h=>s[h]),Number.MAX_VALUE):Math.min(...s,Number.MAX_VALUE);case"not_smaller":return i.axes.length>0?Math.max(...i.axes.map(h=>s[h]),Number.MIN_VALUE):Math.max(...s,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${i.keepAspectRatioPolicy} is not supported`)}})();s.fill(1,0,s.length);let d=e.slice();return i.axes.length>0?(i.axes.forEach(h=>s[h]=c),i.axes.forEach(h=>d[h]=Math.round(e[h]*s[h]))):(s.fill(c,0,s.length),d.forEach((h,_)=>d[_]=Math.round(h*s[_]))),d},Hh=(e,s,i,c,d)=>`
    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> array<${e.type.value}, ${i.length}> {
      var original_indices: array<${e.type.value}, ${i.length}>;
      for (var i:u32 = 0; i < ${i.length}; i++) {
        var output_index = ${e.indicesGet("output_indices","i")};
        var scale = ${F("uniforms.scales","i",c)};
        var roi_low = ${F("uniforms.roi","i",d)};
        var roi_hi = ${F("uniforms.roi",`i + ${s.length}`,d)};
        if (scale == 1.0) {
          original_indices[i] = ${e.type.value}(output_index);
        } else {
          var input_shape_i = ${F("uniforms.input_shape","i",s.length)};
          var output_shape_i = ${F("uniforms.output_shape","i",i.length)};
          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                           input_shape_i, roi_low, roi_hi);
        }
      }
      return original_indices;
    }`,Fh=(e,s,i,c,d,h,_)=>`
    fn calculateInputIndicesFromOutputIndices(output_indices: ${s.type.indices}) -> ${e.type.indices} {
      var input_indices: ${e.type.indices};
      for (var i:u32 = 0; i < ${c.length}; i++) {
        var output_index = ${s.indicesGet("output_indices","i")};
        var input_index: u32;
        var scale = ${F("uniforms.scales","i",d)};
        if (scale == 1.0) {
          input_index = output_index;
        } else {
          var roi_low = ${F("uniforms.roi","i",h)};
          var roi_hi = ${F("uniforms.roi",`i + ${i.length}`,h)};
          var input_shape_i = ${F("uniforms.input_shape","i",i.length)};
          var output_shape_i = ${F("uniforms.output_shape","i",c.length)};
          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                        input_shape_i, roi_low, roi_hi);
          if (!${_} || (original_idx >= 0 && original_idx < ${s.type.value}(input_shape_i))) {
            if (original_idx < 0) {
              input_index = 0;
            } else if (original_idx > ${s.type.value}(input_shape_i - 1)) {
              input_index = input_shape_i - 1;
            } else {
              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));
            }
          } else {
            input_index = u32(original_idx);
          }
        }
        ${e.indicesSet("input_indices","i","input_index")}
      }
      return input_indices;
    }`,qh=(e,s)=>`
    fn checkInputIndices(input_indices: ${e.type.indices}) -> bool {
      for (var i:u32 = 0; i < ${s.length}; i++) {
        var input_index = ${e.indicesGet("input_indices","i")};
        if (input_index < 0 || input_index >= ${F("uniforms.input_shape","i",s.length)}) {
          return false;
        }
      }
      return true;
    }`,zl=(e,s,i,c)=>e.rank>c?`
    ${e.indicesSet("input_indices",s,"channel")};
    ${e.indicesSet("input_indices",i,"batch")};
`:"",jh=(e,s,i,c,d)=>{let[h,_,g,$]=i.length===2?[-1,0,1,-1]:[0,2,3,1],_e=e.type.value;return`
    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${_e} {
      var input_indices: ${e.type.indices};
      ${e.indicesSet("input_indices",_,`max(0, min(row, ${i[_]} - 1))`)};
      ${e.indicesSet("input_indices",g,`max(0, min(col, ${i[g]} - 1))`)};
      ${zl(e,$,h,2)}
      return ${e.getByIndices("input_indices")};
    }

    fn bilinearInterpolation(output_indices: ${s.type.indices}) -> ${_e} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var row:${_e} = originalIndices[${_}];
      var col:${_e} = originalIndices[${g}];
      ${c?`if (row < 0 || row > (${i[_]} - 1) || col < 0 || col > (${i[g]} - 1)) {
        return ${d};
      }`:""};
      row = max(0, min(row, ${i[_]} - 1));
      col = max(0, min(col, ${i[g]} - 1));
      var row1: u32 = u32(row);
      var col1: u32 = u32(col);
      var row2: u32 = u32(row + 1);
      var col2: u32 = u32(col + 1);
      var channel: u32 = ${i.length>2?`u32(originalIndices[${$}])`:"0"};
      var batch: u32 =  ${i.length>2?`u32(originalIndices[${h}])`:"0"};
      var x11: ${_e} = getInputValue(batch, channel, row1, col1);
      var x12: ${_e} = getInputValue(batch, channel, row1, col2);
      var x21: ${_e} = getInputValue(batch, channel, row2, col1);
      var x22: ${_e} = getInputValue(batch, channel, row2, col2);
      var dx1: ${_e} = abs(row - ${_e}(row1));
      var dx2: ${_e} = abs(${_e}(row2) - row);
      var dy1: ${_e} = abs(col - ${_e}(col1));
      var dy2: ${_e} = abs(${_e}(col2) - col);
      if (row1 == row2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (col1 == col2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);
    }`},Kh=(e,s,i,c,d,h,_,g,$,_e)=>{let lt=i.length===2,[at,it]=lt?[0,1]:[2,3],ct=e.type.value,mt=pt=>{let zt=pt===at?"row":"col";return`
      fn ${zt}CubicInterpolation(input_indices: ${e.type.indices}, output_indices: ${s.type.indices}) -> ${ct} {
        var output_index = ${s.indicesGet("output_indices",pt)};
        var originalIdx: ${ct} = getOriginalCoordinateFromResizedCoordinate(output_index, ${d[pt]},
        ${c[pt]}, ${i[pt]}, ${h[pt]}, ${h[pt]} + ${i.length});
        var fractOriginalIdx: ${ct} = originalIdx - floor(originalIdx);
        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);

        if (${g} && (originalIdx < 0 || originalIdx > (${i[pt]} - 1))) {
          return ${$};
        }
        var data: array<${ct}, 4> = array<${ct}, 4>(0.0, 0.0, 0.0, 0.0);
        for (var i: i32 = -1; i < 3; i++) {
          var ${zt}: ${ct} = originalIdx + ${ct}(i);
          if (${zt} < 0 || ${zt} >= ${i[pt]}) {
            ${_e?`coefs[i + 1] = 0.0;
                        continue;`:g?`return ${$};`:`${zt} = max(0, min(${zt}, ${i[pt]} - 1));`};
          }
        var input_indices_copy: ${e.type.indices} = input_indices;
          ${e.indicesSet("input_indices_copy",pt,`u32(${zt})`)};
          data[i + 1] = ${pt===at?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};
        }
        return cubicInterpolation1D(data, coefs);
      }`};return`
    ${mt(at)};
    ${mt(it)};
  fn getCubicInterpolationCoefs(s: ${ct}) -> array<${ct}, 4> {
    var absS = abs(s);
    var coeffs: array<${ct}, 4> = array<${ct}, 4>(0.0, 0.0, 0.0, 0.0);
    var oneMinusAbsS: ${ct} = 1.0 - absS;
    var twoMinusAbsS: ${ct} = 2.0 - absS;
    var onePlusAbsS: ${ct} = 1.0 + absS;
    coeffs[0] = ((${_} * onePlusAbsS - 5 * ${_}) * onePlusAbsS + 8 * ${_}) * onePlusAbsS - 4 * ${_};
    coeffs[1] = ((${_} + 2) * absS - (${_} + 3)) * absS * absS + 1;
    coeffs[2] = ((${_} + 2) * oneMinusAbsS - (${_} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;
    coeffs[3] = ((${_} * twoMinusAbsS - 5 * ${_}) * twoMinusAbsS + 8 * ${_}) * twoMinusAbsS - 4 * ${_};
    return coeffs;
  }

  fn cubicInterpolation1D(x: array<${ct}, 4>, coefs: array<${ct}, 4>) -> ${ct} {
    var coefsSum: ${ct} = coefs[0] + coefs[1] + coefs[2] + coefs[3];
    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;
  }

  fn bicubicInterpolation(output_indices: ${s.type.indices}) -> ${ct} {
    var input_indices: ${e.type.indices} = output_indices;
    return colCubicInterpolation(input_indices, output_indices);
  }
    `},Zh=(e,s,i,c,d)=>{let[h,_,g,$,_e]=i.length===3?[-1,0,1,2,-1]:[0,2,3,4,1],lt=e.type.value;return`
    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${lt} {
      var input_indices: ${e.type.indices};
      ${e.indicesSet("input_indices",_,`max(0, min(depth, ${i[_]} - 1))`)};
      ${e.indicesSet("input_indices",g,`max(0, min(height, ${i[g]} - 1))`)};
      ${e.indicesSet("input_indices",$,`max(0, min(width, ${i[$]} - 1))`)};
      ${zl(e,_e,h,3)}
      return ${e.getByIndices("input_indices")};
    }

    fn trilinearInterpolation(output_indices: ${s.type.indices}) -> ${lt} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var depth:${lt} = originalIndices[${_}];
      var height:${lt} = originalIndices[${g}];
      var width:${lt} = originalIndices[${$}];
      ${c?`if (depth < 0 || depth > (${i[_]} - 1) || height < 0 || height > (${i[g]} - 1) || width < 0 || (width > ${i[$]} - 1)) {
      return ${d};
        }`:""};

    depth = max(0, min(depth, ${i[_]} - 1));
      height = max(0, min(height, ${i[g]} - 1));
      width = max(0, min(width, ${i[$]} - 1));
      var depth1: u32 = u32(depth);
      var height1: u32 = u32(height);
      var width1: u32 = u32(width);
      var depth2: u32 = u32(depth + 1);
      var height2: u32 = u32(height + 1);
      var width2: u32 = u32(width + 1);
      var channel: u32 = ${i.length>3?`u32(originalIndices[${_e}])`:"0"};
      var batch: u32 =  ${i.length>3?`u32(originalIndices[${h}])`:"0"};

      var x111: ${lt} = getInputValue(batch, channel, depth1, height1, width1);
      var x112: ${lt} = getInputValue(batch, channel, depth1, height1, width2);
      var x121: ${lt} = getInputValue(batch, channel, depth1, height2, width1);
      var x122: ${lt} = getInputValue(batch, channel, depth1, height2, width2);
      var x211: ${lt} = getInputValue(batch, channel, depth2, height1, width1);
      var x212: ${lt} = getInputValue(batch, channel, depth2, height1, width2);
      var x221: ${lt} = getInputValue(batch, channel, depth2, height2, width1);
      var x222: ${lt} = getInputValue(batch, channel, depth2, height2, width2);
      var dx1: ${lt} = abs(depth - ${lt}(depth1));
      var dx2: ${lt} = abs(${lt}(depth2) - depth);
      var dy1: ${lt} = abs(height - ${lt}(height1));
      var dy2: ${lt} = abs(${lt}(height2) - height);
      var dz1: ${lt} = abs(width - ${lt}(width1));
      var dz2: ${lt} = abs(${lt}(width2) - width);
      if (depth1 == depth2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (height1 == height2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      if (width1 == width2) {
        dz1 = 0.5;
        dz2 = 0.5;
      }
      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +
              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);
    }`},Qh=(e,s,i,c,d,h)=>{let _=e.dims,g=Wh(h,s.axes,_.length),$=Lh(_,c,d,s.axes),_e=c.slice();c.length===0&&(_e=_.map((ft,kt)=>ft===0?1:$[kt]/ft),s.keepAspectRatioPolicy!=="stretch"&&($=Gh(_,_e,s)));let lt=M("output",e.dataType,$.length),at=P("input",e.dataType,_.length),it=k.size($),ct=_.length===$.length&&_.every((ft,kt)=>ft===$[kt]),mt=s.coordinateTransformMode==="tf_crop_and_resize",pt=s.extrapolationValue,zt=at.type.value,dt=ft=>`
      ${ct?"":`
      ${Nh(s.coordinateTransformMode,zt)};
      ${(()=>{switch(s.mode){case"nearest":return`
              ${qh(at,_)};
              ${Vh(s.nearestMode,i,zt)};
              ${Fh(at,lt,_,$,_e.length,g.length,mt)};
              `;case"linear":return`
              ${Hh(lt,_,$,_e.length,g.length)};
              ${(()=>{if(_.length===2||_.length===4)return`${jh(at,lt,_,mt,pt)}`;if(_.length===3||_.length===5)return`${Zh(at,lt,_,mt,pt)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};
            `;case"cubic":return`
            ${(()=>{if(_.length===2||_.length===4)return`${Kh(at,lt,_,$,_e,g,s.cubicCoeffA,mt,s.extrapolationValue,s.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};
            `;default:throw Error("Invalid resize mode")}})()};
      `}
      ${ft.registerUniform("output_size","u32").registerUniform("scales","f32",_e.length).registerUniform("roi","f32",g.length).declareVariables(at,lt)}
      ${ft.mainStart()}
        ${ft.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
        ${ct?"output[global_idx] = input[global_idx];":`
        let output_indices = ${lt.offsetToIndices("global_idx")};
        var input_indices: ${at.type.indices};
        ${(()=>{switch(s.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);
                if (checkInputIndices(input_indices)) {
                  output[global_idx] = ${at.getByIndices("input_indices")};
                } else {
                  output[global_idx] = ${s.extrapolationValue};
                }`;case"linear":return`output[global_idx] = ${_.length===2||_.length===4?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${s.mode}`)}})()};
`}
      }`;return{name:"Resize",shaderCache:{hint:`${s.cacheKey}|${i}|${_e.length>0?s.mode==="cubic"?_e:_e.length:""}|${d.length>0?d:""}|${g.length>0?g:""}|${ct}|${s.mode==="nearest"?_.length:_}`,inputDependencies:["rank"]},getShaderSource:dt,getRunData:()=>({outputs:[{dims:$,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(it/64)},programUniforms:[{type:12,data:it},{type:1,data:_e},{type:1,data:g},...N(_,$)]})}},Yh=e=>{let s=e.customDataBuffer;return new Uint32Array(s,s.byteOffset,1)[0]},Ol=(e,s)=>{let i=[],c=[],d=[],h=Yh(e);if(s.antialias!==0)throw Error("Only default value (0) for Antialias attribute is supported");Uh(e.inputs,s,h,i,c,d),e.compute(Qh(e.inputs[0],s,h,i,c,d),{inputs:[0]})},Bl=e=>{let s=e.antialias,i=e.axes,c=e.coordinateTransformMode,d=e.cubicCoeffA,h=e.excludeOutside!==0,_=e.extrapolationValue,g=e.keepAspectRatioPolicy,$=e.mode,_e=e.nearestMode===""?"simple":e.nearestMode;return J({antialias:s,axes:i,coordinateTransformMode:c,cubicCoeffA:d,excludeOutside:h,extrapolationValue:_,keepAspectRatioPolicy:g,mode:$,nearestMode:_e})}}),Xh,Jh,Ml,Rl=U(()=>{ee(),ne(),ie(),Xh=e=>{if(!e||e.length<3)throw new Error("layerNorm requires at least 3 inputs.");let s=e[0],i=e[1],c=e[2];if(s.dataType!==i.dataType||s.dataType!==c.dataType)throw new Error("All inputs must have the same data type");if(s.dims.length!==3&&s.dims.length!==2)throw new Error("Input must be 2D or 3D");if(i.dims.length!==3&&i.dims.length!==2)throw new Error("Skip must be 2D or 3D");let d=s.dims[s.dims.length-1],h=s.dims[s.dims.length-2];if(i.dims[i.dims.length-1]!==d)throw new Error("Skip must have the same hidden size as input");if(i.dims[i.dims.length-2]!==h)throw new Error("Skip must have the same sequence length as input");if(c.dims.length!==1)throw new Error("Gamma must be 1D");if(c.dims[c.dims.length-1]!==d)throw new Error("Gamma must have the same hidden size as input");if(e.length>3){let _=e[3];if(_.dims.length!==1)throw new Error("Beta must be 1D");if(_.dims[_.dims.length-1]!==d)throw new Error("Beta must have the same hidden size as input")}if(e.length>4){let _=e[4];if(_.dims.length!==1)throw new Error("Bias must be 1D");if(_.dims[_.dims.length-1]!==d)throw new Error("Bias must have the same hidden size as input")}},Jh=(e,s,i,c)=>{let d=s.simplified,h=e[0].dims,_=k.size(h),g=h,$=_,_e=h.slice(-1)[0],lt=c?h.slice(0,-1).concat(1):[],at=!d&&e.length>3,it=e.length>4,ct=c&&i>1,mt=c&&i>2,pt=i>3,zt=64,dt=ce(_e),ft=[{type:12,data:$},{type:12,data:dt},{type:12,data:_e},{type:1,data:s.epsilon}],kt=Lt=>{let Gt=[{name:"output_size",type:"u32"},{name:"components",type:"u32"},{name:"hidden_size",type:"u32"},{name:"epsilon",type:"f32"}],Bt=[P("x",e[0].dataType,e[0].dims,dt),P("skip",e[1].dataType,e[1].dims,dt),P("gamma",e[2].dataType,e[2].dims,dt)];at&&Bt.push(P("beta",e[3].dataType,e[3].dims,dt)),it&&Bt.push(P("bias",e[4].dataType,e[4].dims,dt)),Bt.push(M("output",e[0].dataType,g,dt)),ct&&Bt.push(M("mean_output",1,lt)),mt&&Bt.push(M("inv_std_output",1,lt)),pt&&Bt.push(M("input_skip_bias_sum",e[0].dataType,g,dt));let nr=be(e[0].dataType),cr=be(1,dt);return`

      ${Lt.registerUniforms(Gt).declareVariables(...Bt)}
      var<workgroup> sum_shared : array<${cr}, ${zt}>;
      var<workgroup> sum_squared_shared : array<${cr}, ${zt}>;

      ${Lt.mainStart([zt,1,1])}
        let ix = local_id.x;
        let iy = global_id.x / ${zt};

        let hidden_size_vectorized: u32 = uniforms.hidden_size / uniforms.components;
        var stride = hidden_size_vectorized / ${zt};
        let offset = ix * stride + iy * hidden_size_vectorized;
        let offset1d = stride * ix;
        if (ix == ${zt-1}) {
          stride = hidden_size_vectorized - stride * ix;
        }
        for (var i: u32 = 0; i < stride; i++) {
          let skip_value = skip[offset + i];
          let bias_value = ${it?"bias[offset1d + i]":nr+"(0.0)"};
          let input_value = x[offset + i];
          let value = input_value + skip_value + bias_value;
          ${pt?"input_skip_bias_sum[offset + i] = value;":""}
          output[offset + i] = value;
          let f32_value = ${Ct(nr,dt,"value")};
          sum_shared[ix] += f32_value;
          sum_squared_shared[ix] += f32_value * f32_value;
        }
        workgroupBarrier();

        var reduce_size : u32 = ${zt};
        for (var curr_size = reduce_size >> 1;  curr_size > 0; curr_size = reduce_size >> 1) {
          reduce_size = curr_size + (reduce_size & 1);
          if (ix < curr_size) {
            sum_shared[ix] += sum_shared[ix + reduce_size];
            sum_squared_shared[ix] += sum_squared_shared[ix + reduce_size];
          }
          workgroupBarrier();
        }

        let sum = sum_shared[0];
        let square_sum = sum_squared_shared[0];
        let mean = ${He("sum",dt)} / f32(uniforms.hidden_size);
        let inv_std_dev = inverseSqrt(${He("square_sum",dt)} / f32(uniforms.hidden_size) ${d?"":"- mean * mean"} + uniforms.epsilon);
        ${ct?"mean_output[global_idx] = mean;":""}
        ${mt?"inv_std_output[global_idx] = inv_std_dev;":""}

        for (var i: u32 = 0; i < stride; i++) {
          output[offset + i] = (output[offset + i] ${d?"":`- ${nr}(mean)`}) *
            ${nr}(inv_std_dev) * gamma[offset1d + i]
            ${at?"+ beta[offset1d + i]":""};
        }
      }`},St=[{dims:g,dataType:e[0].dataType}];return i>1&&St.push({dims:lt,dataType:1}),i>2&&St.push({dims:lt,dataType:1}),i>3&&St.push({dims:h,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:`${dt};${ct};${mt};${pt}`,inputDependencies:e.map((Lt,Gt)=>"type")},getShaderSource:kt,getRunData:()=>({outputs:St,dispatchGroup:{x:Math.ceil($/_e)},programUniforms:ft})}},Ml=(e,s)=>{Xh(e.inputs);let i=[0];e.outputCount>1&&i.push(-3),e.outputCount>2&&i.push(-3),e.outputCount>3&&i.push(3),e.compute(Jh(e.inputs,s,e.outputCount,!1),{outputs:i})}}),eg,nn,tg,Ul,rg,ng,Nl,Vl,Wl=U(()=>{ee(),ne(),Se(),ie(),eg=(e,s)=>{if(!e||e.length<1)throw new Error("too few inputs");if(s.axes.length!==0){if(s.axes.length!==s.starts.length||s.axes.length!==s.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(s.starts.length!==s.ends.length)throw new Error("starts and ends must have the same length");e.slice(1).forEach((i,c)=>{if(e[c+1].dataType!==6&&e[c+1].dataType!==7)throw new Error(`Input ${c} must be an array of int32 or int64`)})},nn=(e,s)=>{let i=[];if(e.length>s)if(e[s].dataType===7)e[s].getBigInt64Array().forEach(c=>i.push(Number(c)));else if(e[s].dataType===6)e[s].getInt32Array().forEach(c=>i.push(Number(c)));else throw new Error(`Input ${s} must be an array of int32 or int64`);return i},tg=(e,s)=>{if(e.length>1){let i=nn(e,1),c=nn(e,2),d=nn(e,3);return d.length===0&&(d=[...Array(e[0].dims.length).keys()]),J({starts:i,ends:c,axes:d})}else return s},Ul=(e,s,i,c,d)=>{let h=e;return e<0&&(h+=i[c[s]]),d[s]<0?Math.max(0,Math.min(h,i[c[s]]-1)):Math.max(0,Math.min(h,i[c[s]]))},rg=(e,s,i)=>`fn calculateInputIndices(output_indices: ${s.type.indices}) -> ${e.type.indices} {
          var input_indices: ${e.type.indices};
          var carry = 0u;
          for (var i = ${i.length}; i >= 0; i--) {
            let input_shape_i = ${F("uniforms.input_shape","i",i.length)};
            let steps_i = ${F("uniforms.steps","i",i.length)};
            let signs_i = ${F("uniforms.signs","i",i.length)};
            let starts_i = ${F("uniforms.starts","i",i.length)};
            var output_index = ${s.indicesGet("output_indices","i")};
            var input_index = output_index * steps_i + starts_i + carry;
            carry = input_index / input_shape_i;
            input_index = input_index % input_shape_i;
            if (signs_i < 0) {
              input_index = input_shape_i - input_index - 1u + starts_i;
            }
            ${e.indicesSet("input_indices","i","input_index")};
          }
          return input_indices;
      }`,ng=(e,s)=>{let i=e[0].dims,c=k.size(i),d=s.axes.length>0?k.normalizeAxes(s.axes,i.length):[...Array(i.length).keys()],h=nn(e,4);h.forEach(dt=>dt!==0||(()=>{throw new Error("step cannot be 0")})),h.length===0&&(h=Array(d.length).fill(1));let _=s.starts.map((dt,ft)=>Ul(dt,ft,i,d,h)),g=s.ends.map((dt,ft)=>Ul(dt,ft,i,d,h));if(d.length!==_.length||d.length!==g.length)throw new Error("start, ends and axes should have the same number of elements");if(d.length!==i.length)for(let dt=0;dt<i.length;++dt)d.includes(dt)||(_.splice(dt,0,0),g.splice(dt,0,i[dt]),h.splice(dt,0,1));let $=h.map(dt=>Math.sign(dt));h.forEach((dt,ft,kt)=>{if(dt<0){let St=(g[ft]-_[ft])/dt,Lt=_[ft],Gt=Lt+St*h[ft];_[ft]=Gt,g[ft]=Lt,kt[ft]=-dt}});let _e=i.slice(0);d.forEach((dt,ft)=>{_e[dt]=Math.ceil((g[dt]-_[dt])/h[dt])});let lt={dims:_e,dataType:e[0].dataType},at=M("output",e[0].dataType,_e.length),it=P("input",e[0].dataType,e[0].dims.length),ct=k.size(_e),mt=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:_.length},{name:"signs",type:"i32",length:$.length},{name:"steps",type:"u32",length:h.length}],pt=[{type:12,data:ct},{type:12,data:_},{type:6,data:$},{type:12,data:h},...N(e[0].dims,_e)],zt=dt=>`
      ${dt.registerUniforms(mt).declareVariables(it,at)}
        ${rg(it,at,i)}
        ${dt.mainStart()}
          ${dt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
          let output_indices = ${at.offsetToIndices("global_idx")};
          let input_indices = calculateInputIndices(output_indices);
          ${at.setByOffset("global_idx",it.getByIndices("input_indices"))}
      }`;return{name:"Slice",shaderCache:{hint:`${$.length}_${_.length}_${h.length}`,inputDependencies:["rank"]},getShaderSource:zt,getRunData:()=>({outputs:[lt],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:pt})}},Nl=(e,s)=>{eg(e.inputs,s);let i=tg(e.inputs,s);e.compute(ng(e.inputs,i),{inputs:[0]})},Vl=e=>{let s=e.starts,i=e.ends,c=e.axes;return J({starts:s,ends:i,axes:c})}}),og,ig,Ll,Gl,Hl=U(()=>{ee(),ne(),Se(),st(),ie(),og=e=>{if(!e||e.length!==1)throw new Error("Softmax op requires 1 input.")},ig=(e,s)=>{let i=e.inputs[0],c=i.dims,d=k.size(c),h=c.length,_=k.normalizeAxis(s.axis,h),g=_<c.length-1,$,_e=[];g?(_e=Array.from({length:h},(Bt,nr)=>nr),_e[_]=h-1,_e[h-1]=_,$=e.compute(Ee(i,_e),{inputs:[i],outputs:[-1]})[0]):$=i;let lt=$.dims,at=lt[h-1],it=d/at,ct=ce(at),mt=at/ct,pt=64;it===1&&(pt=256);let zt=(Bt,nr)=>nr===4?`max(max(${Bt}.x, ${Bt}.y), max(${Bt}.z, ${Bt}.w))`:nr===2?`max(${Bt}.x, ${Bt}.y)`:nr===3?`max(max(${Bt}.x, ${Bt}.y), ${Bt}.z)`:Bt,dt=P("x",$.dataType,$.dims,ct),ft=M("result",$.dataType,$.dims,ct),kt=dt.type.value,St=be($.dataType)==="f32"?`var threadMax = ${kt}(-3.402823e+38f);`:`var threadMax = ${kt}(-65504.0h);`,Lt=Bt=>`
      var<workgroup> rowMaxShared : ${kt};
      var<workgroup> rowSumShared : ${kt};
      var<workgroup> threadShared : array<${kt}, ${pt}>;

      fn getValue(row: i32, col: i32, row_stride: i32) -> ${kt} {
        let index = row * row_stride + col;
        return x[index];
      }

      fn setValue(row: i32, col: i32, row_stride: i32, value: ${kt}) {
        let index = row * row_stride + col;
        result[index] = value;
      }
      ${Bt.registerUniform("packedCols","i32").declareVariables(dt,ft)}
      ${Bt.mainStart(pt)}
        let gindex = i32(global_idx);
        let lindex = i32(local_idx);
        const wg = ${pt};
        let row = gindex / wg;
        let cols = uniforms.packedCols;
        let row_stride : i32 = uniforms.packedCols;

        // find the rows max
        ${St}
        for (var col = lindex; col < cols; col += wg) {
          let value = getValue(row, col, row_stride);
          threadMax = max(threadMax, value);
        }
        if (lindex < cols) {
          threadShared[lindex] = threadMax;
        }
        workgroupBarrier();

        var reduceSize = min(cols, wg);
        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
          reduceSize = currSize + (reduceSize & 1);
          if (lindex < currSize) {
            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowMaxShared = ${kt}(${zt("threadShared[0]",ct)});
        }
        workgroupBarrier();

        // find the rows sum
        var threadSum = ${kt}(0.0);
        for (var col = lindex; col < cols; col += wg) {
          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);
          threadSum += subExp;
        }
        threadShared[lindex] = threadSum;
        workgroupBarrier();

        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {
          if (lindex < currSize) {
            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowSumShared = ${kt}(${He("threadShared[0]",ct)});
        }
        workgroupBarrier();

        // calculate final value for each element in the row
        for (var col = lindex; col < cols; col += wg) {
          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;
          setValue(row, col, row_stride, value);
        }
      }`,Gt=e.compute({name:"Softmax",shaderCache:{hint:`${ct};${pt}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:lt,dataType:$.dataType}],dispatchGroup:{x:it},programUniforms:[{type:6,data:mt}]}),getShaderSource:Lt},{inputs:[$],outputs:[g?-1:0]})[0];g&&e.compute(Ee(Gt,_e),{inputs:[Gt]})},Ll=(e,s)=>{og(e.inputs),ig(e,s)},Gl=e=>J({axis:e.axis})}),Fl,ag,sg,ug,ql,jl=U(()=>{ee(),ne(),ie(),Fl=e=>Array.from(e.getBigInt64Array(),Number),ag=e=>{if(!e||e.length!==2)throw new Error("Tile requires 2 inputs.");if(e[0].dataType!==1&&e[0].dataType!==10&&e[0].dataType!==6&&e[0].dataType!==12)throw new Error("Tile only support float, float16, int32, and uint32 data types");if(e[1].dataType!==7)throw new Error("Tile `repeats` input should be of int64 data type");if(e[1].dims.length!==1)throw new Error("Tile `repeats` input should be 1-D");if(Fl(e[1]).length!==e[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},sg=(e,s)=>{let i=[];for(let c=0;c<e.length;++c)i.push(e[c]*s[c]);return i},ug=(e,s)=>{let i=e[0].dims,c=s??Fl(e[1]),d=sg(i,c),h=k.size(d),_=e[0].dataType,g=P("input",_,i.length),$=M("output",_,d.length),_e=lt=>`
      const inputShape = ${g.indices(...i)};
      ${lt.registerUniform("output_size","u32").declareVariables(g,$)}
      ${lt.mainStart()}
      ${lt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let output_indices = ${$.offsetToIndices("global_idx")};
      var input_indices: ${g.type.indices};
      for (var i = 0; i < ${i.length}; i++) {
        let input_dim_i = ${g.indicesGet("uniforms.input_shape","i")};
        let input_dim_value = ${$.indicesGet("output_indices","i")}  % input_dim_i;

        ${g.indicesSet("input_indices","i","input_dim_value")}
      }
      ${$.setByOffset("global_idx",g.getByIndices("input_indices"))}
    }`;return{name:"Tile",shaderCache:{hint:`${c}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:d,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:[{type:12,data:h},...N(e[0].dims,d)]}),getShaderSource:_e}},ql=e=>{ag(e.inputs),e.compute(ug(e.inputs),{inputs:[0]})}}),dg,lg,Kl,Zl=U(()=>{ee(),ne(),ie(),dg=(e,s,i,c,d)=>{let h=M("output_data",d,i.length,4),_=P("a_data",s[1].dataType,s[1].dims.length,4),g=P("b_data",s[2].dataType,s[2].dims.length,4),$=P("c_data",s[0].dataType,s[0].dims.length,4),_e,lt=(at,it,ct)=>`select(${it}, ${at}, ${ct})`;if(!c)_e=h.setByOffset("global_idx",lt(_.getByOffset("global_idx"),g.getByOffset("global_idx"),$.getByOffset("global_idx")));else{let at=(it,ct,mt="")=>{let pt=`a_data[index_a${ct}][component_a${ct}]`,zt=`b_data[index_b${ct}][component_b${ct}]`,dt=`bool(c_data[index_c${ct}] & (0xffu << (component_c${ct} * 8)))`;return`
            let output_indices${ct} = ${h.offsetToIndices(`global_idx * 4u + ${ct}u`)};
            let offset_a${ct} = ${_.broadcastedIndicesToOffset(`output_indices${ct}`,h)};
            let offset_b${ct} = ${g.broadcastedIndicesToOffset(`output_indices${ct}`,h)};
            let offset_c${ct} = ${$.broadcastedIndicesToOffset(`output_indices${ct}`,h)};
            let index_a${ct} = offset_a${ct} / 4u;
            let index_b${ct} = offset_b${ct} / 4u;
            let index_c${ct} = offset_c${ct} / 4u;
            let component_a${ct} = offset_a${ct} % 4u;
            let component_b${ct} = offset_b${ct} % 4u;
            let component_c${ct} = offset_c${ct} % 4u;
            ${it}[${ct}] = ${mt}(${lt(pt,zt,dt)});
          `};d===9?_e=`
            var data = vec4<u32>(0);
            ${at("data",0,"u32")}
            ${at("data",1,"u32")}
            ${at("data",2,"u32")}
            ${at("data",3,"u32")}
            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:_e=`
            ${at("output_data[global_idx]",0)}
            ${at("output_data[global_idx]",1)}
            ${at("output_data[global_idx]",2)}
            ${at("output_data[global_idx]",3)}
          `}return`
        ${e.registerUniform("vec_size","u32").declareVariables($,_,g,h)}
        ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${_e}
      }`},lg=e=>{let s=e[1].dims,i=e[2].dims,c=e[0].dims,d=e[1].dataType,h=!(k.areEqual(s,i)&&k.areEqual(i,c)),_=s,g=k.size(s);if(h){let _e=Je.calcShape(Je.calcShape(s,i,!1),c,!1);if(!_e)throw new Error("Can't perform where op on the given tensors");_=_e,g=k.size(_)}let $=Math.ceil(g/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:_e=>dg(_e,e,_,h,d),getRunData:()=>({outputs:[{dims:_,dataType:d}],dispatchGroup:{x:Math.ceil(g/64/4)},programUniforms:[{type:12,data:$},...N(c,s,i,_)]})}},Kl=e=>{e.compute(lg(e.inputs))}}),Ql,Yl=U(()=>{Es(),Fr(),zs(),Bs(),_u(),ku(),Ou(),Zu(),rd(),id(),ud(),md(),gd(),yd(),vd(),Sd(),Cd(),kd(),Od(),Md(),Fd(),Kd(),Qd(),Xd(),tl(),$o(),nl(),wl(),xl(),Tl(),kl(),Gr(),Dl(),To(),Rl(),Wl(),Hl(),So(),jl(),st(),jr(),Zl(),Ql=new Map([["Abs",[Ds]],["Acos",[Ms]],["Acosh",[Rs]],["Add",[wu]],["ArgMax",[As,uo]],["ArgMin",[Cs,uo]],["Asin",[Us]],["Asinh",[Ns]],["Atan",[Vs]],["Atanh",[Ws]],["Attention",[ks]],["AveragePool",[cl,ll]],["BatchNormalization",[Ps]],["BiasAdd",[Os]],["BiasSplitGelu",[yu]],["Cast",[Gs,Ls]],["Ceil",[Fs]],["Clip",[Hs]],["Concat",[Pu,zu]],["Conv",[yo,bo]],["ConvTranspose",[td,Ju]],["Cos",[qs]],["Cosh",[js]],["CumSum",[nd,od]],["DepthToSpace",[ad,sd]],["DequantizeLinear",[vl,$l]],["Div",[vu]],["Einsum",[cd,pd]],["Elu",[Ks,Yt]],["Equal",[$u]],["Erf",[Zs]],["Exp",[Qs]],["Expand",[hd]],["FastGelu",[bd]],["Floor",[Ys]],["FusedConv",[yo,bo]],["Gather",[wd,_d]],["GatherElements",[Ed,Ad]],["GatherBlockQuantized",[Td,Id]],["GatherND",[$d,xd]],["Gelu",[Xs]],["Gemm",[zd,Pd]],["GlobalAveragePool",[fl,ml]],["GlobalMaxPool",[_l,yl]],["Greater",[Iu]],["GreaterOrEqual",[Au]],["GridSample",[Bd,Dd]],["GroupQueryAttention",[Hd]],["HardSigmoid",[au,iu]],["InstanceNormalization",[jd]],["LayerNormalization",[Zd]],["LeakyRelu",[Js,Yt]],["Less",[Cu]],["LessOrEqual",[Eu]],["Log",[hu]],["MatMul",[Yd]],["MatMulNBits",[Jd,el]],["MaxPool",[gl,bl]],["Mul",[xu]],["MultiHeadAttention",[Nd,Ud]],["Neg",[tu]],["Not",[eu]],["Pad",[rl]],["Pow",[Su]],["QuickGelu",[gu,Yt]],["Range",[Sl]],["Reciprocal",[ru]],["ReduceMin",[vs]],["ReduceMean",[gs]],["ReduceMax",[ws]],["ReduceSum",[xs]],["ReduceProd",[$s]],["ReduceL1",[bs]],["ReduceL2",[ys]],["ReduceLogSum",[Ts]],["ReduceLogSumExp",[_s]],["ReduceSumSquare",[Ss]],["Relu",[nu]],["Resize",[Ol,Bl]],["RotaryEmbedding",[Ld]],["ScatterND",[El,Al]],["Sigmoid",[ou]],["Sin",[su]],["Sinh",[uu]],["Slice",[Nl,Vl]],["SkipLayerNormalization",[Ml]],["Split",[Vd,Wd]],["Sqrt",[du]],["Softmax",[Ll,Gl]],["Sub",[Tu]],["Tan",[lu]],["Tanh",[pu]],["ThresholdedRelu",[fu,Yt]],["Tile",[ql]],["Transpose",[ns,os]],["Where",[Kl]]])}),on,Xl=U(()=>{We(),Xe(),ie(),on=class{constructor(e){this.backend=e,this.repo=new Map,this.attributesBound=!1}getArtifact(e){return this.repo.get(e)}setArtifact(e,s){this.repo.set(e,s)}run(e,s,i,c,d){Re(e.programInfo.name);let h=this.backend.device,_=this.backend.getComputePassEncoder();this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2);let g=[];for(let _e of s)g.push({binding:g.length,resource:{buffer:_e.buffer}});for(let _e of i)g.push({binding:g.length,resource:{buffer:_e.buffer}});d&&g.push({binding:g.length,resource:d});let $=h.createBindGroup({layout:e.computePipeline.getBindGroupLayout(0),entries:g,label:e.programInfo.name});if(this.backend.sessionStatus==="capturing"){let _e={kernelId:this.backend.currentKernelId,computePipeline:e.computePipeline,bindGroup:$,dispatchGroup:c};this.backend.capturedCommandList.get(this.backend.currentSessionId).push(_e)}_.setPipeline(e.computePipeline),_.setBindGroup(0,$),_.dispatchWorkgroups(...c),this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||this.backend.queryType==="at-passes")&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),Oe(e.programInfo.name)}dispose(){}build(e,s){Re(e.name);let i=this.backend.device,c=[];[{feature:"shader-f16",extension:"f16"},{feature:"subgroups",extension:"subgroups"}].forEach(_e=>{i.features.has(_e.feature)&&c.push(`enable ${_e.extension};`)});let d=ts(s,this.backend.device.limits),h=e.getShaderSource(d),_=`${c.join(`
`)}
${d.additionalImplementations}
${h}`,g=i.createShaderModule({code:_,label:e.name});se("verbose",()=>`[WebGPU] ${e.name} shader code: ${_}`);let $=i.createComputePipeline({compute:{module:g,entryPoint:"main"},layout:"auto",label:e.name});return Oe(e.name),{programInfo:e,computePipeline:$,uniformVariablesInfo:d.variablesInfo}}normalizeDispatchGroupSize(e){let s=typeof e=="number"?e:e.x,i=typeof e=="number"?1:e.y||1,c=typeof e=="number"?1:e.z||1,d=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(s<=d&&i<=d&&c<=d)return[s,i,c];let h=s*i*c,_=Math.ceil(Math.sqrt(h));if(_>d){if(_=Math.ceil(Math.cbrt(h)),_>d)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[_,_,_]}else return[_,_,1]}}}),Jl={};Dt(Jl,{WebGpuBackend:()=>Co});var cg,pg,Io,Co,ec=U(()=>{We(),ee(),Xe(),Zn(),Ja(),Yl(),Xl(),cg=(e,s)=>{if(s.length!==e.length)throw new Error(`inputDependencies length ${s.length} is not equal to inputTensors length ${e.length}.`);let i=[];for(let c=0;c<e.length;++c){let d=e[c].dataType;switch(s[c]){case"none":{i.push("");break}case"type":{i.push(`${d}`);break}case"rank":{let h=e[c].dims.length;i.push(`${d};${h}`);break}case"dims":{let h=e[c].dims.join(",");i.push(`${d};${h}`);break}default:throw new Error(`unsupported input dependency: ${s[c]}`)}}return i.join("|")},pg=(e,s,i)=>{var d,h;let c=e.name;return(d=e.shaderCache)!=null&&d.hint&&(c+="["+e.shaderCache.hint+"]"),c+=":"+i+`:${cg(s,((h=e.shaderCache)==null?void 0:h.inputDependencies)??new Array(s.length).fill("dims"))}`,c},Io=class{constructor(e){e&&(this.architecture=e.architecture,this.vendor=e.vendor)}isArchitecture(e){return this.architecture===e}isVendor(e){return this.vendor===e}},Co=class{constructor(){this.currentSessionId=null,this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.maxDispatchNumber=16,this.pendingDispatchNumber=0,this.pendingKernels=[],this.pendingQueries=new Map,this.sessionStatus="default",this.capturedCommandList=new Map,this.capturedPendingKernels=new Map,this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let e=this.kernelCustomData.get(this.currentKernelId);return e||(e={},this.kernelCustomData.set(this.currentKernelId,e)),e}async initialize(e,s){this.env=e;let i=[],c={requiredLimits:{maxComputeWorkgroupStorageSize:s.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:s.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:s.limits.maxStorageBufferBindingSize,maxBufferSize:s.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:s.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:s.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:s.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:s.limits.maxComputeWorkgroupSizeZ},requiredFeatures:i},d=h=>s.features.has(h)&&i.push(h)&&!0;d("chromium-experimental-timestamp-query-inside-passes")||d("timestamp-query"),d("shader-f16"),d("subgroups"),this.device=await s.requestDevice(c),this.adapterInfo=new Io(s.info||await s.requestAdapterInfo()),this.gpuDataManager=Xa(this),this.programManager=new on(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,Br(e.logLevel,!!e.debug),this.device.onuncapturederror=h=>{h.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${h.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(this.env.webgpu,"adapter",{value:s,writable:!1,enumerable:!0,configurable:!1}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder()),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let e=this.getCommandEncoder(),s={};this.queryType==="at-passes"&&(s.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:this.pendingDispatchNumber*2,endOfPassWriteIndex:this.pendingDispatchNumber*2+1}),this.computePassEncoder=e.beginComputePass(s)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;Re(),this.endComputePass();let e;this.queryType!=="none"&&(this.commandEncoder.resolveQuerySet(this.querySet,0,this.pendingDispatchNumber*2,this.queryResolveBuffer,0),e=this.device.createBuffer({size:this.pendingDispatchNumber*2*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(e,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,this.pendingDispatchNumber*2*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,this.queryType!=="none"&&e.mapAsync(GPUMapMode.READ).then(()=>{var c;let s=new BigUint64Array(e.getMappedRange()),i=this.pendingQueries.get(e);for(let d=0;d<s.length/2;d++){let h=i[d],_=h.kernelId,g=this.kernels.get(_),$=g.kernelType,_e=g.kernelName,lt=h.programName,at=h.inputTensorViews,it=h.outputTensorViews,ct=s[d*2],mt=s[d*2+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=ct);let pt=Number(ct-this.queryTimeBase),zt=Number(mt-this.queryTimeBase);if(!Number.isSafeInteger(pt)||!Number.isSafeInteger(zt))throw new RangeError("incorrect timestamp range");if((c=this.env.webgpu.profiling)!=null&&c.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:at.map(dt=>({dims:dt.dims,dataType:Ye(dt.dataType)})),outputsMetadata:it.map(dt=>({dims:dt.dims,dataType:Ye(dt.dataType)})),kernelId:_,kernelType:$,kernelName:_e,programName:lt,startTime:pt,endTime:zt});else{let dt="";at.forEach((kt,St)=>{dt+=`input[${St}]: [${kt.dims}] | ${Ye(kt.dataType)}, `});let ft="";it.forEach((kt,St)=>{ft+=`output[${St}]: [${kt.dims}] | ${Ye(kt.dataType)}, `}),console.log(`[profiling] kernel "${_}|${$}|${_e}|${lt}" ${dt}${ft}execution time: ${zt-pt} ns`)}gr("GPU",`${lt}::${ct}::${mt}`)}e.unmap(),this.pendingQueries.delete(e)}),Oe()}run(e,s,i,c,d,h){Re(e.name);let _=[];for(let ft=0;ft<s.length;++ft){let kt=s[ft].data;if(kt===0)continue;let St=this.gpuDataManager.get(kt);if(!St)throw new Error(`no GPU data for input: ${kt}`);_.push(St)}let{outputs:g,dispatchGroup:$,programUniforms:_e}=e.getRunData(s),lt=i.length===0?g.map((ft,kt)=>kt):i;if(lt.length!==g.length)throw new Error(`Output size ${lt.length} must be equal to ${g.length}.`);let at=[],it=[];for(let ft=0;ft<g.length;++ft){if(!Number.isInteger(lt[ft])||lt[ft]<-3||lt[ft]>=h)throw new Error(`Invalid output index: ${lt[ft]}`);if(lt[ft]===-3)continue;let kt=lt[ft]===-1,St=lt[ft]===-2,Lt=kt||St?d(g[ft].dataType,g[ft].dims):c(lt[ft],g[ft].dataType,g[ft].dims);if(at.push(Lt),Lt.data===0)continue;let Gt=this.gpuDataManager.get(Lt.data);if(!Gt)throw new Error(`no GPU data for output: ${Lt.data}`);if(kt&&this.temporaryData.push(Gt),St){let Bt=this.kernelPersistentData.get(this.currentKernelId);Bt||(Bt=[],this.kernelPersistentData.set(this.currentKernelId,Bt)),Bt.push(Gt)}it.push(Gt)}if(_.length!==s.length||it.length!==at.length){if(it.length===0)return Oe(e.name),at;throw new Error(`Program ${e.name} has zero-sized tensor(s) in inputs or outputs. This is not supported now.`)}let ct;if(_e){let ft=0,kt=[];_e.forEach(Bt=>{let nr=typeof Bt.data=="number"?[Bt.data]:Bt.data;if(nr.length===0)return;let cr=Bt.type===10?2:4,ur,yn;Bt.type===10?(yn=nr.length>4?16:nr.length>2?8:nr.length*cr,ur=nr.length>4?16:cr*nr.length):(yn=nr.length<=2?nr.length*cr:16,ur=16),ft=Math.ceil(ft/yn)*yn,kt.push(ft);let hn=Bt.type===10?8:4;ft+=nr.length>4?Math.ceil(nr.length/hn)*ur:nr.length*cr});let St=16;ft=Math.ceil(ft/St)*St;let Lt=new ArrayBuffer(ft);_e.forEach((Bt,nr)=>{let cr=kt[nr],ur=typeof Bt.data=="number"?[Bt.data]:Bt.data;if(Bt.type===6)new Int32Array(Lt,cr,ur.length).set(ur);else if(Bt.type===12)new Uint32Array(Lt,cr,ur.length).set(ur);else if(Bt.type===10)new Uint16Array(Lt,cr,ur.length).set(ur);else if(Bt.type===1)new Float32Array(Lt,cr,ur.length).set(ur);else throw new Error(`Unsupported uniform type: ${Ye(Bt.type)}`)});let Gt=this.gpuDataManager.create(ft,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(Gt.buffer,0,Lt,0,ft),this.gpuDataManager.release(Gt.id),ct={offset:0,size:ft,buffer:Gt.buffer}}let mt=this.programManager.normalizeDispatchGroupSize($),pt=mt[1]===1&&mt[2]===1,zt=pg(e,s,pt),dt=this.programManager.getArtifact(zt);if(dt||(dt=this.programManager.build(e,mt),this.programManager.setArtifact(zt,dt),se("info",()=>`[artifact] key: ${zt}, programName: ${e.name}`)),_e&&dt.uniformVariablesInfo){if(_e.length!==dt.uniformVariablesInfo.length)throw new Error(`Uniform variables count mismatch: expect ${dt.uniformVariablesInfo.length}, got ${_e.length} in program "${dt.programInfo.name}".`);for(let ft=0;ft<_e.length;ft++){let kt=_e[ft],St=kt.type,Lt=typeof kt.data=="number"?1:kt.data.length,[Gt,Bt]=dt.uniformVariablesInfo[ft];if(St!==Gt||Lt!==Bt)throw new Error(`Uniform variable ${ft} mismatch: expect type ${Gt} with size ${Bt}, got type ${St} with size ${Lt} in program "${dt.programInfo.name}".`)}}if(se("info",()=>`[ProgramManager] run "${e.name}" (key=${zt}) with ${mt[0]}x${mt[1]}x${mt[2]}`),this.queryType!=="none"||this.sessionStatus==="capturing"){let ft={kernelId:this.currentKernelId,programName:dt.programInfo.name,inputTensorViews:s,outputTensorViews:at};this.pendingKernels.push(ft),this.sessionStatus==="capturing"&&this.capturedPendingKernels.get(this.currentSessionId).push(ft)}return this.programManager.run(dt,_,it,mt,ct),Oe(e.name),at}upload(e,s){this.gpuDataManager.upload(e,s)}memcpy(e,s){this.gpuDataManager.memcpy(e,s)}async download(e,s){await this.gpuDataManager.download(e,s)}alloc(e){return this.gpuDataManager.create(e).id}free(e){return this.gpuDataManager.release(e)}createKernel(e,s,i,c){let d=Ql.get(e);if(!d)throw new Error(`kernel not implemented: ${e}`);let h={kernelType:e,kernelName:c,kernelEntry:d[0],attributes:[d[1],i]};this.kernels.set(s,h)}releaseKernel(e){let s=this.kernelPersistentData.get(e);if(s){for(let i of s)this.gpuDataManager.release(i.id);this.kernelPersistentData.delete(e)}this.kernelCustomData.delete(e),this.kernels.delete(e)}computeKernel(e,s,i){let c=this.kernels.get(e);if(!c)throw new Error(`kernel not created: ${e}`);let d=c.kernelType,h=c.kernelName,_=c.kernelEntry,g=c.attributes;if(this.currentKernelId!==null)throw new Error(`kernel "[${d}] ${h}" is not allowed to be called recursively`);this.currentKernelId=e,g[0]&&(g[1]=g[0](g[1]),g[0]=void 0),se("info",()=>`[WebGPU] Start to run kernel "[${d}] ${h}"...`);let $=this.env.debug;this.temporaryData=[];try{return $&&this.device.pushErrorScope("validation"),_(s,g[1]),0}catch(_e){return i.push(Promise.resolve(`[WebGPU] Kernel "[${d}] ${h}" failed. ${_e}`)),1}finally{$&&i.push(this.device.popErrorScope().then(_e=>_e?`GPU validation error for kernel "[${d}] ${h}": ${_e.message}`:null));for(let _e of this.temporaryData)this.gpuDataManager.release(_e.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(e,s,i,c){let d=this.sessionExternalDataMapping.get(e);d||(d=new Map,this.sessionExternalDataMapping.set(e,d));let h=d.get(s),_=this.gpuDataManager.registerExternalBuffer(i,c,h);return d.set(s,[_,i]),_}unregisterBuffers(e){let s=this.sessionExternalDataMapping.get(e);s&&(s.forEach(i=>this.gpuDataManager.unregisterExternalBuffer(i[0])),this.sessionExternalDataMapping.delete(e))}getBuffer(e){let s=this.gpuDataManager.get(e);if(!s)throw new Error(`no GPU data for buffer: ${e}`);return s.buffer}createDownloader(e,s,i){return async()=>{let c=await ro(this,e,s);return Mr(c.buffer,i)}}writeTimestamp(e){this.queryType==="inside-passes"&&this.computePassEncoder.writeTimestamp(this.querySet,e)}setQueryType(){var e;this.queryType="none",(((e=this.env.webgpu.profiling)==null?void 0:e.mode)==="default"||(typeof this.env.trace>"u"?this.env.wasm.trace:this.env.trace))&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"),this.queryType!=="none"&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxDispatchNumber*2}),this.queryResolveBuffer=this.device.createBuffer({size:this.maxDispatchNumber*2*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE})))}captureBegin(){se("info","captureBegin"),this.capturedCommandList.get(this.currentSessionId)||this.capturedCommandList.set(this.currentSessionId,[]),this.capturedPendingKernels.get(this.currentSessionId)||this.capturedPendingKernels.set(this.currentSessionId,[]),this.flush(),this.sessionStatus="capturing"}captureEnd(){se("info","captureEnd"),this.flush(),this.sessionStatus="default"}replay(){se("info","replay"),this.sessionStatus="replaying";let e=this.capturedCommandList.get(this.currentSessionId),s=this.capturedPendingKernels.get(this.currentSessionId),i=e.length;this.pendingKernels=[];for(let c=0;c<i;c++){let d=this.getComputePassEncoder(),h=e[c];this.writeTimestamp(this.pendingDispatchNumber*2),d.setPipeline(h.computePipeline),d.setBindGroup(0,h.bindGroup),d.dispatchWorkgroups(...h.dispatchGroup),this.writeTimestamp(this.pendingDispatchNumber*2+1),this.pendingDispatchNumber++,this.queryType!=="none"&&this.pendingKernels.push(s[c]),(this.pendingDispatchNumber>=this.maxDispatchNumber||this.queryType==="at-passes")&&this.endComputePass(),this.pendingDispatchNumber>=this.maxDispatchNumber&&this.flush()}this.flush(),this.sessionStatus="default"}onCreateSession(){this.gpuDataManager.onCreateSession()}onReleaseSession(e){this.unregisterBuffers(e),this.capturedCommandList.has(e)&&this.capturedCommandList.delete(e),this.capturedPendingKernels.has(e)&&this.capturedPendingKernels.delete(e),this.gpuDataManager.onReleaseSession(e)}onRunStart(e){this.currentSessionId=e,this.setQueryType()}}}),tc={};Dt(tc,{init:()=>mg});var tr,Ao,mg,rc=U(()=>{ee(),Xe(),ne(),Ka(),tr=class GP{constructor(s,i,c,d){this.module=s,this.dataType=i,this.data=c,this.dims=d}getFloat32Array(){if(this.dataType!==1)throw new Error("Invalid data type");let s=k.size(this.dims);return s===0?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,s)}getBigInt64Array(){if(this.dataType!==7)throw new Error("Invalid data type");let s=k.size(this.dims);return s===0?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,s)}getInt32Array(){if(this.dataType!==6)throw new Error("Invalid data type");let s=k.size(this.dims);return s===0?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,s)}getUint16Array(){if(this.dataType!==10&&this.dataType!==4)throw new Error("Invalid data type");let s=k.size(this.dims);return s===0?new Uint16Array:new Uint16Array(this.module.HEAP8.buffer,this.data,s)}reshape(s){if(k.size(s)!==k.size(this.dims))throw new Error("Invalid new shape");return new GP(this.module,this.dataType,this.data,s)}},Ao=class{constructor(e,s,i){this.module=e,this.backend=s,this.customDataOffset=0,this.customDataSize=0,this.adapterInfo=s.adapterInfo;let c=e.PTR_SIZE,d=i/e.PTR_SIZE,h=c===4?"i32":"i64";this.opKernelContext=Number(e.getValue(c*d++,h));let _=Number(e.getValue(c*d++,h));this.outputCount=Number(e.getValue(c*d++,h)),this.customDataOffset=Number(e.getValue(c*d++,"*")),this.customDataSize=Number(e.getValue(c*d++,h));let g=[];for(let $=0;$<_;$++){let _e=Number(e.getValue(c*d++,h)),lt=Number(e.getValue(c*d++,"*")),at=Number(e.getValue(c*d++,h)),it=[];for(let ct=0;ct<at;ct++)it.push(Number(e.getValue(c*d++,h)));g.push(new tr(e,_e,lt,it))}this.inputs=g}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}compute(e,s){var _;let i=((_=s==null?void 0:s.inputs)==null?void 0:_.map(g=>typeof g=="number"?this.inputs[g]:g))??this.inputs,c=(s==null?void 0:s.outputs)??[],d=(g,$,_e)=>new tr(this.module,$,this.output(g,_e),_e),h=(g,$)=>{let _e=gt(g,$);if(!_e)throw new Error(`Unsupported data type: ${g}`);let lt=_e>0?this.backend.gpuDataManager.create(_e).id:0;return new tr(this.module,g,lt,$)};return this.backend.run(e,i,c,d,h,this.outputCount)}output(e,s){let i=this.module.stackSave();try{let c=this.module.PTR_SIZE,d=c===4?"i32":"i64",h=this.module.stackAlloc((1+s.length)*c);this.module.setValue(h,s.length,d);for(let _=0;_<s.length;_++)this.module.setValue(h+c*(_+1),s[_],d);return this.module._JsepOutput(this.opKernelContext,e,h)}catch(c){throw new Error(`Failed to generate kernel's output[${e}] with dims [${s}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${c}`)}finally{this.module.stackRestore(i)}}},mg=async(e,s,i,c)=>{let d=s.jsepInit;if(!d)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");if(e==="webgpu"){let h=(ec(),Ft(Jl)).WebGpuBackend,_=new h;await _.initialize(i,c),d("webgpu",[_,g=>_.alloc(Number(g)),g=>_.free(g),(g,$,_e,lt=!1)=>{if(lt)se("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${Number(g)}, dst=${Number($)}, size=${Number(_e)}`),_.memcpy(Number(g),Number($));else{se("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${Number(g)}, gpuDataId=${Number($)}, size=${Number(_e)}`);let at=s.HEAPU8.subarray(Number(g>>>0),Number(g>>>0)+Number(_e));_.upload(Number($),at)}},async(g,$,_e)=>{se("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${g}, dataOffset=${$}, size=${_e}`),await _.download(Number(g),()=>s.HEAPU8.subarray(Number($)>>>0,Number($+_e)>>>0))},(g,$,_e)=>_.createKernel(g,Number($),_e,s.UTF8ToString(s._JsepGetNodeName(Number($)))),g=>_.releaseKernel(g),(g,$,_e,lt)=>{se("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${_e}, kernel=${g}, contextDataOffset=${$}`);let at=new Ao(s,_,Number($));return _.computeKernel(Number(g),at,lt)},()=>_.captureBegin(),()=>_.captureEnd(),()=>_.replay()])}else{let h=new Nr(i);d("webnn",[h,()=>h.reserveTensorId(),_=>h.releaseTensorId(_),async(_,g,$,_e,lt)=>h.ensureTensor(_,g,$,_e,lt),(_,g)=>{h.uploadTensor(_,g)},async(_,g)=>h.downloadTensor(_,g)])}}}),fg,vr,$r,At,hg,nc,jt,xr,Sr,oc,Tr,Ir,Cr,Vn=U(()=>{Ma(),Ua(),ee(),ht(),Er(),jn(),fg=(e,s)=>{fe()._OrtInit(e,s)!==0&&pe("Can't initialize onnxruntime.")},vr=async e=>{fg(e.wasm.numThreads,Zt(e.logLevel))},$r=async(e,s)=>{var i,c;(c=(i=fe()).asyncInit)==null||c.call(i);{let d=(rc(),Ft(tc)).init;if(s==="webgpu"){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let h=e.webgpu.adapter;if(h){if(typeof h.limits!="object"||typeof h.features!="object"||typeof h.requestDevice!="function")throw new Error("Invalid GPU adapter set in `env.webgpu.adapter`. It must be a GPUAdapter object.")}else{let _=e.webgpu.powerPreference;if(_!==void 0&&_!=="low-power"&&_!=="high-performance")throw new Error(`Invalid powerPreference setting: "${_}"`);let g=e.webgpu.forceFallbackAdapter;if(g!==void 0&&typeof g!="boolean")throw new Error(`Invalid forceFallbackAdapter setting: "${g}"`);if(h=await navigator.gpu.requestAdapter({powerPreference:_,forceFallbackAdapter:g}),!h)throw new Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.')}await d("webgpu",fe(),e,h)}if(s==="webnn"){if(typeof navigator>"u"||!navigator.ml)throw new Error("WebNN is not supported in current environment");await d("webnn",fe(),e)}}},At=new Map,hg=e=>{let s=fe(),i=s.stackSave();try{let c=s.PTR_SIZE,d=s.stackAlloc(2*c);s._OrtGetInputOutputCount(e,d,d+c)!==0&&pe("Can't get session input/output count.");let h=c===4?"i32":"i64";return[Number(s.getValue(d,h)),Number(s.getValue(d+c,h))]}finally{s.stackRestore(i)}},nc=(e,s)=>{let i=fe(),c=i.stackSave(),d=0;try{let h=i.PTR_SIZE,_=i.stackAlloc(2*h);i._OrtGetInputOutputMetadata(e,s,_,_+h)!==0&&pe("Can't get session input/output metadata.");let g=Number(i.getValue(_,"*"));d=Number(i.getValue(_+h,"*"));let $=i.HEAP32[d/4];if($===0)return[g,0];let _e=i.HEAPU32[d/4+1],lt=[];for(let at=0;at<_e;at++){let it=Number(i.getValue(d+8+at*h,"*"));lt.push(it!==0?i.UTF8ToString(it):Number(i.getValue(d+8+(at+_e)*h,"*")))}return[g,$,lt]}finally{i.stackRestore(c),d!==0&&i._OrtFree(d)}},jt=e=>{let s=fe(),i=s._malloc(e.byteLength);if(i===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${e.byteLength}.`);return s.HEAPU8.set(e,i),[i,e.byteLength]},xr=async(e,s)=>{var at,it,ct,mt;let i,c,d=fe();Array.isArray(e)?[i,c]=e:e.buffer===d.HEAPU8.buffer?[i,c]=[e.byteOffset,e.byteLength]:[i,c]=jt(e);let h=0,_=0,g=0,$=[],_e=[],lt=[];try{if([_,$]=await Ra(s),(s==null?void 0:s.externalData)&&d.mountExternalData){let nr=[];for(let cr of s.externalData){let ur=typeof cr=="string"?cr:cr.path;nr.push(Qt(typeof cr=="string"?cr:cr.data).then(yn=>{d.mountExternalData(ur,yn)}))}await Promise.all(nr)}for(let nr of(s==null?void 0:s.executionProviders)??[])if((typeof nr=="string"?nr:nr.name)==="webnn"){if(d.shouldTransferToMLTensor=!1,typeof nr!="string"){let cr=nr,ur=cr==null?void 0:cr.context,yn=cr==null?void 0:cr.gpuDevice,hn=cr==null?void 0:cr.deviceType,_n=cr==null?void 0:cr.powerPreference;ur?d.currentContext=ur:yn?d.currentContext=await d.webnnCreateMLContext(yn):d.currentContext=await d.webnnCreateMLContext({deviceType:hn,powerPreference:_n})}else d.currentContext=await d.webnnCreateMLContext();break}h=await d._OrtCreateSession(i,c,_),(at=d.webgpuOnCreateSession)==null||at.call(d,h),h===0&&pe("Can't create a session."),(it=d.jsepOnCreateSession)==null||it.call(d),d.currentContext&&(d.webnnRegisterMLContext(h,d.currentContext),d.currentContext=void 0,d.shouldTransferToMLTensor=!0);let[pt,zt]=hg(h),dt=!!(s!=null&&s.enableGraphCapture),ft=[],kt=[],St=[],Lt=[],Gt=[];for(let nr=0;nr<pt;nr++){let[cr,ur,yn]=nc(h,nr);cr===0&&pe("Can't get an input name."),_e.push(cr);let hn=d.UTF8ToString(cr);ft.push(hn),St.push(ur===0?{name:hn,isTensor:!1}:{name:hn,isTensor:!0,type:Ye(ur),shape:yn})}for(let nr=0;nr<zt;nr++){let[cr,ur,yn]=nc(h,nr+pt);cr===0&&pe("Can't get an output name."),lt.push(cr);let hn=d.UTF8ToString(cr);kt.push(hn),Lt.push(ur===0?{name:hn,isTensor:!1}:{name:hn,isTensor:!0,type:Ye(ur),shape:yn});{if(dt&&(s==null?void 0:s.preferredOutputLocation)===void 0){Gt.push("gpu-buffer");continue}let _n=typeof(s==null?void 0:s.preferredOutputLocation)=="string"?s.preferredOutputLocation:((ct=s==null?void 0:s.preferredOutputLocation)==null?void 0:ct[hn])??"cpu";if(_n!=="cpu"&&_n!=="cpu-pinned"&&_n!=="gpu-buffer"&&_n!=="ml-tensor")throw new Error(`Not supported preferred output location: ${_n}.`);if(dt&&_n!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${_n}. Only 'gpu-buffer' location is supported when enableGraphCapture is true.`);Gt.push(_n)}}let Bt=null;return Gt.some(nr=>nr==="gpu-buffer"||nr==="ml-tensor")&&(g=d._OrtCreateBinding(h),g===0&&pe("Can't create IO binding."),Bt={handle:g,outputPreferredLocations:Gt,outputPreferredLocationsEncoded:Gt.map(nr=>qn(nr))}),At.set(h,[h,_e,lt,Bt,dt,!1]),[h,ft,kt,St,Lt]}catch(pt){throw _e.forEach(zt=>d._OrtFree(zt)),lt.forEach(zt=>d._OrtFree(zt)),g!==0&&d._OrtReleaseBinding(g)!==0&&pe("Can't release IO binding."),h!==0&&d._OrtReleaseSession(h)!==0&&pe("Can't release session."),pt}finally{d._free(i),_!==0&&d._OrtReleaseSessionOptions(_)!==0&&pe("Can't release session options."),$.forEach(pt=>d._free(pt)),(mt=d.unmountExternalData)==null||mt.call(d)}},Sr=e=>{var $,_e,lt;let s=fe(),i=At.get(e);if(!i)throw new Error(`cannot release session. invalid session id: ${e}`);let[c,d,h,_,g]=i;_&&(g&&s._OrtClearBoundOutputs(_.handle)!==0&&pe("Can't clear bound outputs."),s._OrtReleaseBinding(_.handle)!==0&&pe("Can't release IO binding.")),($=s.jsepOnReleaseSession)==null||$.call(s,e),(_e=s.webnnOnReleaseSession)==null||_e.call(s,e),(lt=s.webgpuOnReleaseSession)==null||lt.call(s,e),d.forEach(at=>s._OrtFree(at)),h.forEach(at=>s._OrtFree(at)),s._OrtReleaseSession(c)!==0&&pe("Can't release session."),At.delete(e)},oc=async(e,s,i,c,d,h,_=!1)=>{if(!e){s.push(0);return}let g=fe(),$=g.PTR_SIZE,_e=e[0],lt=e[1],at=e[3],it=at,ct,mt;if(_e==="string"&&(at==="gpu-buffer"||at==="ml-tensor"))throw new Error("String tensor is not supported on GPU.");if(_&&at!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${h} when enableGraphCapture is true.`);if(at==="gpu-buffer"){let dt=e[2].gpuBuffer;mt=gt(Mt(_e),lt);{let ft=g.jsepRegisterBuffer;if(!ft)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');ct=ft(c,h,dt,mt)}}else if(at==="ml-tensor"){let dt=e[2].mlTensor;mt=gt(Mt(_e),lt);let ft=g.webnnRegisterMLTensor;if(!ft)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');ct=ft(c,dt,Mt(_e),lt)}else{let dt=e[2];if(Array.isArray(dt)){mt=$*dt.length,ct=g._malloc(mt),i.push(ct);for(let ft=0;ft<dt.length;ft++){if(typeof dt[ft]!="string")throw new TypeError(`tensor data at index ${ft} is not a string`);g.setValue(ct+ft*$,Ne(dt[ft],i),"*")}}else{let ft=g.webnnIsGraphInput;if(_e!=="string"&&ft){let kt=g.UTF8ToString(d);if(ft(c,kt)){let St=Mt(_e);mt=gt(St,lt),it="ml-tensor";let Lt=g.webnnCreateTemporaryTensor,Gt=g.webnnUploadTensor;if(!Lt||!Gt)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');let Bt=await Lt(c,St,lt);Gt(Bt,new Uint8Array(dt.buffer,dt.byteOffset,dt.byteLength)),ct=Bt}else mt=dt.byteLength,ct=g._malloc(mt),i.push(ct),g.HEAPU8.set(new Uint8Array(dt.buffer,dt.byteOffset,mt),ct)}else mt=dt.byteLength,ct=g._malloc(mt),i.push(ct),g.HEAPU8.set(new Uint8Array(dt.buffer,dt.byteOffset,mt),ct)}}let pt=g.stackSave(),zt=g.stackAlloc(4*lt.length);try{lt.forEach((ft,kt)=>g.setValue(zt+kt*$,ft,$===4?"i32":"i64"));let dt=g._OrtCreateTensor(Mt(_e),ct,mt,zt,lt.length,qn(it));dt===0&&pe(`Can't create tensor for input/output. session=${c}, index=${h}.`),s.push(dt)}finally{g.stackRestore(pt)}},Tr=async(e,s,i,c,d,h)=>{var yn,hn,_n,gn;let _=fe(),g=_.PTR_SIZE,$=At.get(e);if(!$)throw new Error(`cannot run inference. invalid session id: ${e}`);let _e=$[0],lt=$[1],at=$[2],it=$[3],ct=$[4],mt=$[5],pt=s.length,zt=c.length,dt=0,ft=[],kt=[],St=[],Lt=[],Gt=_.stackSave(),Bt=_.stackAlloc(pt*g),nr=_.stackAlloc(pt*g),cr=_.stackAlloc(zt*g),ur=_.stackAlloc(zt*g);try{[dt,ft]=Da(h);for(let kn=0;kn<pt;kn++)await oc(i[kn],kt,Lt,e,lt[s[kn]],s[kn],ct);for(let kn=0;kn<zt;kn++)await oc(d[kn],St,Lt,e,at[c[kn]],pt+c[kn],ct);for(let kn=0;kn<pt;kn++)_.setValue(Bt+kn*g,kt[kn],"*"),_.setValue(nr+kn*g,lt[s[kn]],"*");for(let kn=0;kn<zt;kn++)_.setValue(cr+kn*g,St[kn],"*"),_.setValue(ur+kn*g,at[c[kn]],"*");if(it&&!mt){let{handle:kn,outputPreferredLocations:bn,outputPreferredLocationsEncoded:Sn}=it;if(lt.length!==pt)throw new Error(`input count from feeds (${pt}) is expected to be always equal to model's input count (${lt.length}).`);for(let fn=0;fn<pt;fn++){let or=s[fn];await _._OrtBindInput(kn,lt[or],kt[fn])!==0&&pe(`Can't bind input[${fn}] for session=${e}.`)}for(let fn=0;fn<zt;fn++){let or=c[fn];(yn=d[fn])!=null&&yn[3]?_._OrtBindOutput(kn,at[or],St[fn],0)!==0&&pe(`Can't bind pre-allocated output[${fn}] for session=${e}.`):_._OrtBindOutput(kn,at[or],0,Sn[or])!==0&&pe(`Can't bind output[${fn}] to ${bn[fn]} for session=${e}.`)}At.set(e,[_e,lt,at,it,ct,!0])}(hn=_.jsepOnRunStart)==null||hn.call(_,_e),(_n=_.webnnOnRunStart)==null||_n.call(_,_e);let vn;it?vn=await _._OrtRunWithBinding(_e,it.handle,zt,cr,dt):vn=await _._OrtRun(_e,nr,Bt,pt,ur,zt,cr,dt),vn!==0&&pe("failed to call OrtRun().");let Tn=[];for(let kn=0;kn<zt;kn++){let bn=Number(_.getValue(cr+kn*g,"*"));if(bn===St[kn]){Tn.push(d[kn]);continue}let Sn=_.stackSave(),fn=_.stackAlloc(4*g),or=!1,lr,pn=0;try{_._OrtGetTensorData(bn,fn,fn+g,fn+2*g,fn+3*g)!==0&&pe(`Can't access output tensor data on index ${kn}.`);let Cn=g===4?"i32":"i64",Lo=Number(_.getValue(fn,Cn));pn=_.getValue(fn+g,"*");let Mo=_.getValue(fn+g*2,"*"),Ro=Number(_.getValue(fn+g*3,Cn)),qo=[];for(let En=0;En<Ro;En++)qo.push(Number(_.getValue(Mo+En*g,Cn)));_._OrtFree(Mo)!==0&&pe("Can't free memory for tensor dims.");let tp=qo.reduce((En,mr)=>En*mr,1);lr=Ye(Lo);let Wo=it==null?void 0:it.outputPreferredLocations[c[kn]];if(lr==="string"){if(Wo==="gpu-buffer"||Wo==="ml-tensor")throw new Error("String tensor is not supported on GPU.");let En=[];for(let mr=0;mr<tp;mr++){let Do=_.getValue(pn+mr*g,"*"),Go=_.getValue(pn+(mr+1)*g,"*"),Jo=mr===tp-1?void 0:Go-Do;En.push(_.UTF8ToString(Do,Jo))}Tn.push([lr,qo,En,"cpu"])}else if(Wo==="gpu-buffer"&&tp>0){let En=_.jsepGetBuffer;if(!En)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let mr=En(pn),Do=gt(Lo,tp);if(Do===void 0||!zr(lr))throw new Error(`Unsupported data type: ${lr}`);or=!0,Tn.push([lr,qo,{gpuBuffer:mr,download:_.jsepCreateDownloader(mr,Do,lr),dispose:()=>{_._OrtReleaseTensor(bn)!==0&&pe("Can't release tensor.")}},"gpu-buffer"])}else if(Wo==="ml-tensor"&&tp>0){let En=_.webnnEnsureTensor,mr=_.webnnIsInt64Supported;if(!En||!mr)throw new Error('preferredLocation "ml-tensor" is not supported without using WebNN.');if(gt(Lo,tp)===void 0||!Or(lr))throw new Error(`Unsupported data type: ${lr}`);if(lr==="int64"&&!mr(e))throw new Error('preferredLocation "ml-tensor" for int64 output is not supported by current WebNN Context.');let Do=await En(e,pn,Lo,qo,!1);or=!0,Tn.push([lr,qo,{mlTensor:Do,download:_.webnnCreateMLTensorDownloader(pn,lr),dispose:()=>{_.webnnReleaseTensorId(pn),_._OrtReleaseTensor(bn)}},"ml-tensor"])}else{let En=Pr(lr),mr=new En(tp);new Uint8Array(mr.buffer,mr.byteOffset,mr.byteLength).set(_.HEAPU8.subarray(pn,pn+mr.byteLength)),Tn.push([lr,qo,mr,"cpu"])}}finally{_.stackRestore(Sn),lr==="string"&&pn&&_._free(pn),or||_._OrtReleaseTensor(bn),(gn=_.webnnOnRunEnd)==null||gn.call(_,_e)}}return it&&!ct&&(_._OrtClearBoundOutputs(it.handle)!==0&&pe("Can't clear bound outputs."),At.set(e,[_e,lt,at,it,ct,!1])),Tn}finally{_.stackRestore(Gt),kt.forEach(vn=>_._OrtReleaseTensor(vn)),St.forEach(vn=>_._OrtReleaseTensor(vn)),Lt.forEach(vn=>_._free(vn)),dt!==0&&_._OrtReleaseRunOptions(dt),ft.forEach(vn=>_._free(vn))}},Ir=e=>{let s=fe(),i=At.get(e);if(!i)throw new Error("invalid session id");let c=i[0],d=s._OrtEndProfiling(c);d===0&&pe("Can't get an profile file name."),s._OrtFree(d)},Cr=e=>{let s=[];for(let i of e){let c=i[2];!Array.isArray(c)&&"buffer"in c&&s.push(c.buffer)}return s}}),Et,Le,rr,sn,un,an,Eo,ko,Vt,Wt,bg,ic,ac,sc,uc,dc,lc,cc,Po=U(()=>{We(),Vn(),ht(),_r(),Et=()=>!!ge.wasm.proxy&&typeof document<"u",rr=!1,sn=!1,un=!1,ko=new Map,Vt=(e,s)=>{let i=ko.get(e);i?i.push(s):ko.set(e,[s])},Wt=()=>{if(rr||!sn||un||!Le)throw new Error("worker not ready")},bg=e=>{switch(e.data.type){case"init-wasm":rr=!1,e.data.err?(un=!0,Eo[1](e.data.err)):(sn=!0,Eo[0]()),an&&(URL.revokeObjectURL(an),an=void 0);break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let s=ko.get(e.data.type);e.data.err?s.shift()[1](e.data.err):s.shift()[0](e.data.out);break}}},ic=async()=>{if(!sn){if(rr)throw new Error("multiple calls to 'initWasm()' detected.");if(un)throw new Error("previous call to 'initWasm()' failed.");if(rr=!0,Et())return new Promise((e,s)=>{Le==null||Le.terminate(),za().then(([i,c])=>{try{Le=c,Le.onerror=h=>s(h),Le.onmessage=bg,Eo=[e,s];let d={type:"init-wasm",in:ge};!d.in.wasm.wasmPaths&&(i||Gn)&&(d.in.wasm.wasmPaths={wasm:new URL("/assets/ort-wasm-simd-threaded.jsep-B0T3yYHD.wasm",import.meta.url).href}),Le.postMessage(d),an=i}catch(d){s(d)}},s)});try{await wr(ge.wasm),await vr(ge),sn=!0}catch(e){throw un=!0,e}finally{rr=!1}}},ac=async e=>{if(Et())return Wt(),new Promise((s,i)=>{Vt("init-ep",[s,i]);let c={type:"init-ep",in:{epName:e,env:ge}};Le.postMessage(c)});await $r(ge,e)},sc=async e=>Et()?(Wt(),new Promise((s,i)=>{Vt("copy-from",[s,i]);let c={type:"copy-from",in:{buffer:e}};Le.postMessage(c,[e.buffer])})):jt(e),uc=async(e,s)=>{if(Et()){if(s!=null&&s.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return Wt(),new Promise((i,c)=>{Vt("create",[i,c]);let d={type:"create",in:{model:e,options:{...s}}},h=[];e instanceof Uint8Array&&h.push(e.buffer),Le.postMessage(d,h)})}else return xr(e,s)},dc=async e=>{if(Et())return Wt(),new Promise((s,i)=>{Vt("release",[s,i]);let c={type:"release",in:e};Le.postMessage(c)});Sr(e)},lc=async(e,s,i,c,d,h)=>{if(Et()){if(i.some(_=>_[3]!=="cpu"))throw new Error("input tensor on GPU is not supported for proxy.");if(d.some(_=>_))throw new Error("pre-allocated output tensor is not supported for proxy.");return Wt(),new Promise((_,g)=>{Vt("run",[_,g]);let $=i,_e={type:"run",in:{sessionId:e,inputIndices:s,inputs:$,outputIndices:c,options:h}};Le.postMessage(_e,Cr($))})}else return Tr(e,s,i,c,d,h)},cc=async e=>{if(Et())return Wt(),new Promise((s,i)=>{Vt("end-profiling",[s,i]);let c={type:"end-profiling",in:e};Le.postMessage(c)});Ir(e)}}),pc,yg,dn,mc=U(()=>{We(),Po(),ee(),yr(),jn(),pc=(e,s)=>{switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];case"ml-tensor":return[e.type,e.dims,{mlTensor:e.mlTensor},"ml-tensor"];default:throw new Error(`invalid data location: ${e.location} for ${s()}`)}},yg=e=>{switch(e[3]){case"cpu":return new Ge(e[0],e[2],e[1]);case"gpu-buffer":{let s=e[0];if(!zr(s))throw new Error(`not supported data type: ${s} for deserializing GPU tensor`);let{gpuBuffer:i,download:c,dispose:d}=e[2];return Ge.fromGpuBuffer(i,{dataType:s,dims:e[1],download:c,dispose:d})}case"ml-tensor":{let s=e[0];if(!Or(s))throw new Error(`not supported data type: ${s} for deserializing MLTensor tensor`);let{mlTensor:i,download:c,dispose:d}=e[2];return Ge.fromMLTensor(i,{dataType:s,dims:e[1],download:c,dispose:d})}default:throw new Error(`invalid data location: ${e[3]}`)}},dn=class{async fetchModelAndCopyToWasmMemory(e){return sc(await Qt(e))}async loadModel(e,s){Re();let i;typeof e=="string"?i=await this.fetchModelAndCopyToWasmMemory(e):i=e,[this.sessionId,this.inputNames,this.outputNames,this.inputMetadata,this.outputMetadata]=await uc(i,s),Oe()}async dispose(){return dc(this.sessionId)}async run(e,s,i){Re();let c=[],d=[];Object.entries(e).forEach(at=>{let it=at[0],ct=at[1],mt=this.inputNames.indexOf(it);if(mt===-1)throw new Error(`invalid input '${it}'`);c.push(ct),d.push(mt)});let h=[],_=[];Object.entries(s).forEach(at=>{let it=at[0],ct=at[1],mt=this.outputNames.indexOf(it);if(mt===-1)throw new Error(`invalid output '${it}'`);h.push(ct),_.push(mt)});let g=c.map((at,it)=>pc(at,()=>`input "${this.inputNames[d[it]]}"`)),$=h.map((at,it)=>at?pc(at,()=>`output "${this.outputNames[_[it]]}"`):null),_e=await lc(this.sessionId,d,g,_,$,i),lt={};for(let at=0;at<_e.length;at++)lt[this.outputNames[_[at]]]=h[at]??yg(_e[at]);return Oe(),lt}startProfiling(){}endProfiling(){cc(this.sessionId)}}}),hc={};Dt(hc,{OnnxruntimeWebAssemblyBackend:()=>ln,initializeFlags:()=>fc,wasmBackend:()=>_g});var fc,ln,_g,gc=U(()=>{We(),Po(),mc(),fc=()=>{(typeof ge.wasm.initTimeout!="number"||ge.wasm.initTimeout<0)&&(ge.wasm.initTimeout=0);let e=ge.wasm.simd;if(typeof e!="boolean"&&e!==void 0&&e!=="fixed"&&e!=="relaxed"&&(console.warn(`Property "env.wasm.simd" is set to unknown value "${e}". Reset it to \`false\` and ignore SIMD feature checking.`),ge.wasm.simd=!1),typeof ge.wasm.proxy!="boolean"&&(ge.wasm.proxy=!1),typeof ge.wasm.trace!="boolean"&&(ge.wasm.trace=!1),typeof ge.wasm.numThreads!="number"||!Number.isInteger(ge.wasm.numThreads)||ge.wasm.numThreads<=0)if(typeof self<"u"&&!self.crossOriginIsolated)ge.wasm.numThreads=1;else{let s=typeof navigator>"u"?On("node:os").cpus().length:navigator.hardwareConcurrency;ge.wasm.numThreads=Math.min(4,Math.ceil((s||1)/2))}},ln=class{async init(e){fc(),await ic(),await ac(e)}async createInferenceSessionHandler(e,s){let i=new dn;return await i.loadModel(e,s),i}},_g=new ln});We();We();We();var _a="1.22.0-dev.20250409-89f8206ba4",IS=Nn;{let e=(gc(),Ft(hc)).wasmBackend;$t("webgpu",e,5),$t("webnn",e,5),$t("cpu",e,10),$t("wasm",e,10)}Object.defineProperty(ge.versions,"web",{value:_a,enumerable:!0});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const __WEBPACK_EXTERNAL_MODULE_onnxruntime_web_74d14b94__=Object.freeze(Object.defineProperty({__proto__:null,get InferenceSession(){return Gp},get TRACE(){return gr},get TRACE_FUNC_BEGIN(){return Re},get TRACE_FUNC_END(){return Oe},get Tensor(){return Ge},default:IS,get env(){return ge},get registerBackend(){return $t}},Symbol.toStringTag,{value:"Module"}));var define_process_env_default={},__webpack_modules__={"onnxruntime-common":e=>{e.exports=__WEBPACK_EXTERNAL_MODULE_onnxruntime_common_82b39e9f__},"onnxruntime-web":e=>{e.exports=__WEBPACK_EXTERNAL_MODULE_onnxruntime_web_74d14b94__},"?2ce3":()=>{},"?7992":()=>{},"?5af5":()=>{},"?2b25":()=>{},"?db59":()=>{},"?383f":()=>{},"?fa4b":()=>{},"./node_modules/@huggingface/jinja/dist/index.js":(e,s,i)=>{i.r(s),i.d(s,{Environment:()=>ip,Interpreter:()=>Rp,Template:()=>m_,parse:()=>Mo,tokenize:()=>lt});var c=Object.freeze({Text:"Text",NumericLiteral:"NumericLiteral",StringLiteral:"StringLiteral",Identifier:"Identifier",Equals:"Equals",OpenParen:"OpenParen",CloseParen:"CloseParen",OpenStatement:"OpenStatement",CloseStatement:"CloseStatement",OpenExpression:"OpenExpression",CloseExpression:"CloseExpression",OpenSquareBracket:"OpenSquareBracket",CloseSquareBracket:"CloseSquareBracket",OpenCurlyBracket:"OpenCurlyBracket",CloseCurlyBracket:"CloseCurlyBracket",Comma:"Comma",Dot:"Dot",Colon:"Colon",Pipe:"Pipe",CallOperator:"CallOperator",AdditiveBinaryOperator:"AdditiveBinaryOperator",MultiplicativeBinaryOperator:"MultiplicativeBinaryOperator",ComparisonBinaryOperator:"ComparisonBinaryOperator",UnaryOperator:"UnaryOperator",Comment:"Comment"}),d=class{constructor(ir,In){this.value=ir,this.type=In}};function h(ir){return/\w/.test(ir)}function _(ir){return/[0-9]/.test(ir)}var g=[["{%",c.OpenStatement],["%}",c.CloseStatement],["{{",c.OpenExpression],["}}",c.CloseExpression],["(",c.OpenParen],[")",c.CloseParen],["{",c.OpenCurlyBracket],["}",c.CloseCurlyBracket],["[",c.OpenSquareBracket],["]",c.CloseSquareBracket],[",",c.Comma],[".",c.Dot],[":",c.Colon],["|",c.Pipe],["<=",c.ComparisonBinaryOperator],[">=",c.ComparisonBinaryOperator],["==",c.ComparisonBinaryOperator],["!=",c.ComparisonBinaryOperator],["<",c.ComparisonBinaryOperator],[">",c.ComparisonBinaryOperator],["+",c.AdditiveBinaryOperator],["-",c.AdditiveBinaryOperator],["~",c.AdditiveBinaryOperator],["*",c.MultiplicativeBinaryOperator],["/",c.MultiplicativeBinaryOperator],["%",c.MultiplicativeBinaryOperator],["=",c.Equals]],$=new Map([["n",`
`],["t","	"],["r","\r"],["b","\b"],["f","\f"],["v","\v"],["'","'"],['"','"'],["\\","\\"]]);function _e(ir,In={}){return ir.endsWith(`
`)&&(ir=ir.slice(0,-1)),In.lstrip_blocks&&(ir=ir.replace(/^[ \t]*({[#%-])/gm,"$1")),In.trim_blocks&&(ir=ir.replace(/([#%-]})\n/g,"$1")),ir.replace(/-%}\s*/g,"%}").replace(/\s*{%-/g,"{%").replace(/-}}\s*/g,"}}").replace(/\s*{{-/g,"{{").replace(/-#}\s*/g,"#}").replace(/\s*{#-/g,"{#").replace(/{%\s*(end)?generation\s*%}/gs,"")}function lt(ir,In={}){var Cp,n_;const wn=[],An=_e(ir,In);let No=0,Yo=0;const sp=zp=>{let i_="";for(;zp(An[No]);){if(An[No]==="\\"){if(++No,No>=An.length)throw new SyntaxError("Unexpected end of input");const kp=An[No++],h_=$.get(kp);if(h_===void 0)throw new SyntaxError(`Unexpected escaped character: ${kp}`);i_+=h_;continue}if(i_+=An[No++],No>=An.length)throw new SyntaxError("Unexpected end of input")}return i_};e:for(;No<An.length;){const zp=(Cp=wn.at(-1))==null?void 0:Cp.type;if(zp===void 0||zp===c.CloseStatement||zp===c.CloseExpression||zp===c.Comment){let kp="";for(;No<An.length&&!(An[No]==="{"&&(An[No+1]==="%"||An[No+1]==="{"||An[No+1]==="#"));)kp+=An[No++];if(kp.length>0){wn.push(new d(kp,c.Text));continue}}if(An[No]==="{"&&An[No+1]==="#"){No+=2;let kp="";for(;An[No]!=="#"||An[No+1]!=="}";){if(No+2>=An.length)throw new SyntaxError("Missing end of comment tag");kp+=An[No++]}wn.push(new d(kp,c.Comment)),No+=2;continue}sp(kp=>/\s/.test(kp));const i_=An[No];if(i_==="-"||i_==="+"){const kp=(n_=wn.at(-1))==null?void 0:n_.type;if(kp===c.Text||kp===void 0)throw new SyntaxError(`Unexpected character: ${i_}`);switch(kp){case c.Identifier:case c.NumericLiteral:case c.StringLiteral:case c.CloseParen:case c.CloseSquareBracket:break;default:{++No;const h_=sp(_);wn.push(new d(`${i_}${h_}`,h_.length>0?c.NumericLiteral:c.UnaryOperator));continue}}}for(const[kp,h_]of g){if(kp==="}}"&&Yo>0)continue;if(An.slice(No,No+kp.length)===kp){wn.push(new d(kp,h_)),h_===c.OpenExpression?Yo=0:h_===c.OpenCurlyBracket?++Yo:h_===c.CloseCurlyBracket&&--Yo,No+=kp.length;continue e}}if(i_==="'"||i_==='"'){++No;const kp=sp(h_=>h_!==i_);wn.push(new d(kp,c.StringLiteral)),++No;continue}if(_(i_)){let kp=sp(_);if(An[No]==="."&&_(An[No+1])){++No;const h_=sp(_);kp=`${kp}.${h_}`}wn.push(new d(kp,c.NumericLiteral));continue}if(h(i_)){const kp=sp(h);wn.push(new d(kp,c.Identifier));continue}throw new SyntaxError(`Unexpected character: ${i_}`)}return wn}var at=class{constructor(){Oo(this,"type","Statement")}},it=class extends at{constructor(In){super();Oo(this,"type","Program");this.body=In}},ct=class extends at{constructor(In,wn,An){super();Oo(this,"type","If");this.test=In,this.body=wn,this.alternate=An}},mt=class extends at{constructor(In,wn,An,No){super();Oo(this,"type","For");this.loopvar=In,this.iterable=wn,this.body=An,this.defaultBlock=No}},pt=class extends at{constructor(){super(...arguments);Oo(this,"type","Break")}},zt=class extends at{constructor(){super(...arguments);Oo(this,"type","Continue")}},dt=class extends at{constructor(In,wn,An){super();Oo(this,"type","Set");this.assignee=In,this.value=wn,this.body=An}},ft=class extends at{constructor(In,wn,An){super();Oo(this,"type","Macro");this.name=In,this.args=wn,this.body=An}},kt=class extends at{constructor(In){super();Oo(this,"type","Comment");this.value=In}},St=class extends at{constructor(){super(...arguments);Oo(this,"type","Expression")}},Lt=class extends St{constructor(In,wn,An){super();Oo(this,"type","MemberExpression");this.object=In,this.property=wn,this.computed=An}},Gt=class extends St{constructor(In,wn){super();Oo(this,"type","CallExpression");this.callee=In,this.args=wn}},Bt=class extends St{constructor(In){super();Oo(this,"type","Identifier");this.value=In}},nr=class extends St{constructor(In){super();Oo(this,"type","Literal");this.value=In}},cr=class extends nr{constructor(){super(...arguments);Oo(this,"type","IntegerLiteral")}},ur=class extends nr{constructor(){super(...arguments);Oo(this,"type","FloatLiteral")}},yn=class extends nr{constructor(){super(...arguments);Oo(this,"type","StringLiteral")}},hn=class extends nr{constructor(){super(...arguments);Oo(this,"type","ArrayLiteral")}},_n=class extends nr{constructor(){super(...arguments);Oo(this,"type","TupleLiteral")}},gn=class extends nr{constructor(){super(...arguments);Oo(this,"type","ObjectLiteral")}},vn=class extends St{constructor(In,wn,An){super();Oo(this,"type","BinaryExpression");this.operator=In,this.left=wn,this.right=An}},Tn=class extends St{constructor(In,wn){super();Oo(this,"type","FilterExpression");this.operand=In,this.filter=wn}},kn=class extends at{constructor(In,wn){super();Oo(this,"type","FilterStatement");this.filter=In,this.body=wn}},bn=class extends St{constructor(In,wn){super();Oo(this,"type","SelectExpression");this.lhs=In,this.test=wn}},Sn=class extends St{constructor(In,wn,An){super();Oo(this,"type","TestExpression");this.operand=In,this.negate=wn,this.test=An}},fn=class extends St{constructor(In,wn){super();Oo(this,"type","UnaryExpression");this.operator=In,this.argument=wn}},or=class extends St{constructor(In=void 0,wn=void 0,An=void 0){super();Oo(this,"type","SliceExpression");this.start=In,this.stop=wn,this.step=An}},lr=class extends St{constructor(In,wn){super();Oo(this,"type","KeywordArgumentExpression");this.key=In,this.value=wn}},pn=class extends St{constructor(In){super();Oo(this,"type","SpreadExpression");this.argument=In}},Cn=class extends at{constructor(In,wn,An){super();Oo(this,"type","CallStatement");this.call=In,this.callerArgs=wn,this.body=An}},Lo=class extends St{constructor(In,wn,An){super();Oo(this,"type","Ternary");this.condition=In,this.trueExpr=wn,this.falseExpr=An}};function Mo(ir){const In=new it([]);let wn=0;function An(dp,pp){const $p=ir[wn++];if(!$p||$p.type!==dp)throw new Error(`Parser Error: ${pp}. ${$p.type} !== ${dp}.`);return $p}function No(dp){if(!n_(dp))throw new SyntaxError(`Expected ${dp}`);++wn}function Yo(){switch(ir[wn].type){case c.Comment:return new kt(ir[wn++].value);case c.Text:return zp();case c.OpenStatement:return i_();case c.OpenExpression:return kp();default:throw new SyntaxError(`Unexpected token type: ${ir[wn].type}`)}}function sp(...dp){return wn+dp.length<=ir.length&&dp.every((pp,$p)=>pp===ir[wn+$p].type)}function Cp(...dp){var pp,$p,P_;return((pp=ir[wn])==null?void 0:pp.type)===c.OpenStatement&&(($p=ir[wn+1])==null?void 0:$p.type)===c.Identifier&&dp.includes((P_=ir[wn+1])==null?void 0:P_.value)}function n_(...dp){return wn+dp.length<=ir.length&&dp.every((pp,$p)=>ir[wn+$p].type==="Identifier"&&pp===ir[wn+$p].value)}function zp(){return new yn(An(c.Text,"Expected text token").value)}function i_(){if(An(c.OpenStatement,"Expected opening statement token"),ir[wn].type!==c.Identifier)throw new SyntaxError(`Unknown statement, got ${ir[wn].type}`);const dp=ir[wn].value;let pp;switch(dp){case"set":++wn,pp=h_();break;case"if":++wn,pp=$_(),An(c.OpenStatement,"Expected {% token"),No("endif"),An(c.CloseStatement,"Expected %} token");break;case"macro":++wn,pp=xx(),An(c.OpenStatement,"Expected {% token"),No("endmacro"),An(c.CloseStatement,"Expected %} token");break;case"for":++wn,pp=N_(),An(c.OpenStatement,"Expected {% token"),No("endfor"),An(c.CloseStatement,"Expected %} token");break;case"call":{++wn;let $p=null;sp(c.OpenParen)&&($p=kx());const P_=wx();if(P_.type!=="Identifier")throw new SyntaxError("Expected identifier following call statement");const nw=kx();An(c.CloseStatement,"Expected closing statement token");const Ux=[];for(;!Cp("endcall");)Ux.push(Yo());An(c.OpenStatement,"Expected '{%'"),No("endcall"),An(c.CloseStatement,"Expected closing statement token");const Px=new Gt(P_,nw);pp=new Cn(Px,$p,Ux);break}case"break":++wn,An(c.CloseStatement,"Expected closing statement token"),pp=new pt;break;case"continue":++wn,An(c.CloseStatement,"Expected closing statement token"),pp=new zt;break;case"filter":{++wn;let $p=wx();$p instanceof Bt&&sp(c.OpenParen)&&($p=jx($p)),An(c.CloseStatement,"Expected closing statement token");const P_=[];for(;!Cp("endfilter");)P_.push(Yo());An(c.OpenStatement,"Expected '{%'"),No("endfilter"),An(c.CloseStatement,"Expected '%}'"),pp=new kn($p,P_);break}default:throw new SyntaxError(`Unknown statement type: ${dp}`)}return pp}function kp(){An(c.OpenExpression,"Expected opening expression token");const dp=lx();return An(c.CloseExpression,"Expected closing expression token"),dp}function h_(){const dp=bx();let pp=null;const $p=[];if(sp(c.Equals))++wn,pp=bx();else{for(An(c.CloseStatement,"Expected %} token");!Cp("endset");)$p.push(Yo());An(c.OpenStatement,"Expected {% token"),No("endset")}return An(c.CloseStatement,"Expected closing statement token"),new dt(dp,pp,$p)}function $_(){const dp=lx();An(c.CloseStatement,"Expected closing statement token");const pp=[],$p=[];for(;!Cp("elif","else","endif");)pp.push(Yo());if(Cp("elif")){++wn,++wn;const P_=$_();$p.push(P_)}else if(Cp("else"))for(++wn,++wn,An(c.CloseStatement,"Expected closing statement token");!Cp("endif");)$p.push(Yo());return new ct(dp,pp,$p)}function xx(){const dp=wx();if(dp.type!=="Identifier")throw new SyntaxError("Expected identifier following macro statement");const pp=kx();An(c.CloseStatement,"Expected closing statement token");const $p=[];for(;!Cp("endmacro");)$p.push(Yo());return new ft(dp,pp,$p)}function bx(dp=!1){const pp=dp?wx:lx,$p=[pp()],P_=sp(c.Comma);for(;P_&&(++wn,$p.push(pp()),!!sp(c.Comma)););return P_?new _n($p):$p[0]}function N_(){const dp=bx(!0);if(!(dp instanceof Bt||dp instanceof _n))throw new SyntaxError(`Expected identifier/tuple for the loop variable, got ${dp.type} instead`);if(!n_("in"))throw new SyntaxError("Expected `in` keyword following loop variable");++wn;const pp=lx();An(c.CloseStatement,"Expected closing statement token");const $p=[];for(;!Cp("endfor","else");)$p.push(Yo());const P_=[];if(Cp("else"))for(++wn,++wn,An(c.CloseStatement,"Expected closing statement token");!Cp("endfor");)P_.push(Yo());return new mt(dp,pp,$p,P_)}function lx(){return B_()}function B_(){const dp=Rx();if(n_("if")){++wn;const pp=Rx();if(n_("else")){++wn;const $p=B_();return new Lo(pp,dp,$p)}else return new bn(dp,pp)}return dp}function Rx(){let dp=Ox();for(;n_("or");){const pp=ir[wn];++wn;const $p=Ox();dp=new vn(pp,dp,$p)}return dp}function Ox(){let dp=ux();for(;n_("and");){const pp=ir[wn];++wn;const $p=ux();dp=new vn(pp,dp,$p)}return dp}function ux(){let dp;for(;n_("not");){const pp=ir[wn];++wn;const $p=ux();dp=new fn(pp,$p)}return dp??Qx()}function Qx(){let dp=Xx();for(;;){let pp;if(n_("not","in"))pp=new d("not in",c.Identifier),wn+=2;else if(n_("in"))pp=ir[wn++];else if(sp(c.ComparisonBinaryOperator))pp=ir[wn++];else break;const $p=Xx();dp=new vn(pp,dp,$p)}return dp}function Xx(){let dp=L_();for(;sp(c.AdditiveBinaryOperator);){const pp=ir[wn];++wn;const $p=L_();dp=new vn(pp,dp,$p)}return dp}function rx(){const dp=K_(wx());return sp(c.OpenParen)?jx(dp):dp}function jx(dp){let pp=new Gt(dp,kx());return pp=K_(pp),sp(c.OpenParen)&&(pp=jx(pp)),pp}function kx(){An(c.OpenParen,"Expected opening parenthesis for arguments list");const dp=_x();return An(c.CloseParen,"Expected closing parenthesis for arguments list"),dp}function _x(){const dp=[];for(;!sp(c.CloseParen);){let pp;if(ir[wn].type===c.MultiplicativeBinaryOperator&&ir[wn].value==="*"){++wn;const $p=lx();pp=new pn($p)}else if(pp=lx(),sp(c.Equals)){if(++wn,!(pp instanceof Bt))throw new SyntaxError("Expected identifier for keyword argument");const $p=lx();pp=new lr(pp,$p)}dp.push(pp),sp(c.Comma)&&++wn}return dp}function Bx(){const dp=[];let pp=!1;for(;!sp(c.CloseSquareBracket);)sp(c.Colon)?(dp.push(void 0),++wn,pp=!0):(dp.push(lx()),sp(c.Colon)&&(++wn,pp=!0));if(dp.length===0)throw new SyntaxError("Expected at least one argument for member/slice expression");if(pp){if(dp.length>3)throw new SyntaxError("Expected 0-3 arguments for slice expression");return new or(...dp)}return dp[0]}function K_(dp){for(;sp(c.Dot)||sp(c.OpenSquareBracket);){const pp=ir[wn];++wn;let $p;const P_=pp.type===c.OpenSquareBracket;if(P_)$p=Bx(),An(c.CloseSquareBracket,"Expected closing square bracket");else if($p=wx(),$p.type!=="Identifier")throw new SyntaxError("Expected identifier following dot operator");dp=new Lt(dp,$p,P_)}return dp}function L_(){let dp=Nx();for(;sp(c.MultiplicativeBinaryOperator);){const pp=ir[wn++],$p=Nx();dp=new vn(pp,dp,$p)}return dp}function Nx(){let dp=rw();for(;n_("is");){++wn;const pp=n_("not");pp&&++wn;const $p=wx();if(!($p instanceof Bt))throw new SyntaxError("Expected identifier for the test");dp=new Sn(dp,pp,$p)}return dp}function rw(){let dp=rx();for(;sp(c.Pipe);){++wn;let pp=wx();if(!(pp instanceof Bt))throw new SyntaxError("Expected identifier for the filter");sp(c.OpenParen)&&(pp=jx(pp)),dp=new Tn(dp,pp)}return dp}function wx(){const dp=ir[wn++];switch(dp.type){case c.NumericLiteral:{const pp=dp.value;return pp.includes(".")?new ur(Number(pp)):new cr(Number(pp))}case c.StringLiteral:{let pp=dp.value;for(;sp(c.StringLiteral);)pp+=ir[wn++].value;return new yn(pp)}case c.Identifier:return new Bt(dp.value);case c.OpenParen:{const pp=bx();return An(c.CloseParen,"Expected closing parenthesis, got ${tokens[current].type} instead."),pp}case c.OpenSquareBracket:{const pp=[];for(;!sp(c.CloseSquareBracket);)pp.push(lx()),sp(c.Comma)&&++wn;return++wn,new hn(pp)}case c.OpenCurlyBracket:{const pp=new Map;for(;!sp(c.CloseCurlyBracket);){const $p=lx();An(c.Colon,"Expected colon between key and value in object literal");const P_=lx();pp.set($p,P_),sp(c.Comma)&&++wn}return++wn,new gn(pp)}default:throw new SyntaxError(`Unexpected token: ${dp.type}`)}}for(;wn<ir.length;)In.body.push(Yo());return In}function Ro(ir,In,wn=1){In===void 0&&(In=ir,ir=0);const An=[];for(let No=ir;No<In;No+=wn)An.push(No);return An}function qo(ir,In,wn,An=1){const No=Math.sign(An);No>=0?(In=(In??(In=0))<0?Math.max(ir.length+In,0):Math.min(In,ir.length),wn=(wn??(wn=ir.length))<0?Math.max(ir.length+wn,0):Math.min(wn,ir.length)):(In=(In??(In=ir.length-1))<0?Math.max(ir.length+In,-1):Math.min(In,ir.length-1),wn=(wn??(wn=-1))<-1?Math.max(ir.length+wn,-1):Math.min(wn,ir.length-1));const Yo=[];for(let sp=In;No*sp<No*wn;sp+=An)Yo.push(ir[sp]);return Yo}function tp(ir){return ir.replace(/\b\w/g,In=>In.toUpperCase())}function Wo(ir){return En(new Date,ir)}function En(ir,In){const wn=new Intl.DateTimeFormat(void 0,{month:"long"}),An=new Intl.DateTimeFormat(void 0,{month:"short"}),No=Yo=>Yo<10?"0"+Yo:Yo.toString();return In.replace(/%[YmdbBHM%]/g,Yo=>{switch(Yo){case"%Y":return ir.getFullYear().toString();case"%m":return No(ir.getMonth()+1);case"%d":return No(ir.getDate());case"%b":return An.format(ir);case"%B":return wn.format(ir);case"%H":return No(ir.getHours());case"%M":return No(ir.getMinutes());case"%%":return"%";default:return Yo}})}function mr(ir){return ir.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Do(ir,In,wn,An){if(An===0)return ir;let No=An==null||An<0?1/0:An;const Yo=In.length===0?new RegExp("(?=)","gu"):new RegExp(mr(In),"gu");return ir.replaceAll(Yo,sp=>No>0?(--No,wn):sp)}var Go=class extends Error{},Jo=class extends Error{},_i=class{constructor(ir=void 0){Oo(this,"type","RuntimeValue");Oo(this,"value");Oo(this,"builtins",new Map);this.value=ir}__bool__(){return new ep(!!this.value)}toString(){return String(this.value)}},Ho=class extends _i{constructor(){super(...arguments);Oo(this,"type","IntegerValue")}},_c=class extends _i{constructor(){super(...arguments);Oo(this,"type","FloatValue")}toString(){return this.value%1===0?this.value.toFixed(1):this.value.toString()}},Qo=class extends _i{constructor(){super(...arguments);Oo(this,"type","StringValue");Oo(this,"builtins",new Map([["upper",new gp(()=>new Qo(this.value.toUpperCase()))],["lower",new gp(()=>new Qo(this.value.toLowerCase()))],["strip",new gp(()=>new Qo(this.value.trim()))],["title",new gp(()=>new Qo(tp(this.value)))],["capitalize",new gp(()=>new Qo(this.value.charAt(0).toUpperCase()+this.value.slice(1)))],["length",new Ho(this.value.length)],["rstrip",new gp(()=>new Qo(this.value.trimEnd()))],["lstrip",new gp(()=>new Qo(this.value.trimStart()))],["startswith",new gp(In=>{if(In.length===0)throw new Error("startswith() requires at least one argument");const wn=In[0];if(wn instanceof Qo)return new ep(this.value.startsWith(wn.value));if(wn instanceof Zo){for(const An of wn.value){if(!(An instanceof Qo))throw new Error("startswith() tuple elements must be strings");if(this.value.startsWith(An.value))return new ep(!0)}return new ep(!1)}throw new Error("startswith() argument must be a string or tuple of strings")})],["endswith",new gp(In=>{if(In.length===0)throw new Error("endswith() requires at least one argument");const wn=In[0];if(wn instanceof Qo)return new ep(this.value.endsWith(wn.value));if(wn instanceof Zo){for(const An of wn.value){if(!(An instanceof Qo))throw new Error("endswith() tuple elements must be strings");if(this.value.endsWith(An.value))return new ep(!0)}return new ep(!1)}throw new Error("endswith() argument must be a string or tuple of strings")})],["split",new gp(In=>{const wn=In[0]??new Mp;if(!(wn instanceof Qo||wn instanceof Mp))throw new Error("sep argument must be a string or null");const An=In[1]??new Ho(-1);if(!(An instanceof Ho))throw new Error("maxsplit argument must be a number");let No=[];if(wn instanceof Mp){const Yo=this.value.trimStart();for(const{0:sp,index:Cp}of Yo.matchAll(/\S+/g)){if(An.value!==-1&&No.length>=An.value&&Cp!==void 0){No.push(sp+Yo.slice(Cp+sp.length));break}No.push(sp)}}else{if(wn.value==="")throw new Error("empty separator");No=this.value.split(wn.value),An.value!==-1&&No.length>An.value&&No.push(No.splice(An.value).join(wn.value))}return new Zo(No.map(Yo=>new Qo(Yo)))})],["replace",new gp(In=>{if(In.length<2)throw new Error("replace() requires at least two arguments");const wn=In[0],An=In[1];if(!(wn instanceof Qo&&An instanceof Qo))throw new Error("replace() arguments must be strings");let No;if(In.length>2?In[2].type==="KeywordArgumentsValue"?No=In[2].value.get("count")??new Mp:No=In[2]:No=new Mp,!(No instanceof Ho||No instanceof Mp))throw new Error("replace() count argument must be a number or null");return new Qo(Do(this.value,wn.value,An.value,No.value))})]]))}},ep=class extends _i{constructor(){super(...arguments);Oo(this,"type","BooleanValue")}},lp=class extends _i{constructor(){super(...arguments);Oo(this,"type","ObjectValue");Oo(this,"builtins",new Map([["get",new gp(([In,wn])=>{if(!(In instanceof Qo))throw new Error(`Object key must be a string: got ${In.type}`);return this.value.get(In.value)??wn??new Mp})],["items",new gp(()=>this.items())],["keys",new gp(()=>this.keys())],["values",new gp(()=>this.values())]]))}__bool__(){return new ep(this.value.size>0)}items(){return new Zo(Array.from(this.value.entries()).map(([In,wn])=>new Zo([new Qo(In),wn])))}keys(){return new Zo(Array.from(this.value.keys()).map(In=>new Qo(In)))}values(){return new Zo(Array.from(this.value.values()))}},_p=class extends lp{constructor(){super(...arguments);Oo(this,"type","KeywordArgumentsValue")}},Zo=class extends _i{constructor(){super(...arguments);Oo(this,"type","ArrayValue");Oo(this,"builtins",new Map([["length",new Ho(this.value.length)]]))}__bool__(){return new ep(this.value.length>0)}},bp=class extends Zo{constructor(){super(...arguments);Oo(this,"type","TupleValue")}},gp=class extends _i{constructor(){super(...arguments);Oo(this,"type","FunctionValue")}},Mp=class extends _i{constructor(){super(...arguments);Oo(this,"type","NullValue")}},wp=class extends _i{constructor(){super(...arguments);Oo(this,"type","UndefinedValue")}},ip=class{constructor(ir){Oo(this,"variables",new Map([["namespace",new gp(ir=>{if(ir.length===0)return new lp(new Map);if(ir.length!==1||!(ir[0]instanceof lp))throw new Error("`namespace` expects either zero arguments or a single object argument");return ir[0]})]]));Oo(this,"tests",new Map([["boolean",ir=>ir.type==="BooleanValue"],["callable",ir=>ir instanceof gp],["odd",ir=>{if(!(ir instanceof Ho))throw new Error(`cannot odd on ${ir.type}`);return ir.value%2!==0}],["even",ir=>{if(!(ir instanceof Ho))throw new Error(`cannot even on ${ir.type}`);return ir.value%2===0}],["false",ir=>ir.type==="BooleanValue"&&!ir.value],["true",ir=>ir.type==="BooleanValue"&&ir.value],["none",ir=>ir.type==="NullValue"],["string",ir=>ir.type==="StringValue"],["number",ir=>ir instanceof Ho||ir instanceof _c],["integer",ir=>ir instanceof Ho],["iterable",ir=>ir.type==="ArrayValue"||ir.type==="StringValue"],["mapping",ir=>ir.type==="ObjectValue"],["lower",ir=>{const In=ir.value;return ir.type==="StringValue"&&In===In.toLowerCase()}],["upper",ir=>{const In=ir.value;return ir.type==="StringValue"&&In===In.toUpperCase()}],["none",ir=>ir.type==="NullValue"],["defined",ir=>ir.type!=="UndefinedValue"],["undefined",ir=>ir.type==="UndefinedValue"],["equalto",(ir,In)=>ir.value===In.value],["eq",(ir,In)=>ir.value===In.value]]));this.parent=ir}set(ir,In){return this.declareVariable(ir,Ap(In))}declareVariable(ir,In){if(this.variables.has(ir))throw new SyntaxError(`Variable already declared: ${ir}`);return this.variables.set(ir,In),In}setVariable(ir,In){return this.variables.set(ir,In),In}resolve(ir){if(this.variables.has(ir))return this;if(this.parent)return this.parent.resolve(ir);throw new Error(`Unknown variable: ${ir}`)}lookupVariable(ir){try{return this.resolve(ir).variables.get(ir)??new wp}catch{return new wp}}};function fp(ir){ir.set("false",!1),ir.set("true",!0),ir.set("none",null),ir.set("raise_exception",In=>{throw new Error(In)}),ir.set("range",Ro),ir.set("strftime_now",Wo),ir.set("True",!0),ir.set("False",!1),ir.set("None",null)}var Rp=class{constructor(ir){Oo(this,"global");this.global=ir??new ip}run(ir){return this.evaluate(ir,this.global)}evaluateBinaryExpression(ir,In){const wn=this.evaluate(ir.left,In);switch(ir.operator.value){case"and":return wn.__bool__().value?this.evaluate(ir.right,In):wn;case"or":return wn.__bool__().value?wn:this.evaluate(ir.right,In)}const An=this.evaluate(ir.right,In);switch(ir.operator.value){case"==":return new ep(wn.value==An.value);case"!=":return new ep(wn.value!=An.value)}if(wn instanceof wp||An instanceof wp){if(An instanceof wp&&["in","not in"].includes(ir.operator.value))return new ep(ir.operator.value==="not in");throw new Error(`Cannot perform operation ${ir.operator.value} on undefined values`)}else{if(wn instanceof Mp||An instanceof Mp)throw new Error("Cannot perform operation on null values");if(ir.operator.value==="~")return new Qo(wn.value.toString()+An.value.toString());if((wn instanceof Ho||wn instanceof _c)&&(An instanceof Ho||An instanceof _c)){const No=wn.value,Yo=An.value;switch(ir.operator.value){case"+":case"-":case"*":{const sp=ir.operator.value==="+"?No+Yo:ir.operator.value==="-"?No-Yo:No*Yo;return wn instanceof _c||An instanceof _c?new _c(sp):new Ho(sp)}case"/":return new _c(No/Yo);case"%":{const sp=No%Yo;return wn instanceof _c||An instanceof _c?new _c(sp):new Ho(sp)}case"<":return new ep(No<Yo);case">":return new ep(No>Yo);case">=":return new ep(No>=Yo);case"<=":return new ep(No<=Yo)}}else if(wn instanceof Zo&&An instanceof Zo)switch(ir.operator.value){case"+":return new Zo(wn.value.concat(An.value))}else if(An instanceof Zo){const No=An.value.find(Yo=>Yo.value===wn.value)!==void 0;switch(ir.operator.value){case"in":return new ep(No);case"not in":return new ep(!No)}}}if(wn instanceof Qo||An instanceof Qo)switch(ir.operator.value){case"+":return new Qo(wn.value.toString()+An.value.toString())}if(wn instanceof Qo&&An instanceof Qo)switch(ir.operator.value){case"in":return new ep(An.value.includes(wn.value));case"not in":return new ep(!An.value.includes(wn.value))}if(wn instanceof Qo&&An instanceof lp)switch(ir.operator.value){case"in":return new ep(An.value.has(wn.value));case"not in":return new ep(!An.value.has(wn.value))}throw new SyntaxError(`Unknown operator "${ir.operator.value}" between ${wn.type} and ${An.type}`)}evaluateArguments(ir,In){const wn=[],An=new Map;for(const No of ir)if(No.type==="SpreadExpression"){const Yo=No,sp=this.evaluate(Yo.argument,In);if(!(sp instanceof Zo))throw new Error(`Cannot unpack non-iterable type: ${sp.type}`);for(const Cp of sp.value)wn.push(Cp)}else if(No.type==="KeywordArgumentExpression"){const Yo=No;An.set(Yo.key.value,this.evaluate(Yo.value,In))}else{if(An.size>0)throw new Error("Positional arguments must come before keyword arguments");wn.push(this.evaluate(No,In))}return[wn,An]}applyFilter(ir,In,wn){if(In.type==="Identifier"){const An=In;if(An.value==="tojson")return new Qo(u_(ir));if(ir instanceof Zo)switch(An.value){case"list":return ir;case"first":return ir.value[0];case"last":return ir.value[ir.value.length-1];case"length":return new Ho(ir.value.length);case"reverse":return new Zo(ir.value.reverse());case"sort":return new Zo(ir.value.sort((No,Yo)=>{if(No.type!==Yo.type)throw new Error(`Cannot compare different types: ${No.type} and ${Yo.type}`);switch(No.type){case"IntegerValue":case"FloatValue":return No.value-Yo.value;case"StringValue":return No.value.localeCompare(Yo.value);default:throw new Error(`Cannot compare type: ${No.type}`)}}));case"join":return new Qo(ir.value.map(No=>No.value).join(""));case"string":return new Qo(u_(ir));case"unique":{const No=new Set,Yo=[];for(const sp of ir.value)No.has(sp.value)||(No.add(sp.value),Yo.push(sp));return new Zo(Yo)}default:throw new Error(`Unknown ArrayValue filter: ${An.value}`)}else if(ir instanceof Qo)switch(An.value){case"length":case"upper":case"lower":case"title":case"capitalize":{const No=ir.builtins.get(An.value);if(No instanceof gp)return No.value([],wn);if(No instanceof Ho)return No;throw new Error(`Unknown StringValue filter: ${An.value}`)}case"trim":return new Qo(ir.value.trim());case"indent":return new Qo(ir.value.split(`
`).map((No,Yo)=>Yo===0||No.length===0?No:"    "+No).join(`
`));case"join":case"string":return ir;case"int":{const No=parseInt(ir.value,10);return new Ho(isNaN(No)?0:No)}case"float":{const No=parseFloat(ir.value);return new _c(isNaN(No)?0:No)}default:throw new Error(`Unknown StringValue filter: ${An.value}`)}else if(ir instanceof Ho||ir instanceof _c)switch(An.value){case"abs":return ir instanceof Ho?new Ho(Math.abs(ir.value)):new _c(Math.abs(ir.value));case"int":return new Ho(Math.floor(ir.value));case"float":return new _c(ir.value);default:throw new Error(`Unknown NumericValue filter: ${An.value}`)}else if(ir instanceof lp)switch(An.value){case"items":return new Zo(Array.from(ir.value.entries()).map(([No,Yo])=>new Zo([new Qo(No),Yo])));case"length":return new Ho(ir.value.size);default:throw new Error(`Unknown ObjectValue filter: ${An.value}`)}else if(ir instanceof ep)switch(An.value){case"bool":return new ep(ir.value);case"int":return new Ho(ir.value?1:0);case"float":return new _c(ir.value?1:0);case"string":return new Qo(ir.value?"true":"false");default:throw new Error(`Unknown BooleanValue filter: ${An.value}`)}throw new Error(`Cannot apply filter "${An.value}" to type: ${ir.type}`)}else if(In.type==="CallExpression"){const An=In;if(An.callee.type!=="Identifier")throw new Error(`Unknown filter: ${An.callee.type}`);const No=An.callee.value;if(No==="tojson"){const[,Yo]=this.evaluateArguments(An.args,wn),sp=Yo.get("indent")??new Mp;if(!(sp instanceof Ho||sp instanceof Mp))throw new Error("If set, indent must be a number");return new Qo(u_(ir,sp.value))}else if(No==="join"){let Yo;if(ir instanceof Qo)Yo=Array.from(ir.value);else if(ir instanceof Zo)Yo=ir.value.map(zp=>zp.value);else throw new Error(`Cannot apply filter "${No}" to type: ${ir.type}`);const[sp,Cp]=this.evaluateArguments(An.args,wn),n_=sp.at(0)??Cp.get("separator")??new Qo("");if(!(n_ instanceof Qo))throw new Error("separator must be a string");return new Qo(Yo.join(n_.value))}else if(No==="int"||No==="float"){const[Yo,sp]=this.evaluateArguments(An.args,wn),Cp=Yo.at(0)??sp.get("default")??(No==="int"?new Ho(0):new _c(0));if(ir instanceof Qo){const n_=No==="int"?parseInt(ir.value,10):parseFloat(ir.value);return isNaN(n_)?Cp:No==="int"?new Ho(n_):new _c(n_)}else{if(ir instanceof Ho||ir instanceof _c)return ir;if(ir instanceof ep)return No==="int"?new Ho(ir.value?1:0):new _c(ir.value?1:0);throw new Error(`Cannot apply filter "${No}" to type: ${ir.type}`)}}else if(No==="default"){const[Yo,sp]=this.evaluateArguments(An.args,wn),Cp=Yo[0]??new Qo(""),n_=Yo[1]??sp.get("boolean")??new ep(!1);if(!(n_ instanceof ep))throw new Error("`default` filter flag must be a boolean");return ir instanceof wp||n_.value&&!ir.__bool__().value?Cp:ir}if(ir instanceof Zo){switch(No){case"selectattr":case"rejectattr":{const Yo=No==="selectattr";if(ir.value.some(kp=>!(kp instanceof lp)))throw new Error(`\`${No}\` can only be applied to array of objects`);if(An.args.some(kp=>kp.type!=="StringLiteral"))throw new Error(`arguments of \`${No}\` must be strings`);const[sp,Cp,n_]=An.args.map(kp=>this.evaluate(kp,wn));let zp;if(Cp){const kp=wn.tests.get(Cp.value);if(!kp)throw new Error(`Unknown test: ${Cp.value}`);zp=kp}else zp=(...kp)=>kp[0].__bool__().value;const i_=ir.value.filter(kp=>{const h_=kp.value.get(sp.value),$_=h_?zp(h_,n_):!1;return Yo?$_:!$_});return new Zo(i_)}case"map":{const[,Yo]=this.evaluateArguments(An.args,wn);if(Yo.has("attribute")){const sp=Yo.get("attribute");if(!(sp instanceof Qo))throw new Error("attribute must be a string");const Cp=Yo.get("default"),n_=ir.value.map(zp=>{if(!(zp instanceof lp))throw new Error("items in map must be an object");return zp.value.get(sp.value)??Cp??new wp});return new Zo(n_)}else throw new Error("`map` expressions without `attribute` set are not currently supported.")}}throw new Error(`Unknown ArrayValue filter: ${No}`)}else if(ir instanceof Qo){switch(No){case"indent":{const[Yo,sp]=this.evaluateArguments(An.args,wn),Cp=Yo.at(0)??sp.get("width")??new Ho(4);if(!(Cp instanceof Ho))throw new Error("width must be a number");const n_=Yo.at(1)??sp.get("first")??new ep(!1),zp=Yo.at(2)??sp.get("blank")??new ep(!1),i_=ir.value.split(`
`),kp=" ".repeat(Cp.value),h_=i_.map(($_,xx)=>!n_.value&&xx===0||!zp.value&&$_.length===0?$_:kp+$_);return new Qo(h_.join(`
`))}case"replace":{const Yo=ir.builtins.get("replace");if(!(Yo instanceof gp))throw new Error("replace filter not available");const[sp,Cp]=this.evaluateArguments(An.args,wn);return Yo.value([...sp,new _p(Cp)],wn)}}throw new Error(`Unknown StringValue filter: ${No}`)}else throw new Error(`Cannot apply filter "${No}" to type: ${ir.type}`)}throw new Error(`Unknown filter: ${In.type}`)}evaluateFilterExpression(ir,In){const wn=this.evaluate(ir.operand,In);return this.applyFilter(wn,ir.filter,In)}evaluateTestExpression(ir,In){const wn=this.evaluate(ir.operand,In),An=In.tests.get(ir.test.value);if(!An)throw new Error(`Unknown test: ${ir.test.value}`);const No=An(wn);return new ep(ir.negate?!No:No)}evaluateSelectExpression(ir,In){return this.evaluate(ir.test,In).__bool__().value?this.evaluate(ir.lhs,In):new wp}evaluateUnaryExpression(ir,In){const wn=this.evaluate(ir.argument,In);switch(ir.operator.value){case"not":return new ep(!wn.value);default:throw new SyntaxError(`Unknown operator: ${ir.operator.value}`)}}evaluateTernaryExpression(ir,In){return this.evaluate(ir.condition,In).__bool__().value?this.evaluate(ir.trueExpr,In):this.evaluate(ir.falseExpr,In)}evalProgram(ir,In){return this.evaluateBlock(ir.body,In)}evaluateBlock(ir,In){let wn="";for(const An of ir){const No=this.evaluate(An,In);No.type!=="NullValue"&&No.type!=="UndefinedValue"&&(wn+=No.toString())}return new Qo(wn)}evaluateIdentifier(ir,In){return In.lookupVariable(ir.value)}evaluateCallExpression(ir,In){const[wn,An]=this.evaluateArguments(ir.args,In);An.size>0&&wn.push(new _p(An));const No=this.evaluate(ir.callee,In);if(No.type!=="FunctionValue")throw new Error(`Cannot call something that is not a function: got ${No.type}`);return No.value(wn,In)}evaluateSliceExpression(ir,In,wn){if(!(ir instanceof Zo||ir instanceof Qo))throw new Error("Slice object must be an array or string");const An=this.evaluate(In.start,wn),No=this.evaluate(In.stop,wn),Yo=this.evaluate(In.step,wn);if(!(An instanceof Ho||An instanceof wp))throw new Error("Slice start must be numeric or undefined");if(!(No instanceof Ho||No instanceof wp))throw new Error("Slice stop must be numeric or undefined");if(!(Yo instanceof Ho||Yo instanceof wp))throw new Error("Slice step must be numeric or undefined");return ir instanceof Zo?new Zo(qo(ir.value,An.value,No.value,Yo.value)):new Qo(qo(Array.from(ir.value),An.value,No.value,Yo.value).join(""))}evaluateMemberExpression(ir,In){const wn=this.evaluate(ir.object,In);let An;if(ir.computed){if(ir.property.type==="SliceExpression")return this.evaluateSliceExpression(wn,ir.property,In);An=this.evaluate(ir.property,In)}else An=new Qo(ir.property.value);let No;if(wn instanceof lp){if(!(An instanceof Qo))throw new Error(`Cannot access property with non-string: got ${An.type}`);No=wn.value.get(An.value)??wn.builtins.get(An.value)}else if(wn instanceof Zo||wn instanceof Qo)if(An instanceof Ho)No=wn.value.at(An.value),wn instanceof Qo&&(No=new Qo(wn.value.at(An.value)));else if(An instanceof Qo)No=wn.builtins.get(An.value);else throw new Error(`Cannot access property with non-string/non-number: got ${An.type}`);else{if(!(An instanceof Qo))throw new Error(`Cannot access property with non-string: got ${An.type}`);No=wn.builtins.get(An.value)}return No instanceof _i?No:new wp}evaluateSet(ir,In){const wn=ir.value?this.evaluate(ir.value,In):this.evaluateBlock(ir.body,In);if(ir.assignee.type==="Identifier"){const An=ir.assignee.value;In.setVariable(An,wn)}else if(ir.assignee.type==="TupleLiteral"){const An=ir.assignee;if(!(wn instanceof Zo))throw new Error(`Cannot unpack non-iterable type in set: ${wn.type}`);const No=wn.value;if(No.length!==An.value.length)throw new Error(`Too ${An.value.length>No.length?"few":"many"} items to unpack in set`);for(let Yo=0;Yo<An.value.length;++Yo){const sp=An.value[Yo];if(sp.type!=="Identifier")throw new Error(`Cannot unpack to non-identifier in set: ${sp.type}`);In.setVariable(sp.value,No[Yo])}}else if(ir.assignee.type==="MemberExpression"){const An=ir.assignee,No=this.evaluate(An.object,In);if(!(No instanceof lp))throw new Error("Cannot assign to member of non-object");if(An.property.type!=="Identifier")throw new Error("Cannot assign to member with non-identifier property");No.value.set(An.property.value,wn)}else throw new Error(`Invalid LHS inside assignment expression: ${JSON.stringify(ir.assignee)}`);return new Mp}evaluateIf(ir,In){const wn=this.evaluate(ir.test,In);return this.evaluateBlock(wn.__bool__().value?ir.body:ir.alternate,In)}evaluateFor(ir,In){const wn=new ip(In);let An,No;if(ir.iterable.type==="SelectExpression"){const zp=ir.iterable;No=this.evaluate(zp.lhs,wn),An=zp.test}else No=this.evaluate(ir.iterable,wn);if(!(No instanceof Zo||No instanceof lp))throw new Error(`Expected iterable or object type in for loop: got ${No.type}`);No instanceof lp&&(No=No.keys());const Yo=[],sp=[];for(let zp=0;zp<No.value.length;++zp){const i_=new ip(wn),kp=No.value[zp];let h_;if(ir.loopvar.type==="Identifier")h_=$_=>$_.setVariable(ir.loopvar.value,kp);else if(ir.loopvar.type==="TupleLiteral"){const $_=ir.loopvar;if(kp.type!=="ArrayValue")throw new Error(`Cannot unpack non-iterable type: ${kp.type}`);const xx=kp;if($_.value.length!==xx.value.length)throw new Error(`Too ${$_.value.length>xx.value.length?"few":"many"} items to unpack`);h_=bx=>{for(let N_=0;N_<$_.value.length;++N_){if($_.value[N_].type!=="Identifier")throw new Error(`Cannot unpack non-identifier type: ${$_.value[N_].type}`);bx.setVariable($_.value[N_].value,xx.value[N_])}}}else throw new Error(`Invalid loop variable(s): ${ir.loopvar.type}`);An&&(h_(i_),!this.evaluate(An,i_).__bool__().value)||(Yo.push(kp),sp.push(h_))}let Cp="",n_=!0;for(let zp=0;zp<Yo.length;++zp){const i_=new Map([["index",new Ho(zp+1)],["index0",new Ho(zp)],["revindex",new Ho(Yo.length-zp)],["revindex0",new Ho(Yo.length-zp-1)],["first",new ep(zp===0)],["last",new ep(zp===Yo.length-1)],["length",new Ho(Yo.length)],["previtem",zp>0?Yo[zp-1]:new wp],["nextitem",zp<Yo.length-1?Yo[zp+1]:new wp]]);wn.setVariable("loop",new lp(i_)),sp[zp](wn);try{const kp=this.evaluateBlock(ir.body,wn);Cp+=kp.value}catch(kp){if(kp instanceof Jo)continue;if(kp instanceof Go)break;throw kp}n_=!1}if(n_){const zp=this.evaluateBlock(ir.defaultBlock,wn);Cp+=zp.value}return new Qo(Cp)}evaluateMacro(ir,In){return In.setVariable(ir.name.value,new gp((wn,An)=>{var sp;const No=new ip(An);wn=wn.slice();let Yo;((sp=wn.at(-1))==null?void 0:sp.type)==="KeywordArgumentsValue"&&(Yo=wn.pop());for(let Cp=0;Cp<ir.args.length;++Cp){const n_=ir.args[Cp],zp=wn[Cp];if(n_.type==="Identifier"){const i_=n_;if(!zp)throw new Error(`Missing positional argument: ${i_.value}`);No.setVariable(i_.value,zp)}else if(n_.type==="KeywordArgumentExpression"){const i_=n_,kp=zp??(Yo==null?void 0:Yo.value.get(i_.key.value))??this.evaluate(i_.value,No);No.setVariable(i_.key.value,kp)}else throw new Error(`Unknown argument type: ${n_.type}`)}return this.evaluateBlock(ir.body,No)})),new Mp}evaluateCallStatement(ir,In){const wn=new gp((Cp,n_)=>{const zp=new ip(n_);if(ir.callerArgs)for(let i_=0;i_<ir.callerArgs.length;++i_){const kp=ir.callerArgs[i_];if(kp.type!=="Identifier")throw new Error(`Caller parameter must be an identifier, got ${kp.type}`);zp.setVariable(kp.value,Cp[i_]??new wp)}return this.evaluateBlock(ir.body,zp)}),[An,No]=this.evaluateArguments(ir.call.args,In);An.push(new _p(No));const Yo=this.evaluate(ir.call.callee,In);if(Yo.type!=="FunctionValue")throw new Error(`Cannot call something that is not a function: got ${Yo.type}`);const sp=new ip(In);return sp.setVariable("caller",wn),Yo.value(An,sp)}evaluateFilterStatement(ir,In){const wn=this.evaluateBlock(ir.body,In);return this.applyFilter(wn,ir.filter,In)}evaluate(ir,In){if(!ir)return new wp;switch(ir.type){case"Program":return this.evalProgram(ir,In);case"Set":return this.evaluateSet(ir,In);case"If":return this.evaluateIf(ir,In);case"For":return this.evaluateFor(ir,In);case"Macro":return this.evaluateMacro(ir,In);case"CallStatement":return this.evaluateCallStatement(ir,In);case"Break":throw new Go;case"Continue":throw new Jo;case"IntegerLiteral":return new Ho(ir.value);case"FloatLiteral":return new _c(ir.value);case"StringLiteral":return new Qo(ir.value);case"ArrayLiteral":return new Zo(ir.value.map(wn=>this.evaluate(wn,In)));case"TupleLiteral":return new bp(ir.value.map(wn=>this.evaluate(wn,In)));case"ObjectLiteral":{const wn=new Map;for(const[An,No]of ir.value){const Yo=this.evaluate(An,In);if(!(Yo instanceof Qo))throw new Error(`Object keys must be strings: got ${Yo.type}`);wn.set(Yo.value,this.evaluate(No,In))}return new lp(wn)}case"Identifier":return this.evaluateIdentifier(ir,In);case"CallExpression":return this.evaluateCallExpression(ir,In);case"MemberExpression":return this.evaluateMemberExpression(ir,In);case"UnaryExpression":return this.evaluateUnaryExpression(ir,In);case"BinaryExpression":return this.evaluateBinaryExpression(ir,In);case"FilterExpression":return this.evaluateFilterExpression(ir,In);case"FilterStatement":return this.evaluateFilterStatement(ir,In);case"TestExpression":return this.evaluateTestExpression(ir,In);case"SelectExpression":return this.evaluateSelectExpression(ir,In);case"Ternary":return this.evaluateTernaryExpression(ir,In);case"Comment":return new Mp;default:throw new SyntaxError(`Unknown node type: ${ir.type}`)}}};function Ap(ir){switch(typeof ir){case"number":return Number.isInteger(ir)?new Ho(ir):new _c(ir);case"string":return new Qo(ir);case"boolean":return new ep(ir);case"undefined":return new wp;case"object":return ir===null?new Mp:Array.isArray(ir)?new Zo(ir.map(Ap)):new lp(new Map(Object.entries(ir).map(([In,wn])=>[In,Ap(wn)])));case"function":return new gp((In,wn)=>{const An=ir(...In.map(No=>No.value))??null;return Ap(An)});default:throw new Error(`Cannot convert to runtime value: ${ir}`)}}function u_(ir,In,wn){const An=wn??0;switch(ir.type){case"NullValue":case"UndefinedValue":return"null";case"IntegerValue":case"FloatValue":case"StringValue":case"BooleanValue":return JSON.stringify(ir.value);case"ArrayValue":case"ObjectValue":{const No=In?" ".repeat(In):"",Yo=`
`+No.repeat(An),sp=Yo+No;if(ir.type==="ArrayValue"){const Cp=ir.value.map(n_=>u_(n_,In,An+1));return In?`[${sp}${Cp.join(`,${sp}`)}${Yo}]`:`[${Cp.join(", ")}]`}else{const Cp=Array.from(ir.value.entries()).map(([n_,zp])=>{const i_=`"${n_}": ${u_(zp,In,An+1)}`;return In?`${sp}${i_}`:i_});return In?`{${Cp.join(",")}${Yo}}`:`{${Cp.join(", ")}}`}}default:throw new Error(`Cannot convert to JSON: ${ir.type}`)}}var Ip=`
`,C_="{%- ",G_=" -%}";function z_(ir){switch(ir.operator.type){case"MultiplicativeBinaryOperator":return 4;case"AdditiveBinaryOperator":return 3;case"ComparisonBinaryOperator":return 2;case"Identifier":return ir.operator.value==="and"?1:ir.operator.value==="in"||ir.operator.value==="not in"?2:0}return 0}function hx(ir,In="	"){const wn=typeof In=="number"?" ".repeat(In):In;return H_(ir.body,0,wn).replace(/\n$/,"")}function S_(...ir){return C_+ir.join(" ")+G_}function H_(ir,In,wn){return ir.map(An=>zx(An,In,wn)).join(Ip)}function zx(ir,In,wn){const An=wn.repeat(In);switch(ir.type){case"Program":return H_(ir.body,In,wn);case"If":return qx(ir,In,wn);case"For":return Ix(ir,In,wn);case"Set":return X_(ir,In,wn);case"Macro":return e_(ir,In,wn);case"Break":return An+S_("break");case"Continue":return An+S_("continue");case"CallStatement":return r_(ir,In,wn);case"FilterStatement":return g_(ir,In,wn);case"Comment":return An+"{# "+ir.value+" #}";default:return An+"{{- "+Pp(ir)+" -}}"}}function qx(ir,In,wn){const An=wn.repeat(In),No=[];let Yo=ir;for(;Yo&&(No.push({test:Yo.test,body:Yo.body}),Yo.alternate.length===1&&Yo.alternate[0].type==="If");)Yo=Yo.alternate[0];let sp=An+S_("if",Pp(No[0].test))+Ip+H_(No[0].body,In+1,wn);for(let Cp=1;Cp<No.length;++Cp)sp+=Ip+An+S_("elif",Pp(No[Cp].test))+Ip+H_(No[Cp].body,In+1,wn);return Yo&&Yo.alternate.length>0&&(sp+=Ip+An+S_("else")+Ip+H_(Yo.alternate,In+1,wn)),sp+=Ip+An+S_("endif"),sp}function Ix(ir,In,wn){const An=wn.repeat(In);let No="";if(ir.iterable.type==="SelectExpression"){const sp=ir.iterable;No=`${Pp(sp.lhs)} if ${Pp(sp.test)}`}else No=Pp(ir.iterable);let Yo=An+S_("for",Pp(ir.loopvar),"in",No)+Ip+H_(ir.body,In+1,wn);return ir.defaultBlock.length>0&&(Yo+=Ip+An+S_("else")+Ip+H_(ir.defaultBlock,In+1,wn)),Yo+=Ip+An+S_("endfor"),Yo}function X_(ir,In,wn){const An=wn.repeat(In),No=Pp(ir.assignee),Yo=ir.value?Pp(ir.value):"",sp=An+S_("set",`${No}${ir.value?" = "+Yo:""}`);return ir.body.length===0?sp:sp+Ip+H_(ir.body,In+1,wn)+Ip+An+S_("endset")}function e_(ir,In,wn){const An=wn.repeat(In),No=ir.args.map(Pp).join(", ");return An+S_("macro",`${ir.name.value}(${No})`)+Ip+H_(ir.body,In+1,wn)+Ip+An+S_("endmacro")}function r_(ir,In,wn){const An=wn.repeat(In),No=ir.callerArgs&&ir.callerArgs.length>0?`(${ir.callerArgs.map(Pp).join(", ")})`:"",Yo=Pp(ir.call);let sp=An+S_(`call${No}`,Yo)+Ip;return sp+=H_(ir.body,In+1,wn)+Ip,sp+=An+S_("endcall"),sp}function g_(ir,In,wn){const An=wn.repeat(In),No=ir.filter.type==="Identifier"?ir.filter.value:Pp(ir.filter);let Yo=An+S_("filter",No)+Ip;return Yo+=H_(ir.body,In+1,wn)+Ip,Yo+=An+S_("endfilter"),Yo}function Pp(ir,In=-1){switch(ir.type){case"SpreadExpression":return`*${Pp(ir.argument)}`;case"Identifier":return ir.value;case"IntegerLiteral":return`${ir.value}`;case"FloatLiteral":return`${ir.value}`;case"StringLiteral":return JSON.stringify(ir.value);case"BinaryExpression":{const wn=ir,An=z_(wn),No=Pp(wn.left,An),Yo=Pp(wn.right,An+1),sp=`${No} ${wn.operator.value} ${Yo}`;return An<In?`(${sp})`:sp}case"UnaryExpression":{const wn=ir;return wn.operator.value+(wn.operator.value==="not"?" ":"")+Pp(wn.argument,1/0)}case"CallExpression":{const wn=ir,An=wn.args.map(Pp).join(", ");return`${Pp(wn.callee)}(${An})`}case"MemberExpression":{const wn=ir;let An=Pp(wn.object);["Identifier","MemberExpression","CallExpression","StringLiteral","IntegerLiteral","FloatLiteral","ArrayLiteral","TupleLiteral","ObjectLiteral"].includes(wn.object.type)||(An=`(${An})`);let No=Pp(wn.property);return!wn.computed&&wn.property.type!=="Identifier"&&(No=`(${No})`),wn.computed?`${An}[${No}]`:`${An}.${No}`}case"FilterExpression":{const wn=ir,An=Pp(wn.operand,1/0);return wn.filter.type==="CallExpression"?`${An} | ${Pp(wn.filter)}`:`${An} | ${wn.filter.value}`}case"SelectExpression":{const wn=ir;return`${Pp(wn.lhs)} if ${Pp(wn.test)}`}case"TestExpression":{const wn=ir;return`${Pp(wn.operand)} is${wn.negate?" not":""} ${wn.test.value}`}case"ArrayLiteral":case"TupleLiteral":{const wn=ir.value.map(Pp),An=ir.type==="ArrayLiteral"?"[]":"()";return`${An[0]}${wn.join(", ")}${An[1]}`}case"ObjectLiteral":return`{${Array.from(ir.value.entries()).map(([An,No])=>`${Pp(An)}: ${Pp(No)}`).join(", ")}}`;case"SliceExpression":{const wn=ir,An=wn.start?Pp(wn.start):"",No=wn.stop?Pp(wn.stop):"",Yo=wn.step?`:${Pp(wn.step)}`:"";return`${An}:${No}${Yo}`}case"KeywordArgumentExpression":{const wn=ir;return`${wn.key.value}=${Pp(wn.value)}`}case"Ternary":{const wn=ir,An=`${Pp(wn.trueExpr)} if ${Pp(wn.condition,0)} else ${Pp(wn.falseExpr)}`;return In>-1?`(${An})`:An}default:throw new Error(`Unknown expression type: ${ir.type}`)}}var m_=class{constructor(ir){Oo(this,"parsed");const In=lt(ir,{lstrip_blocks:!0,trim_blocks:!0});this.parsed=Mo(In)}render(ir){const In=new ip;if(fp(In),ir)for(const[No,Yo]of Object.entries(ir))In.set(No,Yo);return new Rp(In).run(this.parsed).value}format(ir){return hx(this.parsed,(ir==null?void 0:ir.indent)||"	")}}},"./src/backends/onnx.js":(e,s,i)=>{var c;i.r(s),i.d(s,{Tensor:()=>g.Tensor,createInferenceSession:()=>zt,deviceToExecutionProviders:()=>mt,isONNXProxy:()=>Gt,isONNXTensor:()=>St,runInferenceSession:()=>kt});var d=i("./src/env.js"),h=i("?2ce3"),_=i("onnxruntime-web"),g=i("onnxruntime-common");const $=Object.freeze({auto:null,gpu:null,cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:{name:"webnn",deviceType:"cpu"},"webnn-npu":{name:"webnn",deviceType:"npu"},"webnn-gpu":{name:"webnn",deviceType:"gpu"},"webnn-cpu":{name:"webnn",deviceType:"cpu"}}),_e=[];let lt,at;const it=Symbol.for("onnxruntime");if(it in globalThis)at=globalThis[it];else if(d.apis.IS_NODE_ENV){switch(at=h??(c||(c=i.t(h,2))),process.platform){case"win32":_e.push("dml");break;case"linux":process.arch==="x64"&&_e.push("cuda");break}_e.push("cpu"),lt=["cpu"]}else at=_,d.apis.IS_WEBNN_AVAILABLE&&_e.push("webnn-npu","webnn-gpu","webnn-cpu","webnn"),d.apis.IS_WEBGPU_AVAILABLE&&_e.push("webgpu"),_e.push("wasm"),lt=["wasm"];const ct=at.InferenceSession;function mt(Bt=null){if(!Bt)return lt;switch(Bt){case"auto":return _e;case"gpu":return _e.filter(nr=>["webgpu","cuda","dml","webnn-gpu"].includes(nr))}if(_e.includes(Bt))return[$[Bt]??Bt];throw new Error(`Unsupported device: "${Bt}". Should be one of: ${_e.join(", ")}.`)}let pt=null;async function zt(Bt,nr,cr){pt&&await pt;const ur=ct.create(Bt,nr);pt??(pt=ur);const yn=await ur;return yn.config=cr,yn}let dt=Promise.resolve();const ft=d.apis.IS_BROWSER_ENV||d.apis.IS_WEBWORKER_ENV;async function kt(Bt,nr){const cr=()=>Bt.run(nr);return await(ft?dt=dt.then(cr):cr())}function St(Bt){return Bt instanceof at.Tensor}const Lt=at==null?void 0:at.env;Lt!=null&&Lt.wasm&&(!(typeof ServiceWorkerGlobalScope<"u"&&self instanceof ServiceWorkerGlobalScope)&&!Lt.wasm.wasmPaths&&(Lt.wasm.wasmPaths=`https://cdn.jsdelivr.net/npm/@huggingface/transformers@${d.env.version}/dist/`),Lt.wasm.proxy=!1),Lt!=null&&Lt.webgpu&&(Lt.webgpu.powerPreference="high-performance");function Gt(){var Bt;return(Bt=Lt==null?void 0:Lt.wasm)==null?void 0:Bt.proxy}d.env.backends.onnx=Lt},"./src/base/feature_extraction_utils.js":(e,s,i)=>{i.r(s),i.d(s,{FeatureExtractor:()=>_,validate_audio_inputs:()=>g});var c=i("./src/utils/constants.js"),d=i("./src/utils/generic.js"),h=i("./src/utils/hub.js");class _ extends d.Callable{constructor(_e){super(),this.config=_e}static async from_pretrained(_e,lt={}){const at=await(0,h.getModelJSON)(_e,c.FEATURE_EXTRACTOR_NAME,!0,lt);return new this(at)}}function g($,_e){var lt;if(!($ instanceof Float32Array||$ instanceof Float64Array))throw new Error(`${_e} expects input to be a Float32Array or a Float64Array, but got ${((lt=$==null?void 0:$.constructor)==null?void 0:lt.name)??typeof $} instead. If using the feature extractor directly, remember to use \`read_audio(url, sampling_rate)\` to obtain the raw audio data of the file/url.`)}},"./src/base/image_processors_utils.js":(e,s,i)=>{i.r(s),i.d(s,{ImageProcessor:()=>St,center_to_corners_format:()=>at,post_process_instance_segmentation:()=>kt,post_process_object_detection:()=>it,post_process_panoptic_segmentation:()=>ft,post_process_semantic_segmentation:()=>ct});var c=i("./src/utils/generic.js"),d=i("./src/utils/tensor.js"),h=i("./src/utils/maths.js");i("./src/utils/image.js");var _=i("./src/utils/core.js"),g=i("./src/utils/hub.js"),$=i("./src/utils/constants.js");function _e(Lt,Gt,Bt=0,nr=null){const cr=Lt/Gt;let ur=(0,h.bankers_round)(cr)*Gt;return nr!==null&&ur>nr&&(ur=Math.floor(cr)*Gt),ur<Bt&&(ur=Math.ceil(cr)*Gt),ur}function lt([Lt,Gt],Bt){return[Math.max(Math.floor(Lt/Bt),1)*Bt,Math.max(Math.floor(Gt/Bt),1)*Bt]}function at([Lt,Gt,Bt,nr]){return[Lt-Bt/2,Gt-nr/2,Lt+Bt/2,Gt+nr/2]}function it(Lt,Gt=.5,Bt=null,nr=!1){const cr=Lt.logits,ur=Lt.pred_boxes,[yn,hn,_n]=cr.dims;if(Bt!==null&&Bt.length!==yn)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let gn=[];for(let vn=0;vn<yn;++vn){let Tn=Bt!==null?Bt[vn]:null,kn={boxes:[],classes:[],scores:[]},bn=cr[vn],Sn=ur[vn];for(let fn=0;fn<hn;++fn){let or=bn[fn],lr=[],pn;if(nr){pn=or.sigmoid().data;for(let Cn=0;Cn<pn.length;++Cn)pn[Cn]>Gt&&lr.push(Cn)}else{let Cn=(0,h.max)(or.data)[1];if(Cn===_n-1||(pn=(0,h.softmax)(or.data),pn[Cn]<Gt))continue;lr.push(Cn)}for(const Cn of lr){let Lo=Sn[fn].data;Lo=at(Lo),Tn!==null&&(Lo=Lo.map((Mo,Ro)=>Mo*Tn[(Ro+1)%2])),kn.boxes.push(Lo),kn.classes.push(Cn),kn.scores.push(pn[Cn])}}gn.push(kn)}return gn}function ct(Lt,Gt=null){const Bt=Lt.logits,nr=Bt.dims[0];if(Gt!==null&&Gt.length!==nr)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");const cr=[];for(let ur=0;ur<nr;++ur){const yn=Gt!==null?Gt[ur]:null;let hn=Bt[ur];yn!==null&&(hn=(0,d.interpolate)(hn,yn,"bilinear",!1));const[_n,gn]=yn??hn.dims.slice(-2),vn=new d.Tensor("int32",new Int32Array(_n*gn),[_n,gn]),Tn=hn[0].data,kn=vn.data;for(let fn=1;fn<hn.dims[0];++fn){const or=hn[fn].data;for(let lr=0;lr<or.length;++lr)or[lr]>Tn[lr]&&(Tn[lr]=or[lr],kn[lr]=fn)}const bn=new Array(hn.dims[0]);for(let fn=0;fn<kn.length;++fn){const or=kn[fn];bn[or]=or}const Sn=bn.filter(fn=>fn!==void 0);cr.push({segmentation:vn,labels:Sn})}return cr}function mt(Lt,Gt,Bt,nr){const cr=[],ur=[],yn=[];for(let hn=0;hn<Lt.dims[0];++hn){const _n=Lt[hn],gn=Gt[hn],vn=(0,h.max)(_n.data)[1];if(vn===nr)continue;const kn=(0,h.softmax)(_n.data)[vn];kn>Bt&&(cr.push(gn),ur.push(kn),yn.push(vn))}return[cr,ur,yn]}function pt(Lt,Gt,Bt,nr=.5,cr=.8){const ur=[];let yn=0,hn=0;const _n=Gt[Bt].data;for(let vn=0;vn<Lt.length;++vn)Lt[vn]===Bt&&(ur.push(vn),++yn),_n[vn]>=nr&&++hn;let gn=yn>0&&hn>0;return gn&&(gn=yn/hn>cr),[gn,ur]}function zt(Lt,Gt,Bt,nr,cr,ur=null,yn=null){const[hn,_n]=yn??Lt[0].dims,gn=new d.Tensor("int32",new Int32Array(hn*_n),[hn,_n]),vn=[];if(yn!==null)for(let fn=0;fn<Lt.length;++fn)Lt[fn]=(0,d.interpolate)(Lt[fn],yn,"bilinear",!1);const Tn=new Int32Array(Lt[0].data.length),kn=new Float32Array(Lt[0].data.length);for(let fn=0;fn<Lt.length;++fn){let or=Gt[fn];const lr=Lt[fn].data;for(let pn=0;pn<lr.length;++pn)lr[pn]*=or,lr[pn]>kn[pn]&&(Tn[pn]=fn,kn[pn]=lr[pn])}let bn=0;const Sn=gn.data;for(let fn=0;fn<Bt.length;++fn){const or=Bt[fn],[lr,pn]=pt(Tn,Lt,fn,nr,cr);if(lr){++bn;for(const Cn of pn)Sn[Cn]=bn;vn.push({id:bn,label_id:or,score:Gt[fn]})}}return[gn,vn]}function dt(Lt,Gt,Bt=28,nr=56*56,cr=14*14*4*1280){if(Lt<Bt||Gt<Bt)throw new Error(`height:${Lt} or width:${Gt} must be larger than factor:${Bt}`);if(Math.max(Lt,Gt)/Math.min(Lt,Gt)>200)throw new Error(`absolute aspect ratio must be smaller than 200, got ${Math.max(Lt,Gt)/Math.min(Lt,Gt)}`);let ur=Math.round(Lt/Bt)*Bt,yn=Math.round(Gt/Bt)*Bt;if(ur*yn>cr){const hn=Math.sqrt(Lt*Gt/cr);ur=Math.floor(Lt/hn/Bt)*Bt,yn=Math.floor(Gt/hn/Bt)*Bt}else if(ur*yn<nr){const hn=Math.sqrt(nr/(Lt*Gt));ur=Math.ceil(Lt*hn/Bt)*Bt,yn=Math.ceil(Gt*hn/Bt)*Bt}return[ur,yn]}function ft(Lt,Gt=.5,Bt=.5,nr=.8,cr=null,ur=null){cr===null&&(console.warn("`label_ids_to_fuse` unset. No instance will be fused."),cr=new Set);const yn=Lt.class_queries_logits??Lt.logits,_n=(Lt.masks_queries_logits??Lt.pred_masks).sigmoid();let[gn,vn,Tn]=yn.dims;if(Tn-=1,ur!==null&&ur.length!==gn)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let kn=[];for(let bn=0;bn<gn;++bn){let Sn=ur!==null?ur[bn]:null,fn=yn[bn],or=_n[bn],[lr,pn,Cn]=mt(fn,or,Gt,Tn);if(Cn.length===0){let[Ro,qo]=Sn??or.dims.slice(-2),tp=new d.Tensor("int32",new Int32Array(Ro*qo).fill(-1),[Ro,qo]);kn.push({segmentation:tp,segments_info:[]});continue}let[Lo,Mo]=zt(lr,pn,Cn,Bt,nr,cr,Sn);kn.push({segmentation:Lo,segments_info:Mo})}return kn}function kt(Lt,Gt=.5,Bt=null){throw new Error("`post_process_instance_segmentation` is not yet implemented.")}class St extends c.Callable{constructor(Gt){super(),this.image_mean=Gt.image_mean??Gt.mean,this.image_std=Gt.image_std??Gt.std,this.resample=Gt.resample??2,this.do_rescale=Gt.do_rescale??!0,this.rescale_factor=Gt.rescale_factor??1/255,this.do_normalize=Gt.do_normalize,this.do_thumbnail=Gt.do_thumbnail,this.size=Gt.size??Gt.image_size,this.do_resize=Gt.do_resize??this.size!==void 0,this.size_divisibility=Gt.size_divisibility??Gt.size_divisor,this.do_center_crop=Gt.do_center_crop,this.crop_size=Gt.crop_size,this.do_convert_rgb=Gt.do_convert_rgb??!0,this.do_crop_margin=Gt.do_crop_margin,this.pad_size=Gt.pad_size,this.do_pad=Gt.do_pad,this.min_pixels=Gt.min_pixels,this.max_pixels=Gt.max_pixels,this.do_pad&&!this.pad_size&&this.size&&this.size.width!==void 0&&this.size.height!==void 0&&(this.pad_size=this.size),this.do_flip_channel_order=Gt.do_flip_channel_order??!1,this.config=Gt}async thumbnail(Gt,Bt,nr=2){const cr=Gt.height,ur=Gt.width,yn=Bt.height,hn=Bt.width;let _n=Math.min(cr,yn),gn=Math.min(ur,hn);return _n===cr&&gn===ur?Gt:(cr>ur?gn=Math.floor(ur*_n/cr):ur>cr&&(_n=Math.floor(cr*gn/ur)),await Gt.resize(gn,_n,{resample:nr}))}async crop_margin(Gt,Bt=200){const nr=Gt.clone().grayscale(),cr=(0,h.min)(nr.data)[0],yn=(0,h.max)(nr.data)[0]-cr;if(yn===0)return Gt;const hn=Bt/255;let _n=nr.width,gn=nr.height,vn=0,Tn=0;const kn=nr.data;for(let bn=0;bn<nr.height;++bn){const Sn=bn*nr.width;for(let fn=0;fn<nr.width;++fn)(kn[Sn+fn]-cr)/yn<hn&&(_n=Math.min(_n,fn),gn=Math.min(gn,bn),vn=Math.max(vn,fn),Tn=Math.max(Tn,bn))}return Gt=await Gt.crop([_n,gn,vn,Tn]),Gt}pad_image(Gt,Bt,nr,{mode:cr="constant",center:ur=!1,constant_values:yn=0}={}){const[hn,_n,gn]=Bt;let vn,Tn;if(typeof nr=="number"?(vn=nr,Tn=nr):nr==="square"?vn=Tn=Math.max(hn,_n):(vn=nr.width,Tn=nr.height),vn!==_n||Tn!==hn){const kn=new Float32Array(vn*Tn*gn);if(Array.isArray(yn))for(let fn=0;fn<kn.length;++fn)kn[fn]=yn[fn%gn];else yn!==0&&kn.fill(yn);const[bn,Sn]=ur?[Math.floor((vn-_n)/2),Math.floor((Tn-hn)/2)]:[0,0];for(let fn=0;fn<hn;++fn){const or=(fn+Sn)*vn,lr=fn*_n;for(let pn=0;pn<_n;++pn){const Cn=(or+pn+bn)*gn,Lo=(lr+pn)*gn;for(let Mo=0;Mo<gn;++Mo)kn[Cn+Mo]=Gt[Lo+Mo]}}if(cr==="symmetric"){if(ur)throw new Error("`center` padding is not supported when `mode` is set to `symmetric`.");const fn=hn-1,or=_n-1;for(let lr=0;lr<Tn;++lr){const pn=lr*vn,Cn=(0,_.calculateReflectOffset)(lr,fn)*_n;for(let Lo=0;Lo<vn;++Lo){if(lr<hn&&Lo<_n)continue;const Mo=(pn+Lo)*gn,Ro=(Cn+(0,_.calculateReflectOffset)(Lo,or))*gn;for(let qo=0;qo<gn;++qo)kn[Mo+qo]=Gt[Ro+qo]}}}Gt=kn,Bt=[Tn,vn,gn]}return[Gt,Bt]}rescale(Gt){for(let Bt=0;Bt<Gt.length;++Bt)Gt[Bt]=this.rescale_factor*Gt[Bt]}get_resize_output_image_size(Gt,Bt){const[nr,cr]=Gt.size;let ur,yn;if(this.do_thumbnail){const{height:hn,width:_n}=Bt;ur=Math.min(hn,_n)}else Number.isInteger(Bt)?(ur=Bt,yn=this.config.max_size??ur):Bt!==void 0&&(ur=Bt.shortest_edge,yn=Bt.longest_edge);if(ur!==void 0||yn!==void 0){const hn=ur===void 0?1:Math.max(ur/nr,ur/cr),_n=nr*hn,gn=cr*hn,vn=yn===void 0?1:Math.min(yn/_n,yn/gn);let Tn=Math.floor(Number((_n*vn).toFixed(2))),kn=Math.floor(Number((gn*vn).toFixed(2)));return this.size_divisibility!==void 0&&([Tn,kn]=lt([Tn,kn],this.size_divisibility)),[Tn,kn]}else if(Bt!==void 0&&Bt.width!==void 0&&Bt.height!==void 0){let hn=Bt.width,_n=Bt.height;if(this.config.keep_aspect_ratio&&this.config.ensure_multiple_of){let gn=_n/cr,vn=hn/nr;Math.abs(1-vn)<Math.abs(1-gn)?gn=vn:vn=gn,_n=_e(gn*cr,this.config.ensure_multiple_of),hn=_e(vn*nr,this.config.ensure_multiple_of)}return[hn,_n]}else{if(this.size_divisibility!==void 0)return lt([nr,cr],this.size_divisibility);if(this.min_pixels!==void 0&&this.max_pixels!==void 0){const hn=this.config.patch_size*this.config.merge_size;return dt(cr,nr,hn,this.min_pixels,this.max_pixels)}else throw new Error(`Could not resize image due to unsupported \`this.size\` option in config: ${JSON.stringify(Bt)}`)}}async resize(Gt){const[Bt,nr]=this.get_resize_output_image_size(Gt,this.size);return await Gt.resize(Bt,nr,{resample:this.resample})}async preprocess(Gt,{do_normalize:Bt=null,do_pad:nr=null,do_convert_rgb:cr=null,do_convert_grayscale:ur=null,do_flip_channel_order:yn=null}={}){this.do_crop_margin&&(Gt=await this.crop_margin(Gt));const[hn,_n]=Gt.size;if(cr??this.do_convert_rgb?Gt=Gt.rgb():ur&&(Gt=Gt.grayscale()),this.do_resize&&(Gt=await this.resize(Gt)),this.do_thumbnail&&(Gt=await this.thumbnail(Gt,this.size,this.resample)),this.do_center_crop){let bn,Sn;Number.isInteger(this.crop_size)?(bn=this.crop_size,Sn=this.crop_size):(bn=this.crop_size.width,Sn=this.crop_size.height),Gt=await Gt.center_crop(bn,Sn)}const gn=[Gt.height,Gt.width];let vn=Float32Array.from(Gt.data),Tn=[Gt.height,Gt.width,Gt.channels];if(this.do_rescale&&this.rescale(vn),Bt??this.do_normalize){let bn=this.image_mean;Array.isArray(this.image_mean)||(bn=new Array(Gt.channels).fill(bn));let Sn=this.image_std;if(Array.isArray(this.image_std)||(Sn=new Array(Gt.channels).fill(bn)),bn.length!==Gt.channels||Sn.length!==Gt.channels)throw new Error(`When set to arrays, the length of \`image_mean\` (${bn.length}) and \`image_std\` (${Sn.length}) must match the number of channels in the image (${Gt.channels}).`);for(let fn=0;fn<vn.length;fn+=Gt.channels)for(let or=0;or<Gt.channels;++or)vn[fn+or]=(vn[fn+or]-bn[or])/Sn[or]}if(nr??this.do_pad){if(this.pad_size)[vn,Tn]=this.pad_image(vn,[Gt.height,Gt.width,Gt.channels],this.pad_size);else if(this.size_divisibility){const[bn,Sn]=lt([Tn[1],Tn[0]],this.size_divisibility);[vn,Tn]=this.pad_image(vn,Tn,{width:bn,height:Sn})}}if(yn??this.do_flip_channel_order){if(Tn[2]!==3)throw new Error("Flipping channel order is only supported for RGB images.");for(let bn=0;bn<vn.length;bn+=3){const Sn=vn[bn];vn[bn]=vn[bn+2],vn[bn+2]=Sn}}const kn=new d.Tensor("float32",vn,Tn).permute(2,0,1);return{original_size:[_n,hn],reshaped_input_size:gn,pixel_values:kn}}async _call(Gt,...Bt){Array.isArray(Gt)||(Gt=[Gt]);const nr=await Promise.all(Gt.map(ur=>this.preprocess(ur)));return{pixel_values:(0,d.stack)(nr.map(ur=>ur.pixel_values),0),original_sizes:nr.map(ur=>ur.original_size),reshaped_input_sizes:nr.map(ur=>ur.reshaped_input_size)}}static async from_pretrained(Gt,Bt={}){const nr=await(0,g.getModelJSON)(Gt,$.IMAGE_PROCESSOR_NAME,!0,Bt);return new this(nr)}}},"./src/base/processing_utils.js":(e,s,i)=>{i.r(s),i.d(s,{Processor:()=>_});var c=i("./src/utils/constants.js"),d=i("./src/utils/generic.js"),h=i("./src/utils/hub.js");class _ extends d.Callable{constructor($,_e,lt){super(),this.config=$,this.components=_e,this.chat_template=lt}get image_processor(){return this.components.image_processor}get tokenizer(){return this.components.tokenizer}get feature_extractor(){return this.components.feature_extractor}apply_chat_template($,_e={}){if(!this.tokenizer)throw new Error("Unable to apply chat template without a tokenizer.");return this.tokenizer.apply_chat_template($,{tokenize:!1,chat_template:this.chat_template??void 0,..._e})}batch_decode(...$){if(!this.tokenizer)throw new Error("Unable to decode without a tokenizer.");return this.tokenizer.batch_decode(...$)}decode(...$){if(!this.tokenizer)throw new Error("Unable to decode without a tokenizer.");return this.tokenizer.decode(...$)}async _call($,..._e){for(const lt of[this.image_processor,this.feature_extractor,this.tokenizer])if(lt)return lt($,..._e);throw new Error("No image processor, feature extractor, or tokenizer found.")}static async from_pretrained($,_e={}){const[lt,at,it]=await Promise.all([this.uses_processor_config?(0,h.getModelJSON)($,c.PROCESSOR_NAME,!0,_e):{},Promise.all(this.classes.filter(ct=>ct in this).map(async ct=>{const mt=await this[ct].from_pretrained($,_e);return[ct.replace(/_class$/,""),mt]})).then(Object.fromEntries),this.uses_chat_template_file?(0,h.getModelText)($,c.CHAT_TEMPLATE_NAME,!0,_e):null]);return new this(lt,at,it)}}Oo(_,"classes",["image_processor_class","tokenizer_class","feature_extractor_class"]),Oo(_,"uses_processor_config",!1),Oo(_,"uses_chat_template_file",!1)},"./src/configs.js":(e,s,i)=>{i.r(s),i.d(s,{AutoConfig:()=>lt,PretrainedConfig:()=>_e,getCacheShapes:()=>g});var c=i("./src/utils/core.js"),d=i("./src/utils/hub.js");async function h(at,it){return await(0,d.getModelJSON)(at,"config.json",!0,it)}function _(at){const it={};let ct={};switch(at.model_type){case"llava":case"paligemma":case"gemma3":case"florence2":case"llava_onevision":case"idefics3":case"ultravox":case"voxtral":case"smolvlm":case"gemma3n":ct=_(at.text_config);break;case"moondream1":ct=_(at.phi_config);break;case"musicgen":ct=_(at.decoder);break;case"multi_modality":ct=_(at.language_config);break;case"gpt2":case"gptj":case"jais":case"codegen":case"gpt_bigcode":it.num_heads="n_head",it.num_layers="n_layer",it.hidden_size="n_embd";break;case"gpt_neox":case"stablelm":case"opt":case"falcon":case"modernbert-decoder":it.num_heads="num_attention_heads",it.num_layers="num_hidden_layers",it.hidden_size="hidden_size";break;case"llama":case"llama4_text":case"nanochat":case"arcee":case"lfm2":case"smollm3":case"olmo":case"olmo2":case"mobilellm":case"granite":case"granitemoehybrid":case"cohere":case"mistral":case"starcoder2":case"qwen2":case"qwen2_vl":case"phi":case"phi3":case"phi3_v":case"llava_qwen2":it.num_heads="num_key_value_heads",it.num_layers="num_hidden_layers",it.hidden_size="hidden_size",it.num_attention_heads="num_attention_heads",it.dim_kv="head_dim";break;case"qwen3":case"gemma":case"gemma2":case"vaultgemma":case"gemma3_text":case"gemma3n_text":case"glm":case"helium":case"ernie4_5":it.num_heads="num_key_value_heads",it.num_layers="num_hidden_layers",it.dim_kv="head_dim";break;case"openelm":it.num_heads="num_kv_heads",it.num_layers="num_transformer_layers",it.dim_kv="head_dim";break;case"gpt_neo":case"donut-swin":it.num_heads="num_heads",it.num_layers="num_layers",it.hidden_size="hidden_size";break;case"bloom":it.num_heads="n_head",it.num_layers="n_layer",it.hidden_size="hidden_size";break;case"mpt":it.num_heads="n_heads",it.num_layers="n_layers",it.hidden_size="d_model";break;case"exaone":it.num_heads="num_key_value_heads",it.num_layers="num_layers",it.dim_kv="head_dim",it.num_attention_heads="num_attention_heads";break;case"t5":case"mt5":case"longt5":it.num_decoder_layers="num_decoder_layers",it.num_decoder_heads="num_heads",it.decoder_dim_kv="d_kv",it.num_encoder_layers="num_layers",it.num_encoder_heads="num_heads",it.encoder_dim_kv="d_kv";break;case"bart":case"mbart":case"marian":case"whisper":case"lite-whisper":case"m2m_100":case"blenderbot":case"blenderbot-small":case"florence2_language":it.num_decoder_layers="decoder_layers",it.num_decoder_heads="decoder_attention_heads",it.decoder_hidden_size="d_model",it.num_encoder_layers="encoder_layers",it.num_encoder_heads="encoder_attention_heads",it.encoder_hidden_size="d_model";break;case"speecht5":it.num_decoder_layers="decoder_layers",it.num_decoder_heads="decoder_attention_heads",it.decoder_hidden_size="hidden_size",it.num_encoder_layers="encoder_layers",it.num_encoder_heads="encoder_attention_heads",it.encoder_hidden_size="hidden_size";break;case"trocr":it.num_encoder_layers=it.num_decoder_layers="decoder_layers",it.num_encoder_heads=it.num_decoder_heads="decoder_attention_heads",it.encoder_hidden_size=it.decoder_hidden_size="d_model";break;case"musicgen_decoder":it.num_encoder_layers=it.num_decoder_layers="num_hidden_layers",it.num_encoder_heads=it.num_decoder_heads="num_attention_heads",it.encoder_hidden_size=it.decoder_hidden_size="hidden_size";break;case"moonshine":it.num_decoder_layers="decoder_num_hidden_layers",it.num_decoder_heads="decoder_num_key_value_heads",it.num_encoder_layers="encoder_num_hidden_layers",it.num_encoder_heads="encoder_num_key_value_heads",it.encoder_hidden_size=it.decoder_hidden_size="hidden_size";break;case"vision-encoder-decoder":const pt=_(at.decoder),zt="num_decoder_layers"in pt,dt=(0,c.pick)(at,["model_type","is_encoder_decoder"]);return zt?(dt.num_decoder_layers=pt.num_decoder_layers,dt.num_decoder_heads=pt.num_decoder_heads,dt.decoder_hidden_size=pt.decoder_hidden_size,dt.num_encoder_layers=pt.num_encoder_layers,dt.num_encoder_heads=pt.num_encoder_heads,dt.encoder_hidden_size=pt.encoder_hidden_size):(dt.num_layers=pt.num_layers,dt.num_heads=pt.num_heads,dt.hidden_size=pt.hidden_size),dt}const mt={...ct,...(0,c.pick)(at,["model_type","multi_query","is_encoder_decoder"])};for(const pt in it)mt[pt]=at[it[pt]];return mt}function g(at,it){if(at.model_type==="lfm2"){const ct=(it==null?void 0:it.prefix)??"past_key_values",mt=ct==="present"?"present":"past",pt={},{layer_types:zt,num_attention_heads:dt,num_key_value_heads:ft,hidden_size:kt,conv_L_cache:St}=at,Lt=kt/dt,Gt=(it==null?void 0:it.batch_size)??1;for(let Bt=0;Bt<zt.length;++Bt)if(zt[Bt]==="full_attention")for(const nr of["key","value"])pt[`${ct}.${Bt}.${nr}`]=[Gt,ft,0,Lt];else if(zt[Bt]==="conv")pt[`${mt}_conv.${Bt}`]=[Gt,kt,St];else throw new Error(`Unsupported layer type: ${zt[Bt]}`);return pt}return $(at,it)}function $(at,{prefix:it="past_key_values",batch_size:ct=1}={}){const mt={},pt=at.normalized_config;if(pt.is_encoder_decoder&&"num_encoder_heads"in pt&&"num_decoder_heads"in pt){const zt=pt.encoder_dim_kv??pt.encoder_hidden_size/pt.num_encoder_heads,dt=pt.decoder_dim_kv??pt.decoder_hidden_size/pt.num_decoder_heads,ft=[ct,pt.num_encoder_heads,0,zt],kt=[ct,pt.num_decoder_heads,0,dt];for(let St=0;St<pt.num_decoder_layers;++St)mt[`${it}.${St}.encoder.key`]=ft,mt[`${it}.${St}.encoder.value`]=ft,mt[`${it}.${St}.decoder.key`]=kt,mt[`${it}.${St}.decoder.value`]=kt}else{const zt=pt.num_heads,dt=pt.num_layers,ft=pt.dim_kv??pt.hidden_size/(pt.num_attention_heads??zt);if(pt.model_type==="falcon"){const kt=[ct*zt,0,ft];for(let St=0;St<dt;++St)mt[`${it}.${St}.key`]=kt,mt[`${it}.${St}.value`]=kt}else if(pt.multi_query){const kt=[ct*zt,0,2*ft];for(let St=0;St<dt;++St)mt[`${it}.${St}.key_value`]=kt}else if(pt.model_type==="bloom"){const kt=[ct*zt,ft,0],St=[ct*zt,0,ft];for(let Lt=0;Lt<dt;++Lt)mt[`${it}.${Lt}.key`]=kt,mt[`${it}.${Lt}.value`]=St}else if(pt.model_type==="openelm")for(let kt=0;kt<dt;++kt){const St=[ct,zt[kt],0,ft];mt[`${it}.${kt}.key`]=St,mt[`${it}.${kt}.value`]=St}else{const kt=[ct,zt,0,ft];for(let St=0;St<dt;++St)mt[`${it}.${St}.key`]=kt,mt[`${it}.${St}.value`]=kt}}return mt}class _e{constructor(it){Oo(this,"model_type",null);Oo(this,"is_encoder_decoder",!1);Oo(this,"max_position_embeddings");Oo(this,"transformers.js_config");Object.assign(this,it),this.normalized_config=_(this)}static async from_pretrained(it,{progress_callback:ct=null,config:mt=null,cache_dir:pt=null,local_files_only:zt=!1,revision:dt="main"}={}){mt&&!(mt instanceof _e)&&(mt=new _e(mt));const ft=mt??await h(it,{progress_callback:ct,config:mt,cache_dir:pt,local_files_only:zt,revision:dt});return new this(ft)}}class lt{static async from_pretrained(...it){return _e.from_pretrained(...it)}}},"./src/env.js":(e,s,i)=>{var cr,ur;i.r(s),i.d(s,{apis:()=>dt,env:()=>Bt});var c=i("?db59"),d=i("?383f"),h=i("?fa4b");const _="3.7.6",g=typeof window<"u"&&typeof window.document<"u",$=typeof self<"u"&&["DedicatedWorkerGlobalScope","ServiceWorkerGlobalScope","SharedWorkerGlobalScope"].includes((cr=self.constructor)==null?void 0:cr.name),_e=typeof self<"u"&&"caches"in self,lt=typeof navigator<"u"&&"gpu"in navigator,at=typeof navigator<"u"&&"ml"in navigator,it=typeof process<"u",ct=it&&((ur=process==null?void 0:process.release)==null?void 0:ur.name)==="node",mt=!nr(c),pt=!nr(d),zt=typeof globalThis.Deno<"u",dt=Object.freeze({IS_BROWSER_ENV:g,IS_WEBWORKER_ENV:$,IS_WEB_CACHE_AVAILABLE:_e,IS_WEBGPU_AVAILABLE:lt,IS_WEBNN_AVAILABLE:at,IS_PROCESS_AVAILABLE:it,IS_NODE_ENV:ct,IS_FS_AVAILABLE:mt,IS_PATH_AVAILABLE:pt}),ft=mt&&pt;let kt="./";if(ft){const yn=Object(import.meta).url;yn?kt=d.dirname(d.dirname(h.fileURLToPath(yn))):typeof __dirname<"u"&&(kt=d.dirname(__dirname))}const St=ft?d.join(kt,"/.cache/"):null,Lt="/models/",Gt=ft?d.join(kt,Lt):Lt,Bt={version:_,backends:{onnx:{}},allowRemoteModels:!0,remoteHost:"https://huggingface.co/",remotePathTemplate:"{model}/resolve/{revision}/",allowLocalModels:!(g||$),localModelPath:Gt,useFS:mt,useBrowserCache:_e&&!zt,useFSCache:mt,cacheDir:St,useCustomCache:!1,customCache:null};function nr(yn){return Object.keys(yn).length===0}},"./src/generation/configuration_utils.js":(e,s,i)=>{i.r(s),i.d(s,{GenerationConfig:()=>d});var c=i("./src/utils/core.js");class d{constructor(_){Oo(this,"max_length",20);Oo(this,"max_new_tokens",null);Oo(this,"min_length",0);Oo(this,"min_new_tokens",null);Oo(this,"early_stopping",!1);Oo(this,"max_time",null);Oo(this,"do_sample",!1);Oo(this,"num_beams",1);Oo(this,"num_beam_groups",1);Oo(this,"penalty_alpha",null);Oo(this,"use_cache",!0);Oo(this,"temperature",1);Oo(this,"top_k",50);Oo(this,"top_p",1);Oo(this,"typical_p",1);Oo(this,"epsilon_cutoff",0);Oo(this,"eta_cutoff",0);Oo(this,"diversity_penalty",0);Oo(this,"repetition_penalty",1);Oo(this,"encoder_repetition_penalty",1);Oo(this,"length_penalty",1);Oo(this,"no_repeat_ngram_size",0);Oo(this,"bad_words_ids",null);Oo(this,"force_words_ids",null);Oo(this,"renormalize_logits",!1);Oo(this,"constraints",null);Oo(this,"forced_bos_token_id",null);Oo(this,"forced_eos_token_id",null);Oo(this,"remove_invalid_values",!1);Oo(this,"exponential_decay_length_penalty",null);Oo(this,"suppress_tokens",null);Oo(this,"streamer",null);Oo(this,"begin_suppress_tokens",null);Oo(this,"forced_decoder_ids",null);Oo(this,"guidance_scale",null);Oo(this,"num_return_sequences",1);Oo(this,"output_attentions",!1);Oo(this,"output_hidden_states",!1);Oo(this,"output_scores",!1);Oo(this,"return_dict_in_generate",!1);Oo(this,"pad_token_id",null);Oo(this,"bos_token_id",null);Oo(this,"eos_token_id",null);Oo(this,"encoder_no_repeat_ngram_size",0);Oo(this,"decoder_start_token_id",null);Oo(this,"generation_kwargs",{});Object.assign(this,(0,c.pick)(_,Object.getOwnPropertyNames(this)))}}},"./src/generation/logits_process.js":(e,s,i)=>{i.r(s),i.d(s,{ClassifierFreeGuidanceLogitsProcessor:()=>dt,ForcedBOSTokenLogitsProcessor:()=>$,ForcedEOSTokenLogitsProcessor:()=>_e,LogitsProcessor:()=>h,LogitsProcessorList:()=>g,LogitsWarper:()=>_,MinLengthLogitsProcessor:()=>mt,MinNewTokensLengthLogitsProcessor:()=>pt,NoBadWordsLogitsProcessor:()=>zt,NoRepeatNGramLogitsProcessor:()=>it,RepetitionPenaltyLogitsProcessor:()=>ct,SuppressTokensAtBeginLogitsProcessor:()=>lt,TemperatureLogitsWarper:()=>ft,TopKLogitsWarper:()=>St,TopPLogitsWarper:()=>kt,WhisperTimeStampLogitsProcessor:()=>at});var c=i("./src/utils/generic.js");i("./src/utils/tensor.js");var d=i("./src/utils/maths.js");class h extends c.Callable{_call(Gt,Bt){throw Error("`_call` should be implemented in a subclass")}}class _ extends c.Callable{_call(Gt,Bt){throw Error("`_call` should be implemented in a subclass")}}class g extends c.Callable{constructor(){super(),this.processors=[]}push(Gt){this.processors.push(Gt)}extend(Gt){this.processors.push(...Gt)}_call(Gt,Bt){let nr=Bt;for(const cr of this.processors)nr=cr(Gt,nr);return nr}[Symbol.iterator](){return this.processors.values()}}class $ extends h{constructor(Gt){super(),this.bos_token_id=Gt}_call(Gt,Bt){for(let nr=0;nr<Gt.length;++nr)if(Gt[nr].length===1){const cr=Bt[nr].data;cr.fill(-1/0),cr[this.bos_token_id]=0}return Bt}}class _e extends h{constructor(Gt,Bt){super(),this.max_length=Gt,this.eos_token_id=Array.isArray(Bt)?Bt:[Bt]}_call(Gt,Bt){for(let nr=0;nr<Gt.length;++nr)if(Gt[nr].length===this.max_length-1){const cr=Bt[nr].data;cr.fill(-1/0);for(const ur of this.eos_token_id)cr[ur]=0}return Bt}}class lt extends h{constructor(Gt,Bt){super(),this.begin_suppress_tokens=Gt,this.begin_index=Bt}_call(Gt,Bt){for(let nr=0;nr<Gt.length;++nr)if(Gt[nr].length===this.begin_index){const cr=Bt[nr].data;for(const ur of this.begin_suppress_tokens)cr[ur]=-1/0}return Bt}}class at extends h{constructor(Gt,Bt){super(),this.eos_token_id=Array.isArray(Gt.eos_token_id)?Gt.eos_token_id[0]:Gt.eos_token_id,this.no_timestamps_token_id=Gt.no_timestamps_token_id,this.timestamp_begin=this.no_timestamps_token_id+1,this.begin_index=Bt.length,Bt.at(-1)===this.no_timestamps_token_id&&(this.begin_index-=1),this.max_initial_timestamp_index=Gt.max_initial_timestamp_index}_call(Gt,Bt){for(let nr=0;nr<Gt.length;++nr){const cr=Bt[nr].data;if(cr[this.no_timestamps_token_id]=-1/0,Gt[nr].length===this.begin_index-1){cr.fill(-1/0),cr[this.timestamp_begin]=0;continue}const ur=Gt[nr].slice(this.begin_index),yn=ur.length>=1&&ur[ur.length-1]>=this.timestamp_begin,hn=ur.length<2||ur[ur.length-2]>=this.timestamp_begin;if(yn&&(hn?cr.subarray(this.timestamp_begin).fill(-1/0):cr.subarray(0,this.eos_token_id).fill(-1/0)),Gt[nr].length===this.begin_index&&this.max_initial_timestamp_index!==null){const Tn=this.timestamp_begin+this.max_initial_timestamp_index;cr.subarray(Tn+1).fill(-1/0)}const _n=(0,d.log_softmax)(cr),gn=Math.log(_n.subarray(this.timestamp_begin).map(Math.exp).reduce((Tn,kn)=>Tn+kn)),vn=(0,d.max)(_n.subarray(0,this.timestamp_begin))[0];gn>vn&&cr.subarray(0,this.timestamp_begin).fill(-1/0)}return Bt}}class it extends h{constructor(Gt){super(),this.no_repeat_ngram_size=Gt}getNgrams(Gt){const Bt=Gt.length,nr=[];for(let ur=0;ur<Bt+1-this.no_repeat_ngram_size;++ur){const yn=[];for(let hn=0;hn<this.no_repeat_ngram_size;++hn)yn.push(Gt[ur+hn]);nr.push(yn.map(Number))}const cr=new Map;for(const ur of nr){const yn=ur.slice(0,ur.length-1),hn=JSON.stringify(yn),_n=cr.get(hn)??[];_n.push(ur[ur.length-1]),cr.set(hn,_n)}return cr}getGeneratedNgrams(Gt,Bt){const nr=Bt.slice(Bt.length+1-this.no_repeat_ngram_size,Bt.length);return Gt.get(JSON.stringify(nr.map(Number)))??[]}calcBannedNgramTokens(Gt){const Bt=[];if(Gt.length+1<this.no_repeat_ngram_size)return Bt;{const nr=this.getNgrams(Gt);return this.getGeneratedNgrams(nr,Gt)}}_call(Gt,Bt){for(let nr=0;nr<Gt.length;++nr){const cr=Bt[nr].data,ur=this.calcBannedNgramTokens(Gt[nr]);for(const yn of ur)cr[yn]=-1/0}return Bt}}class ct extends h{constructor(Gt){super(),this.penalty=Gt}_call(Gt,Bt){for(let nr=0;nr<Gt.length;++nr){const cr=Bt[nr].data;for(const ur of new Set(Gt[nr])){const yn=Number(ur);cr[yn]<0?cr[yn]*=this.penalty:cr[yn]/=this.penalty}}return Bt}}class mt extends h{constructor(Gt,Bt){super(),this.min_length=Gt,this.eos_token_id=Array.isArray(Bt)?Bt:[Bt]}_call(Gt,Bt){for(let nr=0;nr<Gt.length;++nr)if(Gt[nr].length<this.min_length){const cr=Bt[nr].data;for(const ur of this.eos_token_id)cr[ur]=-1/0}return Bt}}class pt extends h{constructor(Gt,Bt,nr){super(),this.prompt_length_to_skip=Gt,this.min_new_tokens=Bt,this.eos_token_id=Array.isArray(nr)?nr:[nr]}_call(Gt,Bt){for(let nr=0;nr<Gt.length;++nr)if(Gt[nr].length-this.prompt_length_to_skip<this.min_new_tokens){const ur=Bt[nr].data;for(const yn of this.eos_token_id)ur[yn]=-1/0}return Bt}}class zt extends h{constructor(Gt,Bt){super(),this.bad_words_ids=Gt,this.eos_token_id=Array.isArray(Bt)?Bt:[Bt]}_call(Gt,Bt){for(let nr=0;nr<Gt.length;++nr){const cr=Bt[nr].data,ur=Gt[nr];for(const yn of this.bad_words_ids){if(ur.length<yn.length-1)continue;let hn=!0;for(let _n=1;_n<=yn.length-1;++_n)if(yn.at(-_n-1)!=ur.at(-_n)){hn=!1;break}hn&&(cr[yn.at(-1)]=-1/0)}}return Bt}}class dt extends h{constructor(Gt){if(super(),Gt<=1)throw new Error(`Require guidance scale >1 to use the classifier free guidance processor, got guidance scale ${Gt}.`);this.guidance_scale=Gt}_call(Gt,Bt){if(Bt.dims[0]!==2*Gt.length)throw new Error(`Logits should have twice the batch size of the input ids, the first half of batches corresponding to the conditional inputs, and the second half of batches corresponding to the unconditional inputs. Got batch size ${Bt.dims[0]} for the logits and ${Gt.length} for the input ids.`);const nr=Gt.length,cr=Bt.slice([0,nr],null),ur=Bt.slice([nr,Bt.dims[0]],null);for(let yn=0;yn<ur.data.length;++yn)ur.data[yn]+=(cr.data[yn]-ur.data[yn])*this.guidance_scale;return ur}}class ft extends _{constructor(Gt){super(),this.temperature=Gt}_call(Gt,Bt){const nr=Bt.data;for(let cr=0;cr<nr.length;++cr)nr[cr]/=this.temperature;return Bt}}class kt extends _{constructor(Gt,{filter_value:Bt=-1/0,min_tokens_to_keep:nr=1}={}){if(super(),Gt<0||Gt>1)throw new Error(`\`top_p\` must be a float > 0 and < 1, but is ${Gt}`);if(!Number.isInteger(nr)||nr<1)throw new Error(`\`min_tokens_to_keep\` must be a positive integer, but is ${nr}`);this.top_p=Gt,this.filter_value=Bt,this.min_tokens_to_keep=nr}}class St extends _{constructor(Gt,{filter_value:Bt=-1/0,min_tokens_to_keep:nr=1}={}){if(super(),!Number.isInteger(Gt)||Gt<0)throw new Error(`\`top_k\` must be a positive integer, but is ${Gt}`);this.top_k=Math.max(Gt,nr),this.filter_value=Bt}}},"./src/generation/logits_sampler.js":(e,s,i)=>{i.r(s),i.d(s,{LogitsSampler:()=>_});var c=i("./src/utils/generic.js"),d=i("./src/utils/tensor.js"),h=i("./src/utils/maths.js");i("./src/generation/configuration_utils.js");class _ extends c.Callable{constructor(at){super(),this.generation_config=at}async _call(at){return this.sample(at)}async sample(at){throw Error("sample should be implemented in subclasses.")}getLogits(at,it){let ct=at.dims.at(-1),mt=at.data;if(it===-1)mt=mt.slice(-ct);else{let pt=it*ct;mt=mt.slice(pt,pt+ct)}return mt}randomSelect(at){let it=0;for(let mt=0;mt<at.length;++mt)it+=at[mt];let ct=Math.random()*it;for(let mt=0;mt<at.length;++mt)if(ct-=at[mt],ct<=0)return mt;return 0}static getSampler(at){if(at.do_sample)return new $(at);if(at.num_beams>1)return new _e(at);if(at.num_return_sequences>1)throw Error(`num_return_sequences has to be 1 when doing greedy search, but is ${at.num_return_sequences}.`);return new g(at)}}class g extends _{async sample(at){const it=(0,h.max)(at.data)[1];return[[BigInt(it),0]]}}class $ extends _{async sample(at){let it=at.dims.at(-1);this.generation_config.top_k>0&&(it=Math.min(this.generation_config.top_k,it));const[ct,mt]=await(0,d.topk)(at,it),pt=(0,h.softmax)(ct.data);return Array.from({length:this.generation_config.num_beams},()=>{const zt=this.randomSelect(pt);return[mt.data[zt],Math.log(pt[zt])]})}}class _e extends _{async sample(at){let it=at.dims.at(-1);this.generation_config.top_k>0&&(it=Math.min(this.generation_config.top_k,it));const[ct,mt]=await(0,d.topk)(at,it),pt=(0,h.softmax)(ct.data);return Array.from({length:this.generation_config.num_beams},(zt,dt)=>[mt.data[dt],Math.log(pt[dt])])}}},"./src/generation/stopping_criteria.js":(e,s,i)=>{i.r(s),i.d(s,{EosTokenCriteria:()=>g,InterruptableStoppingCriteria:()=>$,MaxLengthCriteria:()=>_,StoppingCriteria:()=>d,StoppingCriteriaList:()=>h});var c=i("./src/utils/generic.js");class d extends c.Callable{_call(lt,at){throw Error("StoppingCriteria needs to be subclassed")}}class h extends c.Callable{constructor(){super(),this.criteria=[]}push(lt){this.criteria.push(lt)}extend(lt){lt instanceof h?lt=lt.criteria:lt instanceof d&&(lt=[lt]),this.criteria.push(...lt)}_call(lt,at){const it=new Array(lt.length).fill(!1);for(const ct of this.criteria){const mt=ct(lt,at);for(let pt=0;pt<it.length;++pt)it[pt]||(it[pt]=mt[pt])}return it}[Symbol.iterator](){return this.criteria.values()}}class _ extends d{constructor(lt,at=null){super(),this.max_length=lt,this.max_position_embeddings=at}_call(lt){return lt.map(at=>at.length>=this.max_length)}}class g extends d{constructor(lt){super(),Array.isArray(lt)||(lt=[lt]),this.eos_token_id=lt}_call(lt,at){return lt.map(it=>{const ct=it.at(-1);return this.eos_token_id.some(mt=>ct==mt)})}}class $ extends d{constructor(){super(),this.interrupted=!1}interrupt(){this.interrupted=!0}reset(){this.interrupted=!1}_call(lt,at){return new Array(lt.length).fill(this.interrupted)}}},"./src/generation/streamers.js":(e,s,i)=>{i.r(s),i.d(s,{BaseStreamer:()=>_,TextStreamer:()=>$,WhisperTextStreamer:()=>_e});var c=i("./src/utils/core.js"),d=i("./src/tokenizers.js"),h=i("./src/env.js");class _{put(at){throw Error("Not implemented")}end(){throw Error("Not implemented")}}const g=h.apis.IS_PROCESS_AVAILABLE?lt=>process.stdout.write(lt):lt=>console.log(lt);class $ extends _{constructor(at,{skip_prompt:it=!1,callback_function:ct=null,token_callback_function:mt=null,skip_special_tokens:pt=!0,decode_kwargs:zt={},...dt}={}){super(),this.tokenizer=at,this.skip_prompt=it,this.callback_function=ct??g,this.token_callback_function=mt,this.decode_kwargs={skip_special_tokens:pt,...zt,...dt},this.token_cache=[],this.print_len=0,this.next_tokens_are_prompt=!0}put(at){var zt;if(at.length>1)throw Error("TextStreamer only supports batch size of 1");const it=this.next_tokens_are_prompt;if(it&&(this.next_tokens_are_prompt=!1,this.skip_prompt))return;const ct=at[0];(zt=this.token_callback_function)==null||zt.call(this,ct),this.token_cache=(0,c.mergeArrays)(this.token_cache,ct);const mt=this.tokenizer.decode(this.token_cache,this.decode_kwargs);let pt;it||mt.endsWith(`
`)?(pt=mt.slice(this.print_len),this.token_cache=[],this.print_len=0):mt.length>0&&(0,d.is_chinese_char)(mt.charCodeAt(mt.length-1))?(pt=mt.slice(this.print_len),this.print_len+=pt.length):(pt=mt.slice(this.print_len,mt.lastIndexOf(" ")+1),this.print_len+=pt.length),this.on_finalized_text(pt,!1)}end(){let at;this.token_cache.length>0?(at=this.tokenizer.decode(this.token_cache,this.decode_kwargs).slice(this.print_len),this.token_cache=[],this.print_len=0):at="",this.next_tokens_are_prompt=!0,this.on_finalized_text(at,!0)}on_finalized_text(at,it){var ct,mt;at.length>0&&((ct=this.callback_function)==null||ct.call(this,at)),it&&this.callback_function===g&&h.apis.IS_PROCESS_AVAILABLE&&((mt=this.callback_function)==null||mt.call(this,`
`))}}class _e extends ${constructor(at,{skip_prompt:it=!1,callback_function:ct=null,token_callback_function:mt=null,on_chunk_start:pt=null,on_chunk_end:zt=null,on_finalize:dt=null,time_precision:ft=.02,skip_special_tokens:kt=!0,decode_kwargs:St={}}={}){super(at,{skip_prompt:it,skip_special_tokens:kt,callback_function:ct,token_callback_function:mt,decode_kwargs:St}),this.timestamp_begin=at.timestamp_begin,this.on_chunk_start=pt,this.on_chunk_end=zt,this.on_finalize=dt,this.time_precision=ft,this.waiting_for_timestamp=!1}put(at){var ct,mt,pt;if(at.length>1)throw Error("WhisperTextStreamer only supports batch size of 1");const it=at[0];if(it.length===1){const zt=Number(it[0])-this.timestamp_begin;if(zt>=0){const dt=zt*this.time_precision;this.waiting_for_timestamp?(ct=this.on_chunk_end)==null||ct.call(this,dt):(mt=this.on_chunk_start)==null||mt.call(this,dt),this.waiting_for_timestamp=!this.waiting_for_timestamp,(pt=this.token_callback_function)==null||pt.call(this,it);return}}return super.put(at)}end(){var at;super.end(),(at=this.on_finalize)==null||at.call(this)}}},"./src/models.js":(e,s,i)=>{i.r(s),i.d(s,{ASTForAudioClassification:()=>Zy,ASTModel:()=>Jy,ASTPreTrainedModel:()=>Vw,AlbertForMaskedLM:()=>Tp,AlbertForQuestionAnswering:()=>xp,AlbertForSequenceClassification:()=>yp,AlbertModel:()=>mp,AlbertPreTrainedModel:()=>bu,ArceeForCausalLM:()=>aw,ArceeModel:()=>sx,ArceePreTrainedModel:()=>M_,AutoModel:()=>e0,AutoModelForAudioClassification:()=>xP,AutoModelForAudioFrameClassification:()=>yP,AutoModelForAudioTextToText:()=>CP,AutoModelForCTC:()=>gP,AutoModelForCausalLM:()=>aP,AutoModelForDepthEstimation:()=>EP,AutoModelForDocumentQuestionAnswering:()=>vP,AutoModelForImageClassification:()=>uP,AutoModelForImageFeatureExtraction:()=>$P,AutoModelForImageMatting:()=>bP,AutoModelForImageSegmentation:()=>dP,AutoModelForImageTextToText:()=>PP,AutoModelForImageToImage:()=>MP,AutoModelForMaskGeneration:()=>_P,AutoModelForMaskedLM:()=>iP,AutoModelForNormalEstimation:()=>TP,AutoModelForObjectDetection:()=>mP,AutoModelForPoseEstimation:()=>kP,AutoModelForQuestionAnswering:()=>lP,AutoModelForSemanticSegmentation:()=>pP,AutoModelForSeq2SeqLM:()=>rP,AutoModelForSequenceClassification:()=>eP,AutoModelForSpeechSeq2Seq:()=>nP,AutoModelForTextToSpectrogram:()=>sP,AutoModelForTextToWaveform:()=>oP,AutoModelForTokenClassification:()=>tP,AutoModelForUniversalSegmentation:()=>fP,AutoModelForVision2Seq:()=>cP,AutoModelForXVector:()=>wP,AutoModelForZeroShotObjectDetection:()=>hP,BartForConditionalGeneration:()=>A_,BartForSequenceClassification:()=>ex,BartModel:()=>Cx,BartPretrainedModel:()=>nx,BaseModelOutput:()=>Go,BeitForImageClassification:()=>CM,BeitModel:()=>PM,BeitPreTrainedModel:()=>h1,BertForMaskedLM:()=>Ho,BertForQuestionAnswering:()=>ep,BertForSequenceClassification:()=>_c,BertForTokenClassification:()=>Qo,BertModel:()=>_i,BertPreTrainedModel:()=>Jo,BlenderbotForConditionalGeneration:()=>q_,BlenderbotModel:()=>V_,BlenderbotPreTrainedModel:()=>F_,BlenderbotSmallForConditionalGeneration:()=>sw,BlenderbotSmallModel:()=>Mx,BlenderbotSmallPreTrainedModel:()=>R_,BloomForCausalLM:()=>Y0,BloomModel:()=>X0,BloomPreTrainedModel:()=>n1,CLIPModel:()=>Kw,CLIPPreTrainedModel:()=>Wx,CLIPSegForImageSegmentation:()=>Cw,CLIPSegModel:()=>Sx,CLIPSegPreTrainedModel:()=>dw,CLIPTextModel:()=>dv,CLIPTextModelWithProjection:()=>wy,CLIPVisionModel:()=>pv,CLIPVisionModelWithProjection:()=>yy,CamembertForMaskedLM:()=>n_,CamembertForQuestionAnswering:()=>kp,CamembertForSequenceClassification:()=>zp,CamembertForTokenClassification:()=>i_,CamembertModel:()=>Cp,CamembertPreTrainedModel:()=>sp,CausalLMOutput:()=>fw,CausalLMOutputWithPast:()=>aC,ChineseCLIPModel:()=>Pw,ChineseCLIPPreTrainedModel:()=>My,ClapAudioModelWithProjection:()=>LT,ClapModel:()=>jT,ClapPreTrainedModel:()=>vv,ClapTextModelWithProjection:()=>NT,CodeGenForCausalLM:()=>xn,CodeGenModel:()=>pr,CodeGenPreTrainedModel:()=>sr,CohereForCausalLM:()=>C0,CohereModel:()=>P0,CoherePreTrainedModel:()=>qv,ConvBertForMaskedLM:()=>r_,ConvBertForQuestionAnswering:()=>m_,ConvBertForSequenceClassification:()=>g_,ConvBertForTokenClassification:()=>Pp,ConvBertModel:()=>e_,ConvBertPreTrainedModel:()=>X_,ConvNextForImageClassification:()=>ME,ConvNextModel:()=>bE,ConvNextPreTrainedModel:()=>S1,ConvNextV2ForImageClassification:()=>TE,ConvNextV2Model:()=>EE,ConvNextV2PreTrainedModel:()=>A1,DFineForObjectDetection:()=>UM,DFineModel:()=>BM,DFinePreTrainedModel:()=>v1,DINOv3ConvNextModel:()=>RE,DINOv3ConvNextPreTrainedModel:()=>IE,DINOv3ViTModel:()=>AE,DINOv3ViTPreTrainedModel:()=>SE,DPTForDepthEstimation:()=>sE,DPTModel:()=>nE,DPTPreTrainedModel:()=>$1,DacDecoderModel:()=>E$,DacDecoderOutput:()=>v$,DacEncoderModel:()=>M$,DacEncoderOutput:()=>y$,DacModel:()=>b$,DacPreTrainedModel:()=>Pv,DebertaForMaskedLM:()=>xx,DebertaForQuestionAnswering:()=>lx,DebertaForSequenceClassification:()=>bx,DebertaForTokenClassification:()=>N_,DebertaModel:()=>$_,DebertaPreTrainedModel:()=>h_,DebertaV2ForMaskedLM:()=>Ox,DebertaV2ForQuestionAnswering:()=>Xx,DebertaV2ForSequenceClassification:()=>ux,DebertaV2ForTokenClassification:()=>Qx,DebertaV2Model:()=>Rx,DebertaV2PreTrainedModel:()=>B_,DecisionTransformerModel:()=>n$,DecisionTransformerPreTrainedModel:()=>r$,DeiTForImageClassification:()=>KM,DeiTModel:()=>HM,DeiTPreTrainedModel:()=>M1,DepthAnythingForDepthEstimation:()=>aE,DepthAnythingPreTrainedModel:()=>oE,DepthProForDepthEstimation:()=>dE,DepthProPreTrainedModel:()=>uE,DetrForObjectDetection:()=>AM,DetrForSegmentation:()=>_1,DetrModel:()=>SM,DetrObjectDetectionOutput:()=>g1,DetrPreTrainedModel:()=>hv,DetrSegmentationOutput:()=>IM,Dinov2ForImageClassification:()=>$E,Dinov2Model:()=>kE,Dinov2PreTrainedModel:()=>I1,Dinov2WithRegistersForImageClassification:()=>CE,Dinov2WithRegistersModel:()=>PE,Dinov2WithRegistersPreTrainedModel:()=>R1,DistilBertForMaskedLM:()=>K_,DistilBertForQuestionAnswering:()=>Bx,DistilBertForSequenceClassification:()=>kx,DistilBertForTokenClassification:()=>_x,DistilBertModel:()=>jx,DistilBertPreTrainedModel:()=>rx,DonutSwinModel:()=>vE,DonutSwinPreTrainedModel:()=>yE,EfficientNetForImageClassification:()=>WT,EfficientNetModel:()=>VT,EfficientNetPreTrainedModel:()=>W1,ElectraForMaskedLM:()=>wn,ElectraForQuestionAnswering:()=>Yo,ElectraForSequenceClassification:()=>An,ElectraForTokenClassification:()=>No,ElectraModel:()=>In,ElectraPreTrainedModel:()=>ir,Ernie4_5_ForCausalLM:()=>ST,Ernie4_5_Model:()=>CT,Ernie4_5_PretrainedModel:()=>D1,EsmForMaskedLM:()=>rw,EsmForSequenceClassification:()=>wx,EsmForTokenClassification:()=>dp,EsmModel:()=>Nx,EsmPreTrainedModel:()=>L_,ExaoneForCausalLM:()=>g0,ExaoneModel:()=>_0,ExaonePreTrainedModel:()=>Uv,FalconForCausalLM:()=>OT,FalconModel:()=>RT,FalconPreTrainedModel:()=>B1,FastViTForImageClassification:()=>gM,FastViTModel:()=>_M,FastViTPreTrainedModel:()=>u1,Florence2ForConditionalGeneration:()=>ov,Florence2PreTrainedModel:()=>sv,GLPNForDepthEstimation:()=>wE,GLPNModel:()=>xE,GLPNPreTrainedModel:()=>C1,GPT2LMHeadModel:()=>$y,GPT2Model:()=>ky,GPT2PreTrainedModel:()=>Sw,GPTBigCodeForCausalLM:()=>Pt,GPTBigCodeModel:()=>Ry,GPTBigCodePreTrainedModel:()=>ey,GPTJForCausalLM:()=>Iy,GPTJModel:()=>Ay,GPTJPreTrainedModel:()=>Zw,GPTNeoForCausalLM:()=>Aw,GPTNeoModel:()=>Cy,GPTNeoPreTrainedModel:()=>Yw,GPTNeoXForCausalLM:()=>Sy,GPTNeoXModel:()=>Jw,GPTNeoXPreTrainedModel:()=>Iw,Gemma2ForCausalLM:()=>R0,Gemma2Model:()=>I0,Gemma2PreTrainedModel:()=>Xv,Gemma3ForCausalLM:()=>L0,Gemma3Model:()=>N0,Gemma3PreTrainedModel:()=>Jv,Gemma3nForConditionalGeneration:()=>gy,Gemma3nPreTrainedModel:()=>cv,GemmaForCausalLM:()=>A0,GemmaModel:()=>S0,GemmaPreTrainedModel:()=>Qv,GlmForCausalLM:()=>h0,GlmModel:()=>m0,GlmPreTrainedModel:()=>Bv,GraniteForCausalLM:()=>T0,GraniteModel:()=>E0,GraniteMoeHybridForCausalLM:()=>$0,GraniteMoeHybridModel:()=>k0,GraniteMoeHybridPreTrainedModel:()=>Kv,GranitePreTrainedModel:()=>Hv,GroundingDinoForObjectDetection:()=>jE,GroundingDinoPreTrainedModel:()=>OE,GroupViTModel:()=>hM,GroupViTPreTrainedModel:()=>mM,HeliumForCausalLM:()=>f0,HeliumModel:()=>p0,HeliumPreTrainedModel:()=>zv,HieraForImageClassification:()=>QM,HieraModel:()=>qM,HieraPreTrainedModel:()=>E1,HubertForCTC:()=>fT,HubertForSequenceClassification:()=>mT,HubertModel:()=>pT,HubertPreTrainedModel:()=>HP,IJepaForImageClassification:()=>oM,IJepaModel:()=>sM,IJepaPreTrainedModel:()=>i1,Idefics3ForConditionalGeneration:()=>Jx,Idefics3PreTrainedModel:()=>$w,ImageMattingOutput:()=>AP,JAISLMHeadModel:()=>Py,JAISModel:()=>Xw,JAISPreTrainedModel:()=>Qw,JinaCLIPModel:()=>mv,JinaCLIPPreTrainedModel:()=>Op,JinaCLIPTextModel:()=>Ey,JinaCLIPVisionModel:()=>Ty,Lfm2ForCausalLM:()=>c0,Lfm2Model:()=>l0,Lfm2PreTrainedModel:()=>Oy,LiteWhisperForConditionalGeneration:()=>ev,Llama4ForCausalLM:()=>vp,Llama4PreTrainedModel:()=>cp,LlamaForCausalLM:()=>rp,LlamaModel:()=>Bo,LlamaPreTrainedModel:()=>Pn,LlavaForConditionalGeneration:()=>kw,LlavaOnevisionForConditionalGeneration:()=>rv,LlavaPreTrainedModel:()=>Tw,LlavaQwen2ForCausalLM:()=>lv,LongT5ForConditionalGeneration:()=>Y_,LongT5Model:()=>T_,LongT5PreTrainedModel:()=>I_,M2M100ForConditionalGeneration:()=>GE,M2M100Model:()=>WE,M2M100PreTrainedModel:()=>N1,MBartForCausalLM:()=>Lx,MBartForConditionalGeneration:()=>Vx,MBartForSequenceClassification:()=>px,MBartModel:()=>$x,MBartPreTrainedModel:()=>dx,MPNetForMaskedLM:()=>bw,MPNetForQuestionAnswering:()=>Vo,MPNetForSequenceClassification:()=>Mw,MPNetForTokenClassification:()=>Ew,MPNetModel:()=>vw,MPNetPreTrainedModel:()=>Px,MT5ForConditionalGeneration:()=>Z_,MT5Model:()=>U_,MT5PreTrainedModel:()=>J_,MarianMTModel:()=>VE,MarianModel:()=>UE,MarianPreTrainedModel:()=>j1,MaskFormerForInstanceSegmentation:()=>gE,MaskFormerModel:()=>_E,MaskFormerPreTrainedModel:()=>P1,MaskedLMOutput:()=>fx,Metric3DForDepthEstimation:()=>fE,Metric3DPreTrainedModel:()=>pE,Metric3Dv2ForDepthEstimation:()=>hE,Metric3Dv2PreTrainedModel:()=>mE,MgpstrForSceneTextRecognition:()=>l$,MgpstrModelOutput:()=>a$,MgpstrPreTrainedModel:()=>i$,MimiDecoderModel:()=>w$,MimiDecoderOutput:()=>_$,MimiEncoderModel:()=>x$,MimiEncoderOutput:()=>h$,MimiModel:()=>g$,MimiPreTrainedModel:()=>$v,MistralForCausalLM:()=>PT,MistralModel:()=>$T,MistralPreTrainedModel:()=>F1,MobileBertForMaskedLM:()=>P_,MobileBertForQuestionAnswering:()=>Ux,MobileBertForSequenceClassification:()=>nw,MobileBertModel:()=>$p,MobileBertPreTrainedModel:()=>pp,MobileLLMForCausalLM:()=>w0,MobileLLMModel:()=>x0,MobileLLMPreTrainedModel:()=>Vv,MobileNetV1ForImageClassification:()=>HT,MobileNetV1ForSemanticSegmentation:()=>KT,MobileNetV1Model:()=>GT,MobileNetV1PreTrainedModel:()=>Mv,MobileNetV2ForImageClassification:()=>QT,MobileNetV2ForSemanticSegmentation:()=>XT,MobileNetV2Model:()=>qT,MobileNetV2PreTrainedModel:()=>Ev,MobileNetV3ForImageClassification:()=>JT,MobileNetV3ForSemanticSegmentation:()=>ZT,MobileNetV3Model:()=>YT,MobileNetV3PreTrainedModel:()=>Tv,MobileNetV4ForImageClassification:()=>e$,MobileNetV4ForSemanticSegmentation:()=>t$,MobileNetV4Model:()=>_k,MobileNetV4PreTrainedModel:()=>kv,MobileViTForImageClassification:()=>vM,MobileViTModel:()=>yM,MobileViTPreTrainedModel:()=>d1,MobileViTV2ForImageClassification:()=>MM,MobileViTV2Model:()=>bM,MobileViTV2PreTrainedModel:()=>p1,ModelOutput:()=>Do,ModernBertDecoderForCausalLM:()=>C_,ModernBertDecoderModel:()=>Ip,ModernBertDecoderPreTrainedModel:()=>u_,ModernBertForMaskedLM:()=>fp,ModernBertForSequenceClassification:()=>Rp,ModernBertForTokenClassification:()=>Ap,ModernBertModel:()=>ip,ModernBertPreTrainedModel:()=>wp,Moondream1ForConditionalGeneration:()=>nv,MoonshineForConditionalGeneration:()=>tv,MoonshineModel:()=>Fv,MoonshinePreTrainedModel:()=>Gw,MptForCausalLM:()=>Z0,MptModel:()=>J0,MptPreTrainedModel:()=>s1,MultiModalityCausalLM:()=>o$,MultiModalityPreTrainedModel:()=>s$,MusicgenForCausalLM:()=>XP,MusicgenForConditionalGeneration:()=>H1,MusicgenModel:()=>QP,MusicgenPreTrainedModel:()=>G1,NanoChatForCausalLM:()=>y_,NanoChatModel:()=>l_,NanoChatPreTrainedModel:()=>Sp,NeoBertForMaskedLM:()=>Zo,NeoBertForQuestionAnswering:()=>Mp,NeoBertForSequenceClassification:()=>bp,NeoBertForTokenClassification:()=>gp,NeoBertModel:()=>_p,NeoBertPreTrainedModel:()=>lp,NomicBertModel:()=>z_,NomicBertPreTrainedModel:()=>G_,OPTForCausalLM:()=>tM,OPTModel:()=>eM,OPTPreTrainedModel:()=>o1,Olmo2ForCausalLM:()=>M0,Olmo2Model:()=>b0,Olmo2PreTrainedModel:()=>Gv,OlmoForCausalLM:()=>v0,OlmoModel:()=>y0,OlmoPreTrainedModel:()=>Wv,OpenELMForCausalLM:()=>D0,OpenELMModel:()=>F0,OpenELMPreTrainedModel:()=>Zv,OwlViTForObjectDetection:()=>TM,OwlViTModel:()=>EM,OwlViTPreTrainedModel:()=>f1,Owlv2ForObjectDetection:()=>$M,Owlv2Model:()=>kM,Owlv2PreTrainedModel:()=>m1,PaliGemmaForConditionalGeneration:()=>iv,PaliGemmaPreTrainedModel:()=>av,ParakeetForCTC:()=>YE,ParakeetPreTrainedModel:()=>XE,PatchTSMixerForPrediction:()=>p$,PatchTSMixerModel:()=>d$,PatchTSMixerPreTrainedModel:()=>q1,PatchTSTForPrediction:()=>u$,PatchTSTModel:()=>c$,PatchTSTPreTrainedModel:()=>K1,Phi3ForCausalLM:()=>Q0,Phi3Model:()=>q0,Phi3PreTrainedModel:()=>r1,Phi3VForCausalLM:()=>xy,Phi3VPreTrainedModel:()=>uv,PhiForCausalLM:()=>K0,PhiModel:()=>H0,PhiPreTrainedModel:()=>t1,PreTrainedModel:()=>mr,PretrainedMixin:()=>b_,PvtForImageClassification:()=>cM,PvtModel:()=>lM,PvtPreTrainedModel:()=>l1,PyAnnoteForAudioFrameClassification:()=>ZE,PyAnnoteModel:()=>JE,PyAnnotePreTrainedModel:()=>L1,QuestionAnsweringModelOutput:()=>gx,Qwen2ForCausalLM:()=>B0,Qwen2Model:()=>z0,Qwen2PreTrainedModel:()=>_b,Qwen2VLForConditionalGeneration:()=>G0,Qwen2VLPreTrainedModel:()=>W0,Qwen3ForCausalLM:()=>V0,Qwen3Model:()=>U0,Qwen3PreTrainedModel:()=>e1,RFDetrForObjectDetection:()=>DM,RFDetrModel:()=>FM,RFDetrObjectDetectionOutput:()=>zM,RFDetrPreTrainedModel:()=>y1,RTDetrForObjectDetection:()=>OM,RTDetrModel:()=>RM,RTDetrObjectDetectionOutput:()=>jy,RTDetrPreTrainedModel:()=>x1,RTDetrV2ForObjectDetection:()=>NM,RTDetrV2Model:()=>jM,RTDetrV2ObjectDetectionOutput:()=>LM,RTDetrV2PreTrainedModel:()=>w1,ResNetForImageClassification:()=>YM,ResNetModel:()=>XM,ResNetPreTrainedModel:()=>T1,RoFormerForMaskedLM:()=>H_,RoFormerForQuestionAnswering:()=>Ix,RoFormerForSequenceClassification:()=>zx,RoFormerForTokenClassification:()=>qx,RoFormerModel:()=>S_,RoFormerPreTrainedModel:()=>hx,RobertaForMaskedLM:()=>By,RobertaForQuestionAnswering:()=>Vy,RobertaForSequenceClassification:()=>py,RobertaForTokenClassification:()=>Uy,RobertaModel:()=>zy,RobertaPreTrainedModel:()=>Yx,SamImageSegmentationOutput:()=>BE,SamModel:()=>zE,SamPreTrainedModel:()=>DE,SapiensForDepthEstimation:()=>lE,SapiensForNormalEstimation:()=>cE,SapiensForSemanticSegmentation:()=>iE,SapiensPreTrainedModel:()=>gv,SegformerForImageClassification:()=>DT,SegformerForSemanticSegmentation:()=>zT,SegformerModel:()=>qP,SegformerPreTrainedModel:()=>bv,Seq2SeqLMOutput:()=>oC,SequenceClassifierOutput:()=>c_,SiglipModel:()=>vy,SiglipPreTrainedModel:()=>qw,SiglipTextModel:()=>fv,SiglipVisionModel:()=>by,SmolLM3ForCausalLM:()=>d0,SmolLM3Model:()=>u0,SmolLM3PreTrainedModel:()=>Dv,SmolVLMForConditionalGeneration:()=>Hw,SnacDecoderModel:()=>$$,SnacEncoderModel:()=>k$,SnacModel:()=>T$,SnacPreTrainedModel:()=>Cv,SpeechT5ForSpeechToText:()=>bT,SpeechT5ForTextToSpeech:()=>MT,SpeechT5HifiGan:()=>ET,SpeechT5Model:()=>KP,SpeechT5PreTrainedModel:()=>yv,SqueezeBertForMaskedLM:()=>jo,SqueezeBertForQuestionAnswering:()=>Uo,SqueezeBertForSequenceClassification:()=>zo,SqueezeBertModel:()=>$n,SqueezeBertPreTrainedModel:()=>dr,StableLmForCausalLM:()=>UT,StableLmModel:()=>BT,StableLmPreTrainedModel:()=>V1,Starcoder2ForCausalLM:()=>IT,Starcoder2Model:()=>AT,Starcoder2PreTrainedModel:()=>z1,StyleTextToSpeech2Model:()=>vT,StyleTextToSpeech2PreTrainedModel:()=>yT,Swin2SRForImageSuperResolution:()=>rE,Swin2SRModel:()=>tE,Swin2SRPreTrainedModel:()=>k1,SwinForImageClassification:()=>ZM,SwinForSemanticSegmentation:()=>eE,SwinModel:()=>JM,SwinPreTrainedModel:()=>_v,T5ForConditionalGeneration:()=>w_,T5Model:()=>v_,T5PreTrainedModel:()=>s_,TableTransformerForObjectDetection:()=>WM,TableTransformerModel:()=>VM,TableTransformerObjectDetectionOutput:()=>GM,TableTransformerPreTrainedModel:()=>b1,TokenClassifierOutput:()=>ox,TrOCRForCausalLM:()=>kT,TrOCRPreTrainedModel:()=>TT,UltravoxModel:()=>Q1,UltravoxPreTrainedModel:()=>f$,UniSpeechForCTC:()=>nT,UniSpeechForSequenceClassification:()=>sT,UniSpeechModel:()=>rT,UniSpeechPreTrainedModel:()=>xv,UniSpeechSatForAudioFrameClassification:()=>lT,UniSpeechSatForCTC:()=>aT,UniSpeechSatForSequenceClassification:()=>iT,UniSpeechSatModel:()=>oT,UniSpeechSatPreTrainedModel:()=>Ny,VaultGemmaForCausalLM:()=>j0,VaultGemmaModel:()=>O0,VaultGemmaPreTrainedModel:()=>Yv,ViTForImageClassification:()=>nM,ViTMAEModel:()=>dM,ViTMAEPreTrainedModel:()=>uM,ViTMSNForImageClassification:()=>fM,ViTMSNModel:()=>pM,ViTMSNPreTrainedModel:()=>c1,ViTModel:()=>rM,ViTPreTrainedModel:()=>a1,VisionEncoderDecoderModel:()=>_y,VitMatteForImageMatting:()=>wM,VitMattePreTrainedModel:()=>xM,VitPoseForPoseEstimation:()=>iM,VitPosePreTrainedModel:()=>aM,VitsModel:()=>U1,VitsModelOutput:()=>IP,VitsPreTrainedModel:()=>FT,VoxtralForConditionalGeneration:()=>m$,Wav2Vec2BertForCTC:()=>uT,Wav2Vec2BertForSequenceClassification:()=>dT,Wav2Vec2BertModel:()=>cT,Wav2Vec2BertPreTrainedModel:()=>wv,Wav2Vec2ForAudioFrameClassification:()=>QE,Wav2Vec2ForCTC:()=>KE,Wav2Vec2ForSequenceClassification:()=>qE,Wav2Vec2Model:()=>HE,Wav2Vec2PreTrainedModel:()=>pw,WavLMForAudioFrameClassification:()=>wT,WavLMForCTC:()=>_T,WavLMForSequenceClassification:()=>gT,WavLMForXVector:()=>xT,WavLMModel:()=>hT,WavLMPreTrainedModel:()=>ty,WeSpeakerResNetModel:()=>tT,WeSpeakerResNetPreTrainedModel:()=>eT,WhisperForConditionalGeneration:()=>ow,WhisperModel:()=>hy,WhisperPreTrainedModel:()=>Ww,XLMForQuestionAnswering:()=>qy,XLMForSequenceClassification:()=>Hy,XLMForTokenClassification:()=>Ky,XLMModel:()=>Wy,XLMPreTrainedModel:()=>cw,XLMRobertaForMaskedLM:()=>Xy,XLMRobertaForQuestionAnswering:()=>my,XLMRobertaForSequenceClassification:()=>Yy,XLMRobertaForTokenClassification:()=>fy,XLMRobertaModel:()=>Qy,XLMRobertaPreTrainedModel:()=>uw,XLMWithLMHeadModel:()=>Gy,XVectorOutput:()=>SP,YolosForObjectDetection:()=>LE,YolosModel:()=>NE,YolosObjectDetectionOutput:()=>FE,YolosPreTrainedModel:()=>O1});var c=i("./src/configs.js"),d=i("./src/backends/onnx.js"),h=i("./src/utils/dtypes.js"),_=i("./src/utils/generic.js"),g=i("./src/utils/core.js"),$=i("./src/utils/hub.js"),_e=i("./src/utils/constants.js"),lt=i("./src/generation/logits_process.js"),at=i("./src/generation/configuration_utils.js"),it=i("./src/utils/tensor.js"),ct=i("./src/utils/image.js"),mt=i("./src/utils/maths.js"),pt=i("./src/generation/stopping_criteria.js"),zt=i("./src/generation/logits_sampler.js"),dt=i("./src/env.js"),ft=i("./src/models/whisper/generation_whisper.js"),kt=i("./src/models/whisper/common_whisper.js");const St={EncoderOnly:0,EncoderDecoder:1,Seq2Seq:2,Vision2Seq:3,DecoderOnly:4,MaskGeneration:5,ImageTextToText:6,Musicgen:7,MultiModality:8,Phi3V:9,AudioTextToText:10,AutoEncoder:11,ImageAudioTextToText:12},Lt=new Map,Gt=new Map,Bt=new Map;async function nr(Ht,ar,mn){var mx;let Fo=((mx=mn.config)==null?void 0:mx["transformers.js_config"])??{},Xo=mn.device??Fo.device;Xo&&typeof Xo!="string"&&(Xo.hasOwnProperty(ar)?Xo=Xo[ar]:(console.warn(`device not specified for "${ar}". Using the default device.`),Xo=null));const Ko=Xo??(dt.apis.IS_NODE_ENV?"cpu":"wasm"),np=(0,d.deviceToExecutionProviders)(Ko),up=Fo.device_config??{};up.hasOwnProperty(Ko)&&(Fo={...Fo,...up[Ko]});let hp=mn.dtype??Fo.dtype;if(typeof hp!="string"&&(hp&&hp.hasOwnProperty(ar)?hp=hp[ar]:(hp=h.DEFAULT_DEVICE_DTYPE_MAPPING[Ko]??h.DATA_TYPES.fp32,console.warn(`dtype not specified for "${ar}". Using the default dtype (${hp}) for this device (${Ko}).`))),hp===h.DATA_TYPES.auto){let p_=Fo.dtype;typeof p_!="string"&&(p_=p_==null?void 0:p_[ar]),p_&&p_!==h.DATA_TYPES.auto&&h.DATA_TYPES.hasOwnProperty(p_)?hp=p_:hp=h.DEFAULT_DEVICE_DTYPE_MAPPING[Ko]??h.DATA_TYPES.fp32}const Ep=hp;if(h.DEFAULT_DTYPE_SUFFIX_MAPPING.hasOwnProperty(Ep)){if(Ep===h.DATA_TYPES.fp16&&Ko==="webgpu"&&!await(0,h.isWebGpuFp16Supported)())throw new Error(`The device (${Ko}) does not support fp16.`)}else throw new Error(`Invalid dtype: ${Ep}. Should be one of: ${Object.keys(h.DATA_TYPES).join(", ")}`);const Bp=Fo.kv_cache_dtype,o_=Bp?typeof Bp=="string"?Bp:Bp[Ep]??"float32":void 0;if(o_&&!["float32","float16"].includes(o_))throw new Error(`Invalid kv_cache_dtype: ${o_}. Should be one of: float32, float16`);const a_={dtype:Ep,kv_cache_dtype:o_,device:Ko},x_=h.DEFAULT_DTYPE_SUFFIX_MAPPING[Ep],t_=`${ar}${x_}.onnx`,d_=`${mn.subfolder??""}/${t_}`,Dp={...mn.session_options};Dp.executionProviders??(Dp.executionProviders=np);const __=Fo.free_dimension_overrides;__?Dp.freeDimensionOverrides??(Dp.freeDimensionOverrides=__):Ko.startsWith("webnn")&&!Dp.freeDimensionOverrides&&console.warn(`WebNN does not currently support dynamic shapes and requires 'free_dimension_overrides' to be set in config.json, preferably as a field within config["transformers.js_config"]["device_config"]["${Ko}"]. When 'free_dimension_overrides' is not set, you may experience significant performance degradation.`);const k_=dt.apis.IS_NODE_ENV&&dt.env.useFSCache,O_=(0,$.getModelFile)(Ht,d_,!0,mn,k_),W_=mn.use_external_data_format??Fo.use_external_data_format;let D_=[];if(W_){let p_;typeof W_=="object"?W_.hasOwnProperty(t_)?p_=W_[t_]:W_.hasOwnProperty(ar)?p_=W_[ar]:p_=!1:p_=W_;const ax=+p_;if(ax>$.MAX_EXTERNAL_DATA_CHUNKS)throw new Error(`The number of external data chunks (${ax}) exceeds the maximum allowed value (${$.MAX_EXTERNAL_DATA_CHUNKS}).`);for(let Ax=0;Ax<ax;++Ax){const Rw=`${t_}_data${Ax===0?"":"_"+Ax}`,Ex=`${mn.subfolder??""}/${Rw}`;D_.push(new Promise(async(Fx,Sv)=>{const Ow=await(0,$.getModelFile)(Ht,Ex,!0,mn,k_);Fx(Ow instanceof Uint8Array?{path:Rw,data:Ow}:Rw)}))}}else Dp.externalData!==void 0&&(D_=Dp.externalData.map(async p_=>{if(typeof p_.data=="string"){const ax=await(0,$.getModelFile)(Ht,p_.data,!0,mn);return{...p_,data:ax}}return p_}));if(D_.length>0){const p_=await Promise.all(D_);dt.apis.IS_NODE_ENV||(Dp.externalData=p_)}if(Ko==="webgpu"){const p_=(0,c.getCacheShapes)(mn.config,{prefix:"present"});if(Object.keys(p_).length>0&&!(0,d.isONNXProxy)()){const ax={};for(const Ax in p_)ax[Ax]="gpu-buffer";Dp.preferredOutputLocation=ax}}return{buffer_or_path:await O_,session_options:Dp,session_config:a_}}async function cr(Ht,ar,mn){return Object.fromEntries(await Promise.all(Object.keys(ar).map(async Fo=>{const{buffer_or_path:Xo,session_options:Ko,session_config:np}=await nr(Ht,ar[Fo],mn),up=await(0,d.createInferenceSession)(Xo,Ko,np);return[Fo,up]})))}async function ur(Ht,ar,mn){return Object.fromEntries(await Promise.all(Object.keys(ar).map(async Fo=>{const Xo=await(0,$.getModelJSON)(Ht,ar[Fo],!1,mn);return[Fo,Xo]})))}function yn(Ht,ar){const mn=Object.create(null),Fo=[];for(const np of Ht.inputNames){const up=ar[np];if(!(up instanceof it.Tensor)){Fo.push(np);continue}mn[np]=(0,d.isONNXProxy)()?up.clone():up}if(Fo.length>0)throw new Error(`An error occurred during model execution: "Missing the following inputs: ${Fo.join(", ")}.`);const Xo=Object.keys(ar).length,Ko=Ht.inputNames.length;if(Xo>Ko){let np=Object.keys(ar).filter(up=>!Ht.inputNames.includes(up));console.warn(`WARNING: Too many inputs were provided (${Xo} > ${Ko}). The following inputs will be ignored: "${np.join(", ")}".`)}return mn}async function hn(Ht,ar){const mn=yn(Ht,ar);try{const Fo=Object.fromEntries(Object.entries(mn).map(([Ko,np])=>[Ko,np.ort_tensor])),Xo=await(0,d.runInferenceSession)(Ht,Fo);return _n(Xo)}catch(Fo){const Xo=Object.fromEntries(Object.entries(mn).map(([Ko,np])=>{const up={type:np.type,dims:np.dims,location:np.location};return up.location!=="gpu-buffer"&&(up.data=np.data),[Ko,up]}));throw console.error(`An error occurred during model execution: "${Fo}".`),console.error("Inputs given to model:",Xo),Fo}}function _n(Ht){for(let ar in Ht)(0,d.isONNXTensor)(Ht[ar])?Ht[ar]=new it.Tensor(Ht[ar]):typeof Ht[ar]=="object"&&_n(Ht[ar]);return Ht}function gn(Ht){if(Ht instanceof it.Tensor)return Ht;if(Ht.length===0)throw Error("items must be non-empty");if(Array.isArray(Ht[0])){if(Ht.some(ar=>ar.length!==Ht[0].length))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=True' and/or 'truncation=True' to have batched tensors with the same length.");return new it.Tensor("int64",BigInt64Array.from(Ht.flat().map(ar=>BigInt(ar))),[Ht.length,Ht[0].length])}else return new it.Tensor("int64",BigInt64Array.from(Ht.map(ar=>BigInt(ar))),[1,Ht.length])}function vn(Ht){return new it.Tensor("bool",[Ht],[1])}async function Tn(Ht,ar){let{encoder_outputs:mn,input_ids:Fo,decoder_input_ids:Xo,...Ko}=ar;if(!mn){const up=(0,g.pick)(ar,Ht.sessions.model.inputNames);mn=(await kn(Ht,up)).last_hidden_state}return Ko.input_ids=Xo,Ko.encoder_hidden_states=mn,Ht.sessions.decoder_model_merged.inputNames.includes("encoder_attention_mask")&&(Ko.encoder_attention_mask=ar.attention_mask),await Sn(Ht,Ko,!0)}async function kn(Ht,ar){const mn=Ht.sessions.model,Fo=(0,g.pick)(ar,mn.inputNames);if(mn.inputNames.includes("inputs_embeds")&&!Fo.inputs_embeds){if(!ar.input_ids)throw new Error("Both `input_ids` and `inputs_embeds` are missing in the model inputs.");Fo.inputs_embeds=await Ht.encode_text({input_ids:ar.input_ids})}if(mn.inputNames.includes("token_type_ids")&&!Fo.token_type_ids){if(!Fo.input_ids)throw new Error("Both `input_ids` and `token_type_ids` are missing in the model inputs.");Fo.token_type_ids=(0,it.zeros_like)(Fo.input_ids)}if(mn.inputNames.includes("pixel_mask")&&!Fo.pixel_mask){if(!Fo.pixel_values)throw new Error("Both `pixel_values` and `pixel_mask` are missing in the model inputs.");const Xo=Fo.pixel_values.dims;Fo.pixel_mask=(0,it.ones)([Xo[0],Xo[2],Xo[3]])}return await hn(mn,Fo)}async function bn(Ht,ar){const mn=await Ht.encode(ar);return await Ht.decode(mn)}async function Sn(Ht,ar,mn=!1){const Fo=Ht.sessions[mn?"decoder_model_merged":"model"],{past_key_values:Xo,...Ko}=ar;if(Fo.inputNames.includes("use_cache_branch")&&(Ko.use_cache_branch=vn(!!Xo)),Fo.inputNames.includes("position_ids")&&Ko.attention_mask&&!Ko.position_ids){const up=["paligemma","gemma3_text","gemma3"].includes(Ht.config.model_type)?1:0;Ko.position_ids=Ro(Ko,Xo,up)}Ht.addPastKeyValues(Ko,Xo);const np=(0,g.pick)(Ko,Fo.inputNames);return await hn(Fo,np)}function fn({modality_token_id:Ht,inputs_embeds:ar,modality_features:mn,input_ids:Fo,attention_mask:Xo}){const Ko=Fo.tolist().map(Ep=>Ep.reduce((Bp,o_,a_)=>(o_==Ht&&Bp.push(a_),Bp),[])),np=Ko.reduce((Ep,Bp)=>Ep+Bp.length,0),up=mn.dims[0];if(np!==up)throw new Error(`Number of tokens and features do not match: tokens: ${np}, features ${up}`);let hp=0;for(let Ep=0;Ep<Ko.length;++Ep){const Bp=Ko[Ep],o_=ar[Ep];for(let a_=0;a_<Bp.length;++a_)o_[Bp[a_]].data.set(mn[hp++].data)}return{inputs_embeds:ar,attention_mask:Xo}}function or({image_token_id:Ht,inputs_embeds:ar,image_features:mn,input_ids:Fo,attention_mask:Xo}){return fn({modality_token_id:Ht,inputs_embeds:ar,modality_features:mn,input_ids:Fo,attention_mask:Xo})}function lr({audio_token_id:Ht,inputs_embeds:ar,audio_features:mn,input_ids:Fo,attention_mask:Xo}){return fn({modality_token_id:Ht,inputs_embeds:ar,modality_features:mn,input_ids:Fo,attention_mask:Xo})}async function pn(Ht,{encode_function:ar,merge_function:mn,modality_input_name:Fo,modality_output_name:Xo,input_ids:Ko=null,attention_mask:np=null,position_ids:up=null,inputs_embeds:hp=null,past_key_values:Ep=null,generation_config:Bp=null,logits_processor:o_=null,...a_}){const x_=a_[Fo];if(!hp){if(hp=await Ht.encode_text({input_ids:Ko,...a_}),x_&&Ko.dims[1]!==1){const d_=await ar({[Fo]:x_,...a_});({inputs_embeds:hp,attention_mask:np}=mn({[Xo]:d_,inputs_embeds:hp,input_ids:Ko,attention_mask:np}))}else if(Ep&&x_&&Ko.dims[1]===1){const d_=Ko.dims[1],Dp=Object.values(Ep)[0].dims.at(-2);np=(0,it.cat)([(0,it.ones)([Ko.dims[0],Dp]),np.slice(null,[np.dims[1]-d_,np.dims[1]])],1)}}if(!up&&Ht.config.model_type==="qwen2_vl"){const{image_grid_thw:d_,video_grid_thw:Dp}=a_;[up]=Ht.get_rope_index(Ko,d_,Dp,np)}return await Sn(Ht,{inputs_embeds:hp,past_key_values:Ep,attention_mask:np,position_ids:up,generation_config:Bp,logits_processor:o_},!0)}async function Cn(Ht,ar){return await pn(Ht,{...ar,modality_input_name:"audio_values",modality_output_name:"audio_features",encode_function:Ht.encode_audio.bind(Ht),merge_function:Ht._merge_input_ids_with_audio_features.bind(Ht)})}async function Lo(Ht,ar){return await pn(Ht,{...ar,modality_input_name:"pixel_values",modality_output_name:"image_features",encode_function:Ht.encode_image.bind(Ht),merge_function:Ht._merge_input_ids_with_image_features.bind(Ht)})}function Mo(Ht,ar=0){const[mn,Fo]=Ht.dims,Xo=Ht.data,Ko=new BigInt64Array(Xo.length);for(let np=0;np<mn;++np){const up=np*Fo;let hp=BigInt(ar);for(let Ep=0;Ep<Fo;++Ep){const Bp=up+Ep;Xo[Bp]===0n?Ko[Bp]=BigInt(1):(Ko[Bp]=hp,hp+=Xo[Bp])}}return{data:Ko,dims:Ht.dims}}function Ro(Ht,ar=null,mn=0){const{input_ids:Fo,inputs_embeds:Xo,attention_mask:Ko}=Ht,{data:np,dims:up}=Mo(Ko,mn);let hp=new it.Tensor("int64",np,up);if(ar){const Ep=-(Fo??Xo).dims.at(1);hp=hp.slice(null,[Ep,null])}return hp}function qo(Ht,ar,mn,Fo){const Xo=mn.past_key_values?Object.values(mn.past_key_values)[0].dims.at(-2):0;if(!mn.attention_mask){let Ko;for(const np of["input_ids","inputs_embeds","position_ids"])if(mn[np]){Ko=mn[np].dims;break}if(!Ko)throw new Error("attention_mask is not provided, and unable to infer its shape from model inputs.");mn.attention_mask=(0,it.ones)([Ko[0],Xo+Ko[1]])}if(mn.past_key_values){const{input_ids:Ko,attention_mask:np}=mn;np&&np.dims[1]>Ko.dims[1]||Xo<Ko.dims[1]&&(mn.input_ids=Ko.slice(null,[Xo,null]))}return mn}function tp(Ht,ar,mn,Fo){return mn.past_key_values&&(ar=ar.map(Xo=>[Xo.at(-1)])),{...mn,decoder_input_ids:gn(ar)}}function Wo(Ht,...ar){return Ht.config.is_encoder_decoder?tp(Ht,...ar):qo(Ht,...ar)}function En(Ht,ar,mn,Fo){const Xo=!!mn.past_key_values;return Fo.guidance_scale!==null&&Fo.guidance_scale>1&&(Xo?mn.input_ids=(0,it.cat)([mn.input_ids,mn.input_ids],0):(mn.input_ids=(0,it.cat)([mn.input_ids,(0,it.full_like)(mn.input_ids,BigInt(Fo.pad_token_id))],0),mn.attention_mask=(0,it.cat)([mn.attention_mask,(0,it.full_like)(mn.attention_mask,0n)],0))),(Xo||!mn.pixel_values)&&(mn.pixel_values=(0,it.full)([0,0,3,384,384],1)),Xo&&(mn.images_seq_mask=new it.Tensor("bool",new Array(1).fill(!0).fill(!1,0,1),[1,1]),mn.images_emb_mask=new it.Tensor("bool",new Array(0).fill(!1),[1,1,0])),mn}class mr extends _.Callable{constructor(mn,Fo,Xo){super();Oo(this,"main_input_name","input_ids");Oo(this,"forward_params",["input_ids","attention_mask"]);this.config=mn,this.sessions=Fo,this.configs=Xo;const Ko=Bt.get(this.constructor),np=Lt.get(Ko);switch(this.can_generate=!1,this._forward=null,this._prepare_inputs_for_generation=null,np){case St.DecoderOnly:this.can_generate=!0,this._forward=Sn,this._prepare_inputs_for_generation=qo;break;case St.Seq2Seq:case St.Vision2Seq:case St.Musicgen:this.can_generate=!0,this._forward=Tn,this._prepare_inputs_for_generation=tp;break;case St.EncoderDecoder:this._forward=Tn;break;case St.ImageTextToText:this.can_generate=!0,this._forward=Lo,this._prepare_inputs_for_generation=Wo;break;case St.AudioTextToText:this.can_generate=!0,this._forward=Cn,this._prepare_inputs_for_generation=Wo;break;case St.Phi3V:case St.ImageAudioTextToText:this.can_generate=!0,this._prepare_inputs_for_generation=Wo;break;case St.MultiModality:this.can_generate=!0,this._prepare_inputs_for_generation=En;break;case St.AutoEncoder:this._forward=bn;break;default:this._forward=kn;break}this.can_generate&&this.forward_params.push("past_key_values"),this.custom_config=this.config["transformers.js_config"]??{}}async dispose(){var Fo;const mn=[];for(const Xo of Object.values(this.sessions))(Fo=Xo==null?void 0:Xo.handler)!=null&&Fo.dispose&&mn.push(Xo.handler.dispose());return await Promise.all(mn)}static async from_pretrained(mn,{progress_callback:Fo=null,config:Xo=null,cache_dir:Ko=null,local_files_only:np=!1,revision:up="main",model_file_name:hp=null,subfolder:Ep="onnx",device:Bp=null,dtype:o_=null,use_external_data_format:a_=null,session_options:x_={}}={}){let t_={progress_callback:Fo,config:Xo,cache_dir:Ko,local_files_only:np,revision:up,model_file_name:hp,subfolder:Ep,device:Bp,dtype:o_,use_external_data_format:a_,session_options:x_};const d_=Bt.get(this),Dp=Lt.get(d_);Xo=t_.config=await c.AutoConfig.from_pretrained(mn,t_);let __;if(Dp===St.DecoderOnly)__=await Promise.all([cr(mn,{model:t_.model_file_name??"model"},t_),ur(mn,{generation_config:"generation_config.json"},t_)]);else if(Dp===St.Seq2Seq||Dp===St.Vision2Seq)__=await Promise.all([cr(mn,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},t_),ur(mn,{generation_config:"generation_config.json"},t_)]);else if(Dp===St.MaskGeneration)__=await Promise.all([cr(mn,{model:"vision_encoder",prompt_encoder_mask_decoder:"prompt_encoder_mask_decoder"},t_)]);else if(Dp===St.EncoderDecoder)__=await Promise.all([cr(mn,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},t_)]);else if(Dp===St.ImageTextToText){const k_={embed_tokens:"embed_tokens",vision_encoder:"vision_encoder",decoder_model_merged:"decoder_model_merged"};Xo.is_encoder_decoder&&(k_.model="encoder_model"),__=await Promise.all([cr(mn,k_,t_),ur(mn,{generation_config:"generation_config.json"},t_)])}else if(Dp===St.AudioTextToText){const k_={embed_tokens:"embed_tokens",audio_encoder:"audio_encoder",decoder_model_merged:"decoder_model_merged"};__=await Promise.all([cr(mn,k_,t_),ur(mn,{generation_config:"generation_config.json"},t_)])}else if(Dp===St.ImageAudioTextToText){const k_={embed_tokens:"embed_tokens",audio_encoder:"audio_encoder",vision_encoder:"vision_encoder",decoder_model_merged:"decoder_model_merged"};__=await Promise.all([cr(mn,k_,t_),ur(mn,{generation_config:"generation_config.json"},t_)])}else if(Dp===St.Musicgen)__=await Promise.all([cr(mn,{model:"text_encoder",decoder_model_merged:"decoder_model_merged",encodec_decode:"encodec_decode"},t_),ur(mn,{generation_config:"generation_config.json"},t_)]);else if(Dp===St.MultiModality)__=await Promise.all([cr(mn,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"language_model",lm_head:"lm_head",gen_head:"gen_head",gen_img_embeds:"gen_img_embeds",image_decode:"image_decode"},t_),ur(mn,{generation_config:"generation_config.json"},t_)]);else if(Dp===St.Phi3V)__=await Promise.all([cr(mn,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"model",vision_encoder:"vision_encoder"},t_),ur(mn,{generation_config:"generation_config.json"},t_)]);else if(Dp===St.AutoEncoder)__=await Promise.all([cr(mn,{encoder_model:"encoder_model",decoder_model:"decoder_model"},t_)]);else{if(Dp!==St.EncoderOnly){const k_=d_??(Xo==null?void 0:Xo.model_type);k_!=="custom"&&console.warn(`Model type for '${k_}' not found, assuming encoder-only architecture. Please report this at ${_e.GITHUB_ISSUE_URL}.`)}__=await Promise.all([cr(mn,{model:t_.model_file_name??"model"},t_)])}return new this(Xo,...__)}async _call(mn){return await this.forward(mn)}async forward(mn){return await this._forward(this,mn)}get generation_config(){var mn;return((mn=this.configs)==null?void 0:mn.generation_config)??null}_get_logits_processor(mn,Fo,Xo=null){const Ko=new lt.LogitsProcessorList;if(mn.repetition_penalty!==null&&mn.repetition_penalty!==1&&Ko.push(new lt.RepetitionPenaltyLogitsProcessor(mn.repetition_penalty)),mn.no_repeat_ngram_size!==null&&mn.no_repeat_ngram_size>0&&Ko.push(new lt.NoRepeatNGramLogitsProcessor(mn.no_repeat_ngram_size)),mn.bad_words_ids!==null&&Ko.push(new lt.NoBadWordsLogitsProcessor(mn.bad_words_ids,mn.eos_token_id)),mn.min_length!==null&&mn.eos_token_id!==null&&mn.min_length>0&&Ko.push(new lt.MinLengthLogitsProcessor(mn.min_length,mn.eos_token_id)),mn.min_new_tokens!==null&&mn.eos_token_id!==null&&mn.min_new_tokens>0&&Ko.push(new lt.MinNewTokensLengthLogitsProcessor(Fo,mn.min_new_tokens,mn.eos_token_id)),mn.forced_bos_token_id!==null&&Ko.push(new lt.ForcedBOSTokenLogitsProcessor(mn.forced_bos_token_id)),mn.forced_eos_token_id!==null&&Ko.push(new lt.ForcedEOSTokenLogitsProcessor(mn.max_length,mn.forced_eos_token_id)),mn.begin_suppress_tokens!==null){const np=Fo>1||mn.forced_bos_token_id===null?Fo:Fo+1;Ko.push(new lt.SuppressTokensAtBeginLogitsProcessor(mn.begin_suppress_tokens,np))}return mn.guidance_scale!==null&&mn.guidance_scale>1&&Ko.push(new lt.ClassifierFreeGuidanceLogitsProcessor(mn.guidance_scale)),mn.temperature===0&&mn.do_sample&&(console.warn("`do_sample` changed to false because `temperature: 0` implies greedy sampling (always selecting the most likely token), which is incompatible with `do_sample: true`."),mn.do_sample=!1),mn.do_sample&&mn.temperature!==null&&mn.temperature!==1&&Ko.push(new lt.TemperatureLogitsWarper(mn.temperature)),Xo!==null&&Ko.extend(Xo),Ko}_prepare_generation_config(mn,Fo,Xo=at.GenerationConfig){const Ko={...this.config};for(const up of["decoder","generator","text_config"])up in Ko&&Object.assign(Ko,Ko[up]);const np=new Xo(Ko);return Object.assign(np,this.generation_config??{}),mn&&Object.assign(np,mn),Fo&&Object.assign(np,(0,g.pick)(Fo,Object.getOwnPropertyNames(np))),np}_get_stopping_criteria(mn,Fo=null){const Xo=new pt.StoppingCriteriaList;return mn.max_length!==null&&Xo.push(new pt.MaxLengthCriteria(mn.max_length,this.config.max_position_embeddings??null)),mn.eos_token_id!==null&&Xo.push(new pt.EosTokenCriteria(mn.eos_token_id)),Fo&&Xo.extend(Fo),Xo}_validate_model_class(){if(!this.can_generate){const mn=[J1,Z1,Y1,X1],Fo=Bt.get(this.constructor),Xo=new Set,Ko=this.config.model_type;for(const up of mn){const hp=up.get(Ko);hp&&Xo.add(hp[0])}let np=`The current model class (${Fo}) is not compatible with \`.generate()\`, as it doesn't have a language model head.`;throw Xo.size>0&&(np+=` Please use the following class instead: ${[...Xo].join(", ")}`),Error(np)}}prepare_inputs_for_generation(...mn){return this._prepare_inputs_for_generation(this,...mn)}_update_model_kwargs_for_generation({generated_input_ids:mn,outputs:Fo,model_inputs:Xo,is_encoder_decoder:Ko}){return Xo.past_key_values=this.getPastKeyValues(Fo,Xo.past_key_values),Xo.input_ids=new it.Tensor("int64",mn.flat(),[mn.length,1]),Ko||(Xo.attention_mask=(0,it.cat)([Xo.attention_mask,(0,it.ones)([Xo.attention_mask.dims[0],1])],1)),Xo.position_ids=null,Xo}_prepare_model_inputs({inputs:mn,bos_token_id:Fo,model_kwargs:Xo}){const Ko=(0,g.pick)(Xo,this.forward_params),np=this.main_input_name;if(np in Ko){if(mn)throw new Error("`inputs`: {inputs}` were passed alongside {input_name} which is not allowed. Make sure to either pass {inputs} or {input_name}=...")}else Ko[np]=mn;return{inputs_tensor:Ko[np],model_inputs:Ko,model_input_name:np}}async _prepare_encoder_decoder_kwargs_for_generation({inputs_tensor:mn,model_inputs:Fo,model_input_name:Xo,generation_config:Ko}){if(this.sessions.model.inputNames.includes("inputs_embeds")&&!Fo.inputs_embeds&&"_prepare_inputs_embeds"in this){const{input_ids:up,pixel_values:hp,attention_mask:Ep,...Bp}=Fo,o_=await this._prepare_inputs_embeds(Fo);Fo={...Bp,...(0,g.pick)(o_,["inputs_embeds","attention_mask"])}}let{last_hidden_state:np}=await kn(this,Fo);if(Ko.guidance_scale!==null&&Ko.guidance_scale>1)np=(0,it.cat)([np,(0,it.full_like)(np,0)],0),"attention_mask"in Fo&&(Fo.attention_mask=(0,it.cat)([Fo.attention_mask,(0,it.zeros_like)(Fo.attention_mask)],0));else if(Fo.decoder_input_ids){const up=gn(Fo.decoder_input_ids).dims[0];if(up!==np.dims[0]){if(np.dims[0]!==1)throw new Error(`The encoder outputs have a different batch size (${np.dims[0]}) than the decoder inputs (${up}).`);np=(0,it.cat)(Array.from({length:up},()=>np),0)}}return Fo.encoder_outputs=np,Fo}_prepare_decoder_input_ids_for_generation({batch_size:mn,model_input_name:Fo,model_kwargs:Xo,decoder_start_token_id:Ko,bos_token_id:np,generation_config:up}){let{decoder_input_ids:hp,...Ep}=Xo;if(!(hp instanceof it.Tensor)){if(hp)Array.isArray(hp[0])||(hp=Array.from({length:mn},()=>hp));else if(Ko??(Ko=np),this.config.model_type==="musicgen")hp=Array.from({length:mn*this.config.decoder.num_codebooks},()=>[Ko]);else if(Array.isArray(Ko)){if(Ko.length!==mn)throw new Error(`\`decoder_start_token_id\` expcted to have length ${mn} but got ${Ko.length}`);hp=Ko}else hp=Array.from({length:mn},()=>[Ko]);hp=gn(hp)}return Xo.decoder_attention_mask=(0,it.ones_like)(hp),{input_ids:hp,model_inputs:Ep}}async generate({inputs:mn=null,generation_config:Fo=null,logits_processor:Xo=null,stopping_criteria:Ko=null,streamer:np=null,...up}){this._validate_model_class(),Fo=this._prepare_generation_config(Fo,up);let{inputs_tensor:hp,model_inputs:Ep,model_input_name:Bp}=this._prepare_model_inputs({inputs:mn,model_kwargs:up});const o_=this.config.is_encoder_decoder;o_&&("encoder_outputs"in Ep||(Ep=await this._prepare_encoder_decoder_kwargs_for_generation({inputs_tensor:hp,model_inputs:Ep,model_input_name:Bp,generation_config:Fo})));let a_;o_?{input_ids:a_,model_inputs:Ep}=this._prepare_decoder_input_ids_for_generation({batch_size:Ep[Bp].dims.at(0),model_input_name:Bp,model_kwargs:Ep,decoder_start_token_id:Fo.decoder_start_token_id,bos_token_id:Fo.bos_token_id,generation_config:Fo}):a_=Ep[Bp];let x_=a_.dims.at(-1);Fo.max_new_tokens!==null&&(Fo.max_length=x_+Fo.max_new_tokens);const t_=this._get_logits_processor(Fo,x_,Xo),d_=this._get_stopping_criteria(Fo,Ko),Dp=Ep[Bp].dims.at(0),__=zt.LogitsSampler.getSampler(Fo),k_=new Array(Dp).fill(0),O_=a_.tolist();np&&np.put(O_);let W_,D_={};for(;;){if(Ep=this.prepare_inputs_for_generation(O_,Ep,Fo),W_=await this.forward(Ep),Fo.output_attentions&&Fo.return_dict_in_generate){const Ex=this.getAttentions(W_);for(const Fx in Ex)Fx in D_||(D_[Fx]=[]),D_[Fx].push(Ex[Fx])}const p_=W_.logits.slice(null,-1,null),ax=t_(O_,p_),Ax=[];for(let Ex=0;Ex<ax.dims.at(0);++Ex){const Fx=ax[Ex],Sv=await __(Fx);for(const[Ow,Av]of Sv){const Iv=BigInt(Ow);k_[Ex]+=Av,O_[Ex].push(Iv),Ax.push([Iv]);break}}if(np&&np.put(Ax),d_(O_).every(Ex=>Ex))break;Ep=this._update_model_kwargs_for_generation({generated_input_ids:Ax,outputs:W_,model_inputs:Ep,is_encoder_decoder:o_})}np&&np.end();const tx=this.getPastKeyValues(W_,Ep.past_key_values,!0),mx=new it.Tensor("int64",O_.flat(),[O_.length,O_[0].length]);if(Fo.return_dict_in_generate)return{sequences:mx,past_key_values:tx,...D_};for(const p_ of Object.values(W_))p_.location==="gpu-buffer"&&p_.dispose();return mx}getPastKeyValues(mn,Fo,Xo=!1){const Ko=Object.create(null);for(const np in mn)if(np.startsWith("present")){const up=np.replace("present_conv","past_conv").replace("present","past_key_values"),hp=np.includes("encoder");if(hp&&Fo?Ko[up]=Fo[up]:Ko[up]=mn[np],Fo&&(!hp||Xo)){const Ep=Fo[up];Ep.location==="gpu-buffer"&&Ep.dispose()}}return Ko}getAttentions(mn){const Fo={};for(const Xo of["cross_attentions","encoder_attentions","decoder_attentions"])for(const Ko in mn)Ko.startsWith(Xo)&&(Xo in Fo||(Fo[Xo]=[]),Fo[Xo].push(mn[Ko]));return Fo}addPastKeyValues(mn,Fo){var Xo,Ko,np;if(Fo)Object.assign(mn,Fo);else{const up=this.sessions.decoder_model_merged??this.sessions.model,hp=((Ko=(Xo=mn[this.main_input_name]??mn.attention_mask)==null?void 0:Xo.dims)==null?void 0:Ko[0])??1,Ep=((np=up==null?void 0:up.config)==null?void 0:np.kv_cache_dtype)??"float32",Bp=Ep==="float16"?it.DataTypeMap.float16:it.DataTypeMap.float32,o_=(0,c.getCacheShapes)(this.config,{batch_size:hp});for(const a_ in o_){const x_=o_[a_].reduce((t_,d_)=>t_*d_,1);mn[a_]=new it.Tensor(Ep,new Bp(x_),o_[a_])}}}async encode_image({pixel_values:mn}){return(await hn(this.sessions.vision_encoder,{pixel_values:mn})).image_features}async encode_text({input_ids:mn}){return(await hn(this.sessions.embed_tokens,{input_ids:mn})).inputs_embeds}async encode_audio({audio_values:mn}){return(await hn(this.sessions.audio_encoder,{audio_values:mn})).audio_features}}class Do{}class Go extends Do{constructor({last_hidden_state:ar,hidden_states:mn=null,attentions:Fo=null}){super(),this.last_hidden_state=ar,this.hidden_states=mn,this.attentions=Fo}}class Jo extends mr{}class _i extends Jo{}class Ho extends Jo{async _call(ar){return new fx(await super._call(ar))}}class _c extends Jo{async _call(ar){return new c_(await super._call(ar))}}class Qo extends Jo{async _call(ar){return new ox(await super._call(ar))}}class ep extends Jo{async _call(ar){return new gx(await super._call(ar))}}class lp extends mr{}class _p extends lp{}class Zo extends lp{async _call(ar){return new fx(await super._call(ar))}}class bp extends lp{async _call(ar){return new c_(await super._call(ar))}}class gp extends lp{async _call(ar){return new ox(await super._call(ar))}}class Mp extends lp{async _call(ar){return new gx(await super._call(ar))}}class wp extends mr{}class ip extends wp{}class fp extends wp{async _call(ar){return new fx(await super._call(ar))}}class Rp extends wp{async _call(ar){return new c_(await super._call(ar))}}class Ap extends wp{async _call(ar){return new ox(await super._call(ar))}}class u_ extends mr{}class Ip extends u_{}class C_ extends u_{}class G_ extends mr{}class z_ extends G_{}class hx extends mr{}class S_ extends hx{}class H_ extends hx{async _call(ar){return new fx(await super._call(ar))}}class zx extends hx{async _call(ar){return new c_(await super._call(ar))}}class qx extends hx{async _call(ar){return new ox(await super._call(ar))}}class Ix extends hx{async _call(ar){return new gx(await super._call(ar))}}class X_ extends mr{}class e_ extends X_{}class r_ extends X_{async _call(ar){return new fx(await super._call(ar))}}class g_ extends X_{async _call(ar){return new c_(await super._call(ar))}}class Pp extends X_{async _call(ar){return new ox(await super._call(ar))}}class m_ extends X_{async _call(ar){return new gx(await super._call(ar))}}class ir extends mr{}class In extends ir{}class wn extends ir{async _call(ar){return new fx(await super._call(ar))}}class An extends ir{async _call(ar){return new c_(await super._call(ar))}}class No extends ir{async _call(ar){return new ox(await super._call(ar))}}class Yo extends ir{async _call(ar){return new gx(await super._call(ar))}}class sp extends mr{}class Cp extends sp{}class n_ extends sp{async _call(ar){return new fx(await super._call(ar))}}class zp extends sp{async _call(ar){return new c_(await super._call(ar))}}class i_ extends sp{async _call(ar){return new ox(await super._call(ar))}}class kp extends sp{async _call(ar){return new gx(await super._call(ar))}}class h_ extends mr{}class $_ extends h_{}class xx extends h_{async _call(ar){return new fx(await super._call(ar))}}class bx extends h_{async _call(ar){return new c_(await super._call(ar))}}class N_ extends h_{async _call(ar){return new ox(await super._call(ar))}}class lx extends h_{async _call(ar){return new gx(await super._call(ar))}}class B_ extends mr{}class Rx extends B_{}class Ox extends B_{async _call(ar){return new fx(await super._call(ar))}}class ux extends B_{async _call(ar){return new c_(await super._call(ar))}}class Qx extends B_{async _call(ar){return new ox(await super._call(ar))}}class Xx extends B_{async _call(ar){return new gx(await super._call(ar))}}class rx extends mr{}class jx extends rx{}class kx extends rx{async _call(ar){return new c_(await super._call(ar))}}class _x extends rx{async _call(ar){return new ox(await super._call(ar))}}class Bx extends rx{async _call(ar){return new gx(await super._call(ar))}}class K_ extends rx{async _call(ar){return new fx(await super._call(ar))}}class L_ extends mr{}class Nx extends L_{}class rw extends L_{async _call(ar){return new fx(await super._call(ar))}}class wx extends L_{async _call(ar){return new c_(await super._call(ar))}}class dp extends L_{async _call(ar){return new ox(await super._call(ar))}}class pp extends mr{}class $p extends pp{}class P_ extends pp{async _call(ar){return new fx(await super._call(ar))}}class nw extends pp{async _call(ar){return new c_(await super._call(ar))}}class Ux extends pp{async _call(ar){return new gx(await super._call(ar))}}class Px extends mr{}class vw extends Px{}class bw extends Px{async _call(ar){return new fx(await super._call(ar))}}class Mw extends Px{async _call(ar){return new c_(await super._call(ar))}}class Ew extends Px{async _call(ar){return new ox(await super._call(ar))}}class Vo extends Px{async _call(ar){return new gx(await super._call(ar))}}class dr extends mr{}class $n extends dr{}class jo extends dr{async _call(ar){return new fx(await super._call(ar))}}class zo extends dr{async _call(ar){return new c_(await super._call(ar))}}class Uo extends dr{async _call(ar){return new gx(await super._call(ar))}}class bu extends mr{}class mp extends bu{}class yp extends bu{async _call(ar){return new c_(await super._call(ar))}}class xp extends bu{async _call(ar){return new gx(await super._call(ar))}}class Tp extends bu{async _call(ar){return new fx(await super._call(ar))}}class s_ extends mr{constructor(){super(...arguments);Oo(this,"forward_params",["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"])}}class v_ extends s_{}class w_ extends s_{}class I_ extends mr{}class T_ extends I_{}class Y_ extends I_{}class J_ extends mr{}class U_ extends J_{}class Z_ extends J_{}class nx extends mr{}class Cx extends nx{}class A_ extends nx{}class ex extends nx{async _call(ar){return new c_(await super._call(ar))}}class dx extends mr{}class $x extends dx{}class Vx extends dx{}class px extends dx{async _call(ar){return new c_(await super._call(ar))}}class Lx extends dx{}class F_ extends mr{}class V_ extends F_{}class q_ extends F_{}class R_ extends mr{}class Mx extends R_{}class sw extends R_{}class Yx extends mr{}class zy extends Yx{}class By extends Yx{async _call(ar){return new fx(await super._call(ar))}}class py extends Yx{async _call(ar){return new c_(await super._call(ar))}}class Uy extends Yx{async _call(ar){return new ox(await super._call(ar))}}class Vy extends Yx{async _call(ar){return new gx(await super._call(ar))}}class cw extends mr{}class Wy extends cw{}class Gy extends cw{async _call(ar){return new fx(await super._call(ar))}}class Hy extends cw{async _call(ar){return new c_(await super._call(ar))}}class Ky extends cw{async _call(ar){return new ox(await super._call(ar))}}class qy extends cw{async _call(ar){return new gx(await super._call(ar))}}class uw extends mr{}class Qy extends uw{}class Xy extends uw{async _call(ar){return new fx(await super._call(ar))}}class Yy extends uw{async _call(ar){return new c_(await super._call(ar))}}class fy extends uw{async _call(ar){return new ox(await super._call(ar))}}class my extends uw{async _call(ar){return new gx(await super._call(ar))}}class Vw extends mr{}class Jy extends Vw{}class Zy extends Vw{}class Ww extends mr{constructor(){super(...arguments);Oo(this,"requires_attention_mask",!1);Oo(this,"main_input_name","input_features");Oo(this,"forward_params",["input_features","attention_mask","decoder_input_ids","decoder_attention_mask","past_key_values"])}}class hy extends Ww{}class ow extends Ww{_prepare_generation_config(ar,mn){return super._prepare_generation_config(ar,mn,ft.WhisperGenerationConfig)}_retrieve_init_tokens(ar){const mn=[ar.decoder_start_token_id];let Fo=ar.language;const Xo=ar.task;if(ar.is_multilingual){Fo||(console.warn("No language specified - defaulting to English (en)."),Fo="en");const np=`<|${(0,kt.whisper_language_to_code)(Fo)}|>`;mn.push(ar.lang_to_id[np]),mn.push(ar.task_to_id[Xo??"transcribe"])}else if(Fo||Xo)throw new Error("Cannot specify `task` or `language` for an English-only model. If the model is intended to be multilingual, pass `is_multilingual=true` to generate, or update the generation config.");return!ar.return_timestamps&&ar.no_timestamps_token_id&&mn.at(-1)!==ar.no_timestamps_token_id?mn.push(ar.no_timestamps_token_id):ar.return_timestamps&&mn.at(-1)===ar.no_timestamps_token_id&&(console.warn("<|notimestamps|> prompt token is removed from generation_config since `return_timestamps` is set to `true`."),mn.pop()),mn.filter(Ko=>Ko!=null)}async generate({inputs:ar=null,generation_config:mn=null,logits_processor:Fo=null,stopping_criteria:Xo=null,...Ko}){mn=this._prepare_generation_config(mn,Ko);const np=Ko.decoder_input_ids??this._retrieve_init_tokens(mn);if(mn.return_timestamps&&(Fo??(Fo=new lt.LogitsProcessorList),Fo.push(new lt.WhisperTimeStampLogitsProcessor(mn,np))),mn.begin_suppress_tokens&&(Fo??(Fo=new lt.LogitsProcessorList),Fo.push(new lt.SuppressTokensAtBeginLogitsProcessor(mn.begin_suppress_tokens,np.length))),mn.return_token_timestamps){if(!mn.alignment_heads)throw new Error("Model generation config has no `alignment_heads`, token-level timestamps not available. See https://gist.github.com/hollance/42e32852f24243b748ae6bc1f985b13a on how to add this property to the generation config.");mn.task==="translate"&&console.warn("Token-level timestamps may not be reliable for task 'translate'."),mn.output_attentions=!0,mn.return_dict_in_generate=!0}const up=await super.generate({inputs:ar,generation_config:mn,logits_processor:Fo,decoder_input_ids:np,...Ko});return mn.return_token_timestamps&&(up.token_timestamps=this._extract_token_timestamps(up,mn.alignment_heads,mn.num_frames)),up}_extract_token_timestamps(ar,mn,Fo=null,Xo=.02){if(!ar.cross_attentions)throw new Error("Model outputs must contain cross attentions to extract timestamps. This is most likely because the model was not exported with `output_attentions=True`.");Fo==null&&console.warn("`num_frames` has not been set, meaning the entire audio will be analyzed. This may lead to inaccurate token-level timestamps for short audios (< 30 seconds).");let Ko=this.config.median_filter_width;Ko===void 0&&(console.warn("Model config has no `median_filter_width`, using default value of 7."),Ko=7);const np=ar.cross_attentions,up=Array.from({length:this.config.decoder_layers},(d_,Dp)=>(0,it.cat)(np.map(__=>__[Dp]),2)),hp=(0,it.stack)(mn.map(([d_,Dp])=>{if(d_>=up.length)throw new Error(`Layer index ${d_} is out of bounds for cross attentions (length ${up.length}).`);return Fo?up[d_].slice(null,Dp,null,[0,Fo]):up[d_].slice(null,Dp)})).transpose(1,0,2,3),[Ep,Bp]=(0,it.std_mean)(hp,-2,0,!0),o_=hp.clone();for(let d_=0;d_<o_.dims[0];++d_){const Dp=o_[d_];for(let __=0;__<Dp.dims[0];++__){const k_=Dp[__],O_=Ep[d_][__][0].data,W_=Bp[d_][__][0].data;for(let D_=0;D_<k_.dims[0];++D_){let tx=k_[D_].data;for(let mx=0;mx<tx.length;++mx)tx[mx]=(tx[mx]-W_[mx])/O_[mx];tx.set((0,mt.medianFilter)(tx,Ko))}}}const a_=[(0,it.mean)(o_,1)],x_=ar.sequences.dims,t_=new it.Tensor("float32",new Float32Array(x_[0]*x_[1]),x_);for(let d_=0;d_<x_[0];++d_){const Dp=a_[d_].neg().squeeze_(0),[__,k_]=(0,mt.dynamic_time_warping)(Dp.tolist()),O_=Array.from({length:__.length-1},(tx,mx)=>__[mx+1]-__[mx]),W_=(0,g.mergeArrays)([1],O_).map(tx=>!!tx),D_=[];for(let tx=0;tx<W_.length;++tx)W_[tx]&&D_.push(k_[tx]*Xo);t_[d_].data.set(D_,1)}return t_}}class ev extends ow{}class Gw extends mr{constructor(){super(...arguments);Oo(this,"requires_attention_mask",!1);Oo(this,"main_input_name","input_values");Oo(this,"forward_params",["input_values","decoder_input_ids","past_key_values"])}}class Fv extends Gw{}class tv extends Gw{}class _y extends mr{constructor(){super(...arguments);Oo(this,"main_input_name","pixel_values");Oo(this,"forward_params",["pixel_values","decoder_input_ids","encoder_hidden_states","past_key_values"])}}class Tw extends mr{constructor(){super(...arguments);Oo(this,"forward_params",["input_ids","attention_mask","pixel_values","position_ids","past_key_values"])}}class kw extends Tw{_merge_input_ids_with_image_features(ar){const mn=ar.image_features.dims.at(-1),Fo=ar.image_features.view(-1,mn);return or({image_token_id:this.config.image_token_index,...ar,image_features:Fo})}}class rv extends kw{}class nv extends kw{}class sv extends mr{constructor(){super(...arguments);Oo(this,"forward_params",["input_ids","inputs_embeds","attention_mask","pixel_values","encoder_outputs","decoder_input_ids","decoder_inputs_embeds","decoder_attention_mask","past_key_values"]);Oo(this,"main_input_name","inputs_embeds")}}class ov extends sv{_merge_input_ids_with_image_features({inputs_embeds:ar,image_features:mn,input_ids:Fo,attention_mask:Xo}){return{inputs_embeds:(0,it.cat)([mn,ar],1),attention_mask:(0,it.cat)([(0,it.ones)(mn.dims.slice(0,2)),Xo],1)}}async _prepare_inputs_embeds({input_ids:ar,pixel_values:mn,inputs_embeds:Fo,attention_mask:Xo}){if(!ar&&!mn)throw new Error("Either `input_ids` or `pixel_values` should be provided.");let Ko,np;return ar&&(Ko=await this.encode_text({input_ids:ar})),mn&&(np=await this.encode_image({pixel_values:mn})),Ko&&np?{inputs_embeds:Fo,attention_mask:Xo}=this._merge_input_ids_with_image_features({inputs_embeds:Ko,image_features:np,input_ids:ar,attention_mask:Xo}):Fo=Ko||np,{inputs_embeds:Fo,attention_mask:Xo}}async forward({input_ids:ar,pixel_values:mn,attention_mask:Fo,decoder_input_ids:Xo,decoder_attention_mask:Ko,encoder_outputs:np,past_key_values:up,inputs_embeds:hp,decoder_inputs_embeds:Ep}){if(hp||({inputs_embeds:hp,attention_mask:Fo}=await this._prepare_inputs_embeds({input_ids:ar,pixel_values:mn,inputs_embeds:hp,attention_mask:Fo})),!np){let{last_hidden_state:a_}=await kn(this,{inputs_embeds:hp,attention_mask:Fo});np=a_}if(!Ep){if(!Xo)throw new Error("Either `decoder_input_ids` or `decoder_inputs_embeds` should be provided.");Ep=await this.encode_text({input_ids:Xo})}return await Sn(this,{inputs_embeds:Ep,attention_mask:Ko,encoder_attention_mask:Fo,encoder_hidden_states:np,past_key_values:up},!0)}}class av extends mr{constructor(){super(...arguments);Oo(this,"forward_params",["input_ids","attention_mask","pixel_values","position_ids","past_key_values"])}}class iv extends av{_merge_input_ids_with_image_features(ar){const mn=ar.image_features.dims.at(-1),Fo=ar.image_features.view(-1,mn);return or({image_token_id:this.config.image_token_index,...ar,image_features:Fo})}}class lv extends Tw{_merge_input_ids_with_image_features(ar){const mn=ar.image_features.dims.at(-1),Fo=ar.image_features.view(-1,mn);return or({image_token_id:this.config.image_token_index,...ar,image_features:Fo})}}class cv extends mr{constructor(){super(...arguments);Oo(this,"forward_params",["input_ids","attention_mask","inputs_embeds","per_layer_inputs","position_ids","pixel_values","input_features","input_features_mask","past_key_values"])}}class gy extends cv{async forward({input_ids:ar=null,attention_mask:mn=null,pixel_values:Fo=null,input_features:Xo=null,input_features_mask:Ko=null,position_ids:np=null,inputs_embeds:up=null,per_layer_inputs:hp=null,past_key_values:Ep=null,generation_config:Bp=null,logits_processor:o_=null,...a_}){if((!up||!hp)&&({inputs_embeds:up,per_layer_inputs:hp}=await hn(this.sessions.embed_tokens,{input_ids:ar}),ar.dims[1]!==1)){if(Fo){const{image_features:t_}=await hn(this.sessions.vision_encoder,{pixel_values:Fo});({inputs_embeds:up,attention_mask:mn}=this._merge_input_ids_with_image_features({image_features:t_,inputs_embeds:up,input_ids:ar,attention_mask:mn}))}if(Xo){const{audio_features:t_}=await hn(this.sessions.audio_encoder,{input_features:Xo,input_features_mask:Ko});({inputs_embeds:up,attention_mask:mn}=this._merge_input_ids_with_audio_features({audio_features:t_,inputs_embeds:up,input_ids:ar,attention_mask:mn}))}}return await Sn(this,{inputs_embeds:up,per_layer_inputs:hp,past_key_values:Ep,attention_mask:mn,position_ids:np,generation_config:Bp,logits_processor:o_},!0)}_merge_input_ids_with_image_features(ar){const mn=ar.image_features.dims.at(-1),Fo=ar.image_features.view(-1,mn);return or({image_token_id:this.config.image_token_id,...ar,image_features:Fo})}_merge_input_ids_with_audio_features(ar){const mn=ar.audio_features.dims.at(-1),Fo=ar.audio_features.view(-1,mn);return lr({audio_token_id:this.config.audio_token_id,...ar,audio_features:Fo})}}class $w extends mr{constructor(){super(...arguments);Oo(this,"forward_params",["input_ids","attention_mask","pixel_values","pixel_attention_mask","position_ids","past_key_values"])}}class Jx extends $w{async encode_image({pixel_values:ar,pixel_attention_mask:mn}){return(await hn(this.sessions.vision_encoder,{pixel_values:ar,pixel_attention_mask:mn})).image_features}_merge_input_ids_with_image_features(ar){const mn=ar.image_features.dims.at(-1),Fo=ar.image_features.view(-1,mn);return or({image_token_id:this.config.image_token_id,...ar,image_features:Fo})}}class Hw extends Jx{}class uv extends mr{constructor(){super(...arguments);Oo(this,"forward_params",["input_ids","inputs_embeds","attention_mask","position_ids","pixel_values","image_sizes","past_key_values"])}}class xy extends uv{async forward({input_ids:ar=null,attention_mask:mn=null,pixel_values:Fo=null,image_sizes:Xo=null,position_ids:Ko=null,inputs_embeds:np=null,past_key_values:up=null,generation_config:hp=null,logits_processor:Ep=null,...Bp}){if(!np){let a_;if(Fo&&ar.dims[1]!==1){if(!Xo)throw new Error("`image_sizes` must be provided when `pixel_values` is provided.");({image_features:a_}=await hn(this.sessions.vision_encoder,{pixel_values:Fo,image_sizes:Xo}))}else{const x_=this.config.normalized_config.hidden_size;a_=new it.Tensor("float32",[],[0,x_])}({inputs_embeds:np}=await hn(this.sessions.prepare_inputs_embeds,{input_ids:ar,image_features:a_}))}return await Sn(this,{inputs_embeds:np,past_key_values:up,attention_mask:mn,position_ids:Ko,generation_config:hp,logits_processor:Ep},!1)}}class Wx extends mr{}class Kw extends Wx{}class dv extends Wx{static async from_pretrained(ar,mn={}){return super.from_pretrained(ar,{...mn,model_file_name:mn.model_file_name??"text_model"})}}class wy extends Wx{static async from_pretrained(ar,mn={}){return super.from_pretrained(ar,{...mn,model_file_name:mn.model_file_name??"text_model"})}}class pv extends Wx{static async from_pretrained(ar,mn={}){return super.from_pretrained(ar,{...mn,model_file_name:mn.model_file_name??"vision_model"})}}class yy extends Wx{static async from_pretrained(ar,mn={}){return super.from_pretrained(ar,{...mn,model_file_name:mn.model_file_name??"vision_model"})}}class qw extends mr{}class vy extends qw{}class fv extends qw{static async from_pretrained(ar,mn={}){return super.from_pretrained(ar,{...mn,model_file_name:mn.model_file_name??"text_model"})}}class by extends Wx{static async from_pretrained(ar,mn={}){return super.from_pretrained(ar,{...mn,model_file_name:mn.model_file_name??"vision_model"})}}class My extends mr{}class Pw extends My{}class Op extends mr{}class mv extends Op{async forward(ar){const mn=!ar.input_ids,Fo=!ar.pixel_values;if(mn&&Fo)throw new Error("Either `input_ids` or `pixel_values` should be provided.");if(mn&&(ar.input_ids=(0,it.ones)([ar.pixel_values.dims[0],1])),Fo){const{image_size:Ep}=this.config.vision_config;ar.pixel_values=(0,it.full)([0,3,Ep,Ep],0)}const{text_embeddings:Xo,image_embeddings:Ko,l2norm_text_embeddings:np,l2norm_image_embeddings:up}=await super.forward(ar),hp={};return mn||(hp.text_embeddings=Xo,hp.l2norm_text_embeddings=np),Fo||(hp.image_embeddings=Ko,hp.l2norm_image_embeddings=up),hp}}class Ey extends Op{static async from_pretrained(ar,mn={}){return super.from_pretrained(ar,{...mn,model_file_name:mn.model_file_name??"text_model"})}}class Ty extends Op{static async from_pretrained(ar,mn={}){return super.from_pretrained(ar,{...mn,model_file_name:mn.model_file_name??"vision_model"})}}class dw extends mr{}class Sx extends dw{}class Cw extends dw{}class Sw extends mr{}class ky extends Sw{}class $y extends Sw{}class Qw extends mr{}class Xw extends Qw{}class Py extends Qw{}class Yw extends mr{}class Cy extends Yw{}class Aw extends Yw{}class Iw extends mr{}class Jw extends Iw{}class Sy extends Iw{}class Zw extends mr{}class Ay extends Zw{}class Iy extends Zw{}class ey extends mr{}class Ry extends ey{}class Pt extends ey{}class sr extends mr{}class pr extends sr{}class xn extends sr{}class Pn extends mr{}class Bo extends Pn{}class rp extends Pn{}class cp extends mr{}class vp extends cp{}class Sp extends mr{}class l_ extends Sp{}class y_ extends Sp{}class M_ extends mr{}class sx extends M_{}class aw extends M_{}class Oy extends mr{}class l0 extends Oy{}class c0 extends Oy{}class Dv extends mr{}class u0 extends Dv{}class d0 extends Dv{}class zv extends mr{}class p0 extends zv{}class f0 extends zv{}class Bv extends mr{}class m0 extends Bv{}class h0 extends Bv{}class Uv extends mr{}class _0 extends Uv{}class g0 extends Uv{}class Vv extends mr{}class x0 extends Vv{}class w0 extends Vv{}class Wv extends mr{}class y0 extends Wv{}class v0 extends Wv{}class Gv extends mr{}class b0 extends Gv{}class M0 extends Gv{}class Hv extends mr{}class E0 extends Hv{}class T0 extends Hv{}class Kv extends mr{}class k0 extends Kv{}class $0 extends Kv{}class qv extends mr{}class P0 extends qv{}class C0 extends qv{}class Qv extends mr{}class S0 extends Qv{}class A0 extends Qv{}class Xv extends mr{}class I0 extends Xv{}class R0 extends Xv{}class Yv extends mr{}class O0 extends Yv{}class j0 extends Yv{}class Jv extends mr{}class N0 extends Jv{}class L0 extends Jv{}class Zv extends mr{}class F0 extends Zv{}class D0 extends Zv{}class _b extends mr{}class z0 extends _b{}class B0 extends _b{}class e1 extends mr{}class U0 extends e1{}class V0 extends e1{}class W0 extends mr{constructor(){super(...arguments);Oo(this,"forward_params",["input_ids","attention_mask","position_ids","past_key_values","pixel_values","image_grid_thw"])}}class G0 extends W0{get_rope_index(ar,mn,Fo,Xo){const{vision_config:Ko,image_token_id:np,video_token_id:up,vision_start_token_id:hp}=this.config,Ep=Ko.spatial_merge_size??2,Bp=[];if(mn||Fo){let o_=ar.tolist();Xo||(Xo=(0,it.ones_like)(ar));const a_=Xo.tolist(),x_=Array.from({length:3},k_=>Array.from({length:ar.dims[0]},O_=>Array.from({length:ar.dims[1]},W_=>1))),t_=mn?mn.tolist():[],d_=Fo?Fo.tolist():[];let Dp=0,__=0;for(let k_=0;k_<o_.length;++k_){const O_=o_[k_].filter((j_,ix)=>a_[k_][ix]==1),D_=O_.reduce((j_,ix,mw)=>(ix==hp&&j_.push(mw),j_),[]).map(j_=>O_[j_+1]),tx=D_.filter(j_=>j_==np).length,mx=D_.filter(j_=>j_==up).length;let p_=[],ax=0,Ax=tx,Rw=mx;for(let j_=0;j_<D_.length;++j_){const ix=O_.findIndex((Nw,Gx)=>Gx>ax&&Nw==np),mw=O_.findIndex((Nw,Gx)=>Gx>ax&&Nw==up),jw=Ax>0&&ix!==-1?ix:O_.length+1,ny=Rw>0&&mw!==-1?mw:O_.length+1;let Rv,t0,r0,n0;jw<ny?([t0,r0,n0]=t_[Dp],++Dp,--Ax,Rv=jw):([t0,r0,n0]=d_[__],++__,--Rw,Rv=ny);const[iC,s0,Ov]=[Number(t0),Math.floor(Number(r0)/Ep),Math.floor(Number(n0)/Ep)],o0=Rv-ax,RP=p_.length>0?(0,mt.max)(p_.at(-1))[0]+1:0;p_.push(Array.from({length:3*o0},(Nw,Gx)=>RP+Gx%o0));const a0=o0+RP,jv=iC*s0*Ov,lC=Array.from({length:jv},(Nw,Gx)=>a0+Math.floor(Gx/(s0*Ov))),cC=Array.from({length:jv},(Nw,Gx)=>a0+Math.floor(Gx/Ov)%s0),uC=Array.from({length:jv},(Nw,Gx)=>a0+Gx%Ov);p_.push([lC,cC,uC].flat()),ax=Rv+jv}if(ax<O_.length){const j_=p_.length>0?(0,mt.max)(p_.at(-1))[0]+1:0,ix=O_.length-ax;p_.push(Array.from({length:3*ix},(mw,jw)=>j_+jw%ix))}const Ex=p_.reduce((j_,ix)=>j_+ix.length,0),Fx=new Array(Ex);let Sv=0;for(let j_=0;j_<3;++j_)for(let ix=0;ix<p_.length;++ix){const mw=p_[ix],jw=mw.length/3;for(let ny=j_*jw;ny<(j_+1)*jw;++ny)Fx[Sv++]=mw[ny]}let Ow=0;const Av=a_[k_];for(let j_=0;j_<Av.length;++j_)if(Av[j_]==1){for(let ix=0;ix<3;++ix)x_[ix][k_][j_]=Fx[ix*Ex/3+Ow];++Ow}const Iv=(0,mt.max)(Fx)[0];Bp.push(Iv+1-o_[k_].length)}return[new it.Tensor("int64",x_.flat(1/0),[3,ar.dims[0],ar.dims[1]]),new it.Tensor("int64",Bp,[Bp.length,1])]}else if(Xo){const{data:o_,dims:a_}=Mo(Xo),x_=BigInt64Array.from({length:3*o_.length},(d_,Dp)=>o_[Dp%o_.length]),t_=Array.from({length:a_[0]},(d_,Dp)=>(0,mt.max)(o_.subarray(a_[1]*Dp,a_[1]*(Dp+1)))[0]+1n+BigInt(a_[1]));return[new it.Tensor("int64",x_,[3,...a_]),new it.Tensor("int64",t_,[t_.length,1])]}else{const[o_,a_]=ar.dims,x_=BigInt64Array.from({length:3*o_*a_},(t_,d_)=>BigInt(Math.floor(d_%a_/o_)));return[new it.Tensor("int64",x_,[3,...ar.dims]),(0,it.zeros)([o_,1])]}}async encode_image({pixel_values:ar,image_grid_thw:mn}){return(await hn(this.sessions.vision_encoder,{pixel_values:ar,grid_thw:mn})).image_features}_merge_input_ids_with_image_features(ar){return or({image_token_id:this.config.image_token_id,...ar})}prepare_inputs_for_generation(ar,mn,Fo){if(mn.attention_mask&&!mn.position_ids)if(!mn.past_key_values)[mn.position_ids,mn.rope_deltas]=this.get_rope_index(mn.input_ids,mn.image_grid_thw,mn.video_grid_thw,mn.attention_mask);else{mn.pixel_values=null;const Xo=BigInt(Object.values(mn.past_key_values)[0].dims.at(-2)),Ko=mn.rope_deltas.map(np=>Xo+np);mn.position_ids=(0,it.stack)([Ko,Ko,Ko],0)}return mn}}class t1 extends mr{}class H0 extends t1{}class K0 extends t1{}class r1 extends mr{}class q0 extends r1{}class Q0 extends r1{}class n1 extends mr{}class X0 extends n1{}class Y0 extends n1{}class s1 extends mr{}class J0 extends s1{}class Z0 extends s1{}class o1 extends mr{}class eM extends o1{}class tM extends o1{}class a1 extends mr{}class rM extends a1{}class nM extends a1{async _call(ar){return new c_(await super._call(ar))}}class i1 extends mr{}class sM extends i1{}class oM extends i1{async _call(ar){return new c_(await super._call(ar))}}class aM extends mr{}class iM extends aM{}class l1 extends mr{}class lM extends l1{}class cM extends l1{async _call(ar){return new c_(await super._call(ar))}}class uM extends mr{}class dM extends uM{}class c1 extends mr{}class pM extends c1{}class fM extends c1{async _call(ar){return new c_(await super._call(ar))}}class mM extends mr{}class hM extends mM{}class u1 extends mr{}class _M extends u1{}class gM extends u1{async _call(ar){return new c_(await super._call(ar))}}class xM extends mr{}class wM extends xM{async _call(ar){return new AP(await super._call(ar))}}class d1 extends mr{}class yM extends d1{}class vM extends d1{async _call(ar){return new c_(await super._call(ar))}}class p1 extends mr{}class bM extends p1{}class MM extends p1{async _call(ar){return new c_(await super._call(ar))}}class f1 extends mr{}class EM extends f1{}class TM extends f1{}class m1 extends mr{}class kM extends m1{}class $M extends m1{}class h1 extends mr{}class PM extends h1{}class CM extends h1{async _call(ar){return new c_(await super._call(ar))}}class hv extends mr{}class SM extends hv{}class AM extends hv{async _call(ar){return new g1(await super._call(ar))}}class _1 extends hv{async _call(ar){return new IM(await super._call(ar))}}class g1 extends Do{constructor({logits:ar,pred_boxes:mn}){super(),this.logits=ar,this.pred_boxes=mn}}class IM extends Do{constructor({logits:ar,pred_boxes:mn,pred_masks:Fo}){super(),this.logits=ar,this.pred_boxes=mn,this.pred_masks=Fo}}class x1 extends mr{}class RM extends x1{}class OM extends x1{async _call(ar){return new jy(await super._call(ar))}}class jy extends Do{constructor({logits:ar,pred_boxes:mn}){super(),this.logits=ar,this.pred_boxes=mn}}class w1 extends mr{}class jM extends w1{}class NM extends w1{async _call(ar){return new LM(await super._call(ar))}}class LM extends jy{}class y1 extends mr{}class FM extends y1{}class DM extends y1{async _call(ar){return new zM(await super._call(ar))}}class zM extends jy{}class v1 extends mr{}class BM extends v1{}class UM extends v1{async _call(ar){return new jy(await super._call(ar))}}class b1 extends mr{}class VM extends b1{}class WM extends b1{async _call(ar){return new GM(await super._call(ar))}}class GM extends g1{}class M1 extends mr{}class HM extends M1{}class KM extends M1{async _call(ar){return new c_(await super._call(ar))}}class E1 extends mr{}class qM extends E1{}class QM extends E1{async _call(ar){return new c_(await super._call(ar))}}class T1 extends mr{}class XM extends T1{}class YM extends T1{async _call(ar){return new c_(await super._call(ar))}}class _v extends mr{}class JM extends _v{}class ZM extends _v{async _call(ar){return new c_(await super._call(ar))}}class eE extends _v{}class k1 extends mr{}class tE extends k1{}class rE extends k1{}class $1 extends mr{}class nE extends $1{}class sE extends $1{}class oE extends mr{}class aE extends oE{}class gv extends mr{}class iE extends gv{}class lE extends gv{}class cE extends gv{}class uE extends mr{}class dE extends uE{}class pE extends mr{}class fE extends pE{}class mE extends mr{}class hE extends mE{}class P1 extends mr{}class _E extends P1{}class gE extends P1{}class C1 extends mr{}class xE extends C1{}class wE extends C1{}class yE extends mr{}class vE extends yE{}class S1 extends mr{}class bE extends S1{}class ME extends S1{async _call(ar){return new c_(await super._call(ar))}}class A1 extends mr{}class EE extends A1{}class TE extends A1{async _call(ar){return new c_(await super._call(ar))}}class I1 extends mr{}class kE extends I1{}class $E extends I1{async _call(ar){return new c_(await super._call(ar))}}class R1 extends mr{}class PE extends R1{}class CE extends R1{async _call(ar){return new c_(await super._call(ar))}}class SE extends mr{}class AE extends SE{}class IE extends mr{}class RE extends IE{}class OE extends mr{}class jE extends OE{}class O1 extends mr{}class NE extends O1{}class LE extends O1{async _call(ar){return new FE(await super._call(ar))}}class FE extends Do{constructor({logits:ar,pred_boxes:mn}){super(),this.logits=ar,this.pred_boxes=mn}}class DE extends mr{}class zE extends DE{async get_image_embeddings({pixel_values:ar}){return await kn(this,{pixel_values:ar})}async forward(ar){if((!ar.image_embeddings||!ar.image_positional_embeddings)&&(ar={...ar,...await this.get_image_embeddings(ar)}),!ar.input_labels&&ar.input_points){const Fo=ar.input_points.dims.slice(0,-1),Xo=Fo.reduce((Ko,np)=>Ko*np,1);ar.input_labels=new it.Tensor("int64",new BigInt64Array(Xo).fill(1n),Fo)}const mn={image_embeddings:ar.image_embeddings,image_positional_embeddings:ar.image_positional_embeddings};return ar.input_points&&(mn.input_points=ar.input_points),ar.input_labels&&(mn.input_labels=ar.input_labels),ar.input_boxes&&(mn.input_boxes=ar.input_boxes),await hn(this.sessions.prompt_encoder_mask_decoder,mn)}async _call(ar){return new BE(await super._call(ar))}}class BE extends Do{constructor({iou_scores:ar,pred_masks:mn}){super(),this.iou_scores=ar,this.pred_masks=mn}}class j1 extends mr{}class UE extends j1{}class VE extends j1{}class N1 extends mr{}class WE extends N1{}class GE extends N1{}class pw extends mr{}class HE extends pw{}class KE extends pw{async _call(ar){return new fw(await super._call(ar))}}class qE extends pw{async _call(ar){return new c_(await super._call(ar))}}class QE extends pw{async _call(ar){return new ox(await super._call(ar))}}class XE extends mr{}class YE extends XE{async _call(ar){return new fw(await super._call(ar))}}class L1 extends mr{}class JE extends L1{}class ZE extends L1{async _call(ar){return new ox(await super._call(ar))}}class eT extends mr{}class tT extends eT{}class xv extends mr{}class rT extends xv{}class nT extends xv{async _call(ar){return new fw(await super._call(ar))}}class sT extends xv{async _call(ar){return new c_(await super._call(ar))}}class Ny extends mr{}class oT extends Ny{}class aT extends Ny{async _call(ar){return new fw(await super._call(ar))}}class iT extends Ny{async _call(ar){return new c_(await super._call(ar))}}class lT extends Ny{async _call(ar){return new ox(await super._call(ar))}}class wv extends mr{}class cT extends wv{}class uT extends wv{async _call(ar){return new fw(await super._call(ar))}}class dT extends wv{async _call(ar){return new c_(await super._call(ar))}}class HP extends mr{}class pT extends pw{}class fT extends pw{async _call(ar){return new fw(await super._call(ar))}}class mT extends pw{async _call(ar){return new c_(await super._call(ar))}}class ty extends mr{}class hT extends ty{}class _T extends ty{async _call(ar){return new fw(await super._call(ar))}}class gT extends ty{async _call(ar){return new c_(await super._call(ar))}}class xT extends ty{async _call(ar){return new SP(await super._call(ar))}}class wT extends ty{async _call(ar){return new ox(await super._call(ar))}}class yT extends mr{}class vT extends yT{}class yv extends mr{}class KP extends yv{}class bT extends yv{}class MT extends yv{async generate_speech(ar,mn,{threshold:Fo=.5,minlenratio:Xo=0,maxlenratio:Ko=20,vocoder:np=null}={}){const up={input_ids:ar},{encoder_outputs:hp,encoder_attention_mask:Ep}=await kn(this,up),Bp=hp.dims[1]/this.config.reduction_factor,o_=Math.floor(Bp*Ko),a_=Math.floor(Bp*Xo),x_=this.config.num_mel_bins;let t_=[],d_=null,Dp=null,__=0;for(;;){++__;const W_=vn(!!Dp);let D_;Dp?D_=Dp.output_sequence_out:D_=new it.Tensor("float32",new Float32Array(x_),[1,1,x_]);let tx={use_cache_branch:W_,output_sequence:D_,encoder_attention_mask:Ep,speaker_embeddings:mn,encoder_hidden_states:hp};this.addPastKeyValues(tx,d_),Dp=await hn(this.sessions.decoder_model_merged,tx),d_=this.getPastKeyValues(Dp,d_);const{prob:mx,spectrum:p_}=Dp;if(t_.push(p_),__>=a_&&(Array.from(mx.data).filter(ax=>ax>=Fo).length>0||__>=o_))break}const k_=(0,it.cat)(t_),{waveform:O_}=await hn(np.sessions.model,{spectrogram:k_});return{spectrogram:k_,waveform:O_}}}class ET extends mr{constructor(){super(...arguments);Oo(this,"main_input_name","spectrogram")}}class TT extends mr{}class kT extends TT{}class F1 extends mr{}class $T extends F1{}class PT extends F1{}class D1 extends mr{}class CT extends D1{}class ST extends D1{}class z1 extends mr{}class AT extends z1{}class IT extends z1{}class B1 extends mr{}class RT extends B1{}class OT extends B1{}class vv extends mr{}class jT extends vv{}class NT extends vv{static async from_pretrained(ar,mn={}){return super.from_pretrained(ar,{...mn,model_file_name:mn.model_file_name??"text_model"})}}class LT extends vv{static async from_pretrained(ar,mn={}){return super.from_pretrained(ar,{...mn,model_file_name:mn.model_file_name??"audio_model"})}}class FT extends mr{}class U1 extends FT{async _call(ar){return new IP(await super._call(ar))}}class bv extends mr{}class qP extends bv{}class DT extends bv{}class zT extends bv{}class V1 extends mr{}class BT extends V1{}class UT extends V1{}class W1 extends mr{}class VT extends W1{}class WT extends W1{async _call(ar){return new c_(await super._call(ar))}}class G1 extends mr{}class QP extends G1{}class XP extends G1{}class H1 extends mr{constructor(){super(...arguments);Oo(this,"forward_params",["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"])}_apply_and_filter_by_delay_pattern_mask(mn){const[Fo,Xo]=mn.dims,Ko=this.config.decoder.num_codebooks,np=Xo-Ko;let up=0;for(let Bp=0;Bp<mn.size;++Bp){if(mn.data[Bp]===this.config.decoder.pad_token_id)continue;const o_=Bp%Xo,a_=Math.floor(Bp/Xo)%Ko,x_=o_-a_;x_>0&&x_<=np&&(mn.data[up++]=mn.data[Bp])}const hp=Math.floor(Fo/Ko),Ep=up/(hp*Ko);return new it.Tensor(mn.type,mn.data.slice(0,up),[hp,Ko,Ep])}prepare_inputs_for_generation(mn,Fo,Xo){let Ko=structuredClone(mn);for(let up=0;up<Ko.length;++up)for(let hp=0;hp<Ko[up].length;++hp)up%this.config.decoder.num_codebooks>=hp&&(Ko[up][hp]=BigInt(this.config.decoder.pad_token_id));return Xo.guidance_scale!==null&&Xo.guidance_scale>1&&(Ko=Ko.concat(Ko)),super.prepare_inputs_for_generation(Ko,Fo,Xo)}async generate(mn){const Fo=await super.generate(mn),Xo=this._apply_and_filter_by_delay_pattern_mask(Fo).unsqueeze_(0),{audio_values:Ko}=await hn(this.sessions.encodec_decode,{audio_codes:Xo});return Ko}}class Mv extends mr{}class GT extends Mv{}class HT extends Mv{async _call(ar){return new c_(await super._call(ar))}}class KT extends Mv{}class Ev extends mr{}class qT extends Ev{}class QT extends Ev{async _call(ar){return new c_(await super._call(ar))}}class XT extends Ev{}class Tv extends mr{}class YT extends Tv{}class JT extends Tv{async _call(ar){return new c_(await super._call(ar))}}class ZT extends Tv{}class kv extends mr{}class _k extends kv{}class e$ extends kv{async _call(ar){return new c_(await super._call(ar))}}class t$ extends kv{}class r$ extends mr{}class n$ extends r${}class s$ extends mr{}class o$ extends s${constructor(...mn){super(...mn);Oo(this,"forward_params",["input_ids","pixel_values","images_seq_mask","images_emb_mask","attention_mask","position_ids","past_key_values"]);this._generation_mode="text"}async forward(mn){const Fo=this._generation_mode??"text";let Xo;if(Fo==="text"||!mn.past_key_values){const Ep=this.sessions.prepare_inputs_embeds,Bp=(0,g.pick)(mn,Ep.inputNames);Xo=await hn(Ep,Bp)}else{const Ep=this.sessions.gen_img_embeds,Bp=(0,g.pick)({image_ids:mn.input_ids},Ep.inputNames);Xo=await hn(Ep,Bp)}const Ko={...mn,...Xo},np=await Sn(this,Ko),up=this.sessions[Fo==="text"?"lm_head":"gen_head"];if(!up)throw new Error(`Unable to find "${up}" generation head`);const hp=await hn(up,(0,g.pick)(np,up.inputNames));return{...Xo,...np,...hp}}async generate(mn){return this._generation_mode="text",super.generate(mn)}async generate_images(mn){this._generation_mode="image";const Fo=(mn.inputs??mn[this.main_input_name]).dims[1],Ko=(await super.generate(mn)).slice(null,[Fo,null]),np=this.sessions.image_decode,{decoded_image:up}=await hn(np,{generated_tokens:Ko}),hp=up.add_(1).mul_(255/2).clamp_(0,255).to("uint8"),Ep=[];for(const Bp of hp){const o_=ct.RawImage.fromTensor(Bp);Ep.push(o_)}return Ep}}class a$ extends Do{constructor({char_logits:ar,bpe_logits:mn,wp_logits:Fo}){super(),this.char_logits=ar,this.bpe_logits=mn,this.wp_logits=Fo}get logits(){return[this.char_logits,this.bpe_logits,this.wp_logits]}}class i$ extends mr{}class l$ extends i${async _call(ar){return new a$(await super._call(ar))}}class K1 extends mr{}class c$ extends K1{}class u$ extends K1{}class q1 extends mr{}class d$ extends q1{}class p$ extends q1{}class f$ extends mr{constructor(){super(...arguments);Oo(this,"forward_params",["input_ids","attention_mask","position_ids","audio_values","past_key_values"])}}class Q1 extends f${_merge_input_ids_with_audio_features(ar){const mn=ar.audio_features.dims.at(-1),Fo=ar.audio_features.view(-1,mn);return lr({audio_token_id:this.config.ignore_index??this.config.audio_token_id,...ar,audio_features:Fo})}}class m$ extends Q1{}class $v extends mr{constructor(){super(...arguments);Oo(this,"main_input_name","input_values");Oo(this,"forward_params",["input_values"])}}class h$ extends Do{constructor({audio_codes:ar}){super(),this.audio_codes=ar}}class _$ extends Do{constructor({audio_values:ar}){super(),this.audio_values=ar}}class g$ extends $v{async encode(ar){return new h$(await hn(this.sessions.encoder_model,ar))}async decode(ar){return new _$(await hn(this.sessions.decoder_model,ar))}}class x$ extends $v{static async from_pretrained(ar,mn={}){return super.from_pretrained(ar,{...mn,model_file_name:mn.model_file_name??"encoder_model"})}}class w$ extends $v{static async from_pretrained(ar,mn={}){return super.from_pretrained(ar,{...mn,model_file_name:mn.model_file_name??"decoder_model"})}}class Pv extends mr{constructor(){super(...arguments);Oo(this,"main_input_name","input_values");Oo(this,"forward_params",["input_values"])}}class y$ extends Do{constructor({audio_codes:ar}){super(),this.audio_codes=ar}}class v$ extends Do{constructor({audio_values:ar}){super(),this.audio_values=ar}}class b$ extends Pv{async encode(ar){return new y$(await hn(this.sessions.encoder_model,ar))}async decode(ar){return new v$(await hn(this.sessions.decoder_model,ar))}}class M$ extends Pv{static async from_pretrained(ar,mn={}){return super.from_pretrained(ar,{...mn,model_file_name:mn.model_file_name??"encoder_model"})}}class E$ extends Pv{static async from_pretrained(ar,mn={}){return super.from_pretrained(ar,{...mn,model_file_name:mn.model_file_name??"decoder_model"})}}class Cv extends mr{constructor(){super(...arguments);Oo(this,"main_input_name","input_values");Oo(this,"forward_params",["input_values"])}}class T$ extends Cv{async encode(ar){return await hn(this.sessions.encoder_model,ar)}async decode(ar){return await hn(this.sessions.decoder_model,ar)}}class k$ extends Cv{static async from_pretrained(ar,mn={}){return super.from_pretrained(ar,{...mn,model_file_name:mn.model_file_name??"encoder_model"})}}class $$ extends Cv{static async from_pretrained(ar,mn={}){return super.from_pretrained(ar,{...mn,model_file_name:mn.model_file_name??"decoder_model"})}}class b_{static async from_pretrained(ar,{progress_callback:mn=null,config:Fo=null,cache_dir:Xo=null,local_files_only:Ko=!1,revision:np="main",model_file_name:up=null,subfolder:hp="onnx",device:Ep=null,dtype:Bp=null,use_external_data_format:o_=null,session_options:a_={}}={}){const x_={progress_callback:mn,config:Fo,cache_dir:Xo,local_files_only:Ko,revision:np,model_file_name:up,subfolder:hp,device:Ep,dtype:Bp,use_external_data_format:o_,session_options:a_};if(x_.config=await c.AutoConfig.from_pretrained(ar,x_),!this.MODEL_CLASS_MAPPINGS)throw new Error("`MODEL_CLASS_MAPPINGS` not implemented for this type of `AutoClass`: "+this.name);const t_=x_.config.model_type;for(const d_ of this.MODEL_CLASS_MAPPINGS){let Dp=d_.get(t_);if(!Dp){for(const __ of d_.values())if(__[0]===t_){Dp=__;break}if(!Dp)continue}return await Dp[1].from_pretrained(ar,x_)}if(this.BASE_IF_FAIL)return Z$.has(t_)||console.warn(`Unknown model class "${t_}", attempting to construct from base class.`),await mr.from_pretrained(ar,x_);throw Error(`Unsupported model type: ${t_}`)}}Oo(b_,"MODEL_CLASS_MAPPINGS",null),Oo(b_,"BASE_IF_FAIL",!1);const YP=new Map([["bert",["BertModel",_i]],["neobert",["NeoBertModel",_p]],["modernbert",["ModernBertModel",ip]],["nomic_bert",["NomicBertModel",z_]],["roformer",["RoFormerModel",S_]],["electra",["ElectraModel",In]],["esm",["EsmModel",Nx]],["convbert",["ConvBertModel",e_]],["camembert",["CamembertModel",Cp]],["deberta",["DebertaModel",$_]],["deberta-v2",["DebertaV2Model",Rx]],["mpnet",["MPNetModel",vw]],["albert",["AlbertModel",mp]],["distilbert",["DistilBertModel",jx]],["roberta",["RobertaModel",zy]],["xlm",["XLMModel",Wy]],["xlm-roberta",["XLMRobertaModel",Qy]],["clap",["ClapModel",jT]],["clip",["CLIPModel",Kw]],["clipseg",["CLIPSegModel",Sx]],["chinese_clip",["ChineseCLIPModel",Pw]],["siglip",["SiglipModel",vy]],["jina_clip",["JinaCLIPModel",mv]],["mobilebert",["MobileBertModel",$p]],["squeezebert",["SqueezeBertModel",$n]],["wav2vec2",["Wav2Vec2Model",HE]],["wav2vec2-bert",["Wav2Vec2BertModel",cT]],["unispeech",["UniSpeechModel",rT]],["unispeech-sat",["UniSpeechSatModel",oT]],["hubert",["HubertModel",pT]],["wavlm",["WavLMModel",hT]],["audio-spectrogram-transformer",["ASTModel",Jy]],["vits",["VitsModel",U1]],["pyannote",["PyAnnoteModel",JE]],["wespeaker-resnet",["WeSpeakerResNetModel",tT]],["detr",["DetrModel",SM]],["rt_detr",["RTDetrModel",RM]],["rt_detr_v2",["RTDetrV2Model",jM]],["rf_detr",["RFDetrModel",FM]],["d_fine",["DFineModel",BM]],["table-transformer",["TableTransformerModel",VM]],["vit",["ViTModel",rM]],["ijepa",["IJepaModel",sM]],["pvt",["PvtModel",lM]],["vit_msn",["ViTMSNModel",pM]],["vit_mae",["ViTMAEModel",dM]],["groupvit",["GroupViTModel",hM]],["fastvit",["FastViTModel",_M]],["mobilevit",["MobileViTModel",yM]],["mobilevitv2",["MobileViTV2Model",bM]],["owlvit",["OwlViTModel",EM]],["owlv2",["Owlv2Model",kM]],["beit",["BeitModel",PM]],["deit",["DeiTModel",HM]],["hiera",["HieraModel",qM]],["convnext",["ConvNextModel",bE]],["convnextv2",["ConvNextV2Model",EE]],["dinov2",["Dinov2Model",kE]],["dinov2_with_registers",["Dinov2WithRegistersModel",PE]],["dinov3_vit",["DINOv3ViTModel",AE]],["dinov3_convnext",["DINOv3ConvNextModel",RE]],["resnet",["ResNetModel",XM]],["swin",["SwinModel",JM]],["swin2sr",["Swin2SRModel",tE]],["donut-swin",["DonutSwinModel",vE]],["yolos",["YolosModel",NE]],["dpt",["DPTModel",nE]],["glpn",["GLPNModel",xE]],["hifigan",["SpeechT5HifiGan",ET]],["efficientnet",["EfficientNetModel",VT]],["decision_transformer",["DecisionTransformerModel",n$]],["patchtst",["PatchTSTForPrediction",c$]],["patchtsmixer",["PatchTSMixerForPrediction",d$]],["mobilenet_v1",["MobileNetV1Model",GT]],["mobilenet_v2",["MobileNetV2Model",qT]],["mobilenet_v3",["MobileNetV3Model",YT]],["mobilenet_v4",["MobileNetV4Model",_k]],["maskformer",["MaskFormerModel",_E]],["mgp-str",["MgpstrForSceneTextRecognition",l$]],["style_text_to_speech_2",["StyleTextToSpeech2Model",vT]]]),JP=new Map([["t5",["T5Model",v_]],["longt5",["LongT5Model",T_]],["mt5",["MT5Model",U_]],["bart",["BartModel",Cx]],["mbart",["MBartModel",$x]],["marian",["MarianModel",UE]],["whisper",["WhisperModel",hy]],["m2m_100",["M2M100Model",WE]],["blenderbot",["BlenderbotModel",V_]],["blenderbot-small",["BlenderbotSmallModel",Mx]]]),ZP=new Map([["mimi",["MimiModel",g$]],["dac",["DacModel",b$]],["snac",["SnacModel",T$]]]),eC=new Map([["bloom",["BloomModel",X0]],["jais",["JAISModel",Xw]],["gpt2",["GPT2Model",ky]],["gptj",["GPTJModel",Ay]],["gpt_bigcode",["GPTBigCodeModel",Ry]],["gpt_neo",["GPTNeoModel",Cy]],["gpt_neox",["GPTNeoXModel",Jw]],["codegen",["CodeGenModel",pr]],["llama",["LlamaModel",Bo]],["nanochat",["NanoChatModel",l_]],["arcee",["ArceeModel",sx]],["lfm2",["Lfm2Model",l0]],["smollm3",["SmolLM3Model",u0]],["exaone",["ExaoneModel",_0]],["olmo",["OlmoModel",y0]],["olmo2",["Olmo2Model",b0]],["mobilellm",["MobileLLMModel",x0]],["granite",["GraniteModel",E0]],["granitemoehybrid",["GraniteMoeHybridModel",k0]],["cohere",["CohereModel",P0]],["gemma",["GemmaModel",S0]],["gemma2",["Gemma2Model",I0]],["vaultgemma",["VaultGemmaModel",O0]],["gemma3_text",["Gemma3Model",N0]],["helium",["HeliumModel",p0]],["glm",["GlmModel",m0]],["openelm",["OpenELMModel",F0]],["qwen2",["Qwen2Model",z0]],["qwen3",["Qwen3Model",U0]],["phi",["PhiModel",H0]],["phi3",["Phi3Model",q0]],["mpt",["MptModel",J0]],["opt",["OPTModel",eM]],["mistral",["MistralModel",$T]],["ernie4_5",["Ernie4_5_Model",CT]],["starcoder2",["Starcoder2Model",AT]],["falcon",["FalconModel",RT]],["stablelm",["StableLmModel",BT]],["modernbert-decoder",["ModernBertDecoderModel",Ip]]]),X1=new Map([["speecht5",["SpeechT5ForSpeechToText",bT]],["whisper",["WhisperForConditionalGeneration",ow]],["lite-whisper",["LiteWhisperForConditionalGeneration",ev]],["moonshine",["MoonshineForConditionalGeneration",tv]]]),P$=new Map([["speecht5",["SpeechT5ForTextToSpeech",MT]]]),C$=new Map([["vits",["VitsModel",U1]],["musicgen",["MusicgenForConditionalGeneration",H1]]]),S$=new Map([["bert",["BertForSequenceClassification",_c]],["neobert",["NeoBertForSequenceClassification",bp]],["modernbert",["ModernBertForSequenceClassification",Rp]],["roformer",["RoFormerForSequenceClassification",zx]],["electra",["ElectraForSequenceClassification",An]],["esm",["EsmForSequenceClassification",wx]],["convbert",["ConvBertForSequenceClassification",g_]],["camembert",["CamembertForSequenceClassification",zp]],["deberta",["DebertaForSequenceClassification",bx]],["deberta-v2",["DebertaV2ForSequenceClassification",ux]],["mpnet",["MPNetForSequenceClassification",Mw]],["albert",["AlbertForSequenceClassification",yp]],["distilbert",["DistilBertForSequenceClassification",kx]],["roberta",["RobertaForSequenceClassification",py]],["xlm",["XLMForSequenceClassification",Hy]],["xlm-roberta",["XLMRobertaForSequenceClassification",Yy]],["bart",["BartForSequenceClassification",ex]],["mbart",["MBartForSequenceClassification",px]],["mobilebert",["MobileBertForSequenceClassification",nw]],["squeezebert",["SqueezeBertForSequenceClassification",zo]]]),A$=new Map([["bert",["BertForTokenClassification",Qo]],["neobert",["NeoBertForTokenClassification",gp]],["modernbert",["ModernBertForTokenClassification",Ap]],["roformer",["RoFormerForTokenClassification",qx]],["electra",["ElectraForTokenClassification",No]],["esm",["EsmForTokenClassification",dp]],["convbert",["ConvBertForTokenClassification",Pp]],["camembert",["CamembertForTokenClassification",i_]],["deberta",["DebertaForTokenClassification",N_]],["deberta-v2",["DebertaV2ForTokenClassification",Qx]],["mpnet",["MPNetForTokenClassification",Ew]],["distilbert",["DistilBertForTokenClassification",_x]],["roberta",["RobertaForTokenClassification",Uy]],["xlm",["XLMForTokenClassification",Ky]],["xlm-roberta",["XLMRobertaForTokenClassification",fy]]]),Y1=new Map([["t5",["T5ForConditionalGeneration",w_]],["longt5",["LongT5ForConditionalGeneration",Y_]],["mt5",["MT5ForConditionalGeneration",Z_]],["bart",["BartForConditionalGeneration",A_]],["mbart",["MBartForConditionalGeneration",Vx]],["marian",["MarianMTModel",VE]],["m2m_100",["M2M100ForConditionalGeneration",GE]],["blenderbot",["BlenderbotForConditionalGeneration",q_]],["blenderbot-small",["BlenderbotSmallForConditionalGeneration",sw]]]),J1=new Map([["bloom",["BloomForCausalLM",Y0]],["gpt2",["GPT2LMHeadModel",$y]],["jais",["JAISLMHeadModel",Py]],["gptj",["GPTJForCausalLM",Iy]],["gpt_bigcode",["GPTBigCodeForCausalLM",Pt]],["gpt_neo",["GPTNeoForCausalLM",Aw]],["gpt_neox",["GPTNeoXForCausalLM",Sy]],["codegen",["CodeGenForCausalLM",xn]],["llama",["LlamaForCausalLM",rp]],["nanochat",["NanoChatForCausalLM",y_]],["llama4_text",["Llama4ForCausalLM",vp]],["arcee",["ArceeForCausalLM",aw]],["lfm2",["Lfm2ForCausalLM",c0]],["smollm3",["SmolLM3ForCausalLM",d0]],["exaone",["ExaoneForCausalLM",g0]],["olmo",["OlmoForCausalLM",v0]],["olmo2",["Olmo2ForCausalLM",M0]],["mobilellm",["MobileLLMForCausalLM",w0]],["granite",["GraniteForCausalLM",T0]],["granitemoehybrid",["GraniteMoeHybridForCausalLM",$0]],["cohere",["CohereForCausalLM",C0]],["gemma",["GemmaForCausalLM",A0]],["gemma2",["Gemma2ForCausalLM",R0]],["vaultgemma",["VaultGemmaForCausalLM",j0]],["gemma3_text",["Gemma3ForCausalLM",L0]],["helium",["HeliumForCausalLM",f0]],["glm",["GlmForCausalLM",h0]],["openelm",["OpenELMForCausalLM",D0]],["qwen2",["Qwen2ForCausalLM",B0]],["qwen3",["Qwen3ForCausalLM",V0]],["phi",["PhiForCausalLM",K0]],["phi3",["Phi3ForCausalLM",Q0]],["mpt",["MptForCausalLM",Z0]],["opt",["OPTForCausalLM",tM]],["mbart",["MBartForCausalLM",Lx]],["mistral",["MistralForCausalLM",PT]],["ernie4_5",["Ernie4_5_ForCausalLM",ST]],["starcoder2",["Starcoder2ForCausalLM",IT]],["falcon",["FalconForCausalLM",OT]],["trocr",["TrOCRForCausalLM",kT]],["stablelm",["StableLmForCausalLM",UT]],["modernbert-decoder",["ModernBertDecoderForCausalLM",C_]],["phi3_v",["Phi3VForCausalLM",xy]]]),tC=new Map([["multi_modality",["MultiModalityCausalLM",o$]]]),I$=new Map([["bert",["BertForMaskedLM",Ho]],["neobert",["NeoBertForMaskedLM",Zo]],["modernbert",["ModernBertForMaskedLM",fp]],["roformer",["RoFormerForMaskedLM",H_]],["electra",["ElectraForMaskedLM",wn]],["esm",["EsmForMaskedLM",rw]],["convbert",["ConvBertForMaskedLM",r_]],["camembert",["CamembertForMaskedLM",n_]],["deberta",["DebertaForMaskedLM",xx]],["deberta-v2",["DebertaV2ForMaskedLM",Ox]],["mpnet",["MPNetForMaskedLM",bw]],["albert",["AlbertForMaskedLM",Tp]],["distilbert",["DistilBertForMaskedLM",K_]],["roberta",["RobertaForMaskedLM",By]],["xlm",["XLMWithLMHeadModel",Gy]],["xlm-roberta",["XLMRobertaForMaskedLM",Xy]],["mobilebert",["MobileBertForMaskedLM",P_]],["squeezebert",["SqueezeBertForMaskedLM",jo]]]),R$=new Map([["bert",["BertForQuestionAnswering",ep]],["neobert",["NeoBertForQuestionAnswering",Mp]],["roformer",["RoFormerForQuestionAnswering",Ix]],["electra",["ElectraForQuestionAnswering",Yo]],["convbert",["ConvBertForQuestionAnswering",m_]],["camembert",["CamembertForQuestionAnswering",kp]],["deberta",["DebertaForQuestionAnswering",lx]],["deberta-v2",["DebertaV2ForQuestionAnswering",Xx]],["mpnet",["MPNetForQuestionAnswering",Vo]],["albert",["AlbertForQuestionAnswering",xp]],["distilbert",["DistilBertForQuestionAnswering",Bx]],["roberta",["RobertaForQuestionAnswering",Vy]],["xlm",["XLMForQuestionAnswering",qy]],["xlm-roberta",["XLMRobertaForQuestionAnswering",my]],["mobilebert",["MobileBertForQuestionAnswering",Ux]],["squeezebert",["SqueezeBertForQuestionAnswering",Uo]]]),Z1=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",_y]],["idefics3",["Idefics3ForConditionalGeneration",Jx]],["smolvlm",["SmolVLMForConditionalGeneration",Hw]]]),O$=new Map([["llava",["LlavaForConditionalGeneration",kw]],["llava_onevision",["LlavaOnevisionForConditionalGeneration",rv]],["moondream1",["Moondream1ForConditionalGeneration",nv]],["florence2",["Florence2ForConditionalGeneration",ov]],["qwen2-vl",["Qwen2VLForConditionalGeneration",G0]],["idefics3",["Idefics3ForConditionalGeneration",Jx]],["smolvlm",["SmolVLMForConditionalGeneration",Hw]],["paligemma",["PaliGemmaForConditionalGeneration",iv]],["llava_qwen2",["LlavaQwen2ForCausalLM",lv]],["gemma3n",["Gemma3nForConditionalGeneration",gy]]]),j$=new Map([["ultravox",["UltravoxModel",Q1]],["voxtral",["VoxtralForConditionalGeneration",m$]]]),rC=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",_y]]]),N$=new Map([["vit",["ViTForImageClassification",nM]],["ijepa",["IJepaForImageClassification",oM]],["pvt",["PvtForImageClassification",cM]],["vit_msn",["ViTMSNForImageClassification",fM]],["fastvit",["FastViTForImageClassification",gM]],["mobilevit",["MobileViTForImageClassification",vM]],["mobilevitv2",["MobileViTV2ForImageClassification",MM]],["beit",["BeitForImageClassification",CM]],["deit",["DeiTForImageClassification",KM]],["hiera",["HieraForImageClassification",QM]],["convnext",["ConvNextForImageClassification",ME]],["convnextv2",["ConvNextV2ForImageClassification",TE]],["dinov2",["Dinov2ForImageClassification",$E]],["dinov2_with_registers",["Dinov2WithRegistersForImageClassification",CE]],["resnet",["ResNetForImageClassification",YM]],["swin",["SwinForImageClassification",ZM]],["segformer",["SegformerForImageClassification",DT]],["efficientnet",["EfficientNetForImageClassification",WT]],["mobilenet_v1",["MobileNetV1ForImageClassification",HT]],["mobilenet_v2",["MobileNetV2ForImageClassification",QT]],["mobilenet_v3",["MobileNetV3ForImageClassification",JT]],["mobilenet_v4",["MobileNetV4ForImageClassification",e$]]]),L$=new Map([["detr",["DetrForObjectDetection",AM]],["rt_detr",["RTDetrForObjectDetection",OM]],["rt_detr_v2",["RTDetrV2ForObjectDetection",NM]],["rf_detr",["RFDetrForObjectDetection",DM]],["d_fine",["DFineForObjectDetection",UM]],["table-transformer",["TableTransformerForObjectDetection",WM]],["yolos",["YolosForObjectDetection",LE]]]),F$=new Map([["owlvit",["OwlViTForObjectDetection",TM]],["owlv2",["Owlv2ForObjectDetection",$M]],["grounding-dino",["GroundingDinoForObjectDetection",jE]]]),ry=new Map([["detr",["DetrForSegmentation",_1]],["clipseg",["CLIPSegForImageSegmentation",Cw]]]),D$=new Map([["segformer",["SegformerForSemanticSegmentation",zT]],["sapiens",["SapiensForSemanticSegmentation",iE]],["swin",["SwinForSemanticSegmentation",eE]],["mobilenet_v1",["MobileNetV1ForSemanticSegmentation",KT]],["mobilenet_v2",["MobileNetV2ForSemanticSegmentation",XT]],["mobilenet_v3",["MobileNetV3ForSemanticSegmentation",ZT]],["mobilenet_v4",["MobileNetV4ForSemanticSegmentation",t$]]]),z$=new Map([["detr",["DetrForSegmentation",_1]],["maskformer",["MaskFormerForInstanceSegmentation",gE]]]),B$=new Map([["sam",["SamModel",zE]]]),U$=new Map([["wav2vec2",["Wav2Vec2ForCTC",KE]],["wav2vec2-bert",["Wav2Vec2BertForCTC",uT]],["unispeech",["UniSpeechForCTC",nT]],["unispeech-sat",["UniSpeechSatForCTC",aT]],["wavlm",["WavLMForCTC",_T]],["hubert",["HubertForCTC",fT]],["parakeet_ctc",["ParakeetForCTC",YE]]]),V$=new Map([["wav2vec2",["Wav2Vec2ForSequenceClassification",qE]],["wav2vec2-bert",["Wav2Vec2BertForSequenceClassification",dT]],["unispeech",["UniSpeechForSequenceClassification",sT]],["unispeech-sat",["UniSpeechSatForSequenceClassification",iT]],["wavlm",["WavLMForSequenceClassification",gT]],["hubert",["HubertForSequenceClassification",mT]],["audio-spectrogram-transformer",["ASTForAudioClassification",Zy]]]),W$=new Map([["wavlm",["WavLMForXVector",xT]]]),G$=new Map([["unispeech-sat",["UniSpeechSatForAudioFrameClassification",lT]],["wavlm",["WavLMForAudioFrameClassification",wT]],["wav2vec2",["Wav2Vec2ForAudioFrameClassification",QE]],["pyannote",["PyAnnoteForAudioFrameClassification",ZE]]]),H$=new Map([["vitmatte",["VitMatteForImageMatting",wM]]]),nC=new Map([["patchtst",["PatchTSTForPrediction",u$]],["patchtsmixer",["PatchTSMixerForPrediction",p$]]]),K$=new Map([["swin2sr",["Swin2SRForImageSuperResolution",rE]]]),q$=new Map([["dpt",["DPTForDepthEstimation",sE]],["depth_anything",["DepthAnythingForDepthEstimation",aE]],["glpn",["GLPNForDepthEstimation",wE]],["sapiens",["SapiensForDepthEstimation",lE]],["depth_pro",["DepthProForDepthEstimation",dE]],["metric3d",["Metric3DForDepthEstimation",fE]],["metric3dv2",["Metric3Dv2ForDepthEstimation",hE]]]),Q$=new Map([["sapiens",["SapiensForNormalEstimation",cE]]]),X$=new Map([["vitpose",["VitPoseForPoseEstimation",iM]]]),Y$=new Map([["clip",["CLIPVisionModelWithProjection",yy]],["siglip",["SiglipVisionModel",by]],["jina_clip",["JinaCLIPVisionModel",Ty]]]),J$=[[YP,St.EncoderOnly],[JP,St.EncoderDecoder],[eC,St.DecoderOnly],[ZP,St.AutoEncoder],[S$,St.EncoderOnly],[A$,St.EncoderOnly],[Y1,St.Seq2Seq],[X1,St.Seq2Seq],[J1,St.DecoderOnly],[tC,St.MultiModality],[I$,St.EncoderOnly],[R$,St.EncoderOnly],[Z1,St.Vision2Seq],[O$,St.ImageTextToText],[j$,St.AudioTextToText],[N$,St.EncoderOnly],[ry,St.EncoderOnly],[z$,St.EncoderOnly],[D$,St.EncoderOnly],[H$,St.EncoderOnly],[nC,St.EncoderOnly],[K$,St.EncoderOnly],[q$,St.EncoderOnly],[Q$,St.EncoderOnly],[X$,St.EncoderOnly],[L$,St.EncoderOnly],[F$,St.EncoderOnly],[B$,St.MaskGeneration],[U$,St.EncoderOnly],[V$,St.EncoderOnly],[P$,St.Seq2Seq],[C$,St.EncoderOnly],[W$,St.EncoderOnly],[G$,St.EncoderOnly],[Y$,St.EncoderOnly]];for(const[Ht,ar]of J$)for(const[mn,Fo]of Ht.values())Lt.set(mn,ar),Bt.set(Fo,mn),Gt.set(mn,Fo);const sC=[["MusicgenForConditionalGeneration",H1,St.Musicgen],["Phi3VForCausalLM",xy,St.Phi3V],["CLIPTextModelWithProjection",wy,St.EncoderOnly],["SiglipTextModel",fv,St.EncoderOnly],["JinaCLIPTextModel",Ey,St.EncoderOnly],["ClapTextModelWithProjection",NT,St.EncoderOnly],["ClapAudioModelWithProjection",LT,St.EncoderOnly],["DacEncoderModel",M$,St.EncoderOnly],["DacDecoderModel",E$,St.EncoderOnly],["MimiEncoderModel",x$,St.EncoderOnly],["MimiDecoderModel",w$,St.EncoderOnly],["SnacEncoderModel",k$,St.EncoderOnly],["SnacDecoderModel",$$,St.EncoderOnly],["Gemma3nForConditionalGeneration",gy,St.ImageAudioTextToText]];for(const[Ht,ar,mn]of sC)Lt.set(Ht,mn),Bt.set(ar,Ht),Gt.set(Ht,ar);const Z$=new Map([["modnet",ry],["birefnet",ry],["isnet",ry],["ben",ry]]);for(const[Ht,ar]of Z$.entries())ar.set(Ht,["PreTrainedModel",mr]),Lt.set(Ht,St.EncoderOnly),Bt.set(mr,Ht),Gt.set(Ht,mr);class e0 extends b_{}Oo(e0,"MODEL_CLASS_MAPPINGS",J$.map(ar=>ar[0])),Oo(e0,"BASE_IF_FAIL",!0);class eP extends b_{}Oo(eP,"MODEL_CLASS_MAPPINGS",[S$]);class tP extends b_{}Oo(tP,"MODEL_CLASS_MAPPINGS",[A$]);class rP extends b_{}Oo(rP,"MODEL_CLASS_MAPPINGS",[Y1]);class nP extends b_{}Oo(nP,"MODEL_CLASS_MAPPINGS",[X1]);class sP extends b_{}Oo(sP,"MODEL_CLASS_MAPPINGS",[P$]);class oP extends b_{}Oo(oP,"MODEL_CLASS_MAPPINGS",[C$]);class aP extends b_{}Oo(aP,"MODEL_CLASS_MAPPINGS",[J1]);class iP extends b_{}Oo(iP,"MODEL_CLASS_MAPPINGS",[I$]);class lP extends b_{}Oo(lP,"MODEL_CLASS_MAPPINGS",[R$]);class cP extends b_{}Oo(cP,"MODEL_CLASS_MAPPINGS",[Z1]);class uP extends b_{}Oo(uP,"MODEL_CLASS_MAPPINGS",[N$]);class dP extends b_{}Oo(dP,"MODEL_CLASS_MAPPINGS",[ry]);class pP extends b_{}Oo(pP,"MODEL_CLASS_MAPPINGS",[D$]);class fP extends b_{}Oo(fP,"MODEL_CLASS_MAPPINGS",[z$]);class mP extends b_{}Oo(mP,"MODEL_CLASS_MAPPINGS",[L$]);class hP extends b_{}Oo(hP,"MODEL_CLASS_MAPPINGS",[F$]);class _P extends b_{}Oo(_P,"MODEL_CLASS_MAPPINGS",[B$]);class gP extends b_{}Oo(gP,"MODEL_CLASS_MAPPINGS",[U$]);class xP extends b_{}Oo(xP,"MODEL_CLASS_MAPPINGS",[V$]);class wP extends b_{}Oo(wP,"MODEL_CLASS_MAPPINGS",[W$]);class yP extends b_{}Oo(yP,"MODEL_CLASS_MAPPINGS",[G$]);class vP extends b_{}Oo(vP,"MODEL_CLASS_MAPPINGS",[rC]);class bP extends b_{}Oo(bP,"MODEL_CLASS_MAPPINGS",[H$]);class MP extends b_{}Oo(MP,"MODEL_CLASS_MAPPINGS",[K$]);class EP extends b_{}Oo(EP,"MODEL_CLASS_MAPPINGS",[q$]);class TP extends b_{}Oo(TP,"MODEL_CLASS_MAPPINGS",[Q$]);class kP extends b_{}Oo(kP,"MODEL_CLASS_MAPPINGS",[X$]);class $P extends b_{}Oo($P,"MODEL_CLASS_MAPPINGS",[Y$]);class PP extends b_{}Oo(PP,"MODEL_CLASS_MAPPINGS",[O$]);class CP extends b_{}Oo(CP,"MODEL_CLASS_MAPPINGS",[j$]);class oC extends Do{constructor({logits:ar,past_key_values:mn,encoder_outputs:Fo,decoder_attentions:Xo=null,cross_attentions:Ko=null}){super(),this.logits=ar,this.past_key_values=mn,this.encoder_outputs=Fo,this.decoder_attentions=Xo,this.cross_attentions=Ko}}class c_ extends Do{constructor({logits:ar,...mn}){super(),this.logits=ar;const Fo=Object.values(mn);Fo.length>0&&(this.attentions=Fo)}}class SP extends Do{constructor({logits:ar,embeddings:mn}){super(),this.logits=ar,this.embeddings=mn}}class ox extends Do{constructor({logits:ar}){super(),this.logits=ar}}class fx extends Do{constructor({logits:ar}){super(),this.logits=ar}}class gx extends Do{constructor({start_logits:ar,end_logits:mn}){super(),this.start_logits=ar,this.end_logits=mn}}class fw extends Do{constructor({logits:ar}){super(),this.logits=ar}}class aC extends Do{constructor({logits:ar,past_key_values:mn}){super(),this.logits=ar,this.past_key_values=mn}}class AP extends Do{constructor({alphas:ar}){super(),this.alphas=ar}}class IP extends Do{constructor({waveform:ar,spectrogram:mn}){super(),this.waveform=ar,this.spectrogram=mn}}},"./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js":(e,s,i)=>{i.r(s),i.d(s,{ASTFeatureExtractor:()=>h});var c=i("./src/base/feature_extraction_utils.js");i("./src/utils/tensor.js");var d=i("./src/utils/audio.js");class h extends c.FeatureExtractor{constructor(g){super(g);const $=this.config.sampling_rate,_e=(0,d.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor($/2),$,null,"kaldi",!0);this.mel_filters=_e,this.window=(0,d.window_function)(400,"hann",{periodic:!1}),this.mean=this.config.mean,this.std=this.config.std}async _extract_fbank_features(g,$){return(0,d.spectrogram)(g,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:$,transpose:!0})}async _call(g){(0,c.validate_audio_inputs)(g,"ASTFeatureExtractor");const $=await this._extract_fbank_features(g,this.config.max_length);if(this.config.do_normalize){const _e=this.std*2,lt=$.data;for(let at=0;at<lt.length;++at)lt[at]=(lt[at]-this.mean)/_e}return{input_values:$.unsqueeze_(0)}}}},"./src/models/auto/feature_extraction_auto.js":(e,s,i)=>{i.r(s),i.d(s,{AutoFeatureExtractor:()=>_});var c=i("./src/utils/constants.js"),d=i("./src/utils/hub.js");i("./src/base/feature_extraction_utils.js");var h=i("./src/models/feature_extractors.js");class _{static async from_pretrained($,_e={}){const lt=await(0,d.getModelJSON)($,c.FEATURE_EXTRACTOR_NAME,!0,_e),at=lt.feature_extractor_type,it=h[at];if(!it)throw new Error(`Unknown feature_extractor_type: '${at}'. Please report this at ${c.GITHUB_ISSUE_URL}.`);return new it(lt)}}},"./src/models/auto/image_processing_auto.js":(e,s,i)=>{i.r(s),i.d(s,{AutoImageProcessor:()=>g});var c=i("./src/utils/constants.js"),d=i("./src/utils/hub.js"),h=i("./src/base/image_processors_utils.js"),_=i("./src/models/image_processors.js");class g{static async from_pretrained(_e,lt={}){const at=await(0,d.getModelJSON)(_e,c.IMAGE_PROCESSOR_NAME,!0,lt),it=at.image_processor_type??at.feature_extractor_type;let ct=_[it==null?void 0:it.replace(/Fast$/,"")];return ct||(it!==void 0&&console.warn(`Image processor type '${it}' not found, assuming base ImageProcessor. Please report this at ${c.GITHUB_ISSUE_URL}.`),ct=h.ImageProcessor),new ct(at)}}},"./src/models/auto/processing_auto.js":(e,s,i)=>{i.r(s),i.d(s,{AutoProcessor:()=>_e});var c=i("./src/utils/constants.js"),d=i("./src/utils/hub.js"),h=i("./src/base/processing_utils.js"),_=i("./src/models/processors.js"),g=i("./src/models/image_processors.js"),$=i("./src/models/feature_extractors.js");class _e{static async from_pretrained(at,it={}){const ct=await(0,d.getModelJSON)(at,c.IMAGE_PROCESSOR_NAME,!0,it),{image_processor_type:mt,feature_extractor_type:pt,processor_class:zt}=ct;if(zt&&_[zt])return _[zt].from_pretrained(at,it);if(!mt&&!pt)throw new Error("No `image_processor_type` or `feature_extractor_type` found in the config.");const dt={};if(mt){const kt=g[mt.replace(/Fast$/,"")];if(!kt)throw new Error(`Unknown image_processor_type: '${mt}'.`);dt.image_processor=new kt(ct)}if(pt){const kt=g[pt];if(kt)dt.image_processor=new kt(ct);else{const St=$[pt];if(!St)throw new Error(`Unknown feature_extractor_type: '${pt}'.`);dt.feature_extractor=new St(ct)}}const ft={};return new h.Processor(ft,dt,null)}}},"./src/models/beit/image_processing_beit.js":(e,s,i)=>{i.r(s),i.d(s,{BeitFeatureExtractor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{}},"./src/models/bit/image_processing_bit.js":(e,s,i)=>{i.r(s),i.d(s,{BitImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{}},"./src/models/chinese_clip/image_processing_chinese_clip.js":(e,s,i)=>{i.r(s),i.d(s,{ChineseCLIPFeatureExtractor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{}},"./src/models/clap/feature_extraction_clap.js":(e,s,i)=>{i.r(s),i.d(s,{ClapFeatureExtractor:()=>h});var c=i("./src/base/feature_extraction_utils.js");i("./src/utils/tensor.js");var d=i("./src/utils/audio.js");class h extends c.FeatureExtractor{constructor(g){super(g),this.mel_filters=(0,d.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,null,"htk"),this.mel_filters_slaney=(0,d.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,"slaney","slaney"),this.window=(0,d.window_function)(this.config.fft_window_size,"hann")}async _get_input_mel(g,$,_e,lt){let at;const it=g.length-$;if(it>0)if(_e==="rand_trunc"){const ct=Math.floor(Math.random()*(it+1));g=g.subarray(ct,ct+$),at=await this._extract_fbank_features(g,this.mel_filters_slaney,this.config.nb_max_samples)}else throw new Error(`Truncation strategy "${_e}" not implemented`);else{if(it<0){let ct=new Float64Array($);if(ct.set(g),lt==="repeat")for(let mt=g.length;mt<$;mt+=g.length)ct.set(g.subarray(0,Math.min(g.length,$-mt)),mt);else if(lt==="repeatpad")for(let mt=g.length;mt<-it;mt+=g.length)ct.set(g,mt);g=ct}if(_e==="fusion")throw new Error(`Truncation strategy "${_e}" not implemented`);at=await this._extract_fbank_features(g,this.mel_filters_slaney,this.config.nb_max_samples)}return at.unsqueeze_(0)}async _extract_fbank_features(g,$,_e=null){return(0,d.spectrogram)(g,this.window,this.config.fft_window_size,this.config.hop_length,{power:2,mel_filters:$,log_mel:"dB",max_num_frames:_e,do_pad:!1,transpose:!0})}async _call(g,{max_length:$=null}={}){return(0,c.validate_audio_inputs)(g,"ClapFeatureExtractor"),{input_features:(await this._get_input_mel(g,$??this.config.nb_max_samples,this.config.truncation,this.config.padding)).unsqueeze_(0)}}}},"./src/models/clip/image_processing_clip.js":(e,s,i)=>{i.r(s),i.d(s,{CLIPFeatureExtractor:()=>h,CLIPImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{}class h extends d{}},"./src/models/convnext/image_processing_convnext.js":(e,s,i)=>{i.r(s),i.d(s,{ConvNextFeatureExtractor:()=>h,ConvNextImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{constructor(g){super(g),this.crop_pct=this.config.crop_pct??224/256}async resize(g){var _e;const $=(_e=this.size)==null?void 0:_e.shortest_edge;if($===void 0)throw new Error("Size dictionary must contain 'shortest_edge' key.");if($<384){const lt=Math.floor($/this.crop_pct),[at,it]=this.get_resize_output_image_size(g,{shortest_edge:lt});g=await g.resize(at,it,{resample:this.resample}),g=await g.center_crop($,$)}else g=await g.resize($,$,{resample:this.resample});return g}}class h extends d{}},"./src/models/dac/feature_extraction_dac.js":(e,s,i)=>{i.r(s),i.d(s,{DacFeatureExtractor:()=>d});var c=i("./src/models/encodec/feature_extraction_encodec.js");class d extends c.EncodecFeatureExtractor{}},"./src/models/deit/image_processing_deit.js":(e,s,i)=>{i.r(s),i.d(s,{DeiTFeatureExtractor:()=>h,DeiTImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{}class h extends d{}},"./src/models/detr/image_processing_detr.js":(e,s,i)=>{i.r(s),i.d(s,{DetrFeatureExtractor:()=>_,DetrImageProcessor:()=>h});var c=i("./src/base/image_processors_utils.js"),d=i("./src/utils/tensor.js");class h extends c.ImageProcessor{async _call($){const _e=await super._call($),lt=[_e.pixel_values.dims[0],64,64],at=(0,d.full)(lt,1n);return{..._e,pixel_mask:at}}post_process_object_detection(...$){return(0,c.post_process_object_detection)(...$)}post_process_panoptic_segmentation(...$){return(0,c.post_process_panoptic_segmentation)(...$)}post_process_instance_segmentation(...$){return(0,c.post_process_instance_segmentation)(...$)}}class _ extends h{}},"./src/models/dinov3_vit/image_processing_dinov3_vit.js":(e,s,i)=>{i.r(s),i.d(s,{DINOv3ViTImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{}},"./src/models/donut/image_processing_donut.js":(e,s,i)=>{i.r(s),i.d(s,{DonutFeatureExtractor:()=>h,DonutImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{pad_image(g,$,_e,lt={}){const[at,it,ct]=$;let mt=this.image_mean;Array.isArray(this.image_mean)||(mt=new Array(ct).fill(mt));let pt=this.image_std;Array.isArray(pt)||(pt=new Array(ct).fill(mt));const zt=mt.map((dt,ft)=>-dt/pt[ft]);return super.pad_image(g,$,_e,{center:!0,constant_values:zt,...lt})}}class h extends d{}},"./src/models/dpt/image_processing_dpt.js":(e,s,i)=>{i.r(s),i.d(s,{DPTFeatureExtractor:()=>h,DPTImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{}class h extends d{}},"./src/models/efficientnet/image_processing_efficientnet.js":(e,s,i)=>{i.r(s),i.d(s,{EfficientNetImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{constructor(_){super(_),this.include_top=this.config.include_top??!0,this.include_top&&(this.image_std=this.image_std.map(g=>g*g))}}},"./src/models/encodec/feature_extraction_encodec.js":(e,s,i)=>{i.r(s),i.d(s,{EncodecFeatureExtractor:()=>h});var c=i("./src/base/feature_extraction_utils.js"),d=i("./src/utils/tensor.js");class h extends c.FeatureExtractor{async _call(g){(0,c.validate_audio_inputs)(g,"EncodecFeatureExtractor"),g instanceof Float64Array&&(g=new Float32Array(g));const $=this.config.feature_size;if(g.length%$!==0)throw new Error(`The length of the audio data must be a multiple of the number of channels (${$}).`);const _e=[1,$,g.length/$];return{input_values:new d.Tensor("float32",g,_e)}}}},"./src/models/feature_extractors.js":(e,s,i)=>{i.r(s),i.d(s,{ASTFeatureExtractor:()=>c.ASTFeatureExtractor,ClapFeatureExtractor:()=>h.ClapFeatureExtractor,DacFeatureExtractor:()=>_.DacFeatureExtractor,EncodecFeatureExtractor:()=>d.EncodecFeatureExtractor,Gemma3nAudioFeatureExtractor:()=>g.Gemma3nAudioFeatureExtractor,ImageFeatureExtractor:()=>dt.ImageProcessor,MoonshineFeatureExtractor:()=>$.MoonshineFeatureExtractor,ParakeetFeatureExtractor:()=>_e.ParakeetFeatureExtractor,PyAnnoteFeatureExtractor:()=>lt.PyAnnoteFeatureExtractor,SeamlessM4TFeatureExtractor:()=>at.SeamlessM4TFeatureExtractor,SnacFeatureExtractor:()=>it.SnacFeatureExtractor,SpeechT5FeatureExtractor:()=>ct.SpeechT5FeatureExtractor,Wav2Vec2FeatureExtractor:()=>mt.Wav2Vec2FeatureExtractor,WeSpeakerFeatureExtractor:()=>pt.WeSpeakerFeatureExtractor,WhisperFeatureExtractor:()=>zt.WhisperFeatureExtractor});var c=i("./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js"),d=i("./src/models/encodec/feature_extraction_encodec.js"),h=i("./src/models/clap/feature_extraction_clap.js"),_=i("./src/models/dac/feature_extraction_dac.js"),g=i("./src/models/gemma3n/feature_extraction_gemma3n.js"),$=i("./src/models/moonshine/feature_extraction_moonshine.js"),_e=i("./src/models/parakeet/feature_extraction_parakeet.js"),lt=i("./src/models/pyannote/feature_extraction_pyannote.js"),at=i("./src/models/seamless_m4t/feature_extraction_seamless_m4t.js"),it=i("./src/models/snac/feature_extraction_snac.js"),ct=i("./src/models/speecht5/feature_extraction_speecht5.js"),mt=i("./src/models/wav2vec2/feature_extraction_wav2vec2.js"),pt=i("./src/models/wespeaker/feature_extraction_wespeaker.js"),zt=i("./src/models/whisper/feature_extraction_whisper.js"),dt=i("./src/base/image_processors_utils.js")},"./src/models/florence2/processing_florence2.js":(e,s,i)=>{i.r(s),i.d(s,{Florence2Processor:()=>_});var c=i("./src/base/processing_utils.js"),d=i("./src/models/auto/image_processing_auto.js"),h=i("./src/tokenizers.js");class _ extends c.Processor{constructor($,_e,lt){super($,_e,lt);const{tasks_answer_post_processing_type:at,task_prompts_without_inputs:it,task_prompts_with_input:ct}=this.image_processor.config;this.tasks_answer_post_processing_type=new Map(Object.entries(at??{})),this.task_prompts_without_inputs=new Map(Object.entries(it??{})),this.task_prompts_with_input=new Map(Object.entries(ct??{})),this.regexes={quad_boxes:/(.+?)<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm,bboxes:/([^<]+)?<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm},this.size_per_bin=1e3}construct_prompts($){typeof $=="string"&&($=[$]);const _e=[];for(const lt of $)if(this.task_prompts_without_inputs.has(lt))_e.push(this.task_prompts_without_inputs.get(lt));else{for(const[at,it]of this.task_prompts_with_input)if(lt.includes(at)){_e.push(it.replaceAll("{input}",lt).replaceAll(at,""));break}_e.length!==$.length&&_e.push(lt)}return _e}post_process_generation($,_e,lt){const at=this.tasks_answer_post_processing_type.get(_e)??"pure_text";$=$.replaceAll("<s>","").replaceAll("</s>","");let it;switch(at){case"pure_text":it=$;break;case"description_with_bboxes":case"bboxes":case"phrase_grounding":case"ocr":const ct=at==="ocr"?"quad_boxes":"bboxes",mt=$.matchAll(this.regexes[ct]),pt=[],zt=[];for(const[dt,ft,...kt]of mt)pt.push(ft?ft.trim():pt.at(-1)??""),zt.push(kt.map((St,Lt)=>(Number(St)+.5)/this.size_per_bin*lt[Lt%2]));it={labels:pt,[ct]:zt};break;default:throw new Error(`Task "${_e}" (of type "${at}") not yet implemented.`)}return{[_e]:it}}async _call($,_e=null,lt={}){if(!$&&!_e)throw new Error("Either text or images must be provided");const at=await this.image_processor($,lt),it=_e?this.tokenizer(this.construct_prompts(_e),lt):{};return{...at,...it}}}Oo(_,"tokenizer_class",h.AutoTokenizer),Oo(_,"image_processor_class",d.AutoImageProcessor)},"./src/models/gemma3n/feature_extraction_gemma3n.js":(e,s,i)=>{i.r(s),i.d(s,{Gemma3nAudioFeatureExtractor:()=>_});var c=i("./src/base/feature_extraction_utils.js"),d=i("./src/utils/tensor.js"),h=i("./src/utils/audio.js");class _ extends c.FeatureExtractor{constructor($){super($);const{fft_length:_e,feature_size:lt,min_frequency:at,max_frequency:it,sampling_rate:ct,frame_length:mt}=this.config,pt=(0,h.mel_filter_bank)(Math.floor(1+_e/2),lt,at,it,ct,null,"htk",!1);this.mel_filters=pt,this.window=(0,h.window_function)(mt,"hann")}async _extract_fbank_features($,_e){return(0,h.spectrogram)($,this.window,this.config.frame_length,this.config.hop_length,{fft_length:this.config.fft_length,center:!1,onesided:!0,preemphasis:this.config.preemphasis,preemphasis_htk_flavor:this.config.preemphasis_htk_flavor,mel_filters:this.mel_filters,log_mel:"log",mel_floor:this.config.mel_floor,remove_dc_offset:!1,transpose:!0})}async _call($,{max_length:_e=48e4,truncation:lt=!0,padding:at=!0,pad_to_multiple_of:it=128}={}){if((0,c.validate_audio_inputs)($,"Gemma3nAudioFeatureExtractor"),lt&&$.length>_e&&($=$.slice(0,_e)),at&&$.length%it!==0){const pt=it-$.length%it,zt=new Float64Array($.length+pt);zt.set($),this.config.padding_value!==0&&zt.fill(this.config.padding_value,$.length),$=zt}const ct=await this._extract_fbank_features($,this.config.max_length),mt=(0,d.full)([1,ct.dims[0]],!0);return{input_features:ct.unsqueeze_(0),input_features_mask:mt}}}},"./src/models/gemma3n/processing_gemma3n.js":(e,s,i)=>{i.r(s),i.d(s,{Gemma3nProcessor:()=>g});var c=i("./src/base/processing_utils.js"),d=i("./src/models/auto/image_processing_auto.js"),h=i("./src/models/auto/feature_extraction_auto.js"),_=i("./src/tokenizers.js");i("./src/utils/image.js"),i("./src/utils/audio.js");class g extends c.Processor{constructor(_e,lt,at){super(_e,lt,at),this.audio_seq_length=this.config.audio_seq_length,this.image_seq_length=this.config.image_seq_length;const{audio_token_id:it,boa_token:ct,audio_token:mt,eoa_token:pt,image_token_id:zt,boi_token:dt,image_token:ft,eoi_token:kt}=this.tokenizer.config;this.audio_token_id=it,this.boa_token=ct,this.audio_token=mt;const St=mt.repeat(this.audio_seq_length);this.full_audio_sequence=`

${ct}${St}${pt}

`,this.image_token_id=zt,this.boi_token=dt,this.image_token=ft;const Lt=ft.repeat(this.image_seq_length);this.full_image_sequence=`

${dt}${Lt}${kt}

`}async _call(_e,lt=null,at=null,it={}){typeof _e=="string"&&(_e=[_e]);let ct;at&&(ct=await this.feature_extractor(at,it),_e=_e.map(zt=>zt.replaceAll(this.audio_token,this.full_audio_sequence)));let mt;return lt&&(mt=await this.image_processor(lt,it),_e=_e.map(zt=>zt.replaceAll(this.image_token,this.full_image_sequence))),{...this.tokenizer(_e,it),...mt,...ct}}}Oo(g,"image_processor_class",d.AutoImageProcessor),Oo(g,"feature_extractor_class",h.AutoFeatureExtractor),Oo(g,"tokenizer_class",_.AutoTokenizer),Oo(g,"uses_processor_config",!0),Oo(g,"uses_chat_template_file",!0)},"./src/models/glpn/image_processing_glpn.js":(e,s,i)=>{i.r(s),i.d(s,{GLPNFeatureExtractor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{}},"./src/models/grounding_dino/image_processing_grounding_dino.js":(e,s,i)=>{i.r(s),i.d(s,{GroundingDinoImageProcessor:()=>h});var c=i("./src/base/image_processors_utils.js"),d=i("./src/utils/tensor.js");class h extends c.ImageProcessor{async _call(g){const $=await super._call(g),_e=$.pixel_values.dims,lt=(0,d.ones)([_e[0],_e[2],_e[3]]);return{...$,pixel_mask:lt}}}},"./src/models/grounding_dino/processing_grounding_dino.js":(e,s,i)=>{i.r(s),i.d(s,{GroundingDinoProcessor:()=>$});var c=i("./src/base/processing_utils.js"),d=i("./src/models/auto/image_processing_auto.js"),h=i("./src/tokenizers.js"),_=i("./src/base/image_processors_utils.js");function g(_e,lt){const it=_e.dims.at(-1)-1,ct=_e.tolist();ct.fill(!1,0,1),ct.fill(!1,it);const mt=lt.tolist();return ct.map((pt,zt)=>pt?zt:null).filter(pt=>pt!==null).map(pt=>mt[pt])}class $ extends c.Processor{async _call(lt,at,it={}){const ct=lt?await this.image_processor(lt,it):{};return{...at?this.tokenizer(at,it):{},...ct}}post_process_grounded_object_detection(lt,at,{box_threshold:it=.25,text_threshold:ct=.25,target_sizes:mt=null}={}){const{logits:pt,pred_boxes:zt}=lt,dt=pt.dims[0];if(mt!==null&&mt.length!==dt)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");const ft=pt.dims.at(1),kt=pt.sigmoid(),St=kt.max(-1).tolist(),Lt=zt.tolist().map(Bt=>Bt.map(nr=>(0,_.center_to_corners_format)(nr))),Gt=[];for(let Bt=0;Bt<dt;++Bt){const nr=mt!==null?mt[Bt]:null;nr!==null&&(Lt[Bt]=Lt[Bt].map(_n=>_n.map((gn,vn)=>gn*nr[(vn+1)%2])));const cr=St[Bt],ur=[],yn=[],hn=[];for(let _n=0;_n<ft;++_n){const gn=cr[_n];if(gn<=it)continue;const vn=Lt[Bt][_n],Tn=kt[Bt][_n];ur.push(gn),hn.push(vn);const kn=g(Tn.gt(ct),at[Bt]);yn.push(kn)}Gt.push({scores:ur,boxes:hn,labels:this.batch_decode(yn)})}return Gt}}Oo($,"tokenizer_class",h.AutoTokenizer),Oo($,"image_processor_class",d.AutoImageProcessor)},"./src/models/idefics3/image_processing_idefics3.js":(e,s,i)=>{i.r(s),i.d(s,{Idefics3ImageProcessor:()=>h});var c=i("./src/base/image_processors_utils.js"),d=i("./src/utils/tensor.js");class h extends c.ImageProcessor{constructor(g){super(g),this.do_image_splitting=g.do_image_splitting??!0,this.max_image_size=g.max_image_size}get_resize_for_vision_encoder(g,$){let[_e,lt]=g.dims.slice(-2);const at=lt/_e;return lt>=_e?(lt=Math.ceil(lt/$)*$,_e=Math.floor(lt/at),_e=Math.ceil(_e/$)*$):(_e=Math.ceil(_e/$)*$,lt=Math.floor(_e*at),lt=Math.ceil(lt/$)*$),{height:_e,width:lt}}async _call(g,{do_image_splitting:$=null,return_row_col_info:_e=!1}={}){let lt;if(!Array.isArray(g))lt=[[g]];else{if(g.length===0||!g[0])throw new Error("No images provided.");Array.isArray(g[0])?lt=g:lt=[g]}let at=[],it=[],ct=[];const mt=[],pt=[];for(const Bt of lt){let nr=await Promise.all(Bt.map(yn=>this.preprocess(yn)));mt.push(...nr.map(yn=>yn.original_size)),pt.push(...nr.map(yn=>yn.reshaped_input_size)),nr.forEach(yn=>yn.pixel_values.unsqueeze_(0));const{longest_edge:cr}=this.max_image_size;let ur;if($??this.do_image_splitting){let yn=new Array(nr.length),hn=new Array(nr.length);ur=await Promise.all(nr.map(async(_n,gn)=>{const vn=this.get_resize_for_vision_encoder(_n.pixel_values,cr),Tn=await(0,d.interpolate_4d)(_n.pixel_values,{size:[vn.height,vn.width]}),{frames:kn,num_splits_h:bn,num_splits_w:Sn}=await this.split_image(Tn,this.max_image_size);return yn[gn]=bn,hn[gn]=Sn,(0,d.cat)(kn,0)})),it.push(yn),ct.push(hn)}else{const yn=[cr,cr];ur=await Promise.all(nr.map(hn=>(0,d.interpolate_4d)(hn.pixel_values,{size:yn}))),it.push(new Array(nr.length).fill(0)),ct.push(new Array(nr.length).fill(0))}at.push((0,d.cat)(ur,0))}const zt=at.length,[dt,ft,kt,St]=at[0].dims;let Lt,Gt;if(zt===1)Lt=at[0].unsqueeze_(0),Gt=(0,d.full)([zt,dt,kt,St],!0);else{const Bt=Math.max(...at.map(ur=>ur.dims.at(0)));Gt=(0,d.full)([zt,Bt,kt,St],!0);const nr=Gt.data,cr=Bt*kt*St;for(let ur=0;ur<zt;++ur){const yn=at[ur].dims[0];if(yn<Bt){at[ur]=(0,d.cat)([at[ur],(0,d.full)([Bt-yn,ft,kt,St],0)],0);const hn=ur*cr+yn*kt*St,_n=(ur+1)*cr;nr.fill(!1,hn,_n)}}Lt=(0,d.stack)(at,0)}return{pixel_values:Lt,pixel_attention_mask:Gt,original_sizes:mt,reshaped_input_sizes:pt,..._e?{rows:it,cols:ct}:{}}}async split_image(g,{longest_edge:$}){const _e=$,lt=$,at=[],[it,ct]=g.dims.slice(-2);let mt=0,pt=0;if(it>_e||ct>lt){mt=Math.ceil(it/_e),pt=Math.ceil(ct/lt);const zt=Math.ceil(it/mt),dt=Math.ceil(ct/pt);for(let St=0;St<mt;++St)for(let Lt=0;Lt<pt;++Lt){let Gt,Bt,nr,cr;St===mt-1?(Bt=it-zt,cr=it):(Bt=St*zt,cr=(St+1)*zt),Lt===pt-1?(Gt=ct-dt,nr=ct):(Gt=Lt*dt,nr=(Lt+1)*dt);const ur=[Bt,Gt],yn=[cr,nr],hn=await(0,d.slice)(g,ur,yn,[2,3]);at.push(hn)}const ft=_e,kt=lt;(it!==ft||ct!==kt)&&(g=await(0,d.interpolate_4d)(g,{size:[ft,kt]}))}return at.push(g),{frames:at,num_splits_h:mt,num_splits_w:pt}}}},"./src/models/idefics3/processing_idefics3.js":(e,s,i)=>{i.r(s),i.d(s,{Idefics3Processor:()=>lt});var c=i("./src/base/processing_utils.js"),d=i("./src/models/auto/image_processing_auto.js"),h=i("./src/tokenizers.js");i("./src/utils/image.js");var _=i("./src/utils/core.js");function g(at,it,ct,mt,pt,zt){let dt="";for(let ft=0;ft<it;++ft){for(let kt=0;kt<ct;++kt)dt+=mt+`<row_${ft+1}_col_${kt+1}>`+pt.repeat(at);dt+=`
`}return dt+=`
${mt}${zt}`+pt.repeat(at)+`${mt}`,dt}function $(at,it,ct,mt){return`${it}${mt}`+ct.repeat(at)+`${it}`}function _e(at,it,ct,mt,pt,zt){return at===0&&it===0?$(ct,mt,pt,zt):g(ct,at,it,mt,pt,zt)}class lt extends c.Processor{constructor(){super(...arguments);Oo(this,"fake_image_token","<fake_token_around_image>");Oo(this,"image_token","<image>");Oo(this,"global_img_token","<global-img>")}async _call(ct,mt=null,pt={}){pt.return_row_col_info??(pt.return_row_col_info=!0);let zt;mt&&(zt=await this.image_processor(mt,pt)),Array.isArray(ct)||(ct=[ct]);const dt=zt.rows??[new Array(ct.length).fill(0)],ft=zt.cols??[new Array(ct.length).fill(0)],kt=this.config.image_seq_len,St=[],Lt=[];for(let Bt=0;Bt<ct.length;++Bt){const nr=ct[Bt],cr=dt[Bt],ur=ft[Bt];St.push((0,_.count)(nr,this.image_token));const yn=cr.map((gn,vn)=>_e(gn,ur[vn],kt,this.fake_image_token,this.image_token,this.global_img_token)),hn=nr.split(this.image_token);if(hn.length===0)throw new Error("The image token should be present in the text.");let _n=hn[0];for(let gn=0;gn<yn.length;++gn)_n+=yn[gn]+hn[gn+1];Lt.push(_n)}return{...this.tokenizer(Lt),...zt}}}Oo(lt,"image_processor_class",d.AutoImageProcessor),Oo(lt,"tokenizer_class",h.AutoTokenizer),Oo(lt,"uses_processor_config",!0)},"./src/models/image_processors.js":(e,s,i)=>{i.r(s),i.d(s,{BeitFeatureExtractor:()=>c.BeitFeatureExtractor,BitImageProcessor:()=>d.BitImageProcessor,CLIPFeatureExtractor:()=>_.CLIPFeatureExtractor,CLIPImageProcessor:()=>_.CLIPImageProcessor,ChineseCLIPFeatureExtractor:()=>h.ChineseCLIPFeatureExtractor,ConvNextFeatureExtractor:()=>g.ConvNextFeatureExtractor,ConvNextImageProcessor:()=>g.ConvNextImageProcessor,DINOv3ViTImageProcessor:()=>lt.DINOv3ViTImageProcessor,DPTFeatureExtractor:()=>it.DPTFeatureExtractor,DPTImageProcessor:()=>it.DPTImageProcessor,DeiTFeatureExtractor:()=>$.DeiTFeatureExtractor,DeiTImageProcessor:()=>$.DeiTImageProcessor,DetrFeatureExtractor:()=>_e.DetrFeatureExtractor,DetrImageProcessor:()=>_e.DetrImageProcessor,DonutFeatureExtractor:()=>at.DonutFeatureExtractor,DonutImageProcessor:()=>at.DonutImageProcessor,EfficientNetImageProcessor:()=>ct.EfficientNetImageProcessor,GLPNFeatureExtractor:()=>mt.GLPNFeatureExtractor,GroundingDinoImageProcessor:()=>pt.GroundingDinoImageProcessor,Idefics3ImageProcessor:()=>zt.Idefics3ImageProcessor,JinaCLIPImageProcessor:()=>ft.JinaCLIPImageProcessor,LlavaOnevisionImageProcessor:()=>kt.LlavaOnevisionImageProcessor,Mask2FormerImageProcessor:()=>St.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>Lt.MaskFormerFeatureExtractor,MaskFormerImageProcessor:()=>Lt.MaskFormerImageProcessor,MobileNetV1FeatureExtractor:()=>Gt.MobileNetV1FeatureExtractor,MobileNetV1ImageProcessor:()=>Gt.MobileNetV1ImageProcessor,MobileNetV2FeatureExtractor:()=>Bt.MobileNetV2FeatureExtractor,MobileNetV2ImageProcessor:()=>Bt.MobileNetV2ImageProcessor,MobileNetV3FeatureExtractor:()=>nr.MobileNetV3FeatureExtractor,MobileNetV3ImageProcessor:()=>nr.MobileNetV3ImageProcessor,MobileNetV4FeatureExtractor:()=>cr.MobileNetV4FeatureExtractor,MobileNetV4ImageProcessor:()=>cr.MobileNetV4ImageProcessor,MobileViTFeatureExtractor:()=>ur.MobileViTFeatureExtractor,MobileViTImageProcessor:()=>ur.MobileViTImageProcessor,NougatImageProcessor:()=>yn.NougatImageProcessor,OwlViTFeatureExtractor:()=>_n.OwlViTFeatureExtractor,OwlViTImageProcessor:()=>_n.OwlViTImageProcessor,Owlv2ImageProcessor:()=>hn.Owlv2ImageProcessor,Phi3VImageProcessor:()=>gn.Phi3VImageProcessor,PvtImageProcessor:()=>vn.PvtImageProcessor,Qwen2VLImageProcessor:()=>Tn.Qwen2VLImageProcessor,RTDetrImageProcessor:()=>kn.RTDetrImageProcessor,SamImageProcessor:()=>bn.SamImageProcessor,SegformerFeatureExtractor:()=>Sn.SegformerFeatureExtractor,SegformerImageProcessor:()=>Sn.SegformerImageProcessor,SiglipImageProcessor:()=>fn.SiglipImageProcessor,SmolVLMImageProcessor:()=>or.SmolVLMImageProcessor,Swin2SRImageProcessor:()=>lr.Swin2SRImageProcessor,VLMImageProcessor:()=>dt.VLMImageProcessor,ViTFeatureExtractor:()=>pn.ViTFeatureExtractor,ViTImageProcessor:()=>pn.ViTImageProcessor,VitMatteImageProcessor:()=>Cn.VitMatteImageProcessor,VitPoseImageProcessor:()=>Lo.VitPoseImageProcessor,YolosFeatureExtractor:()=>Mo.YolosFeatureExtractor,YolosImageProcessor:()=>Mo.YolosImageProcessor});var c=i("./src/models/beit/image_processing_beit.js"),d=i("./src/models/bit/image_processing_bit.js"),h=i("./src/models/chinese_clip/image_processing_chinese_clip.js"),_=i("./src/models/clip/image_processing_clip.js"),g=i("./src/models/convnext/image_processing_convnext.js"),$=i("./src/models/deit/image_processing_deit.js"),_e=i("./src/models/detr/image_processing_detr.js"),lt=i("./src/models/dinov3_vit/image_processing_dinov3_vit.js"),at=i("./src/models/donut/image_processing_donut.js"),it=i("./src/models/dpt/image_processing_dpt.js"),ct=i("./src/models/efficientnet/image_processing_efficientnet.js"),mt=i("./src/models/glpn/image_processing_glpn.js"),pt=i("./src/models/grounding_dino/image_processing_grounding_dino.js"),zt=i("./src/models/idefics3/image_processing_idefics3.js"),dt=i("./src/models/janus/image_processing_janus.js"),ft=i("./src/models/jina_clip/image_processing_jina_clip.js"),kt=i("./src/models/llava_onevision/image_processing_llava_onevision.js"),St=i("./src/models/mask2former/image_processing_mask2former.js"),Lt=i("./src/models/maskformer/image_processing_maskformer.js"),Gt=i("./src/models/mobilenet_v1/image_processing_mobilenet_v1.js"),Bt=i("./src/models/mobilenet_v2/image_processing_mobilenet_v2.js"),nr=i("./src/models/mobilenet_v3/image_processing_mobilenet_v3.js"),cr=i("./src/models/mobilenet_v4/image_processing_mobilenet_v4.js"),ur=i("./src/models/mobilevit/image_processing_mobilevit.js"),yn=i("./src/models/nougat/image_processing_nougat.js"),hn=i("./src/models/owlv2/image_processing_owlv2.js"),_n=i("./src/models/owlvit/image_processing_owlvit.js"),gn=i("./src/models/phi3_v/image_processing_phi3_v.js"),vn=i("./src/models/pvt/image_processing_pvt.js"),Tn=i("./src/models/qwen2_vl/image_processing_qwen2_vl.js"),kn=i("./src/models/rt_detr/image_processing_rt_detr.js"),bn=i("./src/models/sam/image_processing_sam.js"),Sn=i("./src/models/segformer/image_processing_segformer.js"),fn=i("./src/models/siglip/image_processing_siglip.js"),or=i("./src/models/smolvlm/image_processing_smolvlm.js"),lr=i("./src/models/swin2sr/image_processing_swin2sr.js"),pn=i("./src/models/vit/image_processing_vit.js"),Cn=i("./src/models/vitmatte/image_processing_vitmatte.js"),Lo=i("./src/models/vitpose/image_processing_vitpose.js"),Mo=i("./src/models/yolos/image_processing_yolos.js")},"./src/models/janus/image_processing_janus.js":(e,s,i)=>{i.r(s),i.d(s,{VLMImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{constructor(_){super({do_pad:!0,pad_size:{width:_.image_size,height:_.image_size},..._}),this.constant_values=this.config.background_color.map(g=>g*this.rescale_factor)}pad_image(_,g,$,_e){return super.pad_image(_,g,$,{constant_values:this.constant_values,center:!0,..._e})}}},"./src/models/janus/processing_janus.js":(e,s,i)=>{i.r(s),i.d(s,{VLChatProcessor:()=>_e});var c=i("./src/base/processing_utils.js"),d=i("./src/models/auto/image_processing_auto.js"),h=i("./src/tokenizers.js"),_=i("./src/utils/core.js"),g=i("./src/utils/tensor.js"),$=i("./src/utils/image.js");class _e extends c.Processor{constructor(at,it,ct){super(at,it,ct),this.image_tag=this.config.image_tag,this.image_start_tag=this.config.image_start_tag,this.image_end_tag=this.config.image_end_tag,this.num_image_tokens=this.config.num_image_tokens}async _call(at,{images:it=null,chat_template:ct="default"}={}){it?Array.isArray(it)||(it=[it]):it=await Promise.all(at.filter(ur=>ur.images).flatMap(ur=>ur.images).map(ur=>$.RawImage.read(ur)));const mt=this.tokenizer,pt=mt.apply_chat_template(at,{tokenize:!1,add_generation_prompt:!0,chat_template:ct}),zt=ur=>mt.encode(ur,{add_special_tokens:!1}),dt=pt.split(this.image_tag),ft=dt.length-1;if(it.length!==ft)throw new Error(`Number of images provided (${it.length}) does not match number of "${this.image_tag}" image tags (${ft})`);const[kt,St,Lt]=mt.model.convert_tokens_to_ids([this.image_tag,this.image_start_tag,this.image_end_tag]);let Gt=zt(dt[0]),Bt=new Array(Gt.length).fill(!1);for(let ur=1;ur<dt.length;++ur){const yn=new Array(this.num_image_tokens).fill(kt),hn=zt(dt[ur]);Gt=(0,_.mergeArrays)(Gt,[St],yn,[Lt],hn);const _n=new Array(this.num_image_tokens).fill(!0);Bt=(0,_.mergeArrays)(Bt,[!1],_n,[!1],new Array(hn.length).fill(!1))}const nr=[1,Gt.length],cr={input_ids:new g.Tensor("int64",Gt,nr),attention_mask:new g.Tensor("int64",new Array(Gt.length).fill(1),nr),images_seq_mask:new g.Tensor("bool",Bt,nr),images_emb_mask:new g.Tensor("bool",new Array(ft*this.num_image_tokens).fill(!0),[1,ft,this.num_image_tokens])};if(it&&it.length>0){const ur=await this.image_processor(it);return ur.pixel_values.unsqueeze_(0),{...cr,...ur}}return cr}}Oo(_e,"image_processor_class",d.AutoImageProcessor),Oo(_e,"tokenizer_class",h.AutoTokenizer),Oo(_e,"uses_processor_config",!0)},"./src/models/jina_clip/image_processing_jina_clip.js":(e,s,i)=>{i.r(s),i.d(s,{JinaCLIPImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{constructor(_){const{resize_mode:g,fill_color:$,interpolation:_e,size:lt,...at}=_,it=g==="squash"?{width:lt,height:lt}:g==="shortest"?{shortest_edge:lt}:{longest_edge:lt},ct=_e==="bicubic"?3:2;super({...at,size:it,resample:ct,do_center_crop:!0,crop_size:lt,do_normalize:!0})}}},"./src/models/jina_clip/processing_jina_clip.js":(e,s,i)=>{i.r(s),i.d(s,{JinaCLIPProcessor:()=>_});var c=i("./src/base/processing_utils.js"),d=i("./src/models/auto/image_processing_auto.js"),h=i("./src/tokenizers.js");class _ extends c.Processor{async _call($=null,_e=null,lt={}){if(!$&&!_e)throw new Error("Either text or images must be provided");const at=$?this.tokenizer($,lt):{},it=_e?await this.image_processor(_e,lt):{};return{...at,...it}}}Oo(_,"tokenizer_class",h.AutoTokenizer),Oo(_,"image_processor_class",d.AutoImageProcessor)},"./src/models/llava/processing_llava.js":(e,s,i)=>{i.r(s),i.d(s,{LlavaProcessor:()=>_});var c=i("./src/base/processing_utils.js"),d=i("./src/models/auto/image_processing_auto.js"),h=i("./src/tokenizers.js");class _ extends c.Processor{async _call($,_e=null,lt={}){const at=await this.image_processor($,lt);if(_e){const[ct,mt]=at.pixel_values.dims.slice(-2),{image_token:pt,patch_size:zt,num_additional_image_tokens:dt}=this.config,ft=Math.floor(ct/zt)*Math.floor(mt/zt)+dt;_e=structuredClone(_e),Array.isArray(_e)||(_e=[_e]);for(let kt=0;kt<_e.length;++kt)_e[kt]=_e[kt].replace(pt,pt.repeat(ft))}const it=_e?this.tokenizer(_e,lt):{};return{...at,...it}}}Oo(_,"tokenizer_class",h.AutoTokenizer),Oo(_,"image_processor_class",d.AutoImageProcessor),Oo(_,"uses_processor_config",!0)},"./src/models/llava_onevision/image_processing_llava_onevision.js":(e,s,i)=>{i.r(s),i.d(s,{LlavaOnevisionImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{}},"./src/models/mask2former/image_processing_mask2former.js":(e,s,i)=>{i.r(s),i.d(s,{Mask2FormerImageProcessor:()=>d});var c=i("./src/models/maskformer/image_processing_maskformer.js");class d extends c.MaskFormerImageProcessor{}},"./src/models/maskformer/image_processing_maskformer.js":(e,s,i)=>{i.r(s),i.d(s,{MaskFormerFeatureExtractor:()=>h,MaskFormerImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{post_process_panoptic_segmentation(...g){return(0,c.post_process_panoptic_segmentation)(...g)}post_process_instance_segmentation(...g){return(0,c.post_process_instance_segmentation)(...g)}}class h extends d{}},"./src/models/mgp_str/processing_mgp_str.js":(e,s,i)=>{i.r(s),i.d(s,{MgpstrProcessor:()=>$});var c=i("./src/base/processing_utils.js"),d=i("./src/models/auto/image_processing_auto.js"),h=i("./src/tokenizers.js"),_=i("./src/utils/maths.js");const g={char:["char_decode",1],bpe:["bpe_decode",2],wp:["wp_decode",102]};class $ extends c.Processor{get char_tokenizer(){return this.components.char_tokenizer}get bpe_tokenizer(){return this.components.bpe_tokenizer}get wp_tokenizer(){return this.components.wp_tokenizer}_decode_helper(lt,at){if(!g.hasOwnProperty(at))throw new Error(`Format ${at} is not supported.`);const[it,ct]=g[at],mt=this[it].bind(this),[pt,zt]=lt.dims,dt=[],ft=[],kt=lt.tolist();for(let Lt=0;Lt<pt;++Lt){const Gt=kt[Lt],Bt=[],nr=[];for(let ur=1;ur<zt;++ur){const[yn,hn]=(0,_.max)((0,_.softmax)(Gt[ur]));if(nr.push(yn),hn==ct)break;Bt.push(hn)}const cr=nr.length>0?nr.reduce((ur,yn)=>ur*yn,1):0;ft.push(Bt),dt.push(cr)}return[mt(ft),dt]}char_decode(lt){return this.char_tokenizer.batch_decode(lt).map(at=>at.replaceAll(" ",""))}bpe_decode(lt){return this.bpe_tokenizer.batch_decode(lt)}wp_decode(lt){return this.wp_tokenizer.batch_decode(lt).map(at=>at.replaceAll(" ",""))}batch_decode([lt,at,it]){const[ct,mt]=this._decode_helper(lt,"char"),[pt,zt]=this._decode_helper(at,"bpe"),[dt,ft]=this._decode_helper(it,"wp"),kt=[],St=[];for(let Lt=0;Lt<ct.length;++Lt){const[Gt,Bt]=(0,_.max)([mt[Lt],zt[Lt],ft[Lt]]);kt.push([ct[Lt],pt[Lt],dt[Lt]][Bt]),St.push(Gt)}return{generated_text:kt,scores:St,char_preds:ct,bpe_preds:pt,wp_preds:dt}}static async from_pretrained(...lt){const at=await super.from_pretrained(...lt),it=await h.AutoTokenizer.from_pretrained("Xenova/gpt2"),ct=await h.AutoTokenizer.from_pretrained("Xenova/bert-base-uncased");return at.components={image_processor:at.image_processor,char_tokenizer:at.tokenizer,bpe_tokenizer:it,wp_tokenizer:ct},at}async _call(lt,at=null){const it=await this.image_processor(lt);return at&&(it.labels=this.tokenizer(at).input_ids),it}}Oo($,"tokenizer_class",h.AutoTokenizer),Oo($,"image_processor_class",d.AutoImageProcessor)},"./src/models/mobilenet_v1/image_processing_mobilenet_v1.js":(e,s,i)=>{i.r(s),i.d(s,{MobileNetV1FeatureExtractor:()=>h,MobileNetV1ImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{}class h extends d{}},"./src/models/mobilenet_v2/image_processing_mobilenet_v2.js":(e,s,i)=>{i.r(s),i.d(s,{MobileNetV2FeatureExtractor:()=>h,MobileNetV2ImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{}class h extends d{}},"./src/models/mobilenet_v3/image_processing_mobilenet_v3.js":(e,s,i)=>{i.r(s),i.d(s,{MobileNetV3FeatureExtractor:()=>h,MobileNetV3ImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{}class h extends d{}},"./src/models/mobilenet_v4/image_processing_mobilenet_v4.js":(e,s,i)=>{i.r(s),i.d(s,{MobileNetV4FeatureExtractor:()=>h,MobileNetV4ImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{}class h extends d{}},"./src/models/mobilevit/image_processing_mobilevit.js":(e,s,i)=>{i.r(s),i.d(s,{MobileViTFeatureExtractor:()=>h,MobileViTImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{}class h extends d{}},"./src/models/moonshine/feature_extraction_moonshine.js":(e,s,i)=>{i.r(s),i.d(s,{MoonshineFeatureExtractor:()=>h});var c=i("./src/base/feature_extraction_utils.js"),d=i("./src/utils/tensor.js");class h extends c.FeatureExtractor{async _call(g){(0,c.validate_audio_inputs)(g,"MoonshineFeatureExtractor"),g instanceof Float64Array&&(g=new Float32Array(g));const $=[1,g.length];return{input_values:new d.Tensor("float32",g,$)}}}},"./src/models/moonshine/processing_moonshine.js":(e,s,i)=>{i.r(s),i.d(s,{MoonshineProcessor:()=>_});var c=i("./src/models/auto/feature_extraction_auto.js"),d=i("./src/tokenizers.js"),h=i("./src/base/processing_utils.js");class _ extends h.Processor{async _call($){return await this.feature_extractor($)}}Oo(_,"tokenizer_class",d.AutoTokenizer),Oo(_,"feature_extractor_class",c.AutoFeatureExtractor)},"./src/models/nougat/image_processing_nougat.js":(e,s,i)=>{i.r(s),i.d(s,{NougatImageProcessor:()=>d});var c=i("./src/models/donut/image_processing_donut.js");class d extends c.DonutImageProcessor{}},"./src/models/owlv2/image_processing_owlv2.js":(e,s,i)=>{i.r(s),i.d(s,{Owlv2ImageProcessor:()=>d});var c=i("./src/models/owlvit/image_processing_owlvit.js");class d extends c.OwlViTImageProcessor{}},"./src/models/owlvit/image_processing_owlvit.js":(e,s,i)=>{i.r(s),i.d(s,{OwlViTFeatureExtractor:()=>h,OwlViTImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{post_process_object_detection(...g){return(0,c.post_process_object_detection)(...g)}}class h extends d{}},"./src/models/owlvit/processing_owlvit.js":(e,s,i)=>{i.r(s),i.d(s,{OwlViTProcessor:()=>_});var c=i("./src/base/processing_utils.js"),d=i("./src/models/auto/image_processing_auto.js"),h=i("./src/tokenizers.js");class _ extends c.Processor{}Oo(_,"tokenizer_class",h.AutoTokenizer),Oo(_,"image_processor_class",d.AutoImageProcessor)},"./src/models/paligemma/processing_paligemma.js":(e,s,i)=>{i.r(s),i.d(s,{PaliGemmaProcessor:()=>$});var c=i("./src/base/processing_utils.js"),d=i("./src/models/auto/image_processing_auto.js"),h=i("./src/tokenizers.js");const _="<image>";function g(_e,lt,at,it,ct){return`${it.repeat(at*ct)}${lt}${_e}
`}class $ extends c.Processor{async _call(lt,at=null,it={}){at||(console.warn("You are using PaliGemma without a text prefix. It will perform as a picture-captioning model."),at=""),Array.isArray(lt)||(lt=[lt]),Array.isArray(at)||(at=[at]);const ct=this.tokenizer.bos_token,mt=this.image_processor.config.image_seq_length;let pt;at.some(ft=>ft.includes(_))?pt=at.map(ft=>{const kt=ft.replaceAll(_,_.repeat(mt)),St=kt.lastIndexOf(_),Lt=St===-1?0:St+_.length;return kt.slice(0,Lt)+ct+kt.slice(Lt)+`
`}):(console.warn("You are passing both `text` and `images` to `PaliGemmaProcessor`. The processor expects special image tokens in the text, as many tokens as there are images per each text. It is recommended to add `<image>` tokens in the very beginning of your text. For this call, we will infer how many images each text has and add special tokens."),pt=at.map(ft=>g(ft,ct,mt,_,lt.length)));const zt=this.tokenizer(pt,it);return{...await this.image_processor(lt,it),...zt}}}Oo($,"tokenizer_class",h.AutoTokenizer),Oo($,"image_processor_class",d.AutoImageProcessor),Oo($,"uses_processor_config",!1)},"./src/models/parakeet/feature_extraction_parakeet.js":(e,s,i)=>{i.r(s),i.d(s,{ParakeetFeatureExtractor:()=>g});var c=i("./src/base/feature_extraction_utils.js"),d=i("./src/utils/tensor.js"),h=i("./src/utils/audio.js");const _=1e-5;class g extends c.FeatureExtractor{constructor(_e){var it;super(_e),(it=this.config).mel_filters??(it.mel_filters=(0,h.mel_filter_bank)(Math.floor(1+this.config.n_fft/2),this.config.feature_size,0,this.config.sampling_rate/2,this.config.sampling_rate,"slaney","slaney"));const lt=(0,h.window_function)(this.config.win_length,"hann",{periodic:!1});this.window=new Float64Array(this.config.n_fft);const at=Math.floor((this.config.n_fft-this.config.win_length)/2);this.window.set(lt,at)}async _extract_fbank_features(_e){const lt=this.config.preemphasis;_e=new Float64Array(_e);for(let it=_e.length-1;it>=1;--it)_e[it]-=lt*_e[it-1];return await(0,h.spectrogram)(_e,this.window,this.window.length,this.config.hop_length,{fft_length:this.config.n_fft,power:2,mel_filters:this.config.mel_filters,log_mel:"log",mel_floor:-1/0,pad_mode:"constant",center:!0,transpose:!0,mel_offset:2**-24})}async _call(_e){(0,c.validate_audio_inputs)(_e,"ParakeetFeatureExtractor");const lt=await this._extract_fbank_features(_e),at=Math.floor((_e.length+Math.floor(this.config.n_fft/2)*2-this.config.n_fft)/this.config.hop_length),it=lt.data;it.fill(0,at*lt.dims[1]);const[ct,mt]=lt.dims,pt=new Float64Array(mt),zt=new Float64Array(mt);for(let kt=0;kt<at;++kt){const St=kt*mt;for(let Lt=0;Lt<mt;++Lt){const Gt=it[St+Lt];pt[Lt]+=Gt,zt[Lt]+=Gt*Gt}}const dt=at>1?at-1:1;for(let kt=0;kt<mt;++kt){const St=pt[kt]/at,Lt=(zt[kt]-at*St*St)/dt,Bt=1/(Math.sqrt(Lt)+_);for(let nr=0;nr<at;++nr){const cr=nr*mt+kt;it[cr]=(it[cr]-St)*Bt}}const ft=new BigInt64Array(ct);return ft.fill(1n,0,at),{input_features:lt.unsqueeze_(0),attention_mask:new d.Tensor("int64",ft,[1,ct])}}}},"./src/models/phi3_v/image_processing_phi3_v.js":(e,s,i)=>{i.r(s),i.d(s,{Phi3VImageProcessor:()=>lt});var c=i("./src/base/image_processors_utils.js"),d=i("./src/utils/tensor.js");const h=336,_=[2,3],{ceil:g,floor:$,sqrt:_e}=Math;class lt extends c.ImageProcessor{constructor(it){super({...it,do_normalize:!0,do_pad:!0,pad_size:"custom",do_convert_rgb:!0,do_resize:!0}),this._num_crops=it.num_crops}calc_num_image_tokens_from_image_size(it,ct){const{num_img_tokens:mt}=this.config;return $(($(ct/h)*$(it/h)+1)*mt+1+($(ct/h)+1)*_e(mt))}get_resize_output_image_size(it,ct){const mt=this._num_crops,[pt,zt]=it.size;let dt=pt/zt,ft=1;for(;ft*Math.ceil(ft/dt)<=mt;)ft+=1;ft-=1;const kt=Math.floor(ft*336),St=Math.floor(kt/dt);return[kt,St]}pad_image(it,ct,mt,pt={}){const[zt,dt]=ct,ft=h*g(zt/h),kt=h*g(dt/h),St=[1,1,1].map((Lt,Gt)=>(Lt-this.image_mean[Gt])/this.image_std[Gt]);return super.pad_image(it,ct,{width:kt,height:ft},{center:!0,constant_values:St,...pt})}async _call(it,{num_crops:ct=null}={}){if(this._num_crops=ct??(ct=this.config.num_crops),ct<4||_e(ct)%1!==0)throw new Error("num_crops must be a square number >= 4");Array.isArray(it)||(it=[it]);const mt=it.length,pt=await Promise.all(it.map(Bt=>this.preprocess(Bt))),zt=pt.map(Bt=>Bt.original_size),dt=pt.map(Bt=>Bt.reshaped_input_size),ft=[];for(const{pixel_values:Bt}of pt){Bt.unsqueeze_(0);const[nr,cr]=Bt.dims.slice(-2),ur=await(0,d.interpolate_4d)(Bt,{size:[h,h],mode:"bicubic"});if(ct>0){const yn=[],hn=_e(ct),_n=$(cr/hn),gn=$(nr/hn);for(let Tn=0;Tn<hn;++Tn)for(let kn=0;kn<hn;++kn){let bn,Sn,fn,or;Tn===hn-1?(Sn=nr-gn,or=nr):(Sn=Tn*gn,or=(Tn+1)*gn),kn===hn-1?(bn=cr-_n,fn=cr):(bn=kn*_n,fn=(kn+1)*_n);const lr=[Sn,bn],pn=[or,fn],Cn=await(0,d.slice)(Bt,lr,pn,_);yn.push(Cn)}const vn=await(0,d.interpolate_4d)((0,d.cat)(yn,0),{size:[h,h],mode:"bicubic"});ft.push((0,d.cat)([ur,vn],0))}else ft.push(ur)}const kt=(0,d.stack)(ft,0),St=dt.map(Bt=>Bt.map(nr=>h*g(nr/h))),Lt=new d.Tensor("int64",St.flat(),[mt,2]),Gt=St.map(([Bt,nr])=>this.calc_num_image_tokens_from_image_size(nr,Bt));return{pixel_values:kt,original_sizes:zt,reshaped_input_sizes:dt,image_sizes:Lt,num_img_tokens:Gt}}}},"./src/models/phi3_v/processing_phi3_v.js":(e,s,i)=>{i.r(s),i.d(s,{Phi3VProcessor:()=>$});var c=i("./src/base/processing_utils.js"),d=i("./src/models/auto/image_processing_auto.js"),h=i("./src/tokenizers.js");i("./src/utils/image.js");const _="<|image|>",g=/<\|image_\d+\|>/g;class $ extends c.Processor{async _call(lt,at=null,{padding:it=!0,truncation:ct=!0,num_crops:mt=null}={}){Array.isArray(lt)||(lt=[lt]);let pt,zt;if(at){zt=await this.image_processor(at,{num_crops:mt});const{num_img_tokens:dt}=zt,ft=lt.map((St,Lt)=>St.split(g).join(_.repeat(dt[Lt])));pt=this.tokenizer(ft,{padding:it,truncation:ct});const kt=this.tokenizer.model.convert_tokens_to_ids([_])[0];pt.input_ids.map_(St=>St==kt?-St:St)}else pt=this.tokenizer(lt);return{...pt,...zt}}}Oo($,"image_processor_class",d.AutoImageProcessor),Oo($,"tokenizer_class",h.AutoTokenizer)},"./src/models/processors.js":(e,s,i)=>{i.r(s),i.d(s,{Florence2Processor:()=>c.Florence2Processor,Gemma3nProcessor:()=>d.Gemma3nProcessor,GroundingDinoProcessor:()=>h.GroundingDinoProcessor,Idefics3Processor:()=>_.Idefics3Processor,JinaCLIPProcessor:()=>$.JinaCLIPProcessor,LlavaProcessor:()=>_e.LlavaProcessor,MgpstrProcessor:()=>lt.MgpstrProcessor,MoonshineProcessor:()=>at.MoonshineProcessor,OwlViTProcessor:()=>it.OwlViTProcessor,PaliGemmaProcessor:()=>mt.PaliGemmaProcessor,Phi3VProcessor:()=>ct.Phi3VProcessor,PyAnnoteProcessor:()=>pt.PyAnnoteProcessor,Qwen2VLProcessor:()=>zt.Qwen2VLProcessor,SamProcessor:()=>dt.SamProcessor,SmolVLMProcessor:()=>ft.SmolVLMProcessor,SpeechT5Processor:()=>kt.SpeechT5Processor,UltravoxProcessor:()=>St.UltravoxProcessor,VLChatProcessor:()=>g.VLChatProcessor,VoxtralProcessor:()=>Lt.VoxtralProcessor,Wav2Vec2Processor:()=>Gt.Wav2Vec2Processor,Wav2Vec2ProcessorWithLM:()=>Bt.Wav2Vec2ProcessorWithLM,WhisperProcessor:()=>nr.WhisperProcessor});var c=i("./src/models/florence2/processing_florence2.js"),d=i("./src/models/gemma3n/processing_gemma3n.js"),h=i("./src/models/grounding_dino/processing_grounding_dino.js"),_=i("./src/models/idefics3/processing_idefics3.js"),g=i("./src/models/janus/processing_janus.js"),$=i("./src/models/jina_clip/processing_jina_clip.js"),_e=i("./src/models/llava/processing_llava.js"),lt=i("./src/models/mgp_str/processing_mgp_str.js"),at=i("./src/models/moonshine/processing_moonshine.js"),it=i("./src/models/owlvit/processing_owlvit.js"),ct=i("./src/models/phi3_v/processing_phi3_v.js"),mt=i("./src/models/paligemma/processing_paligemma.js"),pt=i("./src/models/pyannote/processing_pyannote.js"),zt=i("./src/models/qwen2_vl/processing_qwen2_vl.js"),dt=i("./src/models/sam/processing_sam.js"),ft=i("./src/models/smolvlm/processing_smolvlm.js"),kt=i("./src/models/speecht5/processing_speecht5.js"),St=i("./src/models/ultravox/processing_ultravox.js"),Lt=i("./src/models/voxtral/processing_voxtral.js"),Gt=i("./src/models/wav2vec2/processing_wav2vec2.js"),Bt=i("./src/models/wav2vec2_with_lm/processing_wav2vec2_with_lm.js"),nr=i("./src/models/whisper/processing_whisper.js")},"./src/models/pvt/image_processing_pvt.js":(e,s,i)=>{i.r(s),i.d(s,{PvtImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{}},"./src/models/pyannote/feature_extraction_pyannote.js":(e,s,i)=>{i.r(s),i.d(s,{PyAnnoteFeatureExtractor:()=>_});var c=i("./src/base/feature_extraction_utils.js"),d=i("./src/utils/tensor.js"),h=i("./src/utils/maths.js");class _ extends c.FeatureExtractor{async _call($){(0,c.validate_audio_inputs)($,"PyAnnoteFeatureExtractor"),$ instanceof Float64Array&&($=new Float32Array($));const _e=[1,1,$.length];return{input_values:new d.Tensor("float32",$,_e)}}samples_to_frames($){return($-this.config.offset)/this.config.step}post_process_speaker_diarization($,_e){const lt=_e/this.samples_to_frames(_e)/this.config.sampling_rate,at=[];for(const it of $.tolist()){const ct=[];let mt=-1;for(let pt=0;pt<it.length;++pt){const zt=(0,h.softmax)(it[pt]),[dt,ft]=(0,h.max)(zt),[kt,St]=[pt,pt+1];ft!==mt?(mt=ft,ct.push({id:ft,start:kt,end:St,score:dt})):(ct.at(-1).end=St,ct.at(-1).score+=dt)}at.push(ct.map(({id:pt,start:zt,end:dt,score:ft})=>({id:pt,start:zt*lt,end:dt*lt,confidence:ft/(dt-zt)})))}return at}}},"./src/models/pyannote/processing_pyannote.js":(e,s,i)=>{i.r(s),i.d(s,{PyAnnoteProcessor:()=>h});var c=i("./src/base/processing_utils.js"),d=i("./src/models/pyannote/feature_extraction_pyannote.js");class h extends c.Processor{async _call(g){return await this.feature_extractor(g)}post_process_speaker_diarization(...g){return this.feature_extractor.post_process_speaker_diarization(...g)}get sampling_rate(){return this.feature_extractor.config.sampling_rate}}Oo(h,"feature_extractor_class",d.PyAnnoteFeatureExtractor)},"./src/models/qwen2_vl/image_processing_qwen2_vl.js":(e,s,i)=>{i.r(s),i.d(s,{Qwen2VLImageProcessor:()=>h});var c=i("./src/base/image_processors_utils.js"),d=i("./src/utils/tensor.js");class h extends c.ImageProcessor{async _call(g,...$){const{pixel_values:_e,original_sizes:lt,reshaped_input_sizes:at}=await super._call(g,...$);let it=_e;const{temporal_patch_size:ct,merge_size:mt,patch_size:pt}=this.config;it.dims[0]===1&&(it=(0,d.cat)(Array.from({length:ct},()=>it),0));const zt=it.dims[0]/ct,dt=it.dims[1],ft=Math.floor(it.dims[2]/pt),kt=Math.floor(it.dims[3]/pt),St=it.view(zt,ct,dt,Math.floor(ft/mt),mt,pt,Math.floor(kt/mt),mt,pt).permute(0,3,6,4,7,2,1,5,8).view(zt*ft*kt,dt*ct*pt*pt),Lt=new d.Tensor("int64",[zt,ft,kt],[1,3]);return{pixel_values:St,image_grid_thw:Lt,original_sizes:lt,reshaped_input_sizes:at}}}},"./src/models/qwen2_vl/processing_qwen2_vl.js":(e,s,i)=>{i.r(s),i.d(s,{Qwen2VLProcessor:()=>_});var c=i("./src/base/processing_utils.js"),d=i("./src/models/auto/image_processing_auto.js"),h=i("./src/tokenizers.js");i("./src/utils/image.js");class _ extends c.Processor{async _call($,_e=null,...lt){Array.isArray($)||($=[$]);let at,it;if(_e&&(at=await this.image_processor(_e),it=at.image_grid_thw),it){let mt=this.image_processor.config.merge_size**2,pt=0;const zt=it.tolist();$=$.map(dt=>{for(;dt.includes("<|image_pad|>");){const ft=Number(zt[pt++].reduce((kt,St)=>kt*St,1n));dt=dt.replace("<|image_pad|>","<|placeholder|>".repeat(Math.floor(ft/mt)))}return dt.replaceAll("<|placeholder|>","<|image_pad|>")})}return{...this.tokenizer($),...at}}}Oo(_,"image_processor_class",d.AutoImageProcessor),Oo(_,"tokenizer_class",h.AutoTokenizer)},"./src/models/rt_detr/image_processing_rt_detr.js":(e,s,i)=>{i.r(s),i.d(s,{RTDetrImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{post_process_object_detection(..._){return(0,c.post_process_object_detection)(..._)}}},"./src/models/sam/image_processing_sam.js":(e,s,i)=>{i.r(s),i.d(s,{SamImageProcessor:()=>_});var c=i("./src/base/image_processors_utils.js"),d=i("./src/utils/core.js"),h=i("./src/utils/tensor.js");class _ extends c.ImageProcessor{reshape_input_points($,_e,lt,at=!1){$=structuredClone($);let it=(0,d.calculateDimensions)($);if(it.length===3)at||(it=[1,...it]),$=[$];else if(it.length!==4)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");for(let ct=0;ct<$.length;++ct){let mt=_e[ct],pt=lt[ct],zt=[pt[0]/mt[0],pt[1]/mt[1]];for(let dt=0;dt<$[ct].length;++dt)for(let ft=0;ft<$[ct][dt].length;++ft)for(let kt=0;kt<$[ct][dt][ft].length;++kt)$[ct][dt][ft][kt]*=zt[kt%2]}return new h.Tensor("float32",Float32Array.from($.flat(1/0)),it)}add_input_labels($,_e){let lt=(0,d.calculateDimensions)($);if(lt.length===2)lt=[1,...lt],$=[$];else if(lt.length!==3)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");if(lt.some((at,it)=>at!==_e.dims[it]))throw Error(`The first ${lt.length} dimensions of 'input_points' and 'input_labels' must be the same.`);return new h.Tensor("int64",$.flat(1/0).map(BigInt),lt)}async _call($,{input_points:_e=null,input_labels:lt=null,input_boxes:at=null}={}){const it=await super._call($);if(_e&&(it.input_points=this.reshape_input_points(_e,it.original_sizes,it.reshaped_input_sizes)),lt){if(!it.input_points)throw Error("`input_points` must be provided if `input_labels` are provided.");it.input_labels=this.add_input_labels(lt,it.input_points)}return at&&(it.input_boxes=this.reshape_input_points(at,it.original_sizes,it.reshaped_input_sizes,!0)),it}async post_process_masks($,_e,lt,{mask_threshold:at=0,binarize:it=!0,pad_size:ct=null}={}){const mt=[];ct=ct??this.pad_size;const pt=[ct.height,ct.width];for(let zt=0;zt<_e.length;++zt){const dt=_e[zt],ft=lt[zt];let kt=await(0,h.interpolate_4d)($[zt],{mode:"bilinear",size:pt});if(kt=kt.slice(null,null,[0,ft[0]],[0,ft[1]]),kt=await(0,h.interpolate_4d)(kt,{mode:"bilinear",size:dt}),it){const St=kt.data,Lt=new Uint8Array(St.length);for(let Gt=0;Gt<St.length;++Gt)St[Gt]>at&&(Lt[Gt]=1);kt=new h.Tensor("bool",Lt,kt.dims)}mt.push(kt)}return mt}generate_crop_boxes($,_e,{crop_n_layers:lt=0,overlap_ratio:at=512/1500,points_per_crop:it=32,crop_n_points_downscale_factor:ct=1}={}){}}},"./src/models/sam/processing_sam.js":(e,s,i)=>{i.r(s),i.d(s,{SamProcessor:()=>h});var c=i("./src/base/processing_utils.js"),d=i("./src/models/auto/image_processing_auto.js");class h extends c.Processor{async _call(...g){return await this.image_processor(...g)}post_process_masks(...g){return this.image_processor.post_process_masks(...g)}reshape_input_points(...g){return this.image_processor.reshape_input_points(...g)}}Oo(h,"image_processor_class",d.AutoImageProcessor)},"./src/models/seamless_m4t/feature_extraction_seamless_m4t.js":(e,s,i)=>{i.r(s),i.d(s,{SeamlessM4TFeatureExtractor:()=>_});var c=i("./src/base/feature_extraction_utils.js"),d=i("./src/utils/tensor.js"),h=i("./src/utils/audio.js");class _ extends c.FeatureExtractor{constructor($){super($);const _e=this.config.sampling_rate,lt=(0,h.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(_e/2),_e,null,"kaldi",!0);this.mel_filters=lt,this.window=(0,h.window_function)(400,"povey",{periodic:!1})}async _extract_fbank_features($,_e){return $=$.map(lt=>lt*32768),(0,h.spectrogram)($,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:_e,transpose:!0})}async _call($,{padding:_e=!0,pad_to_multiple_of:lt=2,do_normalize_per_mel_bins:at=!0,return_attention_mask:it=!0}={}){(0,c.validate_audio_inputs)($,"SeamlessM4TFeatureExtractor");let ct=await this._extract_fbank_features($,this.config.max_length);if(at){const[Lt,Gt]=ct.dims,Bt=ct.data;for(let nr=0;nr<Gt;++nr){let cr=0;for(let _n=0;_n<Lt;++_n)cr+=Bt[_n*Gt+nr];const ur=cr/Lt;let yn=0;for(let _n=0;_n<Lt;++_n)yn+=(Bt[_n*Gt+nr]-ur)**2;yn/=Lt-1;const hn=Math.sqrt(yn+1e-7);for(let _n=0;_n<Lt;++_n){const gn=_n*Gt+nr;Bt[gn]=(Bt[gn]-ur)/hn}}}let mt;if(_e){const[Lt,Gt]=ct.dims,Bt=ct.data,nr=Lt%lt;if(nr>0){const cr=new Float32Array(Gt*(Lt+nr));cr.set(Bt),cr.fill(this.config.padding_value,Bt.length);const ur=Lt+nr;ct=new d.Tensor(ct.type,cr,[ur,Gt]),it&&(mt=new d.Tensor("int64",new BigInt64Array(ur),[1,ur]),mt.data.fill(1n,0,Lt))}}const[pt,zt]=ct.dims,dt=this.config.stride;if(pt%dt!==0)throw new Error(`The number of frames (${pt}) must be a multiple of the stride (${dt}).`);const kt=ct.view(1,Math.floor(pt/dt),zt*dt),St={input_features:kt};if(it){const Lt=kt.dims[1],Gt=new BigInt64Array(Lt);if(mt){const Bt=mt.data;for(let nr=1,cr=0;nr<pt;nr+=dt,++cr)Gt[cr]=Bt[nr]}else Gt.fill(1n);St.attention_mask=new d.Tensor("int64",Gt,[1,Lt])}return St}}},"./src/models/segformer/image_processing_segformer.js":(e,s,i)=>{i.r(s),i.d(s,{SegformerFeatureExtractor:()=>h,SegformerImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{post_process_semantic_segmentation(...g){return(0,c.post_process_semantic_segmentation)(...g)}}class h extends d{}},"./src/models/siglip/image_processing_siglip.js":(e,s,i)=>{i.r(s),i.d(s,{SiglipImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{}},"./src/models/smolvlm/image_processing_smolvlm.js":(e,s,i)=>{i.r(s),i.d(s,{SmolVLMImageProcessor:()=>c.Idefics3ImageProcessor});var c=i("./src/models/idefics3/image_processing_idefics3.js")},"./src/models/smolvlm/processing_smolvlm.js":(e,s,i)=>{i.r(s),i.d(s,{SmolVLMProcessor:()=>c.Idefics3Processor});var c=i("./src/models/idefics3/processing_idefics3.js")},"./src/models/snac/feature_extraction_snac.js":(e,s,i)=>{i.r(s),i.d(s,{SnacFeatureExtractor:()=>d});var c=i("./src/models/dac/feature_extraction_dac.js");class d extends c.DacFeatureExtractor{}},"./src/models/speecht5/feature_extraction_speecht5.js":(e,s,i)=>{i.r(s),i.d(s,{SpeechT5FeatureExtractor:()=>d});var c=i("./src/base/feature_extraction_utils.js");class d extends c.FeatureExtractor{}},"./src/models/speecht5/processing_speecht5.js":(e,s,i)=>{i.r(s),i.d(s,{SpeechT5Processor:()=>_});var c=i("./src/base/processing_utils.js"),d=i("./src/tokenizers.js"),h=i("./src/models/auto/feature_extraction_auto.js");class _ extends c.Processor{async _call($){return await this.feature_extractor($)}}Oo(_,"tokenizer_class",d.AutoTokenizer),Oo(_,"feature_extractor_class",h.AutoFeatureExtractor)},"./src/models/swin2sr/image_processing_swin2sr.js":(e,s,i)=>{i.r(s),i.d(s,{Swin2SRImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{pad_image(_,g,$,_e={}){const[lt,at,it]=g;return super.pad_image(_,g,{width:at+($-at%$)%$,height:lt+($-lt%$)%$},{mode:"symmetric",center:!1,constant_values:-1,..._e})}}},"./src/models/ultravox/processing_ultravox.js":(e,s,i)=>{i.r(s),i.d(s,{UltravoxProcessor:()=>_});var c=i("./src/models/auto/feature_extraction_auto.js"),d=i("./src/tokenizers.js"),h=i("./src/base/processing_utils.js");class _ extends h.Processor{async _call($,_e=null,lt={}){if(Array.isArray($))throw new Error("Batched inputs are not supported yet.");let at={};if(_e){const ct=_e.length,{input_features:mt}=await this.feature_extractor(_e,{...lt,max_length:ct}),pt=Math.round(ct/this.config.encoder_ds_factor+1e-4),zt=1+Math.ceil(pt/this.config.stack_factor);at.audio_token_len=[zt],at.audio_values=mt;const dt=this.config.audio_placeholder;if(!$.includes(dt))throw new Error(`The input text does not contain the image token ${dt}.`);$=$.replaceAll(dt,dt.repeat(zt))}return{...this.tokenizer($,{add_special_tokens:!1,...lt}),...at}}}Oo(_,"tokenizer_class",d.AutoTokenizer),Oo(_,"feature_extractor_class",c.AutoFeatureExtractor),Oo(_,"uses_processor_config",!0)},"./src/models/vit/image_processing_vit.js":(e,s,i)=>{i.r(s),i.d(s,{ViTFeatureExtractor:()=>h,ViTImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{}class h extends d{}},"./src/models/vitmatte/image_processing_vitmatte.js":(e,s,i)=>{i.r(s),i.d(s,{VitMatteImageProcessor:()=>h});var c=i("./src/base/image_processors_utils.js"),d=i("./src/utils/tensor.js");class h extends c.ImageProcessor{async _call(g,$){Array.isArray(g)||(g=[g]),Array.isArray($)||($=[$]);const _e=await Promise.all(g.map(it=>this.preprocess(it))),lt=await Promise.all($.map(it=>this.preprocess(it,{do_normalize:!1,do_convert_rgb:!1,do_convert_grayscale:!0})));return{pixel_values:(0,d.stack)(_e.map((it,ct)=>(0,d.cat)([it.pixel_values,lt[ct].pixel_values],0)),0),original_sizes:_e.map(it=>it.original_size),reshaped_input_sizes:_e.map(it=>it.reshaped_input_size)}}}},"./src/models/vitpose/image_processing_vitpose.js":(e,s,i)=>{i.r(s),i.d(s,{VitPoseImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{post_process_pose_estimation(_,g,{threshold:$=null}={}){const _e=_.tolist(),[lt,at,it,ct]=_.dims,mt=[];for(let pt=0;pt<lt;++pt){const zt=_e[pt],dt=g[pt],ft=[];for(let kt=0;kt<dt.length;++kt){const St=dt[kt],Lt=[],Gt=[],Bt=[],nr=St.at(-2)/ct,cr=St.at(-1)/it;for(let ur=0;ur<zt.length;++ur){let[yn,hn]=[0,0],_n=0,gn=-1/0;const vn=zt[ur];for(let kn=0;kn<vn.length;++kn){const bn=vn[kn];for(let Sn=0;Sn<bn.length;++Sn){const fn=bn[Sn];_n+=fn,gn=Math.max(gn,fn),yn+=(Sn+.5)*fn,hn+=kn*fn}}if($!=null&&gn<$)continue;const Tn=[nr*yn/_n,cr*hn/_n];Lt.push(Tn),Bt.push(ur),Gt.push(gn)}ft.push({bbox:St,scores:Gt,labels:Bt,keypoints:Lt})}mt.push(ft)}return mt}}},"./src/models/voxtral/processing_voxtral.js":(e,s,i)=>{i.r(s),i.d(s,{VoxtralProcessor:()=>at});var c=i("./src/models/auto/feature_extraction_auto.js"),d=i("./src/tokenizers.js"),h=i("./src/base/processing_utils.js"),_=i("./src/utils/tensor.js");const g="[AUDIO]",$="[BEGIN_AUDIO]",_e=375;function lt(it,ct){const mt=[];for(let pt=0;pt<it.length;pt+=ct)mt.push(it.subarray(pt,Math.min(pt+ct,it.length)));return mt}class at extends h.Processor{async _call(ct,mt=null,pt={}){if(Array.isArray(ct))throw new Error("Batched inputs are not supported yet.");const zt={};if(mt){if(!ct.includes(g))throw new Error(`The input text does not contain the audio token ${g}.`);Array.isArray(mt)||(mt=[mt]);const ft=ct.split(g),kt=ft.length-1;if(kt!==mt.length)throw new Error(`The number of audio inputs (${mt.length}) does not match the number of audio tokens in the text (${kt}).`);const St=this.feature_extractor.config.n_samples,Lt=mt.map(ur=>lt(ur,St)),Gt=Lt.map(ur=>ur.length),Bt=Lt.flat(),nr=(await Promise.all(Bt.map(ur=>this.feature_extractor(ur,pt)))).map(ur=>ur.input_features);zt.audio_values=nr.length>1?(0,_.cat)(nr,0):nr[0];let cr=ft[0];for(let ur=0;ur<Gt.length;++ur){cr+=$;for(let yn=0;yn<Gt[ur];++yn)cr+=g.repeat(_e);cr+=ft[ur+1]}ct=cr}return{...this.tokenizer(ct,{add_special_tokens:!1,...pt}),...zt}}}Oo(at,"tokenizer_class",d.AutoTokenizer),Oo(at,"feature_extractor_class",c.AutoFeatureExtractor),Oo(at,"uses_processor_config",!1)},"./src/models/wav2vec2/feature_extraction_wav2vec2.js":(e,s,i)=>{i.r(s),i.d(s,{Wav2Vec2FeatureExtractor:()=>h});var c=i("./src/base/feature_extraction_utils.js"),d=i("./src/utils/tensor.js");class h extends c.FeatureExtractor{_zero_mean_unit_var_norm(g){const _e=g.reduce((at,it)=>at+it,0)/g.length,lt=g.reduce((at,it)=>at+(it-_e)**2,0)/g.length;return g.map(at=>(at-_e)/Math.sqrt(lt+1e-7))}async _call(g){(0,c.validate_audio_inputs)(g,"Wav2Vec2FeatureExtractor"),g instanceof Float64Array&&(g=new Float32Array(g));let $=g;this.config.do_normalize&&($=this._zero_mean_unit_var_norm($));const _e=[1,$.length];return{input_values:new d.Tensor("float32",$,_e),attention_mask:new d.Tensor("int64",new BigInt64Array($.length).fill(1n),_e)}}}},"./src/models/wav2vec2/processing_wav2vec2.js":(e,s,i)=>{i.r(s),i.d(s,{Wav2Vec2Processor:()=>_});var c=i("./src/tokenizers.js"),d=i("./src/models/auto/feature_extraction_auto.js"),h=i("./src/base/processing_utils.js");class _ extends h.Processor{async _call($){return await this.feature_extractor($)}}Oo(_,"tokenizer_class",c.AutoTokenizer),Oo(_,"feature_extractor_class",d.AutoFeatureExtractor)},"./src/models/wav2vec2_with_lm/processing_wav2vec2_with_lm.js":(e,s,i)=>{i.r(s),i.d(s,{Wav2Vec2ProcessorWithLM:()=>_});var c=i("./src/tokenizers.js"),d=i("./src/models/auto/feature_extraction_auto.js"),h=i("./src/base/processing_utils.js");class _ extends h.Processor{async _call($){return await this.feature_extractor($)}}Oo(_,"tokenizer_class",c.AutoTokenizer),Oo(_,"feature_extractor_class",d.AutoFeatureExtractor)},"./src/models/wespeaker/feature_extraction_wespeaker.js":(e,s,i)=>{i.r(s),i.d(s,{WeSpeakerFeatureExtractor:()=>h});var c=i("./src/base/feature_extraction_utils.js");i("./src/utils/tensor.js");var d=i("./src/utils/audio.js");class h extends c.FeatureExtractor{constructor(g){super(g);const $=this.config.sampling_rate,_e=(0,d.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor($/2),$,null,"kaldi",!0);this.mel_filters=_e,this.window=(0,d.window_function)(400,"hamming",{periodic:!1}),this.min_num_frames=this.config.min_num_frames}async _extract_fbank_features(g){return g=g.map($=>$*32768),(0,d.spectrogram)(g,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,transpose:!0,min_num_frames:this.min_num_frames})}async _call(g){(0,c.validate_audio_inputs)(g,"WeSpeakerFeatureExtractor");const $=(await this._extract_fbank_features(g)).unsqueeze_(0);if(this.config.fbank_centering_span===null){const _e=$.mean(1).data,lt=$.data,[at,it,ct]=$.dims;for(let mt=0;mt<at;++mt){const pt=mt*it*ct,zt=mt*ct;for(let dt=0;dt<it;++dt){const ft=pt+dt*ct;for(let kt=0;kt<ct;++kt)lt[ft+kt]-=_e[zt+kt]}}}return{input_features:$}}}},"./src/models/whisper/common_whisper.js":(e,s,i)=>{i.r(s),i.d(s,{WHISPER_LANGUAGE_MAPPING:()=>d,WHISPER_TO_LANGUAGE_CODE_MAPPING:()=>h,whisper_language_to_code:()=>_});const c=[["en","english"],["zh","chinese"],["de","german"],["es","spanish"],["ru","russian"],["ko","korean"],["fr","french"],["ja","japanese"],["pt","portuguese"],["tr","turkish"],["pl","polish"],["ca","catalan"],["nl","dutch"],["ar","arabic"],["sv","swedish"],["it","italian"],["id","indonesian"],["hi","hindi"],["fi","finnish"],["vi","vietnamese"],["he","hebrew"],["uk","ukrainian"],["el","greek"],["ms","malay"],["cs","czech"],["ro","romanian"],["da","danish"],["hu","hungarian"],["ta","tamil"],["no","norwegian"],["th","thai"],["ur","urdu"],["hr","croatian"],["bg","bulgarian"],["lt","lithuanian"],["la","latin"],["mi","maori"],["ml","malayalam"],["cy","welsh"],["sk","slovak"],["te","telugu"],["fa","persian"],["lv","latvian"],["bn","bengali"],["sr","serbian"],["az","azerbaijani"],["sl","slovenian"],["kn","kannada"],["et","estonian"],["mk","macedonian"],["br","breton"],["eu","basque"],["is","icelandic"],["hy","armenian"],["ne","nepali"],["mn","mongolian"],["bs","bosnian"],["kk","kazakh"],["sq","albanian"],["sw","swahili"],["gl","galician"],["mr","marathi"],["pa","punjabi"],["si","sinhala"],["km","khmer"],["sn","shona"],["yo","yoruba"],["so","somali"],["af","afrikaans"],["oc","occitan"],["ka","georgian"],["be","belarusian"],["tg","tajik"],["sd","sindhi"],["gu","gujarati"],["am","amharic"],["yi","yiddish"],["lo","lao"],["uz","uzbek"],["fo","faroese"],["ht","haitian creole"],["ps","pashto"],["tk","turkmen"],["nn","nynorsk"],["mt","maltese"],["sa","sanskrit"],["lb","luxembourgish"],["my","myanmar"],["bo","tibetan"],["tl","tagalog"],["mg","malagasy"],["as","assamese"],["tt","tatar"],["haw","hawaiian"],["ln","lingala"],["ha","hausa"],["ba","bashkir"],["jw","javanese"],["su","sundanese"]],d=new Map(c),h=new Map([...c.map(([g,$])=>[$,g]),["burmese","my"],["valencian","ca"],["flemish","nl"],["haitian","ht"],["letzeburgesch","lb"],["pushto","ps"],["panjabi","pa"],["moldavian","ro"],["moldovan","ro"],["sinhalese","si"],["castilian","es"]]);function _(g){g=g.toLowerCase();let $=h.get(g);if($===void 0){const _e=g.match(/^<\|([a-z]{2})\|>$/);if(_e&&(g=_e[1]),d.has(g))$=g;else{const at=g.length===2?d.keys():d.values();throw new Error(`Language "${g}" is not supported. Must be one of: ${JSON.stringify(Array.from(at))}`)}}return $}},"./src/models/whisper/feature_extraction_whisper.js":(e,s,i)=>{i.r(s),i.d(s,{WhisperFeatureExtractor:()=>_});var c=i("./src/base/feature_extraction_utils.js");i("./src/utils/tensor.js");var d=i("./src/utils/audio.js"),h=i("./src/utils/maths.js");class _ extends c.FeatureExtractor{constructor($){var _e;super($),(_e=this.config).mel_filters??(_e.mel_filters=(0,d.mel_filter_bank)(Math.floor(1+this.config.n_fft/2),this.config.feature_size,0,8e3,this.config.sampling_rate,"slaney","slaney")),this.window=(0,d.window_function)(this.config.n_fft,"hann")}async _extract_fbank_features($){const _e=await(0,d.spectrogram)($,this.window,this.config.n_fft,this.config.hop_length,{power:2,mel_filters:this.config.mel_filters,log_mel:"log10",max_num_frames:Math.min(Math.floor($.length/this.config.hop_length),this.config.nb_max_frames)}),lt=_e.data,at=(0,h.max)(lt)[0];for(let it=0;it<lt.length;++it)lt[it]=(Math.max(lt[it],at-8)+4)/4;return _e}async _call($,{max_length:_e=null}={}){(0,c.validate_audio_inputs)($,"WhisperFeatureExtractor");let lt;const at=_e??this.config.n_samples;return $.length>at?($.length>this.config.n_samples&&console.warn("Attempting to extract features for audio longer than 30 seconds. If using a pipeline to extract transcript from a long audio clip, remember to specify `chunk_length_s` and/or `stride_length_s`."),lt=$.slice(0,at)):(lt=new Float32Array(at),lt.set($)),{input_features:(await this._extract_fbank_features(lt)).unsqueeze_(0)}}}},"./src/models/whisper/generation_whisper.js":(e,s,i)=>{i.r(s),i.d(s,{WhisperGenerationConfig:()=>d});var c=i("./src/generation/configuration_utils.js");class d extends c.GenerationConfig{constructor(){super(...arguments);Oo(this,"return_timestamps",null);Oo(this,"return_token_timestamps",null);Oo(this,"num_frames",null);Oo(this,"alignment_heads",null);Oo(this,"task",null);Oo(this,"language",null);Oo(this,"no_timestamps_token_id",null);Oo(this,"prompt_ids",null);Oo(this,"is_multilingual",null);Oo(this,"lang_to_id",null);Oo(this,"task_to_id",null);Oo(this,"max_initial_timestamp_index",1)}}},"./src/models/whisper/processing_whisper.js":(e,s,i)=>{i.r(s),i.d(s,{WhisperProcessor:()=>_});var c=i("./src/models/auto/feature_extraction_auto.js"),d=i("./src/tokenizers.js"),h=i("./src/base/processing_utils.js");class _ extends h.Processor{async _call($){return await this.feature_extractor($)}}Oo(_,"tokenizer_class",d.AutoTokenizer),Oo(_,"feature_extractor_class",c.AutoFeatureExtractor)},"./src/models/yolos/image_processing_yolos.js":(e,s,i)=>{i.r(s),i.d(s,{YolosFeatureExtractor:()=>h,YolosImageProcessor:()=>d});var c=i("./src/base/image_processors_utils.js");class d extends c.ImageProcessor{post_process_object_detection(...g){return(0,c.post_process_object_detection)(...g)}}class h extends d{}},"./src/ops/registry.js":(e,s,i)=>{i.r(s),i.d(s,{TensorOpRegistry:()=>_});var c=i("./src/backends/onnx.js"),d=i("./src/utils/tensor.js");const h=async(g,$,_e)=>{const lt=await(0,c.createInferenceSession)(new Uint8Array(g),$);return async at=>{const it=(0,c.isONNXProxy)(),ct=Object.fromEntries(Object.entries(at).map(([pt,zt])=>[pt,(it?zt.clone():zt).ort_tensor])),mt=await(0,c.runInferenceSession)(lt,ct);return Array.isArray(_e)?_e.map(pt=>new d.Tensor(mt[pt])):new d.Tensor(mt[_e])}};class _{static get nearest_interpolate_4d(){return this._nearest_interpolate_4d||(this._nearest_interpolate_4d=h([8,10,18,0,58,129,1,10,41,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,18,10,4,109,111,100,101,34,7,110,101,97,114,101,115,116,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,21],this.session_options,"y")),this._nearest_interpolate_4d}static get bilinear_interpolate_4d(){return this._bilinear_interpolate_4d||(this._bilinear_interpolate_4d=h([8,9,18,0,58,128,1,10,40,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,17,10,4,109,111,100,101,34,6,108,105,110,101,97,114,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bilinear_interpolate_4d}static get bicubic_interpolate_4d(){return this._bicubic_interpolate_4d||(this._bicubic_interpolate_4d=h([8,9,18,0,58,127,10,39,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,16,10,4,109,111,100,101,34,5,99,117,98,105,99,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bicubic_interpolate_4d}static get matmul(){return this._matmul||(this._matmul=h([8,9,18,0,58,55,10,17,10,1,97,10,1,98,18,1,99,34,6,77,97,116,77,117,108,18,1,114,90,9,10,1,97,18,4,10,2,8,1,90,9,10,1,98,18,4,10,2,8,1,98,9,10,1,99,18,4,10,2,8,1,66,2,16,20],this.session_options,"c")),this._matmul}static get stft(){return this._stft||(this._stft=h([8,7,18,0,58,148,1,10,38,10,1,115,10,1,106,10,1,119,10,1,108,18,1,111,34,4,83,84,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,115,90,26,10,1,115,18,21,10,19,8,1,18,15,10,3,18,1,98,10,3,18,1,115,10,3,18,1,99,90,11,10,1,106,18,6,10,4,8,7,18,0,90,16,10,1,119,18,11,10,9,8,1,18,5,10,3,18,1,119,90,11,10,1,108,18,6,10,4,8,7,18,0,98,31,10,1,111,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,102,10,3,18,1,100,10,3,18,1,99,66,2,16,17],this.session_options,"o")),this._stft}static get rfft(){return this._rfft||(this._rfft=h([8,9,18,0,58,97,10,33,10,1,120,10,0,10,1,97,18,1,121,34,3,68,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,100,90,21,10,1,120,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,90,11,10,1,97,18,6,10,4,8,7,18,0,98,21,10,1,121,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,66,2,16,20],this.session_options,"y")),this._rfft}static get top_k(){return this._top_k||(this._top_k=h([8,10,18,0,58,73,10,18,10,1,120,10,1,107,18,1,118,18,1,105,34,4,84,111,112,75,18,1,116,90,9,10,1,120,18,4,10,2,8,1,90,15,10,1,107,18,10,10,8,8,7,18,4,10,2,8,1,98,9,10,1,118,18,4,10,2,8,1,98,9,10,1,105,18,4,10,2,8,7,66,2,16,21],this.session_options,["v","i"])),this._top_k}static get slice(){return this._slice||(this._slice=h([8,7,18,0,58,96,10,25,10,1,120,10,1,115,10,1,101,10,1,97,10,1,116,18,1,121,34,5,83,108,105,99,101,18,1,114,90,9,10,1,120,18,4,10,2,8,1,90,9,10,1,115,18,4,10,2,8,7,90,9,10,1,101,18,4,10,2,8,7,90,9,10,1,97,18,4,10,2,8,7,90,9,10,1,116,18,4,10,2,8,7,98,9,10,1,121,18,4,10,2,8,1,66,2,16,13],this.session_options,"y")),this._slice}}Oo(_,"session_options",{})},"./src/pipelines.js":(e,s,i)=>{i.r(s),i.d(s,{AudioClassificationPipeline:()=>hn,AutomaticSpeechRecognitionPipeline:()=>gn,BackgroundRemovalPipeline:()=>bn,DepthEstimationPipeline:()=>Lo,DocumentQuestionAnsweringPipeline:()=>lr,FeatureExtractionPipeline:()=>ur,FillMaskPipeline:()=>kt,ImageClassificationPipeline:()=>Tn,ImageFeatureExtractionPipeline:()=>yn,ImageSegmentationPipeline:()=>kn,ImageToImagePipeline:()=>Cn,ImageToTextPipeline:()=>vn,ObjectDetectionPipeline:()=>fn,Pipeline:()=>pt,QuestionAnsweringPipeline:()=>ft,SummarizationPipeline:()=>Lt,Text2TextGenerationPipeline:()=>St,TextClassificationPipeline:()=>zt,TextGenerationPipeline:()=>nr,TextToAudioPipeline:()=>pn,TokenClassificationPipeline:()=>dt,TranslationPipeline:()=>Gt,ZeroShotAudioClassificationPipeline:()=>_n,ZeroShotClassificationPipeline:()=>cr,ZeroShotImageClassificationPipeline:()=>Sn,ZeroShotObjectDetectionPipeline:()=>or,pipeline:()=>qo});var c=i("./src/tokenizers.js"),d=i("./src/models.js"),h=i("./src/models/auto/processing_auto.js");i("./src/base/processing_utils.js");var _=i("./src/utils/generic.js"),g=i("./src/utils/core.js"),$=i("./src/utils/maths.js"),_e=i("./src/utils/audio.js"),lt=i("./src/utils/tensor.js"),at=i("./src/utils/image.js");async function it(Wo){return Array.isArray(Wo)||(Wo=[Wo]),await Promise.all(Wo.map(En=>at.RawImage.read(En)))}async function ct(Wo,En){return Array.isArray(Wo)||(Wo=[Wo]),await Promise.all(Wo.map(mr=>typeof mr=="string"||mr instanceof URL?(0,_e.read_audio)(mr,En):mr instanceof Float64Array?new Float32Array(mr):mr))}function mt(Wo,En){En&&(Wo=Wo.map(_i=>_i|0));const[mr,Do,Go,Jo]=Wo;return{xmin:mr,ymin:Do,xmax:Go,ymax:Jo}}class pt extends _.Callable{constructor({task:En,model:mr,tokenizer:Do=null,processor:Go=null}){super(),this.task=En,this.model=mr,this.tokenizer=Do,this.processor=Go}async dispose(){await this.model.dispose()}}class zt extends pt{constructor(En){super(En)}async _call(En,{top_k:mr=1}={}){const Do=this.tokenizer(En,{padding:!0,truncation:!0}),Go=await this.model(Do),Jo=this.model.config.problem_type==="multi_label_classification"?_c=>_c.sigmoid():_c=>new lt.Tensor("float32",(0,$.softmax)(_c.data),_c.dims),_i=this.model.config.id2label,Ho=[];for(const _c of Go.logits){const Qo=Jo(_c),ep=await(0,lt.topk)(Qo,mr),lp=ep[0].tolist(),Zo=ep[1].tolist().map((bp,gp)=>({label:_i?_i[bp]:`LABEL_${bp}`,score:lp[gp]}));mr===1?Ho.push(...Zo):Ho.push(Zo)}return Array.isArray(En)||mr===1?Ho:Ho[0]}}class dt extends pt{constructor(En){super(En)}async _call(En,{ignore_labels:mr=["O"]}={}){const Do=Array.isArray(En),Go=this.tokenizer(Do?En:[En],{padding:!0,truncation:!0}),_i=(await this.model(Go)).logits,Ho=this.model.config.id2label,_c=[];for(let Qo=0;Qo<_i.dims[0];++Qo){const ep=Go.input_ids[Qo],lp=_i[Qo],_p=[];for(let Zo=0;Zo<lp.dims[0];++Zo){const bp=lp[Zo],gp=(0,$.max)(bp.data)[1],Mp=Ho?Ho[gp]:`LABEL_${gp}`;if(mr.includes(Mp))continue;const wp=this.tokenizer.decode([ep[Zo].item()],{skip_special_tokens:!0});if(wp==="")continue;const ip=(0,$.softmax)(bp.data);_p.push({entity:Mp,score:ip[gp],index:Zo,word:wp})}_c.push(_p)}return Do?_c:_c[0]}}class ft extends pt{constructor(En){super(En)}async _call(En,mr,{top_k:Do=1}={}){const Go=this.tokenizer(En,{text_pair:mr,padding:!0,truncation:!0}),{start_logits:Jo,end_logits:_i}=await this.model(Go),Ho=Go.input_ids.tolist(),_c=Go.attention_mask.tolist(),Qo=this.tokenizer.all_special_ids,ep=[];for(let lp=0;lp<Jo.dims[0];++lp){const _p=Ho[lp],Zo=_p.findIndex(fp=>fp==this.tokenizer.sep_token_id);_c[lp].map((fp,Rp)=>fp==1&&(Rp===0||Rp>Zo&&Qo.findIndex(Ap=>Ap==_p[Rp])===-1));const bp=Jo[lp].tolist(),gp=_i[lp].tolist();for(let fp=1;fp<bp.length;++fp)(_c[lp]==0||fp<=Zo||Qo.findIndex(Rp=>Rp==_p[fp])!==-1)&&(bp[fp]=-1/0,gp[fp]=-1/0);const Mp=(0,$.softmax)(bp).map((fp,Rp)=>[fp,Rp]),wp=(0,$.softmax)(gp).map((fp,Rp)=>[fp,Rp]);Mp[0][0]=0,wp[0][0]=0;const ip=(0,g.product)(Mp,wp).filter(fp=>fp[0][1]<=fp[1][1]).map(fp=>[fp[0][1],fp[1][1],fp[0][0]*fp[1][0]]).sort((fp,Rp)=>Rp[2]-fp[2]);for(let fp=0;fp<Math.min(ip.length,Do);++fp){const[Rp,Ap,u_]=ip[fp],Ip=_p.slice(Rp,Ap+1),C_=this.tokenizer.decode(Ip,{skip_special_tokens:!0});ep.push({answer:C_,score:u_})}}return Do===1?ep[0]:ep}}class kt extends pt{constructor(En){super(En)}async _call(En,{top_k:mr=5}={}){const Do=this.tokenizer(En,{padding:!0,truncation:!0}),{logits:Go}=await this.model(Do),Jo=[],_i=Do.input_ids.tolist();for(let Ho=0;Ho<_i.length;++Ho){const _c=_i[Ho],Qo=_c.findIndex(bp=>bp==this.tokenizer.mask_token_id);if(Qo===-1)throw Error(`Mask token (${this.tokenizer.mask_token}) not found in text.`);const ep=Go[Ho][Qo],lp=await(0,lt.topk)(new lt.Tensor("float32",(0,$.softmax)(ep.data),ep.dims),mr),_p=lp[0].tolist(),Zo=lp[1].tolist();Jo.push(Zo.map((bp,gp)=>{const Mp=_c.slice();return Mp[Qo]=bp,{score:_p[gp],token:Number(bp),token_str:this.tokenizer.decode([bp]),sequence:this.tokenizer.decode(Mp,{skip_special_tokens:!0})}}))}return Array.isArray(En)?Jo:Jo[0]}}class St extends pt{constructor(mr){super(mr);Oo(this,"_key","generated_text")}async _call(mr,Do={}){Array.isArray(mr)||(mr=[mr]),this.model.config.prefix&&(mr=mr.map(Qo=>this.model.config.prefix+Qo));const Go=this.model.config.task_specific_params;Go&&Go[this.task]&&Go[this.task].prefix&&(mr=mr.map(Qo=>Go[this.task].prefix+Qo));const Jo=this.tokenizer,_i={padding:!0,truncation:!0};let Ho;this instanceof Gt&&"_build_translation_inputs"in Jo?Ho=Jo._build_translation_inputs(mr,_i,Do):Ho=Jo(mr,_i);const _c=await this.model.generate({...Ho,...Do});return Jo.batch_decode(_c,{skip_special_tokens:!0}).map(Qo=>({[this._key]:Qo}))}}class Lt extends St{constructor(mr){super(mr);Oo(this,"_key","summary_text")}}class Gt extends St{constructor(mr){super(mr);Oo(this,"_key","translation_text")}}function Bt(Wo){return Array.isArray(Wo)&&Wo.every(En=>"role"in En&&"content"in En)}class nr extends pt{constructor(En){super(En)}async _call(En,mr={}){let Do=!1,Go=!1,Jo=mr.add_special_tokens??(this.tokenizer.add_bos_token||this.tokenizer.add_eos_token)??!1,_i;if(typeof En=="string")_i=En=[En];else if(Array.isArray(En)&&En.every(Zo=>typeof Zo=="string"))Do=!0,_i=En;else{if(Bt(En))En=[En];else if(Array.isArray(En)&&En.every(Bt))Do=!0;else throw new Error("Input must be a string, an array of strings, a Chat, or an array of Chats");Go=!0,_i=En.map(Zo=>this.tokenizer.apply_chat_template(Zo,{tokenize:!1,add_generation_prompt:!0})),Jo=!1}const Ho=Go?!1:mr.return_full_text??!0;this.tokenizer.padding_side="left";const _c=this.tokenizer(_i,{add_special_tokens:Jo,padding:!0,truncation:!0}),Qo=await this.model.generate({..._c,...mr}),ep=this.tokenizer.batch_decode(Qo,{skip_special_tokens:!0});let lp;!Ho&&_c.input_ids.dims.at(-1)>0&&(lp=this.tokenizer.batch_decode(_c.input_ids,{skip_special_tokens:!0}).map(Zo=>Zo.length));const _p=Array.from({length:En.length},Zo=>[]);for(let Zo=0;Zo<ep.length;++Zo){const bp=Math.floor(Zo/Qo.dims[0]*En.length);lp&&(ep[Zo]=ep[Zo].slice(lp[bp])),_p[bp].push({generated_text:Go?[...En[bp],{role:"assistant",content:ep[Zo]}]:ep[Zo]})}return!Do&&_p.length===1?_p[0]:_p}}class cr extends pt{constructor(En){super(En),this.label2id=Object.fromEntries(Object.entries(this.model.config.label2id).map(([mr,Do])=>[mr.toLowerCase(),Do])),this.entailment_id=this.label2id.entailment,this.entailment_id===void 0&&(console.warn("Could not find 'entailment' in label2id mapping. Using 2 as entailment_id."),this.entailment_id=2),this.contradiction_id=this.label2id.contradiction??this.label2id.not_entailment,this.contradiction_id===void 0&&(console.warn("Could not find 'contradiction' in label2id mapping. Using 0 as contradiction_id."),this.contradiction_id=0)}async _call(En,mr,{hypothesis_template:Do="This example is {}.",multi_label:Go=!1}={}){const Jo=Array.isArray(En);Jo||(En=[En]),Array.isArray(mr)||(mr=[mr]);const _i=mr.map(Qo=>Do.replace("{}",Qo)),Ho=Go||mr.length===1,_c=[];for(const Qo of En){const ep=[];for(const Zo of _i){const bp=this.tokenizer(Qo,{text_pair:Zo,padding:!0,truncation:!0}),gp=await this.model(bp);Ho?ep.push([gp.logits.data[this.contradiction_id],gp.logits.data[this.entailment_id]]):ep.push(gp.logits.data[this.entailment_id])}const _p=(Ho?ep.map(Zo=>(0,$.softmax)(Zo)[1]):(0,$.softmax)(ep)).map((Zo,bp)=>[Zo,bp]).sort((Zo,bp)=>bp[0]-Zo[0]);_c.push({sequence:Qo,labels:_p.map(Zo=>mr[Zo[1]]),scores:_p.map(Zo=>Zo[0])})}return Jo?_c:_c[0]}}class ur extends pt{constructor(En){super(En)}async _call(En,{pooling:mr="none",normalize:Do=!1,quantize:Go=!1,precision:Jo="binary"}={}){const _i=this.tokenizer(En,{padding:!0,truncation:!0}),Ho=await this.model(_i);let _c=Ho.last_hidden_state??Ho.logits??Ho.token_embeddings;switch(mr){case"none":break;case"mean":_c=(0,lt.mean_pooling)(_c,_i.attention_mask);break;case"first_token":case"cls":_c=_c.slice(null,0);break;case"last_token":case"eos":_c=_c.slice(null,-1);break;default:throw Error(`Pooling method '${mr}' not supported.`)}return Do&&(_c=_c.normalize(2,-1)),Go&&(_c=(0,lt.quantize_embeddings)(_c,Jo)),_c}}class yn extends pt{constructor(En){super(En)}async _call(En,{pool:mr=null}={}){const Do=await it(En),{pixel_values:Go}=await this.processor(Do),Jo=await this.model({pixel_values:Go});let _i;if(mr){if(!("pooler_output"in Jo))throw Error("No pooled output was returned. Make sure the model has a 'pooler' layer when using the 'pool' option.");_i=Jo.pooler_output}else _i=Jo.last_hidden_state??Jo.logits??Jo.image_embeds;return _i}}class hn extends pt{constructor(En){super(En)}async _call(En,{top_k:mr=5}={}){const Do=this.processor.feature_extractor.config.sampling_rate,Go=await ct(En,Do),Jo=this.model.config.id2label,_i=[];for(const Ho of Go){const _c=await this.processor(Ho),ep=(await this.model(_c)).logits[0],lp=await(0,lt.topk)(new lt.Tensor("float32",(0,$.softmax)(ep.data),ep.dims),mr),_p=lp[0].tolist(),bp=lp[1].tolist().map((gp,Mp)=>({label:Jo?Jo[gp]:`LABEL_${gp}`,score:_p[Mp]}));_i.push(bp)}return Array.isArray(En)?_i:_i[0]}}class _n extends pt{constructor(En){super(En)}async _call(En,mr,{hypothesis_template:Do="This is a sound of {}."}={}){const Go=!Array.isArray(En);Go&&(En=[En]);const Jo=mr.map(ep=>Do.replace("{}",ep)),_i=this.tokenizer(Jo,{padding:!0,truncation:!0}),Ho=this.processor.feature_extractor.config.sampling_rate,_c=await ct(En,Ho),Qo=[];for(const ep of _c){const lp=await this.processor(ep),_p=await this.model({..._i,...lp}),Zo=(0,$.softmax)(_p.logits_per_audio.data);Qo.push([...Zo].map((bp,gp)=>({score:bp,label:mr[gp]})))}return Go?Qo[0]:Qo}}class gn extends pt{constructor(En){super(En)}async _call(En,mr={}){switch(this.model.config.model_type){case"whisper":case"lite-whisper":return this._call_whisper(En,mr);case"wav2vec2":case"wav2vec2-bert":case"unispeech":case"unispeech-sat":case"hubert":case"parakeet_ctc":return this._call_wav2vec2(En,mr);case"moonshine":return this._call_moonshine(En,mr);default:throw new Error(`AutomaticSpeechRecognitionPipeline does not support model type '${this.model.config.model_type}'.`)}}async _call_wav2vec2(En,mr){mr.language&&console.warn('`language` parameter is not yet supported for `wav2vec2` models, defaulting to "English".'),mr.task&&console.warn('`task` parameter is not yet supported for `wav2vec2` models, defaulting to "transcribe".');const Do=!Array.isArray(En);Do&&(En=[En]);const Go=this.processor.feature_extractor.config.sampling_rate,Jo=await ct(En,Go),_i=[];for(const Ho of Jo){const _c=await this.processor(Ho),ep=(await this.model(_c)).logits[0],lp=[];for(const Zo of ep)lp.push((0,$.max)(Zo.data)[1]);const _p=this.tokenizer.decode(lp,{skip_special_tokens:!0}).trim();_i.push({text:_p})}return Do?_i[0]:_i}async _call_whisper(En,mr){const Do=mr.return_timestamps??!1,Go=mr.chunk_length_s??0,Jo=mr.force_full_sequences??!1;let _i=mr.stride_length_s??null;const Ho={...mr};Do==="word"&&(Ho.return_token_timestamps=!0,Ho.return_timestamps=!1);const _c=!Array.isArray(En);_c&&(En=[En]);const Qo=this.processor.feature_extractor.config.chunk_length/this.model.config.max_source_positions,ep=this.processor.feature_extractor.config.hop_length,lp=this.processor.feature_extractor.config.sampling_rate,_p=await ct(En,lp),Zo=[];for(const bp of _p){let gp=[];if(Go>0){if(_i===null)_i=Go/6;else if(Go<=_i)throw Error("`chunk_length_s` must be larger than `stride_length_s`.");const ip=lp*Go,fp=lp*_i,Rp=ip-2*fp;let Ap=0;for(;;){const u_=Ap+ip,Ip=bp.subarray(Ap,u_),C_=await this.processor(Ip),G_=Ap===0,z_=u_>=bp.length;if(gp.push({stride:[Ip.length,G_?0:fp,z_?0:fp],input_features:C_.input_features,is_last:z_}),z_)break;Ap+=Rp}}else gp=[{stride:[bp.length,0,0],input_features:(await this.processor(bp)).input_features,is_last:!0}];for(const ip of gp){Ho.num_frames=Math.floor(ip.stride[0]/ep);const fp=await this.model.generate({inputs:ip.input_features,...Ho});Do==="word"?(ip.tokens=fp.sequences.tolist()[0],ip.token_timestamps=fp.token_timestamps.tolist()[0].map(Rp=>(0,$.round)(Rp,2))):ip.tokens=fp[0].tolist(),ip.stride=ip.stride.map(Rp=>Rp/lp)}const[Mp,wp]=this.tokenizer._decode_asr(gp,{time_precision:Qo,return_timestamps:Do,force_full_sequences:Jo});Zo.push({text:Mp,...wp})}return _c?Zo[0]:Zo}async _call_moonshine(En,mr){const Do=!Array.isArray(En);Do&&(En=[En]);const Go=this.processor.feature_extractor.config.sampling_rate,Jo=await ct(En,Go),_i=[];for(const Ho of Jo){const _c=await this.processor(Ho),Qo=Math.floor(Ho.length/Go)*6,ep=await this.model.generate({max_new_tokens:Qo,...mr,..._c}),lp=this.processor.batch_decode(ep,{skip_special_tokens:!0})[0];_i.push({text:lp})}return Do?_i[0]:_i}}class vn extends pt{constructor(En){super(En)}async _call(En,mr={}){const Do=Array.isArray(En),Go=await it(En),{pixel_values:Jo}=await this.processor(Go),_i=[];for(const Ho of Jo){Ho.dims=[1,...Ho.dims];const _c=await this.model.generate({inputs:Ho,...mr}),Qo=this.tokenizer.batch_decode(_c,{skip_special_tokens:!0}).map(ep=>({generated_text:ep.trim()}));_i.push(Qo)}return Do?_i:_i[0]}}class Tn extends pt{constructor(En){super(En)}async _call(En,{top_k:mr=5}={}){const Do=await it(En),{pixel_values:Go}=await this.processor(Do),Jo=await this.model({pixel_values:Go}),_i=this.model.config.id2label,Ho=[];for(const _c of Jo.logits){const Qo=await(0,lt.topk)(new lt.Tensor("float32",(0,$.softmax)(_c.data),_c.dims),mr),ep=Qo[0].tolist(),_p=Qo[1].tolist().map((Zo,bp)=>({label:_i?_i[Zo]:`LABEL_${Zo}`,score:ep[bp]}));Ho.push(_p)}return Array.isArray(En)?Ho:Ho[0]}}class kn extends pt{constructor(En){super(En),this.subtasks_mapping={panoptic:"post_process_panoptic_segmentation",instance:"post_process_instance_segmentation",semantic:"post_process_semantic_segmentation"}}async _call(En,{threshold:mr=.5,mask_threshold:Do=.5,overlap_mask_area_threshold:Go=.8,label_ids_to_fuse:Jo=null,target_sizes:_i=null,subtask:Ho=null}={}){if(Array.isArray(En)&&En.length!==1)throw Error("Image segmentation pipeline currently only supports a batch size of 1.");const Qo=await it(En),ep=Qo.map(ip=>[ip.height,ip.width]),lp=await this.processor(Qo),{inputNames:_p,outputNames:Zo}=this.model.sessions.model;if(!_p.includes("pixel_values")){if(_p.length!==1)throw Error(`Expected a single input name, but got ${_p.length} inputs: ${_p}.`);const ip=_p[0];if(ip in lp)throw Error(`Input name ${ip} already exists in the inputs.`);lp[ip]=lp.pixel_values}const bp=await this.model(lp);let gp=null;if(Ho!==null)gp=this.subtasks_mapping[Ho];else if(this.processor.image_processor){for(const[ip,fp]of Object.entries(this.subtasks_mapping))if(fp in this.processor.image_processor){gp=this.processor.image_processor[fp].bind(this.processor.image_processor),Ho=ip;break}}const Mp=this.model.config.id2label,wp=[];if(Ho)if(Ho==="panoptic"||Ho==="instance"){const ip=gp(bp,mr,Do,Go,Jo,_i??ep)[0],fp=ip.segmentation;for(const Rp of ip.segments_info){const Ap=new Uint8ClampedArray(fp.data.length);for(let Ip=0;Ip<fp.data.length;++Ip)fp.data[Ip]===Rp.id&&(Ap[Ip]=255);const u_=new at.RawImage(Ap,fp.dims[1],fp.dims[0],1);wp.push({score:Rp.score,label:Mp[Rp.label_id],mask:u_})}}else if(Ho==="semantic"){const{segmentation:ip,labels:fp}=gp(bp,_i??ep)[0];for(const Rp of fp){const Ap=new Uint8ClampedArray(ip.data.length);for(let Ip=0;Ip<ip.data.length;++Ip)ip.data[Ip]===Rp&&(Ap[Ip]=255);const u_=new at.RawImage(Ap,ip.dims[1],ip.dims[0],1);wp.push({score:null,label:Mp[Rp],mask:u_})}}else throw Error(`Subtask ${Ho} not supported.`);else{const fp=bp[Zo[0]];for(let Rp=0;Rp<ep.length;++Rp){const Ap=ep[Rp],u_=fp[Rp];u_.data.some(C_=>C_<-1e-5||C_>1+1e-5)&&u_.sigmoid_();const Ip=await at.RawImage.fromTensor(u_.mul_(255).to("uint8")).resize(Ap[1],Ap[0]);wp.push({label:null,score:null,mask:Ip})}}return wp}}class bn extends kn{constructor(En){super(En)}async _call(En,mr={}){if(Array.isArray(En)&&En.length!==1)throw Error("Background removal pipeline currently only supports a batch size of 1.");const Go=await it(En),Jo=await super._call(En,mr);return Go.map((Ho,_c)=>{const Qo=Ho.clone();return Qo.putAlpha(Jo[_c].mask),Qo})}}class Sn extends pt{constructor(En){super(En)}async _call(En,mr,{hypothesis_template:Do="This is a photo of {}"}={}){const Go=Array.isArray(En),Jo=await it(En),_i=mr.map(_p=>Do.replace("{}",_p)),Ho=this.tokenizer(_i,{padding:this.model.config.model_type==="siglip"?"max_length":!0,truncation:!0}),{pixel_values:_c}=await this.processor(Jo),Qo=await this.model({...Ho,pixel_values:_c}),ep=this.model.config.model_type==="siglip"?_p=>_p.sigmoid().data:_p=>(0,$.softmax)(_p.data),lp=[];for(const _p of Qo.logits_per_image){const bp=[...ep(_p)].map((gp,Mp)=>({score:gp,label:mr[Mp]}));bp.sort((gp,Mp)=>Mp.score-gp.score),lp.push(bp)}return Go?lp:lp[0]}}class fn extends pt{constructor(En){super(En)}async _call(En,{threshold:mr=.9,percentage:Do=!1}={}){const Go=Array.isArray(En);if(Go&&En.length!==1)throw Error("Object detection pipeline currently only supports a batch size of 1.");const Jo=await it(En),_i=Do?null:Jo.map(Zo=>[Zo.height,Zo.width]),{pixel_values:Ho,pixel_mask:_c}=await this.processor(Jo),Qo=await this.model({pixel_values:Ho,pixel_mask:_c}),ep=this.processor.image_processor.post_process_object_detection(Qo,mr,_i),lp=this.model.config.id2label,_p=ep.map(Zo=>Zo.boxes.map((bp,gp)=>({score:Zo.scores[gp],label:lp[Zo.classes[gp]],box:mt(bp,!Do)})));return Go?_p:_p[0]}}class or extends pt{constructor(En){super(En)}async _call(En,mr,{threshold:Do=.1,top_k:Go=null,percentage:Jo=!1}={}){const _i=Array.isArray(En),Ho=await it(En),_c=this.tokenizer(mr,{padding:!0,truncation:!0}),Qo=await this.processor(Ho),ep=[];for(let lp=0;lp<Ho.length;++lp){const _p=Ho[lp],Zo=Jo?null:[[_p.height,_p.width]],bp=Qo.pixel_values[lp].unsqueeze_(0),gp=await this.model({..._c,pixel_values:bp});let Mp;if("post_process_grounded_object_detection"in this.processor){const wp=this.processor.post_process_grounded_object_detection(gp,_c.input_ids,{box_threshold:Do,text_threshold:Do,target_sizes:Zo})[0];Mp=wp.boxes.map((ip,fp)=>({score:wp.scores[fp],label:wp.labels[fp],box:mt(ip,!Jo)}))}else{const wp=this.processor.image_processor.post_process_object_detection(gp,Do,Zo,!0)[0];Mp=wp.boxes.map((ip,fp)=>({score:wp.scores[fp],label:mr[wp.classes[fp]],box:mt(ip,!Jo)}))}Mp.sort((wp,ip)=>ip.score-wp.score),Go!==null&&(Mp=Mp.slice(0,Go)),ep.push(Mp)}return _i?ep:ep[0]}}class lr extends pt{constructor(En){super(En)}async _call(En,mr,Do={}){const Go=(await it(En))[0],{pixel_values:Jo}=await this.processor(Go),_i=`<s_docvqa><s_question>${mr}</s_question><s_answer>`,Ho=this.tokenizer(_i,{add_special_tokens:!1,padding:!0,truncation:!0}).input_ids,_c=await this.model.generate({inputs:Jo,max_length:this.model.config.decoder.max_position_embeddings,decoder_input_ids:Ho,...Do}),ep=this.tokenizer.batch_decode(_c)[0].match(/<s_answer>(.*?)<\/s_answer>/);let lp=null;return ep&&ep.length>=2&&(lp=ep[1].trim()),[{answer:lp}]}}class pn extends pt{constructor(mr){super(mr);Oo(this,"DEFAULT_VOCODER_ID","Xenova/speecht5_hifigan");this.vocoder=mr.vocoder??null}async _call(mr,{speaker_embeddings:Do=null}={}){return this.processor?this._call_text_to_spectrogram(mr,{speaker_embeddings:Do}):this._call_text_to_waveform(mr)}async _call_text_to_waveform(mr){const Do=this.tokenizer(mr,{padding:!0,truncation:!0}),{waveform:Go}=await this.model(Do),Jo=this.model.config.sampling_rate;return new _e.RawAudio(Go.data,Jo)}async _call_text_to_spectrogram(mr,{speaker_embeddings:Do}){if(this.vocoder||(console.log("No vocoder specified, using default HifiGan vocoder."),this.vocoder=await d.AutoModel.from_pretrained(this.DEFAULT_VOCODER_ID,{dtype:"fp32"})),(typeof Do=="string"||Do instanceof URL)&&(Do=new Float32Array(await(await fetch(Do)).arrayBuffer())),Do instanceof Float32Array)Do=new lt.Tensor("float32",Do,[1,Do.length]);else if(!(Do instanceof lt.Tensor))throw new Error("Speaker embeddings must be a `Tensor`, `Float32Array`, `string`, or `URL`.");const{input_ids:Go}=this.tokenizer(mr,{padding:!0,truncation:!0}),{waveform:Jo}=await this.model.generate_speech(Go,Do,{vocoder:this.vocoder}),_i=this.processor.feature_extractor.config.sampling_rate;return new _e.RawAudio(Jo.data,_i)}}class Cn extends pt{constructor(En){super(En)}async _call(En){const mr=await it(En),Do=await this.processor(mr),Go=await this.model(Do),Jo=[];for(const _i of Go.reconstruction){const Ho=_i.squeeze().clamp_(0,1).mul_(255).round_().to("uint8");Jo.push(at.RawImage.fromTensor(Ho))}return Jo.length>1?Jo:Jo[0]}}class Lo extends pt{constructor(En){super(En)}async _call(En){const mr=await it(En),Do=await this.processor(mr),{predicted_depth:Go}=await this.model(Do),Jo=[];for(let _i=0;_i<mr.length;++_i){const Ho=Go[_i],[_c,Qo]=Ho.dims.slice(-2),[ep,lp]=mr[_i].size,_p=(await(0,lt.interpolate_4d)(Ho.view(1,1,_c,Qo),{size:[lp,ep],mode:"bilinear"})).view(lp,ep),Zo=_p.min().item(),bp=_p.max().item(),gp=_p.sub(Zo).div_(bp-Zo).mul_(255).to("uint8").unsqueeze(0),Mp=at.RawImage.fromTensor(gp);Jo.push({predicted_depth:_p,depth:Mp})}return Jo.length>1?Jo:Jo[0]}}const Mo=Object.freeze({"text-classification":{tokenizer:c.AutoTokenizer,pipeline:zt,model:d.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-finetuned-sst-2-english"},type:"text"},"token-classification":{tokenizer:c.AutoTokenizer,pipeline:dt,model:d.AutoModelForTokenClassification,default:{model:"Xenova/bert-base-multilingual-cased-ner-hrl"},type:"text"},"question-answering":{tokenizer:c.AutoTokenizer,pipeline:ft,model:d.AutoModelForQuestionAnswering,default:{model:"Xenova/distilbert-base-cased-distilled-squad"},type:"text"},"fill-mask":{tokenizer:c.AutoTokenizer,pipeline:kt,model:d.AutoModelForMaskedLM,default:{model:"Xenova/bert-base-uncased"},type:"text"},summarization:{tokenizer:c.AutoTokenizer,pipeline:Lt,model:d.AutoModelForSeq2SeqLM,default:{model:"Xenova/distilbart-cnn-6-6"},type:"text"},translation:{tokenizer:c.AutoTokenizer,pipeline:Gt,model:d.AutoModelForSeq2SeqLM,default:{model:"Xenova/t5-small"},type:"text"},"text2text-generation":{tokenizer:c.AutoTokenizer,pipeline:St,model:d.AutoModelForSeq2SeqLM,default:{model:"Xenova/flan-t5-small"},type:"text"},"text-generation":{tokenizer:c.AutoTokenizer,pipeline:nr,model:d.AutoModelForCausalLM,default:{model:"Xenova/gpt2"},type:"text"},"zero-shot-classification":{tokenizer:c.AutoTokenizer,pipeline:cr,model:d.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-mnli"},type:"text"},"audio-classification":{pipeline:hn,model:d.AutoModelForAudioClassification,processor:h.AutoProcessor,default:{model:"Xenova/wav2vec2-base-superb-ks"},type:"audio"},"zero-shot-audio-classification":{tokenizer:c.AutoTokenizer,pipeline:_n,model:d.AutoModel,processor:h.AutoProcessor,default:{model:"Xenova/clap-htsat-unfused"},type:"multimodal"},"automatic-speech-recognition":{tokenizer:c.AutoTokenizer,pipeline:gn,model:[d.AutoModelForSpeechSeq2Seq,d.AutoModelForCTC],processor:h.AutoProcessor,default:{model:"Xenova/whisper-tiny.en"},type:"multimodal"},"text-to-audio":{tokenizer:c.AutoTokenizer,pipeline:pn,model:[d.AutoModelForTextToWaveform,d.AutoModelForTextToSpectrogram],processor:[h.AutoProcessor,null],default:{model:"Xenova/speecht5_tts"},type:"text"},"image-to-text":{tokenizer:c.AutoTokenizer,pipeline:vn,model:d.AutoModelForVision2Seq,processor:h.AutoProcessor,default:{model:"Xenova/vit-gpt2-image-captioning"},type:"multimodal"},"image-classification":{pipeline:Tn,model:d.AutoModelForImageClassification,processor:h.AutoProcessor,default:{model:"Xenova/vit-base-patch16-224"},type:"multimodal"},"image-segmentation":{pipeline:kn,model:[d.AutoModelForImageSegmentation,d.AutoModelForSemanticSegmentation,d.AutoModelForUniversalSegmentation],processor:h.AutoProcessor,default:{model:"Xenova/detr-resnet-50-panoptic"},type:"multimodal"},"background-removal":{pipeline:bn,model:[d.AutoModelForImageSegmentation,d.AutoModelForSemanticSegmentation,d.AutoModelForUniversalSegmentation],processor:h.AutoProcessor,default:{model:"Xenova/modnet"},type:"image"},"zero-shot-image-classification":{tokenizer:c.AutoTokenizer,pipeline:Sn,model:d.AutoModel,processor:h.AutoProcessor,default:{model:"Xenova/clip-vit-base-patch32"},type:"multimodal"},"object-detection":{pipeline:fn,model:d.AutoModelForObjectDetection,processor:h.AutoProcessor,default:{model:"Xenova/detr-resnet-50"},type:"multimodal"},"zero-shot-object-detection":{tokenizer:c.AutoTokenizer,pipeline:or,model:d.AutoModelForZeroShotObjectDetection,processor:h.AutoProcessor,default:{model:"Xenova/owlvit-base-patch32"},type:"multimodal"},"document-question-answering":{tokenizer:c.AutoTokenizer,pipeline:lr,model:d.AutoModelForDocumentQuestionAnswering,processor:h.AutoProcessor,default:{model:"Xenova/donut-base-finetuned-docvqa"},type:"multimodal"},"image-to-image":{pipeline:Cn,model:d.AutoModelForImageToImage,processor:h.AutoProcessor,default:{model:"Xenova/swin2SR-classical-sr-x2-64"},type:"image"},"depth-estimation":{pipeline:Lo,model:d.AutoModelForDepthEstimation,processor:h.AutoProcessor,default:{model:"Xenova/dpt-large"},type:"image"},"feature-extraction":{tokenizer:c.AutoTokenizer,pipeline:ur,model:d.AutoModel,default:{model:"Xenova/all-MiniLM-L6-v2"},type:"text"},"image-feature-extraction":{processor:h.AutoProcessor,pipeline:yn,model:[d.AutoModelForImageFeatureExtraction,d.AutoModel],default:{model:"Xenova/vit-base-patch16-224-in21k"},type:"image"}}),Ro=Object.freeze({"sentiment-analysis":"text-classification",ner:"token-classification",asr:"automatic-speech-recognition","text-to-speech":"text-to-audio",embeddings:"feature-extraction"});async function qo(Wo,En=null,{progress_callback:mr=null,config:Do=null,cache_dir:Go=null,local_files_only:Jo=!1,revision:_i="main",device:Ho=null,dtype:_c=null,subfolder:Qo="onnx",use_external_data_format:ep=null,model_file_name:lp=null,session_options:_p={}}={}){Wo=Ro[Wo]??Wo;const Zo=Mo[Wo.split("_",1)[0]];if(!Zo)throw Error(`Unsupported pipeline: ${Wo}. Must be one of [${Object.keys(Mo)}]`);En||(En=Zo.default.model,console.log(`No model specified. Using default model: "${En}".`));const bp={progress_callback:mr,config:Do,cache_dir:Go,local_files_only:Jo,revision:_i,device:Ho,dtype:_c,subfolder:Qo,use_external_data_format:ep,model_file_name:lp,session_options:_p},gp=new Map([["tokenizer",Zo.tokenizer],["model",Zo.model],["processor",Zo.processor]]),Mp=await tp(gp,En,bp);Mp.task=Wo,(0,g.dispatchCallback)(mr,{status:"ready",task:Wo,model:En});const wp=Zo.pipeline;return new wp(Mp)}async function tp(Wo,En,mr){const Do=Object.create(null),Go=[];for(const[Jo,_i]of Wo.entries()){if(!_i)continue;let Ho;Array.isArray(_i)?Ho=new Promise(async(_c,Qo)=>{var lp,_p;let ep;for(const Zo of _i){if(Zo===null){_c(null);return}try{_c(await Zo.from_pretrained(En,mr));return}catch(bp){if((lp=bp.message)!=null&&lp.includes("Unsupported model type"))ep=bp;else if((_p=bp.message)!=null&&_p.includes("Could not locate file"))ep=bp;else{Qo(bp);return}}}Qo(ep)}):Ho=_i.from_pretrained(En,mr),Do[Jo]=Ho,Go.push(Ho)}await Promise.all(Go);for(const[Jo,_i]of Object.entries(Do))Do[Jo]=await _i;return Do}},"./src/tokenizers.js":(e,s,i)=>{i.r(s),i.d(s,{AlbertTokenizer:()=>g_,AutoTokenizer:()=>Ew,BartTokenizer:()=>kp,BertTokenizer:()=>r_,BlenderbotSmallTokenizer:()=>P_,BlenderbotTokenizer:()=>$p,BloomTokenizer:()=>bx,CLIPTokenizer:()=>rw,CamembertTokenizer:()=>sp,CodeGenTokenizer:()=>Nx,CodeLlamaTokenizer:()=>B_,CohereTokenizer:()=>vw,ConvBertTokenizer:()=>An,DebertaTokenizer:()=>ir,DebertaV2Tokenizer:()=>In,DistilBertTokenizer:()=>Yo,ElectraTokenizer:()=>n_,Ernie4_5_Tokenizer:()=>Mw,EsmTokenizer:()=>Xx,FalconTokenizer:()=>ux,GPT2Tokenizer:()=>i_,GPTNeoXTokenizer:()=>Qx,GemmaTokenizer:()=>jx,Grok1Tokenizer:()=>kx,HerbertTokenizer:()=>wn,LlamaTokenizer:()=>lx,M2M100Tokenizer:()=>K_,MBart50Tokenizer:()=>$_,MBartTokenizer:()=>h_,MPNetTokenizer:()=>Ox,MarianTokenizer:()=>dp,MgpstrTokenizer:()=>bw,MobileBertTokenizer:()=>Pp,NllbTokenizer:()=>Bx,NougatTokenizer:()=>Ux,PreTrainedTokenizer:()=>e_,Qwen2Tokenizer:()=>rx,RoFormerTokenizer:()=>No,RobertaTokenizer:()=>xx,SiglipTokenizer:()=>wx,SpeechT5Tokenizer:()=>nw,SqueezeBertTokenizer:()=>m_,T5Tokenizer:()=>zp,TokenizerModel:()=>yn,VitsTokenizer:()=>Px,Wav2Vec2CTCTokenizer:()=>pp,WhisperTokenizer:()=>L_,XLMRobertaTokenizer:()=>Rx,XLMTokenizer:()=>Cp,is_chinese_char:()=>kt});var c=i("./src/utils/generic.js"),d=i("./src/utils/core.js"),h=i("./src/utils/hub.js"),_=i("./src/utils/maths.js"),g=i("./src/utils/tensor.js"),$=i("./src/utils/data-structures.js"),_e=i("./node_modules/@huggingface/jinja/dist/index.js"),lt=i("./src/models/whisper/common_whisper.js");async function at(Vo,dr){const $n=await Promise.all([(0,h.getModelJSON)(Vo,"tokenizer.json",!0,dr),(0,h.getModelJSON)(Vo,"tokenizer_config.json",!0,dr)]);return dr.legacy!==null&&($n[1].legacy=dr.legacy),$n}function it(Vo,dr){const $n=[];let jo=0;for(const zo of Vo.matchAll(dr)){const Uo=zo[0];jo<zo.index&&$n.push(Vo.slice(jo,zo.index)),Uo.length>0&&$n.push(Uo),jo=zo.index+Uo.length}return jo<Vo.length&&$n.push(Vo.slice(jo)),$n}function ct(Vo,dr=!0){if(Vo.Regex!==void 0){let $n=Vo.Regex.replace(/\\([#&~])/g,"$1");for(const[jo,zo]of cr)$n=$n.replaceAll(jo,zo);return new RegExp($n,"gu")}else if(Vo.String!==void 0){const $n=(0,d.escapeRegExp)(Vo.String);return new RegExp(dr?$n:`(${$n})`,"gu")}else return console.warn("Unknown pattern type:",Vo),null}function mt(Vo){return new Map(Object.entries(Vo))}function pt(Vo){const dr=Vo.dims;switch(dr.length){case 1:return Vo.tolist();case 2:if(dr[0]!==1)throw new Error("Unable to decode tensor with `batch size !== 1`. Use `tokenizer.batch_decode(...)` for batched inputs.");return Vo.tolist()[0];default:throw new Error(`Expected tensor to have 1-2 dimensions, got ${dr.length}.`)}}function zt(Vo){return Vo.replace(/ \./g,".").replace(/ \?/g,"?").replace(/ \!/g,"!").replace(/ ,/g,",").replace(/ \' /g,"'").replace(/ n\'t/g,"n't").replace(/ \'m/g,"'m").replace(/ \'s/g,"'s").replace(/ \'ve/g,"'ve").replace(/ \'re/g,"'re")}function dt(Vo){return Vo.replace(new RegExp("\\p{M}","gu"),"")}function ft(Vo){return dt(Vo.toLowerCase())}function kt(Vo){return Vo>=19968&&Vo<=40959||Vo>=13312&&Vo<=19903||Vo>=131072&&Vo<=173791||Vo>=173824&&Vo<=177983||Vo>=177984&&Vo<=178207||Vo>=178208&&Vo<=183983||Vo>=63744&&Vo<=64255||Vo>=194560&&Vo<=195103}function St(Vo,dr,$n){const jo=[];let zo=0;for(;zo<Vo.length;){if(jo.push(Vo[zo]),(dr.get(Vo[zo])??$n)!==$n){++zo;continue}for(;++zo<Vo.length&&(dr.get(Vo[zo])??$n)===$n;)dr.get(jo.at(-1))!==$n&&(jo[jo.length-1]+=Vo[zo])}return jo}function Lt(Vo){return Vo.match(/\S+/g)||[]}const Gt="\\p{P}\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E",Bt=new RegExp(`^[${Gt}]+$`,"gu"),nr=".,!?",cr=new Map([["(?i:'s|'t|'re|'ve|'m|'ll|'d)","(?:'([sS]|[tT]|[rR][eE]|[vV][eE]|[mM]|[lL][lL]|[dD]))"],["(?i:[sdmt]|ll|ve|re)","(?:[sS]|[dD]|[mM]|[tT]|[lL][lL]|[vV][eE]|[rR][eE])"],["[^\\r\\n\\p{L}\\p{N}]?+","[^\\r\\n\\p{L}\\p{N}]?"],["[^\\s\\p{L}\\p{N}]++","[^\\s\\p{L}\\p{N}]+"],[` ?[^(\\s|[${nr}])]+`,` ?[^\\s${nr}]+`]]);class ur{constructor(dr){this.content=dr.content,this.id=dr.id,this.single_word=dr.single_word??!1,this.lstrip=dr.lstrip??!1,this.rstrip=dr.rstrip??!1,this.special=dr.special??!1,this.normalized=dr.normalized??null}}class yn extends c.Callable{constructor(dr){super(),this.config=dr,this.vocab=[],this.tokens_to_ids=new Map,this.unk_token_id=void 0,this.unk_token=void 0,this.end_of_word_suffix=void 0,this.fuse_unk=this.config.fuse_unk??!1}static fromConfig(dr,...$n){switch(dr.type){case"WordPiece":return new hn(dr);case"Unigram":return new _n(dr,...$n);case"BPE":return new Tn(dr);default:if(dr.vocab)return Array.isArray(dr.vocab)?new _n(dr,...$n):Object.hasOwn(dr,"continuing_subword_prefix")&&Object.hasOwn(dr,"unk_token")?Object.hasOwn(dr,"merges")?new Tn(dr):new hn(dr):new kn(dr,...$n);throw new Error(`Unknown TokenizerModel type: ${dr.type}`)}}_call(dr){return dr=this.encode(dr),this.fuse_unk&&(dr=St(dr,this.tokens_to_ids,this.unk_token_id)),dr}encode(dr){throw Error("encode should be implemented in subclass.")}convert_tokens_to_ids(dr){return dr.map($n=>this.tokens_to_ids.get($n)??this.unk_token_id)}convert_ids_to_tokens(dr){return dr.map($n=>this.vocab[$n]??this.unk_token)}}class hn extends yn{constructor(dr){super(dr),this.tokens_to_ids=mt(dr.vocab),this.unk_token_id=this.tokens_to_ids.get(dr.unk_token),this.unk_token=dr.unk_token,this.max_input_chars_per_word=dr.max_input_chars_per_word??100,this.vocab=new Array(this.tokens_to_ids.size);for(const[$n,jo]of this.tokens_to_ids)this.vocab[jo]=$n}encode(dr){const $n=[];for(const jo of dr){const zo=[...jo];if(zo.length>this.max_input_chars_per_word){$n.push(this.unk_token);continue}let Uo=!1,bu=0;const mp=[];for(;bu<zo.length;){let yp=zo.length,xp=null;for(;bu<yp;){let Tp=zo.slice(bu,yp).join("");if(bu>0&&(Tp=this.config.continuing_subword_prefix+Tp),this.tokens_to_ids.has(Tp)){xp=Tp;break}--yp}if(xp===null){Uo=!0;break}mp.push(xp),bu=yp}Uo?$n.push(this.unk_token):$n.push(...mp)}return $n}}class _n extends yn{constructor(dr,$n){super(dr);const jo=dr.vocab.length;this.vocab=new Array(jo),this.scores=new Array(jo);for(let zo=0;zo<jo;++zo)[this.vocab[zo],this.scores[zo]]=dr.vocab[zo];this.unk_token_id=dr.unk_id,this.unk_token=this.vocab[dr.unk_id],this.tokens_to_ids=new Map(this.vocab.map((zo,Uo)=>[zo,Uo])),this.bos_token=" ",this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=$n.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.unk_token=this.vocab[this.unk_token_id],this.minScore=(0,_.min)(this.scores)[0],this.unk_score=this.minScore-10,this.scores[this.unk_token_id]=this.unk_score,this.trie=new $.CharTrie,this.trie.extend(this.vocab),this.fuse_unk=!0}populateNodes(dr){const $n=dr.chars,jo=1;let zo=0;for(;zo<$n.length;){let Uo=!1;const bu=$n.slice(zo).join(""),mp=this.trie.commonPrefixSearch(bu);for(const yp of mp){const xp=this.tokens_to_ids.get(yp),Tp=this.scores[xp],s_=(0,d.len)(yp);dr.insert(zo,s_,Tp,xp),!Uo&&s_===jo&&(Uo=!0)}Uo||dr.insert(zo,jo,this.unk_score,this.unk_token_id),zo+=jo}}tokenize(dr){const $n=new $.TokenLattice(dr,this.bos_token_id,this.eos_token_id);return this.populateNodes($n),$n.tokens()}encode(dr){const $n=[];for(const jo of dr){const zo=this.tokenize(jo);$n.push(...zo)}return $n}}const gn=(()=>{const Vo=[...Array.from({length:94},(zo,Uo)=>Uo+33),...Array.from({length:12},(zo,Uo)=>Uo+161),...Array.from({length:82},(zo,Uo)=>Uo+174)],dr=Vo.slice();let $n=0;for(let zo=0;zo<256;++zo)Vo.includes(zo)||(Vo.push(zo),dr.push(256+$n),$n+=1);const jo=dr.map(zo=>String.fromCharCode(zo));return Object.fromEntries(Vo.map((zo,Uo)=>[zo,jo[Uo]]))})(),vn=(0,d.reverseDictionary)(gn);class Tn extends yn{constructor(dr){super(dr),this.tokens_to_ids=mt(dr.vocab),this.unk_token_id=this.tokens_to_ids.get(dr.unk_token),this.unk_token=dr.unk_token,this.vocab=new Array(this.tokens_to_ids.size);for(const[jo,zo]of this.tokens_to_ids)this.vocab[zo]=jo;const $n=Array.isArray(dr.merges[0]);this.merges=$n?dr.merges:dr.merges.map(jo=>jo.split(" ",2)),this.bpe_ranks=new Map(this.merges.map((jo,zo)=>[JSON.stringify(jo),zo])),this.end_of_word_suffix=dr.end_of_word_suffix,this.continuing_subword_suffix=dr.continuing_subword_suffix??null,this.byte_fallback=this.config.byte_fallback??!1,this.byte_fallback&&(this.text_encoder=new TextEncoder),this.ignore_merges=this.config.ignore_merges??!1,this.max_length_to_cache=256,this.cache_capacity=1e4,this.cache=new $.LRUCache(this.cache_capacity)}clear_cache(){this.cache.clear()}bpe(dr){if(dr.length===0)return[];const $n=this.cache.get(dr);if($n!==void 0)return $n;const jo=Array.from(dr);this.end_of_word_suffix&&(jo[jo.length-1]+=this.end_of_word_suffix);let zo=[];if(jo.length>1){const Uo=new $.PriorityQueue((yp,xp)=>yp.score<xp.score);let bu={token:jo[0],bias:0,prev:null,next:null},mp=bu;for(let yp=1;yp<jo.length;++yp){const xp={bias:yp/jo.length,token:jo[yp],prev:mp,next:null};mp.next=xp,this._add_node(Uo,mp),mp=xp}for(;!Uo.isEmpty();){const yp=Uo.pop();if(yp.deleted||!yp.next||yp.next.deleted)continue;if(yp.deleted=!0,yp.next.deleted=!0,yp.prev){const Tp={...yp.prev};yp.prev.deleted=!0,yp.prev=Tp,Tp.prev?Tp.prev.next=Tp:bu=Tp}const xp={token:yp.token+yp.next.token,bias:yp.bias,prev:yp.prev,next:yp.next.next};xp.prev?(xp.prev.next=xp,this._add_node(Uo,xp.prev)):bu=xp,xp.next&&(xp.next.prev=xp,this._add_node(Uo,xp))}for(let yp=bu;yp!==null;yp=yp.next)zo.push(yp.token)}else zo=jo;if(this.continuing_subword_suffix)for(let Uo=0;Uo<zo.length-1;++Uo)zo[Uo]+=this.continuing_subword_suffix;return dr.length<this.max_length_to_cache&&this.cache.put(dr,zo),zo}_add_node(dr,$n){const jo=this.bpe_ranks.get(JSON.stringify([$n.token,$n.next.token]));jo!==void 0&&($n.score=jo+$n.bias,dr.push($n))}encode(dr){const $n=[];for(const jo of dr){if(this.ignore_merges&&this.tokens_to_ids.has(jo)){$n.push(jo);continue}const zo=this.bpe(jo);for(const Uo of zo)if(this.tokens_to_ids.has(Uo))$n.push(Uo);else if(this.byte_fallback){const bu=Array.from(this.text_encoder.encode(Uo)).map(mp=>`<0x${mp.toString(16).toUpperCase().padStart(2,"0")}>`);bu.every(mp=>this.tokens_to_ids.has(mp))?$n.push(...bu):$n.push(this.unk_token)}else $n.push(this.unk_token)}return $n}}class kn extends yn{constructor(dr,$n){super(dr),this.tokens_to_ids=mt($n.target_lang?dr.vocab[$n.target_lang]:dr.vocab),this.bos_token=$n.bos_token,this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=$n.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.pad_token=$n.pad_token,this.pad_token_id=this.tokens_to_ids.get(this.pad_token),this.unk_token=$n.unk_token,this.unk_token_id=this.tokens_to_ids.get(this.unk_token),this.vocab=new Array(this.tokens_to_ids.size);for(const[jo,zo]of this.tokens_to_ids)this.vocab[zo]=jo}encode(dr){return dr}}class bn extends c.Callable{constructor(dr){super(),this.config=dr}static fromConfig(dr){if(dr===null)return null;switch(dr.type){case"BertNormalizer":return new Wo(dr);case"Precompiled":return new z_(dr);case"Sequence":return new tp(dr);case"Replace":return new Sn(dr);case"NFC":return new or(dr);case"NFD":return new lr(dr);case"NFKC":return new pn(dr);case"NFKD":return new Cn(dr);case"Strip":return new Lo(dr);case"StripAccents":return new Mo(dr);case"Lowercase":return new Ro(dr);case"Prepend":return new qo(dr);default:throw new Error(`Unknown Normalizer type: ${dr.type}`)}}normalize(dr){throw Error("normalize should be implemented in subclass.")}_call(dr){return this.normalize(dr)}}class Sn extends bn{normalize(dr){const $n=ct(this.config.pattern);return $n===null?dr:dr.replaceAll($n,this.config.content)}}class fn extends bn{constructor(){super(...arguments);Oo(this,"form")}normalize($n){return $n=$n.normalize(this.form),$n}}class or extends fn{constructor(){super(...arguments);Oo(this,"form","NFC")}}class lr extends fn{constructor(){super(...arguments);Oo(this,"form","NFD")}}class pn extends fn{constructor(){super(...arguments);Oo(this,"form","NFKC")}}class Cn extends fn{constructor(){super(...arguments);Oo(this,"form","NFKD")}}class Lo extends bn{normalize(dr){return this.config.strip_left&&this.config.strip_right?dr=dr.trim():(this.config.strip_left&&(dr=dr.trimStart()),this.config.strip_right&&(dr=dr.trimEnd())),dr}}class Mo extends bn{normalize(dr){return dr=dt(dr),dr}}class Ro extends bn{normalize(dr){return dr=dr.toLowerCase(),dr}}class qo extends bn{normalize(dr){return dr=this.config.prepend+dr,dr}}class tp extends bn{constructor(dr){super(dr),this.normalizers=dr.normalizers.map($n=>bn.fromConfig($n))}normalize(dr){return this.normalizers.reduce(($n,jo)=>jo.normalize($n),dr)}}class Wo extends bn{_tokenize_chinese_chars(dr){const $n=[];for(let jo=0;jo<dr.length;++jo){const zo=dr[jo],Uo=zo.charCodeAt(0);kt(Uo)?($n.push(" "),$n.push(zo),$n.push(" ")):$n.push(zo)}return $n.join("")}stripAccents(dr){return dr.normalize("NFD").replace(new RegExp("\\p{Mn}","gu"),"")}_is_control(dr){switch(dr){case"	":case`
`:case"\r":return!1;default:return new RegExp("^\\p{Cc}|\\p{Cf}|\\p{Co}|\\p{Cs}$","u").test(dr)}}_clean_text(dr){const $n=[];for(const jo of dr){const zo=jo.charCodeAt(0);zo===0||zo===65533||this._is_control(jo)||(/^\s$/.test(jo)?$n.push(" "):$n.push(jo))}return $n.join("")}normalize(dr){return this.config.clean_text&&(dr=this._clean_text(dr)),this.config.handle_chinese_chars&&(dr=this._tokenize_chinese_chars(dr)),this.config.lowercase?(dr=dr.toLowerCase(),this.config.strip_accents!==!1&&(dr=this.stripAccents(dr))):this.config.strip_accents&&(dr=this.stripAccents(dr)),dr}}class En extends c.Callable{static fromConfig(dr){if(dr===null)return null;switch(dr.type){case"BertPreTokenizer":return new mr(dr);case"Sequence":return new hx(dr);case"Whitespace":return new S_(dr);case"WhitespaceSplit":return new H_(dr);case"Metaspace":return new C_(dr);case"ByteLevel":return new Do(dr);case"Split":return new Go(dr);case"Punctuation":return new Jo(dr);case"Digits":return new _i(dr);case"Replace":return new zx(dr);default:throw new Error(`Unknown PreTokenizer type: ${dr.type}`)}}pre_tokenize_text(dr,$n){throw Error("pre_tokenize_text should be implemented in subclass.")}pre_tokenize(dr,$n){return(Array.isArray(dr)?dr.map(jo=>this.pre_tokenize_text(jo,$n)):this.pre_tokenize_text(dr,$n)).flat()}_call(dr,$n){return this.pre_tokenize(dr,$n)}}class mr extends En{constructor(dr){super(),this.pattern=new RegExp(`[^\\s${Gt}]+|[${Gt}]`,"gu")}pre_tokenize_text(dr,$n){return dr.trim().match(this.pattern)||[]}}class Do extends En{constructor(dr){super(),this.config=dr,this.add_prefix_space=this.config.add_prefix_space,this.trim_offsets=this.config.trim_offsets,this.use_regex=this.config.use_regex??!0,this.pattern=new RegExp("'s|'t|'re|'ve|'m|'ll|'d| ?\\p{L}+| ?\\p{N}+| ?[^\\s\\p{L}\\p{N}]+|\\s+(?!\\S)|\\s+","gu"),this.byte_encoder=gn,this.text_encoder=new TextEncoder}pre_tokenize_text(dr,$n){return this.add_prefix_space&&!dr.startsWith(" ")&&(dr=" "+dr),(this.use_regex?dr.match(this.pattern)||[]:[dr]).map(zo=>Array.from(this.text_encoder.encode(zo),Uo=>this.byte_encoder[Uo]).join(""))}}class Go extends En{constructor(dr){super(),this.config=dr,this.pattern=ct(this.config.pattern,this.config.invert)}pre_tokenize_text(dr,$n){var jo;return this.pattern===null?[]:this.config.invert?dr.match(this.pattern)||[]:((jo=this.config.behavior)==null?void 0:jo.toLowerCase())==="removed"?dr.split(this.pattern).filter(zo=>zo):it(dr,this.pattern)}}class Jo extends En{constructor(dr){super(),this.config=dr,this.pattern=new RegExp(`[^${Gt}]+|[${Gt}]+`,"gu")}pre_tokenize_text(dr,$n){return dr.match(this.pattern)||[]}}class _i extends En{constructor(dr){super(),this.config=dr;const $n=`[^\\d]+|\\d${this.config.individual_digits?"":"+"}`;this.pattern=new RegExp($n,"gu")}pre_tokenize_text(dr,$n){return dr.match(this.pattern)||[]}}class Ho extends c.Callable{constructor(dr){super(),this.config=dr}static fromConfig(dr){if(dr===null)return null;switch(dr.type){case"TemplateProcessing":return new ep(dr);case"ByteLevel":return new lp(dr);case"RobertaProcessing":return new Qo(dr);case"BertProcessing":return new _c(dr);case"Sequence":return new _p(dr);default:throw new Error(`Unknown PostProcessor type: ${dr.type}`)}}post_process(dr,...$n){throw Error("post_process should be implemented in subclass.")}_call(dr,...$n){return this.post_process(dr,...$n)}}class _c extends Ho{constructor(dr){super(dr),this.cls=dr.cls[0],this.sep=dr.sep[0]}post_process(dr,$n=null,{add_special_tokens:jo=!0}={}){jo&&(dr=(0,d.mergeArrays)([this.cls],dr,[this.sep]));let zo=new Array(dr.length).fill(0);if($n!==null){const Uo=jo&&this instanceof Qo?[this.sep]:[],bu=jo?[this.sep]:[];dr=(0,d.mergeArrays)(dr,Uo,$n,bu),zo=(0,d.mergeArrays)(zo,new Array($n.length+Uo.length+bu.length).fill(1))}return{tokens:dr,token_type_ids:zo}}}class Qo extends _c{}class ep extends Ho{constructor(dr){super(dr),this.single=dr.single,this.pair=dr.pair}post_process(dr,$n=null,{add_special_tokens:jo=!0}={}){const zo=$n===null?this.single:this.pair;let Uo=[],bu=[];for(const mp of zo)"SpecialToken"in mp?jo&&(Uo.push(mp.SpecialToken.id),bu.push(mp.SpecialToken.type_id)):"Sequence"in mp&&(mp.Sequence.id==="A"?(Uo=(0,d.mergeArrays)(Uo,dr),bu=(0,d.mergeArrays)(bu,new Array(dr.length).fill(mp.Sequence.type_id))):mp.Sequence.id==="B"&&(Uo=(0,d.mergeArrays)(Uo,$n),bu=(0,d.mergeArrays)(bu,new Array($n.length).fill(mp.Sequence.type_id))));return{tokens:Uo,token_type_ids:bu}}}class lp extends Ho{post_process(dr,$n=null){return $n&&(dr=(0,d.mergeArrays)(dr,$n)),{tokens:dr}}}class _p extends Ho{constructor(dr){super(dr),this.processors=dr.processors.map($n=>Ho.fromConfig($n))}post_process(dr,$n=null,jo={}){let zo;for(const Uo of this.processors)if(Uo instanceof lp)dr=Uo.post_process(dr).tokens,$n&&($n=Uo.post_process($n).tokens);else{const bu=Uo.post_process(dr,$n,jo);dr=bu.tokens,zo=bu.token_type_ids}return{tokens:dr,token_type_ids:zo}}}class Zo extends c.Callable{constructor(dr){super(),this.config=dr,this.added_tokens=[],this.end_of_word_suffix=null,this.trim_offsets=dr.trim_offsets}static fromConfig(dr){if(dr===null)return null;switch(dr.type){case"WordPiece":return new ip(dr);case"Metaspace":return new G_(dr);case"ByteLevel":return new fp(dr);case"Replace":return new bp(dr);case"ByteFallback":return new gp(dr);case"Fuse":return new Mp(dr);case"Strip":return new wp(dr);case"Sequence":return new Ap(dr);case"CTC":return new Rp(dr);case"BPEDecoder":return new u_(dr);default:throw new Error(`Unknown Decoder type: ${dr.type}`)}}_call(dr){return this.decode(dr)}decode(dr){return this.decode_chain(dr).join("")}decode_chain(dr){throw Error("`decode_chain` should be implemented in subclass.")}}class bp extends Zo{decode_chain(dr){const $n=ct(this.config.pattern);return $n===null?dr:dr.map(jo=>jo.replaceAll($n,this.config.content))}}class gp extends Zo{constructor(dr){super(dr),this.text_decoder=new TextDecoder}decode_chain(dr){const $n=[];let jo=[];for(const zo of dr){let Uo=null;if(zo.length===6&&zo.startsWith("<0x")&&zo.endsWith(">")){const bu=parseInt(zo.slice(3,5),16);isNaN(bu)||(Uo=bu)}if(Uo!==null)jo.push(Uo);else{if(jo.length>0){const bu=this.text_decoder.decode(Uint8Array.from(jo));$n.push(bu),jo=[]}$n.push(zo)}}if(jo.length>0){const zo=this.text_decoder.decode(Uint8Array.from(jo));$n.push(zo),jo=[]}return $n}}class Mp extends Zo{decode_chain(dr){return[dr.join("")]}}class wp extends Zo{constructor(dr){super(dr),this.content=this.config.content,this.start=this.config.start,this.stop=this.config.stop}decode_chain(dr){return dr.map($n=>{let jo=0;for(let Uo=0;Uo<this.start&&$n[Uo]===this.content;++Uo){jo=Uo+1;continue}let zo=$n.length;for(let Uo=0;Uo<this.stop;++Uo){const bu=$n.length-Uo-1;if($n[bu]===this.content){zo=bu;continue}else break}return $n.slice(jo,zo)})}}class ip extends Zo{constructor(dr){super(dr),this.cleanup=dr.cleanup}decode_chain(dr){return dr.map(($n,jo)=>(jo!==0&&($n.startsWith(this.config.prefix)?$n=$n.replace(this.config.prefix,""):$n=" "+$n),this.cleanup&&($n=zt($n)),$n))}}class fp extends Zo{constructor(dr){super(dr),this.byte_decoder=vn,this.text_decoder=new TextDecoder("utf-8",{fatal:!1,ignoreBOM:!0}),this.end_of_word_suffix=null}convert_tokens_to_string(dr){const $n=dr.join(""),jo=new Uint8Array([...$n].map(Uo=>this.byte_decoder[Uo]));return this.text_decoder.decode(jo)}decode_chain(dr){const $n=[];let jo=[];for(const zo of dr)this.added_tokens.find(Uo=>Uo.content===zo)!==void 0?(jo.length>0&&($n.push(this.convert_tokens_to_string(jo)),jo=[]),$n.push(zo)):jo.push(zo);return jo.length>0&&$n.push(this.convert_tokens_to_string(jo)),$n}}class Rp extends Zo{constructor(dr){super(dr),this.pad_token=this.config.pad_token,this.word_delimiter_token=this.config.word_delimiter_token,this.cleanup=this.config.cleanup}convert_tokens_to_string(dr){if(dr.length===0)return"";const $n=[dr[0]];for(let Uo=1;Uo<dr.length;++Uo)dr[Uo]!==$n.at(-1)&&$n.push(dr[Uo]);let zo=$n.filter(Uo=>Uo!==this.pad_token).join("");return this.cleanup&&(zo=zt(zo).replaceAll(this.word_delimiter_token," ").trim()),zo}decode_chain(dr){return[this.convert_tokens_to_string(dr)]}}class Ap extends Zo{constructor(dr){super(dr),this.decoders=dr.decoders.map($n=>Zo.fromConfig($n))}decode_chain(dr){return this.decoders.reduce(($n,jo)=>jo.decode_chain($n),dr)}}class u_ extends Zo{constructor(dr){super(dr),this.suffix=this.config.suffix}decode_chain(dr){return dr.map(($n,jo)=>$n.replaceAll(this.suffix,jo===dr.length-1?"":" "))}}class Ip extends Zo{decode_chain(dr){let $n="";for(let jo=1;jo<dr.length;jo+=2)$n+=dr[jo];return[$n]}}class C_ extends En{constructor(dr){super(),this.addPrefixSpace=dr.add_prefix_space,this.replacement=dr.replacement,this.strRep=dr.str_rep||this.replacement,this.prepend_scheme=dr.prepend_scheme??"always"}pre_tokenize_text(dr,{section_index:$n=void 0}={}){let jo=dr.replaceAll(" ",this.strRep);return this.addPrefixSpace&&!jo.startsWith(this.replacement)&&(this.prepend_scheme==="always"||this.prepend_scheme==="first"&&$n===0)&&(jo=this.strRep+jo),[jo]}}class G_ extends Zo{constructor(dr){super(dr),this.addPrefixSpace=dr.add_prefix_space,this.replacement=dr.replacement}decode_chain(dr){const $n=[];for(let jo=0;jo<dr.length;++jo){let zo=dr[jo].replaceAll(this.replacement," ");this.addPrefixSpace&&jo==0&&zo.startsWith(" ")&&(zo=zo.substring(1)),$n.push(zo)}return $n}}class z_ extends bn{constructor(dr){super(dr),this.charsmap=dr.precompiled_charsmap}normalize(dr){return dr=dr.replace(/[\u0001-\u0008\u000B\u000E-\u001F\u007F\u008F\u009F]/gm,""),dr=dr.replace(/[\u0009\u000A\u000C\u000D\u00A0\u1680\u2000-\u200F\u2028\u2029\u202F\u205F\u2581\u3000\uFEFF\uFFFD]/gm," "),dr.includes("")?dr=dr.split("").map(jo=>jo.normalize("NFKC")).join(""):dr=dr.normalize("NFKC"),dr}}class hx extends En{constructor(dr){super(),this.tokenizers=dr.pretokenizers.map($n=>En.fromConfig($n))}pre_tokenize_text(dr,$n){return this.tokenizers.reduce((jo,zo)=>zo.pre_tokenize(jo,$n),[dr])}}class S_ extends En{constructor(dr){super()}pre_tokenize_text(dr,$n){return dr.match(/\w+|[^\w\s]+/g)||[]}}class H_ extends En{constructor(dr){super()}pre_tokenize_text(dr,$n){return Lt(dr)}}class zx extends En{constructor(dr){super(),this.config=dr,this.pattern=ct(this.config.pattern),this.content=this.config.content}pre_tokenize_text(dr,$n){return this.pattern===null?[dr]:[dr.replaceAll(this.pattern,this.config.content)]}}const qx=["bos_token","eos_token","unk_token","sep_token","pad_token","cls_token","mask_token"];function Ix(Vo,dr,$n,jo){for(const zo of Object.keys(Vo)){const Uo=dr-Vo[zo].length,bu=$n(zo),mp=new Array(Uo).fill(bu);Vo[zo]=jo==="right"?(0,d.mergeArrays)(Vo[zo],mp):(0,d.mergeArrays)(mp,Vo[zo])}}function X_(Vo,dr){for(const $n of Object.keys(Vo))Vo[$n].length=dr}class e_ extends c.Callable{constructor($n,jo){super();Oo(this,"return_token_type_ids",!1);Oo(this,"padding_side","right");this.config=jo,this.normalizer=bn.fromConfig($n.normalizer),this.pre_tokenizer=En.fromConfig($n.pre_tokenizer),this.model=yn.fromConfig($n.model,jo),this.post_processor=Ho.fromConfig($n.post_processor),this.decoder=Zo.fromConfig($n.decoder),this.special_tokens=[],this.all_special_ids=[],this.added_tokens=[];for(const zo of $n.added_tokens){const Uo=new ur(zo);this.added_tokens.push(Uo),this.model.tokens_to_ids.set(Uo.content,Uo.id),this.model.vocab[Uo.id]=Uo.content,Uo.special&&(this.special_tokens.push(Uo.content),this.all_special_ids.push(Uo.id))}if(this.additional_special_tokens=jo.additional_special_tokens??[],this.special_tokens.push(...this.additional_special_tokens),this.special_tokens=[...new Set(this.special_tokens)],this.decoder&&(this.decoder.added_tokens=this.added_tokens,this.decoder.end_of_word_suffix=this.model.end_of_word_suffix),this.added_tokens_splitter=new $.DictionarySplitter(this.added_tokens.map(zo=>zo.content)),this.added_tokens_map=new Map(this.added_tokens.map(zo=>[zo.content,zo])),this.mask_token=this.getToken("mask_token"),this.mask_token_id=this.model.tokens_to_ids.get(this.mask_token),this.pad_token=this.getToken("pad_token","eos_token"),this.pad_token_id=this.model.tokens_to_ids.get(this.pad_token),this.sep_token=this.getToken("sep_token"),this.sep_token_id=this.model.tokens_to_ids.get(this.sep_token),this.unk_token=this.getToken("unk_token"),this.unk_token_id=this.model.tokens_to_ids.get(this.unk_token),this.bos_token=this.getToken("bos_token"),this.bos_token_id=this.model.tokens_to_ids.get(this.bos_token),this.eos_token=this.getToken("eos_token"),this.eos_token_id=this.model.tokens_to_ids.get(this.eos_token),this.model_max_length=jo.model_max_length,this.remove_space=jo.remove_space,this.clean_up_tokenization_spaces=jo.clean_up_tokenization_spaces??!0,this.do_lowercase_and_remove_accent=jo.do_lowercase_and_remove_accent??!1,jo.padding_side&&(this.padding_side=jo.padding_side),this.add_bos_token=jo.add_bos_token,this.add_eos_token=jo.add_eos_token,this.legacy=!1,this.chat_template=jo.chat_template??null,Array.isArray(this.chat_template)){const zo=Object.create(null);for(const{name:Uo,template:bu}of this.chat_template){if(typeof Uo!="string"||typeof bu!="string")throw new Error('Chat template must be a list of objects with "name" and "template" properties');zo[Uo]=bu}this.chat_template=zo}this._compiled_template_cache=new Map}getToken(...$n){for(const jo of $n){const zo=this.config[jo];if(zo)if(typeof zo=="object"){if(zo.__type==="AddedToken")return zo.content;throw Error(`Unknown token: ${zo}`)}else return zo}return null}static async from_pretrained($n,{progress_callback:jo=null,config:zo=null,cache_dir:Uo=null,local_files_only:bu=!1,revision:mp="main",legacy:yp=null}={}){const xp=await at($n,{progress_callback:jo,config:zo,cache_dir:Uo,local_files_only:bu,revision:mp,legacy:yp});return new this(...xp)}_call($n,{text_pair:jo=null,add_special_tokens:zo=!0,padding:Uo=!1,truncation:bu=null,max_length:mp=null,return_tensor:yp=!0,return_token_type_ids:xp=null}={}){const Tp=Array.isArray($n);let s_;if(Tp){if($n.length===0)throw Error("text array must be non-empty");if(jo!==null){if(Array.isArray(jo)){if($n.length!==jo.length)throw Error("text and text_pair must have the same length")}else throw Error("text_pair must also be an array");s_=$n.map((w_,I_)=>this._encode_plus(w_,{text_pair:jo[I_],add_special_tokens:zo,return_token_type_ids:xp}))}else s_=$n.map(w_=>this._encode_plus(w_,{add_special_tokens:zo,return_token_type_ids:xp}))}else{if($n==null)throw Error("text may not be null or undefined");if(Array.isArray(jo))throw Error("When specifying `text_pair`, since `text` is a string, `text_pair` must also be a string (i.e., not an array).");s_=[this._encode_plus($n,{text_pair:jo,add_special_tokens:zo,return_token_type_ids:xp})]}if(mp===null?mp=this.model_max_length:bu===null&&(Uo===!0?(console.warn("`max_length` is ignored when `padding: true` and there is no truncation strategy. To pad to max length, use `padding: 'max_length'`."),mp=this.model_max_length):Uo===!1&&(console.warn("Truncation was not explicitly activated but `max_length` is provided a specific value, please use `truncation: true` to explicitly truncate examples to max length."),bu=!0)),Uo===!0&&(mp=Math.min((0,_.max)(s_.map(w_=>w_.input_ids.length))[0],mp??1/0)),mp=Math.min(mp,this.model_max_length??1/0),Uo||bu)for(let w_=0;w_<s_.length;++w_)s_[w_].input_ids.length!==mp&&(s_[w_].input_ids.length>mp?bu&&X_(s_[w_],mp):Uo&&Ix(s_[w_],mp,I_=>I_==="input_ids"?this.pad_token_id:0,this.padding_side));const v_={};if(yp){if(!(Uo&&bu)&&s_.some(I_=>{var T_;for(const Y_ of Object.keys(I_))if(I_[Y_].length!==((T_=s_[0][Y_])==null?void 0:T_.length))return!0;return!1}))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=true' and 'truncation=true' to have batched tensors with the same length.");const w_=[s_.length,s_[0].input_ids.length];for(const I_ of Object.keys(s_[0]))v_[I_]=new g.Tensor("int64",BigInt64Array.from(s_.flatMap(T_=>T_[I_]).map(BigInt)),w_)}else{for(const w_ of Object.keys(s_[0]))v_[w_]=s_.map(I_=>I_[w_]);if(!Tp)for(const w_ of Object.keys(v_))v_[w_]=v_[w_][0]}return v_}_encode_text($n){if($n===null)return null;const jo=this.added_tokens_splitter.split($n);for(let Uo=0;Uo<jo.length;++Uo){const bu=this.added_tokens_map.get(jo[Uo]);bu&&(bu.lstrip&&Uo>0&&(jo[Uo-1]=jo[Uo-1].trimEnd()),bu.rstrip&&Uo<jo.length-1&&(jo[Uo+1]=jo[Uo+1].trimStart()))}return jo.flatMap((Uo,bu)=>{if(Uo.length===0)return[];if(this.added_tokens_map.has(Uo))return[Uo];if(this.remove_space===!0&&(Uo=Uo.trim().split(/\s+/).join(" ")),this.do_lowercase_and_remove_accent&&(Uo=ft(Uo)),this.normalizer!==null&&(Uo=this.normalizer(Uo)),Uo.length===0)return[];const mp=this.pre_tokenizer!==null?this.pre_tokenizer(Uo,{section_index:bu}):[Uo];return this.model(mp)})}_encode_plus($n,{text_pair:jo=null,add_special_tokens:zo=!0,return_token_type_ids:Uo=null}={}){const{tokens:bu,token_type_ids:mp}=this._tokenize_helper($n,{pair:jo,add_special_tokens:zo}),yp=this.model.convert_tokens_to_ids(bu),xp={input_ids:yp,attention_mask:new Array(yp.length).fill(1)};return(Uo??this.return_token_type_ids)&&mp&&(xp.token_type_ids=mp),xp}_tokenize_helper($n,{pair:jo=null,add_special_tokens:zo=!1}={}){const Uo=this._encode_text($n),bu=this._encode_text(jo);return this.post_processor?this.post_processor(Uo,bu,{add_special_tokens:zo}):{tokens:(0,d.mergeArrays)(Uo??[],bu??[])}}tokenize($n,{pair:jo=null,add_special_tokens:zo=!1}={}){return this._tokenize_helper($n,{pair:jo,add_special_tokens:zo}).tokens}encode($n,{text_pair:jo=null,add_special_tokens:zo=!0,return_token_type_ids:Uo=null}={}){return this._encode_plus($n,{text_pair:jo,add_special_tokens:zo,return_token_type_ids:Uo}).input_ids}batch_decode($n,jo={}){return $n instanceof g.Tensor&&($n=$n.tolist()),$n.map(zo=>this.decode(zo,jo))}decode($n,jo={}){if($n instanceof g.Tensor&&($n=pt($n)),!Array.isArray($n)||$n.length===0||!(0,d.isIntegralNumber)($n[0]))throw Error("token_ids must be a non-empty array of integers.");return this.decode_single($n,jo)}decode_single($n,{skip_special_tokens:jo=!1,clean_up_tokenization_spaces:zo=null}){let Uo=this.model.convert_ids_to_tokens($n);jo&&(Uo=Uo.filter(mp=>!this.special_tokens.includes(mp)));let bu=this.decoder?this.decoder(Uo):Uo.join(" ");return this.decoder&&this.decoder.end_of_word_suffix&&(bu=bu.replaceAll(this.decoder.end_of_word_suffix," "),jo&&(bu=bu.trim())),(zo??this.clean_up_tokenization_spaces)&&(bu=zt(bu)),bu}get_chat_template({chat_template:$n=null,tools:jo=null}={}){if(this.chat_template&&typeof this.chat_template=="object"){const zo=this.chat_template;if($n!==null&&Object.hasOwn(zo,$n))$n=zo[$n];else if($n===null)if(jo!==null&&"tool_use"in zo)$n=zo.tool_use;else if("default"in zo)$n=zo.default;else throw Error(`This model has multiple chat templates with no default specified! Please either pass a chat template or the name of the template you wish to use to the 'chat_template' argument. Available template names are ${Object.keys(zo).sort()}.`)}else if($n===null)if(this.chat_template)$n=this.chat_template;else throw Error("Cannot use apply_chat_template() because tokenizer.chat_template is not set and no template argument was passed! For information about writing templates and setting the tokenizer.chat_template attribute, please see the documentation at https://huggingface.co/docs/transformers/main/en/chat_templating");return $n}apply_chat_template($n,{tools:jo=null,documents:zo=null,chat_template:Uo=null,add_generation_prompt:bu=!1,tokenize:mp=!0,padding:yp=!1,truncation:xp=!1,max_length:Tp=null,return_tensor:s_=!0,return_dict:v_=!1,tokenizer_kwargs:w_={},...I_}={}){if(Uo=this.get_chat_template({chat_template:Uo,tools:jo}),typeof Uo!="string")throw Error(`chat_template must be a string, but got ${typeof Uo}`);let T_=this._compiled_template_cache.get(Uo);T_===void 0&&(T_=new _e.Template(Uo),this._compiled_template_cache.set(Uo,T_));const Y_=Object.create(null);for(const U_ of qx){const Z_=this.getToken(U_);Z_&&(Y_[U_]=Z_)}const J_=T_.render({messages:$n,add_generation_prompt:bu,tools:jo,documents:zo,...Y_,...I_});if(mp){const U_=this._call(J_,{add_special_tokens:!1,padding:yp,truncation:xp,max_length:Tp,return_tensor:s_,...w_});return v_?U_:U_.input_ids}return J_}}class r_ extends e_{constructor(){super(...arguments);Oo(this,"return_token_type_ids",!0)}}class g_ extends e_{constructor(){super(...arguments);Oo(this,"return_token_type_ids",!0)}}class Pp extends e_{constructor(){super(...arguments);Oo(this,"return_token_type_ids",!0)}}class m_ extends e_{constructor(){super(...arguments);Oo(this,"return_token_type_ids",!0)}}class ir extends e_{constructor(){super(...arguments);Oo(this,"return_token_type_ids",!0)}}class In extends e_{constructor(){super(...arguments);Oo(this,"return_token_type_ids",!0)}}class wn extends e_{constructor(){super(...arguments);Oo(this,"return_token_type_ids",!0)}}class An extends e_{constructor(){super(...arguments);Oo(this,"return_token_type_ids",!0)}}class No extends e_{constructor(){super(...arguments);Oo(this,"return_token_type_ids",!0)}}class Yo extends e_{}class sp extends e_{}class Cp extends e_{constructor($n,jo){super($n,jo);Oo(this,"return_token_type_ids",!0);console.warn('WARNING: `XLMTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}}class n_ extends e_{constructor(){super(...arguments);Oo(this,"return_token_type_ids",!0)}}class zp extends e_{}class i_ extends e_{}class kp extends e_{}class h_ extends e_{constructor(dr,$n){super(dr,$n),this.languageRegex=/^[a-z]{2}_[A-Z]{2}$/,this.language_codes=this.special_tokens.filter(jo=>this.languageRegex.test(jo)),this.lang_to_token=jo=>jo}_build_translation_inputs(dr,$n,jo){return _x(this,dr,$n,jo)}}class $_ extends h_{}class xx extends e_{}class bx extends e_{}const N_="";class lx extends e_{constructor($n,jo){super($n,jo);Oo(this,"padding_side","left");this.legacy=jo.legacy??!0,this.legacy||(this.normalizer=null,this.pre_tokenizer=new C_({replacement:N_,add_prefix_space:!0,prepend_scheme:"first"}))}_encode_text($n){if($n===null)return null;if(this.legacy||$n.length===0)return super._encode_text($n);let jo=super._encode_text(N_+$n.replaceAll(N_," "));return jo.length>1&&jo[0]===N_&&this.special_tokens.includes(jo[1])&&(jo=jo.slice(1)),jo}}class B_ extends e_{}class Rx extends e_{}class Ox extends e_{}class ux extends e_{}class Qx extends e_{}class Xx extends e_{}class rx extends e_{}class jx extends e_{}class kx extends e_{}function _x(Vo,dr,$n,jo){if(!("language_codes"in Vo)||!Array.isArray(Vo.language_codes))throw new Error("Tokenizer must have `language_codes` attribute set and it should be an array of language ids.");if(!("languageRegex"in Vo)||!(Vo.languageRegex instanceof RegExp))throw new Error("Tokenizer must have `languageRegex` attribute set and it should be a regular expression.");if(!("lang_to_token"in Vo)||typeof Vo.lang_to_token!="function")throw new Error("Tokenizer must have `lang_to_token` attribute set and it should be a function.");const zo=jo.src_lang,Uo=jo.tgt_lang;if(!Vo.language_codes.includes(Uo))throw new Error(`Target language code "${Uo}" is not valid. Must be one of: {${Vo.language_codes.join(", ")}}`);if(zo!==void 0){if(!Vo.language_codes.includes(zo))throw new Error(`Source language code "${zo}" is not valid. Must be one of: {${Vo.language_codes.join(", ")}}`);for(const bu of Vo.post_processor.config.single)if("SpecialToken"in bu&&Vo.languageRegex.test(bu.SpecialToken.id)){bu.SpecialToken.id=Vo.lang_to_token(zo);break}}return jo.forced_bos_token_id=Vo.model.convert_tokens_to_ids([Vo.lang_to_token(Uo)])[0],Vo._call(dr,$n)}class Bx extends e_{constructor(dr,$n){super(dr,$n),this.languageRegex=/^[a-z]{3}_[A-Z][a-z]{3}$/,this.language_codes=this.special_tokens.filter(jo=>this.languageRegex.test(jo)),this.lang_to_token=jo=>jo}_build_translation_inputs(dr,$n,jo){return _x(this,dr,$n,jo)}}class K_ extends e_{constructor(dr,$n){super(dr,$n),this.languageRegex=/^__[a-z]{2,3}__$/,this.language_codes=this.special_tokens.filter(jo=>this.languageRegex.test(jo)).map(jo=>jo.slice(2,-2)),this.lang_to_token=jo=>`__${jo}__`}_build_translation_inputs(dr,$n,jo){return _x(this,dr,$n,jo)}}class L_ extends e_{get timestamp_begin(){return this.model.convert_tokens_to_ids(["<|notimestamps|>"])[0]+1}_decode_asr(dr,{return_timestamps:$n=!1,return_language:jo=!1,time_precision:zo=null,force_full_sequences:Uo=!0}={}){if(zo===null)throw Error("Must specify time_precision");let bu=null;const mp=$n==="word";function yp(){return{language:bu,timestamp:[null,null],text:""}}const xp=[];let Tp=yp(),s_=0;const v_=this.timestamp_begin,I_=v_+1500;let T_=[],Y_=[],J_=!1,U_=null;const Z_=new Set(this.all_special_ids);for(const A_ of dr){const ex=A_.tokens,dx=mp?A_.token_timestamps:null;let $x=null,Vx=v_;if("stride"in A_){const[F_,V_,q_]=A_.stride;if(s_-=V_,U_=F_-q_,V_&&(Vx=V_/zo+v_),q_)for(let R_=ex.length-1;R_>=0;--R_){const Mx=Number(ex[R_]);if(Mx>=v_){if($x!==null&&(Mx-v_)*zo<U_)break;$x=Mx}}}let px=[],Lx=[];for(let F_=0;F_<ex.length;++F_){const V_=Number(ex[F_]);if(Z_.has(V_)){const q_=this.decode([V_]),R_=lt.WHISPER_LANGUAGE_MAPPING.get(q_.slice(2,-2));if(R_!==void 0){if(bu!==null&&R_!==bu&&!$n){T_.push(px);const Mx=this.findLongestCommonSequence(T_)[0],sw=this.decode(Mx);Tp.text=sw,xp.push(Tp),T_=[],px=[],Tp=yp()}bu=Tp.language=R_}}else if(V_>=v_&&V_<=I_){const q_=(V_-v_)*zo+s_,R_=(0,_.round)(q_,2);if($x!==null&&V_>=$x)J_=!0;else if(J_||T_.length>0&&V_<Vx)J_=!1;else if(Tp.timestamp[0]===null)Tp.timestamp[0]=R_;else if(R_!==Tp.timestamp[0]){Tp.timestamp[1]=R_,T_.push(px),mp&&Y_.push(Lx);const[Mx,sw]=this.findLongestCommonSequence(T_,Y_),Yx=this.decode(Mx);Tp.text=Yx,mp&&(Tp.words=this.collateWordTimestamps(Mx,sw,bu)),xp.push(Tp),T_=[],px=[],Y_=[],Lx=[],Tp=yp()}}else if(px.push(V_),mp){let q_=(0,_.round)(dx[F_]+s_,2),R_;if(F_+1<dx.length){R_=(0,_.round)(dx[F_+1]+s_,2);const Mx=this.decode([V_]);Bt.test(Mx)&&(R_=(0,_.round)(Math.min(q_+zo,R_),2))}else R_=null;Lx.push([q_,R_])}}if("stride"in A_){const[F_,V_,q_]=A_.stride;s_+=F_-q_}px.length>0?(T_.push(px),mp&&Y_.push(Lx)):T_.every(F_=>F_.length===0)&&(Tp=yp(),T_=[],px=[],Y_=[],Lx=[])}if(T_.length>0){if(Uo&&$n)throw new Error("Whisper did not predict an ending timestamp, which can happen if audio is cut off in the middle of a word. Also make sure WhisperTimeStampLogitsProcessor was used during generation.");const[A_,ex]=this.findLongestCommonSequence(T_,Y_),dx=this.decode(A_);Tp.text=dx,mp&&(Tp.words=this.collateWordTimestamps(A_,ex,bu)),xp.push(Tp)}let nx=Object.create(null);const Cx=xp.map(A_=>A_.text).join("");if($n||jo){for(let A_=0;A_<xp.length;++A_){const ex=xp[A_];$n||delete ex.timestamp,jo||delete ex.language}if(mp){const A_=[];for(const ex of xp)for(const dx of ex.words)A_.push(dx);nx={chunks:A_}}else nx={chunks:xp}}return[Cx,nx]}findLongestCommonSequence(dr,$n=null){let jo=dr[0],zo=jo.length,Uo=[];const bu=Array.isArray($n)&&$n.length>0;let mp=bu?[]:null,yp=bu?$n[0]:null;for(let xp=1;xp<dr.length;++xp){const Tp=dr[xp];let s_=0,v_=[zo,zo,0,0];const w_=Tp.length;for(let nx=1;nx<zo+w_;++nx){const Cx=Math.max(0,zo-nx),A_=Math.min(zo,zo+w_-nx),ex=jo.slice(Cx,A_),dx=Math.max(0,nx-zo),$x=Math.min(w_,nx),Vx=Tp.slice(dx,$x);if(ex.length!==Vx.length)throw new Error("There is a bug within whisper `decode_asr` function, please report it. Dropping to prevent bad inference.");let px;bu?px=ex.filter((V_,q_)=>V_===Vx[q_]&&yp[Cx+q_]<=$n[xp][dx+q_]).length:px=ex.filter((V_,q_)=>V_===Vx[q_]).length;const Lx=nx/1e4,F_=px/nx+Lx;px>1&&F_>s_&&(s_=F_,v_=[Cx,A_,dx,$x])}const[I_,T_,Y_,J_]=v_,U_=Math.floor((T_+I_)/2),Z_=Math.floor((J_+Y_)/2);Uo.push(...jo.slice(0,U_)),jo=Tp.slice(Z_),zo=jo.length,bu&&(mp.push(...yp.slice(0,U_)),yp=$n[xp].slice(Z_))}return Uo.push(...jo),bu?(mp.push(...yp),[Uo,mp]):[Uo,[]]}collateWordTimestamps(dr,$n,jo){const[zo,Uo,bu]=this.combineTokensIntoWords(dr,jo),mp=[];for(let yp=0;yp<zo.length;++yp){const xp=bu[yp];mp.push({text:zo[yp],timestamp:[$n[xp.at(0)][0],$n[xp.at(-1)][1]]})}return mp}combineTokensIntoWords(dr,$n,jo=`"'([{-`,zo=`"'.,!?:)]}`){$n=$n??"english";let Uo,bu,mp;return["chinese","japanese","thai","lao","myanmar"].includes($n)?[Uo,bu,mp]=this.splitTokensOnUnicode(dr):[Uo,bu,mp]=this.splitTokensOnSpaces(dr),this.mergePunctuations(Uo,bu,mp,jo,zo)}decode(dr,$n){let jo;return $n!=null&&$n.decode_with_timestamps?(dr instanceof g.Tensor&&(dr=pt(dr)),jo=this.decodeWithTimestamps(dr,$n)):jo=super.decode(dr,$n),jo}decodeWithTimestamps(dr,$n){const jo=($n==null?void 0:$n.time_precision)??.02,zo=Array.from(this.all_special_ids).at(-1)+1;let Uo=[[]];for(let bu of dr)if(bu=Number(bu),bu>=zo){const mp=((bu-zo)*jo).toFixed(2);Uo.push(`<|${mp}|>`),Uo.push([])}else Uo[Uo.length-1].push(bu);return Uo=Uo.map(bu=>typeof bu=="string"?bu:super.decode(bu,$n)),Uo.join("")}splitTokensOnUnicode(dr){const $n=this.decode(dr,{decode_with_timestamps:!0}),jo="",zo=[],Uo=[],bu=[];let mp=[],yp=[],xp=0;for(let Tp=0;Tp<dr.length;++Tp){const s_=dr[Tp];mp.push(s_),yp.push(Tp);const v_=this.decode(mp,{decode_with_timestamps:!0});(!v_.includes(jo)||$n[xp+v_.indexOf(jo)]===jo)&&(zo.push(v_),Uo.push(mp),bu.push(yp),mp=[],yp=[],xp+=v_.length)}return[zo,Uo,bu]}splitTokensOnSpaces(dr){const[$n,jo,zo]=this.splitTokensOnUnicode(dr),Uo=[],bu=[],mp=[],yp=new RegExp(`^[${Gt}]$`,"gu");for(let xp=0;xp<$n.length;++xp){const Tp=$n[xp],s_=jo[xp],v_=zo[xp],w_=s_[0]>=this.model.tokens_to_ids.get("<|endoftext|>"),I_=Tp.startsWith(" "),T_=Tp.trim(),Y_=yp.test(T_);if(w_||I_||Y_||Uo.length===0)Uo.push(Tp),bu.push(s_),mp.push(v_);else{const J_=Uo.length-1;Uo[J_]+=Tp,bu[J_].push(...s_),mp[J_].push(...v_)}}return[Uo,bu,mp]}mergePunctuations(dr,$n,jo,zo,Uo){const bu=structuredClone(dr),mp=structuredClone($n),yp=structuredClone(jo);let xp=bu.length-2,Tp=bu.length-1;for(;xp>=0;)bu[xp].startsWith(" ")&&zo.includes(bu[xp].trim())?(bu[Tp]=bu[xp]+bu[Tp],mp[Tp]=(0,d.mergeArrays)(mp[xp],mp[Tp]),yp[Tp]=(0,d.mergeArrays)(yp[xp],yp[Tp]),bu[xp]="",mp[xp]=[],yp[xp]=[]):Tp=xp,--xp;for(xp=0,Tp=1;Tp<bu.length;)!bu[xp].endsWith(" ")&&Uo.includes(bu[Tp])?(bu[xp]+=bu[Tp],mp[xp]=(0,d.mergeArrays)(mp[xp],mp[Tp]),yp[xp]=(0,d.mergeArrays)(yp[xp],yp[Tp]),bu[Tp]="",mp[Tp]=[],yp[Tp]=[]):xp=Tp,++Tp;return[bu.filter(s_=>s_),mp.filter(s_=>s_.length>0),yp.filter(s_=>s_.length>0)]}}class Nx extends e_{}class rw extends e_{}class wx extends e_{}class dp extends e_{constructor(dr,$n){super(dr,$n),this.languageRegex=/^(>>\w+<<)\s*/g,this.supported_language_codes=this.model.vocab.filter(jo=>this.languageRegex.test(jo)),console.warn('WARNING: `MarianTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}_encode_text(dr){if(dr===null)return null;const[$n,...jo]=dr.trim().split(this.languageRegex);if(jo.length===0)return super._encode_text($n);if(jo.length===2){const[zo,Uo]=jo;return this.supported_language_codes.includes(zo)||console.warn(`Unsupported language code "${zo}" detected, which may lead to unexpected behavior. Should be one of: ${JSON.stringify(this.supported_language_codes)}`),(0,d.mergeArrays)([zo],super._encode_text(Uo))}}}class pp extends e_{}class $p extends e_{}class P_ extends e_{}class nw extends e_{}class Ux extends e_{}class Px extends e_{constructor(dr,$n){super(dr,$n),this.decoder=new Ip({})}}class vw extends e_{}class bw extends e_{}class Mw extends e_{}class Ew{static async from_pretrained(dr,{progress_callback:$n=null,config:jo=null,cache_dir:zo=null,local_files_only:Uo=!1,revision:bu="main",legacy:mp=null}={}){var v_;const[yp,xp]=await at(dr,{progress_callback:$n,config:jo,cache_dir:zo,local_files_only:Uo,revision:bu,legacy:mp}),Tp=((v_=xp.tokenizer_class)==null?void 0:v_.replace(/Fast$/,""))??"PreTrainedTokenizer";let s_=this.TOKENIZER_CLASS_MAPPING[Tp];return s_||(console.warn(`Unknown tokenizer class "${Tp}", attempting to construct from base class.`),s_=e_),new s_(yp,xp)}}Oo(Ew,"TOKENIZER_CLASS_MAPPING",{T5Tokenizer:zp,DistilBertTokenizer:Yo,CamembertTokenizer:sp,DebertaTokenizer:ir,DebertaV2Tokenizer:In,BertTokenizer:r_,HerbertTokenizer:wn,ConvBertTokenizer:An,RoFormerTokenizer:No,XLMTokenizer:Cp,ElectraTokenizer:n_,MobileBertTokenizer:Pp,SqueezeBertTokenizer:m_,AlbertTokenizer:g_,GPT2Tokenizer:i_,BartTokenizer:kp,MBartTokenizer:h_,MBart50Tokenizer:$_,RobertaTokenizer:xx,WhisperTokenizer:L_,CodeGenTokenizer:Nx,CLIPTokenizer:rw,SiglipTokenizer:wx,MarianTokenizer:dp,BloomTokenizer:bx,NllbTokenizer:Bx,M2M100Tokenizer:K_,LlamaTokenizer:lx,CodeLlamaTokenizer:B_,XLMRobertaTokenizer:Rx,MPNetTokenizer:Ox,FalconTokenizer:ux,GPTNeoXTokenizer:Qx,EsmTokenizer:Xx,Wav2Vec2CTCTokenizer:pp,BlenderbotTokenizer:$p,BlenderbotSmallTokenizer:P_,SpeechT5Tokenizer:nw,NougatTokenizer:Ux,VitsTokenizer:Px,Qwen2Tokenizer:rx,GemmaTokenizer:jx,Grok1Tokenizer:kx,CohereTokenizer:vw,MgpstrTokenizer:bw,Ernie4_5_Tokenizer:Mw,PreTrainedTokenizer:e_})},"./src/utils/audio.js":(e,s,i)=>{i.r(s),i.d(s,{RawAudio:()=>hn,hamming:()=>it,hanning:()=>at,mel_filter_bank:()=>kt,read_audio:()=>_e,spectrogram:()=>nr,window_function:()=>cr});var c=i("./src/utils/hub.js"),d=i("./src/utils/maths.js"),h=i("./src/utils/core.js"),_=i("./src/env.js"),g=i("./src/utils/tensor.js"),$=i("?7992");async function _e(_n,gn){if(typeof AudioContext>"u")throw Error("Unable to load audio from path/URL since `AudioContext` is not available in your environment. Instead, audio data should be passed directly to the pipeline/processor. For more information and some example code, see https://huggingface.co/docs/transformers.js/guides/node-audio-processing.");const vn=await(await(0,c.getFile)(_n)).arrayBuffer(),Tn=new AudioContext({sampleRate:gn});typeof gn>"u"&&console.warn(`No sampling rate provided, using default of ${Tn.sampleRate}Hz.`);const kn=await Tn.decodeAudioData(vn);let bn;if(kn.numberOfChannels===2){const Sn=Math.sqrt(2),fn=kn.getChannelData(0),or=kn.getChannelData(1);bn=new Float32Array(fn.length);for(let lr=0;lr<kn.length;++lr)bn[lr]=Sn*(fn[lr]+or[lr])/2}else bn=kn.getChannelData(0);return bn}function lt(_n,gn){if(_n<1)return new Float64Array;if(_n===1)return new Float64Array([1]);const vn=1-gn,Tn=2*Math.PI/(_n-1),kn=new Float64Array(_n);for(let bn=0;bn<_n;++bn)kn[bn]=gn-vn*Math.cos(bn*Tn);return kn}function at(_n){return lt(_n,.5)}function it(_n){return lt(_n,.54)}const ct={htk:_n=>2595*Math.log10(1+_n/700),kaldi:_n=>1127*Math.log(1+_n/700),slaney:(_n,gn=1e3,vn=15,Tn=27/Math.log(6.4))=>_n>=gn?vn+Math.log(_n/gn)*Tn:3*_n/200};function mt(_n,gn="htk"){const vn=ct[gn];if(!vn)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return typeof _n=="number"?vn(_n):_n.map(Tn=>vn(Tn))}const pt={htk:_n=>700*(10**(_n/2595)-1),kaldi:_n=>700*(Math.exp(_n/1127)-1),slaney:(_n,gn=1e3,vn=15,Tn=Math.log(6.4)/27)=>_n>=vn?gn*Math.exp(Tn*(_n-vn)):200*_n/3};function zt(_n,gn="htk"){const vn=pt[gn];if(!vn)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return typeof _n=="number"?vn(_n):_n.map(Tn=>vn(Tn))}function dt(_n,gn){const vn=Float64Array.from({length:gn.length-1},(Sn,fn)=>gn[fn+1]-gn[fn]),Tn=Array.from({length:_n.length},()=>new Array(gn.length));for(let Sn=0;Sn<_n.length;++Sn){const fn=Tn[Sn];for(let or=0;or<gn.length;++or)fn[or]=gn[or]-_n[Sn]}const kn=gn.length-2,bn=Array.from({length:kn},()=>new Array(_n.length));for(let Sn=0;Sn<_n.length;++Sn){const fn=Tn[Sn];for(let or=0;or<kn;++or){const lr=-fn[or]/vn[or],pn=fn[or+2]/vn[or+1];bn[or][Sn]=Math.max(0,Math.min(lr,pn))}}return bn}function ft(_n,gn,vn){const Tn=(gn-_n)/(vn-1);return Float64Array.from({length:vn},(kn,bn)=>_n+Tn*bn)}function kt(_n,gn,vn,Tn,kn,bn=null,Sn="htk",fn=!1){if(bn!==null&&bn!=="slaney")throw new Error('norm must be one of null or "slaney"');if(_n<2)throw new Error(`Require num_frequency_bins: ${_n} >= 2`);if(vn>Tn)throw new Error(`Require min_frequency: ${vn} <= max_frequency: ${Tn}`);const or=mt(vn,Sn),lr=mt(Tn,Sn),pn=ft(or,lr,gn+2);let Cn=zt(pn,Sn),Lo;if(fn){const Ro=kn/((_n-1)*2);Lo=mt(Float64Array.from({length:_n},(qo,tp)=>tp*Ro),Sn),Cn=pn}else Lo=ft(0,Math.floor(kn/2),_n);const Mo=dt(Lo,Cn);if(bn!==null&&bn==="slaney")for(let Ro=0;Ro<gn;++Ro){const qo=Mo[Ro],tp=2/(Cn[Ro+2]-Cn[Ro]);for(let Wo=0;Wo<_n;++Wo)qo[Wo]*=tp}return Mo}function St(_n,gn,vn){const Tn=new _n.constructor(_n.length+gn+vn),kn=_n.length-1;for(let bn=0;bn<_n.length;++bn)Tn[gn+bn]=_n[bn];for(let bn=1;bn<=gn;++bn)Tn[gn-bn]=_n[(0,h.calculateReflectOffset)(bn,kn)];for(let bn=1;bn<=vn;++bn)Tn[kn+gn+bn]=_n[(0,h.calculateReflectOffset)(kn-bn,kn)];return Tn}function Lt(_n,gn,vn,Tn,kn){if(vn<=0)throw new Error("reference must be greater than zero");if(Tn<=0)throw new Error("min_value must be greater than zero");vn=Math.max(Tn,vn);const bn=Math.log10(vn);for(let Sn=0;Sn<_n.length;++Sn)_n[Sn]=gn*Math.log10(Math.max(Tn,_n[Sn])-bn);if(kn!==null){if(kn<=0)throw new Error("db_range must be greater than zero");const Sn=(0,d.max)(_n)[0]-kn;for(let fn=0;fn<_n.length;++fn)_n[fn]=Math.max(_n[fn],Sn)}return _n}function Gt(_n,gn=1,vn=1e-5,Tn=null){return Lt(_n,20,gn,vn,Tn)}function Bt(_n,gn=1,vn=1e-10,Tn=null){return Lt(_n,10,gn,vn,Tn)}async function nr(_n,gn,vn,Tn,{fft_length:kn=null,power:bn=1,center:Sn=!0,pad_mode:fn="reflect",onesided:or=!0,preemphasis:lr=null,preemphasis_htk_flavor:pn=!0,mel_filters:Cn=null,mel_floor:Lo=1e-10,log_mel:Mo=null,reference:Ro=1,min_value:qo=1e-10,db_range:tp=null,remove_dc_offset:Wo=null,min_num_frames:En=null,max_num_frames:mr=null,do_pad:Do=!0,transpose:Go=!1,mel_offset:Jo=0}={}){const _i=gn.length;if(kn===null&&(kn=vn),vn>kn)throw Error(`frame_length (${vn}) may not be larger than fft_length (${kn})`);if(_i!==vn)throw new Error(`Length of the window (${_i}) must equal frame_length (${vn})`);if(Tn<=0)throw new Error("hop_length must be greater than zero");if(bn===null&&Cn!==null)throw new Error("You have provided `mel_filters` but `power` is `None`. Mel spectrogram computation is not yet supported for complex-valued spectrogram. Specify `power` to fix this issue.");if(!pn)throw new Error("`preemphasis_htk_flavor=false` is not currently supported.");if(Sn)switch(fn){case"reflect":{const ip=Math.floor((kn-1)/2)+1;_n=St(_n,ip,ip);break}case"constant":{const ip=Math.floor(kn/2),fp=new _n.constructor(_n.length+2*ip);fp.set(_n,ip),_n=fp;break}default:throw new Error(`pad_mode="${fn}" not implemented yet.`)}let Ho=Math.floor(1+Math.floor((_n.length-vn)/Tn));En!==null&&Ho<En&&(Ho=En);const _c=or?Math.floor(kn/2)+1:kn;let Qo=Ho,ep=Ho;mr!==null&&(mr>Ho?Do&&(ep=mr):ep=Qo=mr);const lp=new d.FFT(kn),_p=new Float64Array(kn),Zo=new Float64Array(lp.outputBufferSize),bp=new Float32Array(_c*ep);for(let ip=0;ip<Qo;++ip){const fp=ip*Tn,Rp=Math.min(_n.length-fp,vn);Rp!==vn&&_p.fill(0,0,vn);for(let Ap=0;Ap<Rp;++Ap)_p[Ap]=_n[fp+Ap];if(Wo){let Ap=0;for(let Ip=0;Ip<Rp;++Ip)Ap+=_p[Ip];const u_=Ap/Rp;for(let Ip=0;Ip<Rp;++Ip)_p[Ip]-=u_}if(lr!==null){for(let Ap=Rp-1;Ap>=1;--Ap)_p[Ap]-=lr*_p[Ap-1];_p[0]*=1-lr}for(let Ap=0;Ap<gn.length;++Ap)_p[Ap]*=gn[Ap];lp.realTransform(Zo,_p);for(let Ap=0;Ap<_c;++Ap){const u_=Ap<<1;bp[Ap*ep+ip]=Zo[u_]**2+Zo[u_+1]**2}}if(bn!==null&&bn!==2){const ip=bn/2;for(let fp=0;fp<bp.length;++fp)bp[fp]**=ip}const gp=Cn.length;let Mp=await(0,g.matmul)(new g.Tensor("float32",Cn.flat(),[gp,_c]),new g.Tensor("float32",bp,[_c,ep]));Go&&(Mp=Mp.transpose(1,0));const wp=Mp.data;for(let ip=0;ip<wp.length;++ip)wp[ip]=Jo+Math.max(Lo,wp[ip]);if(bn!==null&&Mo!==null){const ip=Math.min(wp.length,Qo*gp);switch(Mo){case"log":for(let fp=0;fp<ip;++fp)wp[fp]=Math.log(wp[fp]);break;case"log10":for(let fp=0;fp<ip;++fp)wp[fp]=Math.log10(wp[fp]);break;case"dB":if(bn===1)Gt(wp,Ro,qo,tp);else if(bn===2)Bt(wp,Ro,qo,tp);else throw new Error(`Cannot use log_mel option '${Mo}' with power ${bn}`);break;default:throw new Error(`log_mel must be one of null, 'log', 'log10' or 'dB'. Got '${Mo}'`)}}return Mp}function cr(_n,gn,{periodic:vn=!0,frame_length:Tn=null,center:kn=!0}={}){const bn=vn?_n+1:_n;let Sn;switch(gn){case"boxcar":Sn=new Float64Array(bn).fill(1);break;case"hann":case"hann_window":Sn=at(bn);break;case"hamming":Sn=it(bn);break;case"povey":Sn=at(bn).map(fn=>Math.pow(fn,.85));break;default:throw new Error(`Unknown window type ${gn}.`)}if(vn&&(Sn=Sn.subarray(0,_n)),Tn===null)return Sn;if(_n>Tn)throw new Error(`Length of the window (${_n}) may not be larger than frame_length (${Tn})`);return Sn}function ur(_n,gn){let vn=44;const Tn=new ArrayBuffer(vn+_n.length*4),kn=new DataView(Tn);yn(kn,0,"RIFF"),kn.setUint32(4,36+_n.length*4,!0),yn(kn,8,"WAVE"),yn(kn,12,"fmt "),kn.setUint32(16,16,!0),kn.setUint16(20,3,!0),kn.setUint16(22,1,!0),kn.setUint32(24,gn,!0),kn.setUint32(28,gn*4,!0),kn.setUint16(32,4,!0),kn.setUint16(34,32,!0),yn(kn,36,"data"),kn.setUint32(40,_n.length*4,!0);for(let bn=0;bn<_n.length;++bn,vn+=4)kn.setFloat32(vn,_n[bn],!0);return Tn}function yn(_n,gn,vn){for(let Tn=0;Tn<vn.length;++Tn)_n.setUint8(gn+Tn,vn.charCodeAt(Tn))}class hn{constructor(gn,vn){this.audio=gn,this.sampling_rate=vn}toWav(){return ur(this.audio,this.sampling_rate)}toBlob(){const gn=this.toWav();return new Blob([gn],{type:"audio/wav"})}async save(gn){let vn;if(_.apis.IS_BROWSER_ENV){if(_.apis.IS_WEBWORKER_ENV)throw new Error("Unable to save a file from a Web Worker.");vn=h.saveBlob}else if(_.apis.IS_FS_AVAILABLE)vn=async(Tn,kn)=>{let bn=await kn.arrayBuffer();$.writeFileSync(Tn,Buffer.from(bn))};else throw new Error("Unable to save because filesystem is disabled in this environment.");await vn(gn,this.toBlob())}}},"./src/utils/constants.js":(e,s,i)=>{i.r(s),i.d(s,{CHAT_TEMPLATE_NAME:()=>$,CONFIG_NAME:()=>d,FEATURE_EXTRACTOR_NAME:()=>h,GENERATION_CONFIG_NAME:()=>_e,GITHUB_ISSUE_URL:()=>c,IMAGE_PROCESSOR_NAME:()=>_,PROCESSOR_NAME:()=>g});const c="https://github.com/huggingface/transformers.js/issues/new/choose",d="config.json",h="preprocessor_config.json",_=h,g="processor_config.json",$="chat_template.jinja",_e="generation_config.json"},"./src/utils/core.js":(e,s,i)=>{i.r(s),i.d(s,{calculateDimensions:()=>_e,calculateReflectOffset:()=>ct,count:()=>dt,dispatchCallback:()=>c,escapeRegExp:()=>h,isIntegralNumber:()=>g,isNullishDimension:()=>$,isTypedArray:()=>_,len:()=>zt,mergeArrays:()=>at,pick:()=>pt,pop:()=>lt,product:()=>it,reverseDictionary:()=>d,saveBlob:()=>mt});function c(ft,kt){ft&&ft(kt)}function d(ft){return Object.fromEntries(Object.entries(ft).map(([kt,St])=>[St,kt]))}function h(ft){return ft.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function _(ft){var kt,St,Lt;return((Lt=(St=(kt=ft==null?void 0:ft.prototype)==null?void 0:kt.__proto__)==null?void 0:St.constructor)==null?void 0:Lt.name)==="TypedArray"}function g(ft){return Number.isInteger(ft)||typeof ft=="bigint"}function $(ft){return ft==null||ft===-1}function _e(ft){const kt=[];let St=ft;for(;Array.isArray(St);)kt.push(St.length),St=St[0];return kt}function lt(ft,kt,St=void 0){const Lt=ft[kt];if(Lt!==void 0)return delete ft[kt],Lt;if(St===void 0)throw Error(`Key ${kt} does not exist in object.`);return St}function at(...ft){return Array.prototype.concat.apply([],ft)}function it(...ft){return ft.reduce((kt,St)=>kt.flatMap(Lt=>St.map(Gt=>[Lt,Gt])))}function ct(ft,kt){return Math.abs((ft+kt)%(2*kt)-kt)}function mt(ft,kt){const St=URL.createObjectURL(kt),Lt=document.createElement("a");Lt.href=St,Lt.download=ft,Lt.click(),Lt.remove(),URL.revokeObjectURL(St)}function pt(ft,kt){return Object.assign({},...kt.map(St=>{if(ft[St]!==void 0)return{[St]:ft[St]}}))}function zt(ft){let kt=0;for(const St of ft)++kt;return kt}function dt(ft,kt){let St=0;for(const Lt of ft)Lt===kt&&++St;return St}},"./src/utils/data-structures.js":(e,s,i)=>{i.r(s),i.d(s,{CharTrie:()=>d,DictionarySplitter:()=>$,LRUCache:()=>_e,PriorityQueue:()=>c,TokenLattice:()=>_});class c{constructor(at=(ct,mt)=>ct>mt,it=1/0){this._heap=[],this._comparator=at,this._maxSize=it}get size(){return this._heap.length}isEmpty(){return this.size===0}peek(){return this._heap[0]}push(...at){return this.extend(at)}extend(at){for(const it of at)if(this.size<this._maxSize)this._heap.push(it),this._siftUp();else{const ct=this._smallest();this._comparator(it,this._heap[ct])&&(this._heap[ct]=it,this._siftUpFrom(ct))}return this.size}pop(){const at=this.peek(),it=this.size-1;return it>0&&this._swap(0,it),this._heap.pop(),this._siftDown(),at}replace(at){const it=this.peek();return this._heap[0]=at,this._siftDown(),it}_parent(at){return(at+1>>>1)-1}_left(at){return(at<<1)+1}_right(at){return at+1<<1}_greater(at,it){return this._comparator(this._heap[at],this._heap[it])}_swap(at,it){const ct=this._heap[at];this._heap[at]=this._heap[it],this._heap[it]=ct}_siftUp(){this._siftUpFrom(this.size-1)}_siftUpFrom(at){for(;at>0&&this._greater(at,this._parent(at));)this._swap(at,this._parent(at)),at=this._parent(at)}_siftDown(){let at=0;for(;this._left(at)<this.size&&this._greater(this._left(at),at)||this._right(at)<this.size&&this._greater(this._right(at),at);){const it=this._right(at)<this.size&&this._greater(this._right(at),this._left(at))?this._right(at):this._left(at);this._swap(at,it),at=it}}_smallest(){return 2**Math.floor(Math.log2(this.size))-1}}class d{constructor(){this.root=h.default()}extend(at){for(const it of at)this.push(it)}push(at){let it=this.root;for(const ct of at){let mt=it.children.get(ct);mt===void 0&&(mt=h.default(),it.children.set(ct,mt)),it=mt}it.isLeaf=!0}*commonPrefixSearch(at){let it=this.root;if(it===void 0)return;let ct="";for(const mt of at){if(ct+=mt,it=it.children.get(mt),it===void 0)return;it.isLeaf&&(yield ct)}}}class h{constructor(at,it){this.isLeaf=at,this.children=it}static default(){return new h(!1,new Map)}}class _{constructor(at,it,ct){this.chars=Array.from(at),this.len=this.chars.length,this.bosTokenId=it,this.eosTokenId=ct,this.nodes=[],this.beginNodes=Array.from({length:this.len+1},()=>[]),this.endNodes=Array.from({length:this.len+1},()=>[]);const mt=new g(this.bosTokenId,0,0,0,0),pt=new g(this.eosTokenId,1,this.len,0,0);this.nodes.push(mt.clone()),this.nodes.push(pt.clone()),this.beginNodes[this.len].push(pt),this.endNodes[0].push(mt)}insert(at,it,ct,mt){const pt=this.nodes.length,zt=new g(mt,pt,at,it,ct);this.beginNodes[at].push(zt),this.endNodes[at+it].push(zt),this.nodes.push(zt)}viterbi(){const at=this.len;let it=0;for(;it<=at;){if(this.beginNodes[it].length==0)return[];for(let dt of this.beginNodes[it]){dt.prev=null;let ft=0,kt=null;for(let St of this.endNodes[it]){const Lt=St.backtraceScore+dt.score;(kt===null||Lt>ft)&&(kt=St.clone(),ft=Lt)}if(kt!==null)dt.prev=kt,dt.backtraceScore=ft;else return[]}++it}const ct=[],pt=this.beginNodes[at][0].prev;if(pt===null)return[];let zt=pt.clone();for(;zt.prev!==null;)ct.push(zt.clone()),zt=zt.clone().prev.clone();return ct.reverse(),ct}piece(at){return this.chars.slice(at.pos,at.pos+at.length).join("")}tokens(){return this.viterbi().map(it=>this.piece(it))}tokenIds(){return this.viterbi().map(it=>it.tokenId)}}class g{constructor(at,it,ct,mt,pt){this.tokenId=at,this.nodeId=it,this.pos=ct,this.length=mt,this.score=pt,this.prev=null,this.backtraceScore=0}clone(){const at=new g(this.tokenId,this.nodeId,this.pos,this.length,this.score);return at.prev=this.prev,at.backtraceScore=this.backtraceScore,at}}class ${constructor(at){this.trie=this._buildTrie(at)}_buildTrie(at){var ct;const it=Object.create(null);for(const mt of at){let pt=it;for(let zt=0;zt<mt.length;++zt)pt=pt[ct=mt[zt]]??(pt[ct]=Object.create(null));pt.end=mt}return it}split(at){const it=[],ct=at.length;let mt=0,pt=0;for(;pt<ct;){let zt=this.trie,dt=null,ft=pt;for(;ft<ct&&(zt=zt[at[ft]]);)zt.end&&(dt=zt.end),++ft;dt?(pt>mt&&it.push(at.slice(mt,pt)),it.push(dt),pt+=dt.length,mt=pt):++pt}return mt<ct&&it.push(at.slice(mt)),it}}class _e{constructor(at){this.capacity=at,this.cache=new Map}get(at){if(!this.cache.has(at))return;const it=this.cache.get(at);return this.cache.delete(at),this.cache.set(at,it),it}put(at,it){this.cache.has(at)&&this.cache.delete(at),this.cache.set(at,it),this.cache.size>this.capacity&&this.cache.delete(this.cache.keys().next().value)}clear(){this.cache.clear()}}},"./src/utils/devices.js":(e,s,i)=>{i.r(s),i.d(s,{DEVICE_TYPES:()=>c});const c=Object.freeze({auto:"auto",gpu:"gpu",cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:"webnn","webnn-npu":"webnn-npu","webnn-gpu":"webnn-gpu","webnn-cpu":"webnn-cpu"})},"./src/utils/dtypes.js":(e,s,i)=>{i.r(s),i.d(s,{DATA_TYPES:()=>_,DEFAULT_DEVICE_DTYPE_MAPPING:()=>g,DEFAULT_DTYPE_SUFFIX_MAPPING:()=>$,isWebGpuFp16Supported:()=>h});var c=i("./src/env.js"),d=i("./src/utils/devices.js");const h=function(){let _e;return async function(){if(_e===void 0)if(!c.apis.IS_WEBGPU_AVAILABLE)_e=!1;else try{_e=(await navigator.gpu.requestAdapter()).features.has("shader-f16")}catch{_e=!1}return _e}}(),_=Object.freeze({auto:"auto",fp32:"fp32",fp16:"fp16",q8:"q8",int8:"int8",uint8:"uint8",q4:"q4",bnb4:"bnb4",q4f16:"q4f16"}),g=Object.freeze({[d.DEVICE_TYPES.wasm]:_.q8}),$=Object.freeze({[_.fp32]:"",[_.fp16]:"_fp16",[_.int8]:"_int8",[_.uint8]:"_uint8",[_.q8]:"_quantized",[_.q4]:"_q4",[_.q4f16]:"_q4f16",[_.bnb4]:"_bnb4"})},"./src/utils/generic.js":(e,s,i)=>{i.r(s),i.d(s,{Callable:()=>c});const c=class{constructor(){let d=function(...h){return d._call(...h)};return Object.setPrototypeOf(d,new.target.prototype)}_call(...d){throw Error("Must implement _call method in subclass")}}},"./src/utils/hub.js":(e,s,i)=>{i.r(s),i.d(s,{MAX_EXTERNAL_DATA_CHUNKS:()=>g,getFile:()=>ct,getModelFile:()=>ft,getModelJSON:()=>St,getModelText:()=>kt});var c=i("?7992"),d=i("?5af5"),h=i("./src/env.js"),_=i("./src/utils/core.js");const g=100,$={txt:"text/plain",html:"text/html",css:"text/css",js:"text/javascript",json:"application/json",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif"};class _e{constructor(nr){if(this.filePath=nr,this.headers=new Headers,this.exists=c.existsSync(nr),this.exists){this.status=200,this.statusText="OK";let cr=c.statSync(nr);this.headers.set("content-length",cr.size.toString()),this.updateContentType();const ur=c.createReadStream(nr);this.body=new ReadableStream({start(yn){ur.on("data",hn=>yn.enqueue(hn)),ur.on("end",()=>yn.close()),ur.on("error",hn=>yn.error(hn))},cancel(){ur.destroy()}})}else this.status=404,this.statusText="Not Found",this.body=null}updateContentType(){const nr=this.filePath.toString().split(".").pop().toLowerCase();this.headers.set("content-type",$[nr]??"application/octet-stream")}clone(){let nr=new _e(this.filePath);return nr.exists=this.exists,nr.status=this.status,nr.statusText=this.statusText,nr.headers=new Headers(this.headers),nr}async arrayBuffer(){return(await c.promises.readFile(this.filePath)).buffer}async blob(){const nr=await c.promises.readFile(this.filePath);return new Blob([nr],{type:this.headers.get("content-type")})}async text(){return await c.promises.readFile(this.filePath,"utf8")}async json(){return JSON.parse(await this.text())}}function lt(Bt,nr=null,cr=null){let ur;try{ur=new URL(Bt)}catch{return!1}return!(nr&&!nr.includes(ur.protocol)||cr&&!cr.includes(ur.hostname))}const at=/^(\b[\w\-.]+\b\/)?\b[\w\-.]{1,96}\b$/;function it(Bt){return!(!at.test(Bt)||Bt.includes("..")||Bt.includes("--")||Bt.endsWith(".git")||Bt.endsWith(".ipynb"))}async function ct(Bt){var nr;if(h.env.useFS&&!lt(Bt,["http:","https:","blob:"]))return new _e(Bt instanceof URL?Bt.protocol==="file:"?Bt.pathname:Bt.toString():Bt);if(typeof process<"u"&&((nr=process==null?void 0:process.release)==null?void 0:nr.name)==="node"){const cr=!!(define_process_env_default!=null&&define_process_env_default.TESTING_REMOTELY),ur=h.env.version,yn=new Headers;if(yn.set("User-Agent",`transformers.js/${ur}; is_ci/${cr};`),lt(Bt,["http:","https:"],["huggingface.co","hf.co"])){const _n=(define_process_env_default==null?void 0:define_process_env_default.HF_TOKEN)??(define_process_env_default==null?void 0:define_process_env_default.HF_ACCESS_TOKEN);_n&&yn.set("Authorization",`Bearer ${_n}`)}return fetch(Bt,{headers:yn})}else return fetch(Bt)}const mt={400:"Bad request error occurred while trying to load file",401:"Unauthorized access to file",403:"Forbidden access to file",404:"Could not locate file",408:"Request timeout error occurred while trying to load file",500:"Internal server error error occurred while trying to load file",502:"Bad gateway error occurred while trying to load file",503:"Service unavailable error occurred while trying to load file",504:"Gateway timeout error occurred while trying to load file"};function pt(Bt,nr,cr){if(!cr)return null;const ur=mt[Bt]??`Error (${Bt}) occurred while trying to load file`;throw Error(`${ur}: "${nr}".`)}class zt{constructor(nr){this.path=nr}async match(nr){let cr=d.join(this.path,nr),ur=new _e(cr);if(ur.exists)return ur}async put(nr,cr,ur=void 0){let yn=d.join(this.path,nr);try{const hn=cr.headers.get("Content-Length"),_n=parseInt(hn??"0");let gn=0;await c.promises.mkdir(d.dirname(yn),{recursive:!0});const vn=c.createWriteStream(yn),Tn=cr.body.getReader();for(;;){const{done:kn,value:bn}=await Tn.read();if(kn)break;await new Promise((fn,or)=>{vn.write(bn,lr=>{if(lr){or(lr);return}fn()})}),gn+=bn.length;const Sn=_n?gn/_n*100:0;ur==null||ur({progress:Sn,loaded:gn,total:_n})}vn.close()}catch(hn){try{await c.promises.unlink(yn)}catch{}throw hn}}}async function dt(Bt,...nr){for(let cr of nr)try{let ur=await Bt.match(cr);if(ur)return ur}catch{continue}}async function ft(Bt,nr,cr=!0,ur={},yn=!1){if(!h.env.allowLocalModels){if(ur.local_files_only)throw Error("Invalid configuration detected: local models are disabled (`env.allowLocalModels=false`) but you have requested to only use local models (`local_files_only=true`).");if(!h.env.allowRemoteModels)throw Error("Invalid configuration detected: both local and remote models are disabled. Fix by setting `env.allowLocalModels` or `env.allowRemoteModels` to `true`.")}(0,_.dispatchCallback)(ur.progress_callback,{status:"initiate",name:Bt,file:nr});let hn;if(!hn&&h.env.useCustomCache){if(!h.env.customCache)throw Error("`env.useCustomCache=true`, but `env.customCache` is not defined.");if(!h.env.customCache.match||!h.env.customCache.put)throw new Error("`env.customCache` must be an object which implements the `match` and `put` functions of the Web Cache API. For more information, see https://developer.mozilla.org/en-US/docs/Web/API/Cache");hn=h.env.customCache}if(!hn&&h.env.useBrowserCache){if(typeof caches>"u")throw Error("Browser cache is not available in this environment.");try{hn=await caches.open("transformers-cache")}catch(Lo){console.warn("An error occurred while opening the browser cache:",Lo)}}if(!hn&&h.env.useFSCache){if(!h.apis.IS_FS_AVAILABLE)throw Error("File System Cache is not available in this environment.");hn=new zt(ur.cache_dir??h.env.cacheDir)}const _n=ur.revision??"main",gn=Gt(Bt,nr),vn=it(Bt),Tn=vn?Gt(h.env.localModelPath,gn):gn,kn=Gt(h.env.remoteHost,h.env.remotePathTemplate.replaceAll("{model}",Bt).replaceAll("{revision}",encodeURIComponent(_n)),nr);let bn;const Sn=hn instanceof zt?_n==="main"?gn:Gt(Bt,_n,nr):kn;let fn=!1,or;hn&&(or=await dt(hn,Tn,Sn));const lr=or!==void 0;if(or===void 0){if(h.env.allowLocalModels)if(lt(gn,["http:","https:"])){if(ur.local_files_only)throw new Error(`\`local_files_only=true\`, but attempted to load a remote file from: ${gn}.`);if(!h.env.allowRemoteModels)throw new Error(`\`env.allowRemoteModels=false\`, but attempted to load a remote file from: ${gn}.`)}else try{or=await ct(Tn),bn=Tn}catch(Mo){console.warn(`Unable to load from local path "${Tn}": "${Mo}"`)}if(or===void 0||or.status===404){if(ur.local_files_only||!h.env.allowRemoteModels){if(cr)throw Error(`\`local_files_only=true\` or \`env.allowRemoteModels=false\` and file was not found locally at "${Tn}".`);return null}if(!vn)throw Error(`Local file missing at "${Tn}" and download aborted due to invalid model ID "${Bt}".`);if(or=await ct(kn),or.status!==200)return pt(or.status,kn,cr);bn=Sn}fn=hn&&typeof Response<"u"&&or instanceof Response&&or.status===200}(0,_.dispatchCallback)(ur.progress_callback,{status:"download",name:Bt,file:nr});let pn;if(!(h.apis.IS_NODE_ENV&&yn)){let Lo;ur.progress_callback?lr&&typeof navigator<"u"&&/firefox/i.test(navigator.userAgent)?(Lo=new Uint8Array(await or.arrayBuffer()),(0,_.dispatchCallback)(ur.progress_callback,{status:"progress",name:Bt,file:nr,progress:100,loaded:Lo.length,total:Lo.length})):Lo=await Lt(or,Mo=>{(0,_.dispatchCallback)(ur.progress_callback,{status:"progress",name:Bt,file:nr,...Mo})}):Lo=new Uint8Array(await or.arrayBuffer()),pn=Lo}if(fn&&bn&&await hn.match(bn)===void 0)if(pn)await hn.put(bn,new Response(pn,{headers:or.headers})).catch(Lo=>{console.warn(`Unable to add response to browser cache: ${Lo}.`)});else{const Lo=ur.progress_callback?Mo=>(0,_.dispatchCallback)(ur.progress_callback,{status:"progress",name:Bt,file:nr,...Mo}):void 0;await hn.put(bn,or,Lo)}if((0,_.dispatchCallback)(ur.progress_callback,{status:"done",name:Bt,file:nr}),pn){if(!h.apis.IS_NODE_ENV&&yn)throw new Error("Cannot return path in a browser environment.");return pn}if(or instanceof _e)return or.filePath;const Cn=await(hn==null?void 0:hn.match(bn));if(Cn instanceof _e)return Cn.filePath;if(Cn instanceof Response)return new Uint8Array(await Cn.arrayBuffer());if(typeof Cn=="string")return Cn;throw new Error("Unable to get model file path or buffer.")}async function kt(Bt,nr,cr=!0,ur={}){const yn=await ft(Bt,nr,cr,ur,!1);return yn===null?null:new TextDecoder("utf-8").decode(yn)}async function St(Bt,nr,cr=!0,ur={}){const yn=await kt(Bt,nr,cr,ur);return yn===null?{}:JSON.parse(yn)}async function Lt(Bt,nr){const cr=Bt.headers.get("Content-Length");cr===null&&console.warn("Unable to determine content-length from response headers. Will expand buffer when needed.");let ur=parseInt(cr??"0"),yn=new Uint8Array(ur),hn=0;const _n=Bt.body.getReader();async function gn(){const{done:vn,value:Tn}=await _n.read();if(vn)return;const kn=hn+Tn.length;if(kn>ur){ur=kn;const Sn=new Uint8Array(ur);Sn.set(yn),yn=Sn}yn.set(Tn,hn),hn=kn;const bn=hn/ur*100;return nr({progress:bn,loaded:hn,total:ur}),gn()}return await gn(),yn}function Gt(...Bt){return Bt=Bt.map((nr,cr)=>(cr&&(nr=nr.replace(new RegExp("^/"),"")),cr!==Bt.length-1&&(nr=nr.replace(new RegExp("/$"),"")),nr)),Bt.join("/")}},"./src/utils/image.js":(e,s,i)=>{i.r(s),i.d(s,{RawImage:()=>mt,load_image:()=>pt});var c=i("./src/utils/core.js"),d=i("./src/utils/hub.js"),h=i("./src/env.js"),_=i("./src/utils/tensor.js"),g=i("?2b25");let $,_e,lt;const at=h.apis.IS_BROWSER_ENV||h.apis.IS_WEBWORKER_ENV;if(at)$=(zt,dt)=>{if(!self.OffscreenCanvas)throw new Error("OffscreenCanvas not supported by this browser.");return new self.OffscreenCanvas(zt,dt)},lt=self.createImageBitmap,_e=self.ImageData;else if(g)lt=async zt=>{const ft=(await zt.metadata()).channels,{data:kt,info:St}=await zt.rotate().raw().toBuffer({resolveWithObject:!0}),Lt=new mt(new Uint8ClampedArray(kt),St.width,St.height,St.channels);return ft!==void 0&&ft!==St.channels&&Lt.convert(ft),Lt};else throw new Error("Unable to load image processing library.");const it={0:"nearest",1:"lanczos",2:"bilinear",3:"bicubic",4:"box",5:"hamming"},ct=new Map([["png","image/png"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["gif","image/gif"]]);class mt{constructor(dt,ft,kt,St){this.data=dt,this.width=ft,this.height=kt,this.channels=St}get size(){return[this.width,this.height]}static async read(dt){if(dt instanceof mt)return dt;if(typeof dt=="string"||dt instanceof URL)return await this.fromURL(dt);if(dt instanceof Blob)return await this.fromBlob(dt);if(typeof HTMLCanvasElement<"u"&&dt instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&dt instanceof OffscreenCanvas)return this.fromCanvas(dt);throw new Error(`Unsupported input type: ${typeof dt}`)}static fromCanvas(dt){if(!at)throw new Error("fromCanvas() is only supported in browser environments.");const kt=dt.getContext("2d").getImageData(0,0,dt.width,dt.height).data;return new mt(kt,dt.width,dt.height,4)}static async fromURL(dt){const ft=await(0,d.getFile)(dt);if(ft.status!==200)throw new Error(`Unable to read image from "${dt}" (${ft.status} ${ft.statusText})`);const kt=await ft.blob();return this.fromBlob(kt)}static async fromBlob(dt){if(at){const ft=await lt(dt),kt=$(ft.width,ft.height).getContext("2d");return kt.drawImage(ft,0,0),new this(kt.getImageData(0,0,ft.width,ft.height).data,ft.width,ft.height,4)}else{const ft=g(await dt.arrayBuffer());return await lt(ft)}}static fromTensor(dt,ft="CHW"){if(dt.dims.length!==3)throw new Error(`Tensor should have 3 dimensions, but has ${dt.dims.length} dimensions.`);if(ft==="CHW")dt=dt.transpose(1,2,0);else if(ft!=="HWC")throw new Error(`Unsupported channel format: ${ft}`);if(!(dt.data instanceof Uint8ClampedArray||dt.data instanceof Uint8Array))throw new Error(`Unsupported tensor type: ${dt.type}`);switch(dt.dims[2]){case 1:case 2:case 3:case 4:return new mt(dt.data,dt.dims[1],dt.dims[0],dt.dims[2]);default:throw new Error(`Unsupported number of channels: ${dt.dims[2]}`)}}grayscale(){if(this.channels===1)return this;const dt=new Uint8ClampedArray(this.width*this.height*1);switch(this.channels){case 3:case 4:for(let ft=0,kt=0;ft<this.data.length;ft+=this.channels){const St=this.data[ft],Lt=this.data[ft+1],Gt=this.data[ft+2];dt[kt++]=Math.round(.2989*St+.587*Lt+.114*Gt)}break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(dt,this.width,this.height,1)}rgb(){if(this.channels===3)return this;const dt=new Uint8ClampedArray(this.width*this.height*3);switch(this.channels){case 1:for(let ft=0,kt=0;ft<this.data.length;++ft)dt[kt++]=this.data[ft],dt[kt++]=this.data[ft],dt[kt++]=this.data[ft];break;case 4:for(let ft=0,kt=0;ft<this.data.length;ft+=4)dt[kt++]=this.data[ft],dt[kt++]=this.data[ft+1],dt[kt++]=this.data[ft+2];break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(dt,this.width,this.height,3)}rgba(){if(this.channels===4)return this;const dt=new Uint8ClampedArray(this.width*this.height*4);switch(this.channels){case 1:for(let ft=0,kt=0;ft<this.data.length;++ft)dt[kt++]=this.data[ft],dt[kt++]=this.data[ft],dt[kt++]=this.data[ft],dt[kt++]=255;break;case 3:for(let ft=0,kt=0;ft<this.data.length;ft+=3)dt[kt++]=this.data[ft],dt[kt++]=this.data[ft+1],dt[kt++]=this.data[ft+2],dt[kt++]=255;break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(dt,this.width,this.height,4)}putAlpha(dt){if(dt.width!==this.width||dt.height!==this.height)throw new Error(`Expected mask size to be ${this.width}x${this.height}, but got ${dt.width}x${dt.height}`);if(dt.channels!==1)throw new Error(`Expected mask to have 1 channel, but got ${dt.channels}`);const ft=this.data,kt=dt.data,St=this.width*this.height;if(this.channels===3){const Lt=new Uint8ClampedArray(St*4);for(let Gt=0,Bt=0,nr=0;Gt<St;++Gt)Lt[nr++]=ft[Bt++],Lt[nr++]=ft[Bt++],Lt[nr++]=ft[Bt++],Lt[nr++]=kt[Gt];return this._update(Lt,this.width,this.height,4)}else if(this.channels===4){for(let Lt=0;Lt<St;++Lt)ft[4*Lt+3]=kt[Lt];return this}throw new Error(`Expected image to have 3 or 4 channels, but got ${this.channels}`)}async resize(dt,ft,{resample:kt=2}={}){if(this.width===dt&&this.height===ft)return this;let St=it[kt]??kt;const Lt=(0,c.isNullishDimension)(dt),Gt=(0,c.isNullishDimension)(ft);if(Lt&&Gt)return this;if(Lt?dt=ft/this.height*this.width:Gt&&(ft=dt/this.width*this.height),at){const Bt=this.channels,nr=this.toCanvas(),cr=$(dt,ft).getContext("2d");return cr.drawImage(nr,0,0,dt,ft),new mt(cr.getImageData(0,0,dt,ft).data,dt,ft,4).convert(Bt)}else{let Bt=this.toSharp();switch(St){case"box":case"hamming":(St==="box"||St==="hamming")&&(console.warn(`Resampling method ${St} is not yet supported. Using bilinear instead.`),St="bilinear");case"nearest":case"bilinear":case"bicubic":Bt=Bt.affine([dt/this.width,0,0,ft/this.height],{interpolator:St});break;case"lanczos":Bt=Bt.resize({width:dt,height:ft,fit:"fill",kernel:"lanczos3"});break;default:throw new Error(`Resampling method ${St} is not supported.`)}return await lt(Bt)}}async pad([dt,ft,kt,St]){if(dt=Math.max(dt,0),ft=Math.max(ft,0),kt=Math.max(kt,0),St=Math.max(St,0),dt===0&&ft===0&&kt===0&&St===0)return this;if(at){const Lt=this.channels,Gt=this.toCanvas(),Bt=this.width+dt+ft,nr=this.height+kt+St,cr=$(Bt,nr).getContext("2d");return cr.drawImage(Gt,0,0,this.width,this.height,dt,kt,this.width,this.height),new mt(cr.getImageData(0,0,Bt,nr).data,Bt,nr,4).convert(Lt)}else{const Lt=this.toSharp().extend({left:dt,right:ft,top:kt,bottom:St});return await lt(Lt)}}async crop([dt,ft,kt,St]){if(dt=Math.max(dt,0),ft=Math.max(ft,0),kt=Math.min(kt,this.width-1),St=Math.min(St,this.height-1),dt===0&&ft===0&&kt===this.width-1&&St===this.height-1)return this;const Lt=kt-dt+1,Gt=St-ft+1;if(at){const Bt=this.channels,nr=this.toCanvas(),cr=$(Lt,Gt).getContext("2d");return cr.drawImage(nr,dt,ft,Lt,Gt,0,0,Lt,Gt),new mt(cr.getImageData(0,0,Lt,Gt).data,Lt,Gt,4).convert(Bt)}else{const Bt=this.toSharp().extract({left:dt,top:ft,width:Lt,height:Gt});return await lt(Bt)}}async center_crop(dt,ft){if(this.width===dt&&this.height===ft)return this;const kt=(this.width-dt)/2,St=(this.height-ft)/2;if(at){const Lt=this.channels,Gt=this.toCanvas(),Bt=$(dt,ft).getContext("2d");let nr=0,cr=0,ur=0,yn=0;return kt>=0?nr=kt:ur=-kt,St>=0?cr=St:yn=-St,Bt.drawImage(Gt,nr,cr,dt,ft,ur,yn,dt,ft),new mt(Bt.getImageData(0,0,dt,ft).data,dt,ft,4).convert(Lt)}else{let Lt=this.toSharp();if(kt>=0&&St>=0)Lt=Lt.extract({left:Math.floor(kt),top:Math.floor(St),width:dt,height:ft});else if(kt<=0&&St<=0){const Gt=Math.floor(-St),Bt=Math.floor(-kt);Lt=Lt.extend({top:Gt,left:Bt,right:dt-this.width-Bt,bottom:ft-this.height-Gt})}else{let Gt=[0,0],Bt=0;St<0?(Gt[0]=Math.floor(-St),Gt[1]=ft-this.height-Gt[0]):Bt=Math.floor(St);let nr=[0,0],cr=0;kt<0?(nr[0]=Math.floor(-kt),nr[1]=dt-this.width-nr[0]):cr=Math.floor(kt),Lt=Lt.extend({top:Gt[0],bottom:Gt[1],left:nr[0],right:nr[1]}).extract({left:cr,top:Bt,width:dt,height:ft})}return await lt(Lt)}}async toBlob(dt="image/png",ft=1){if(!at)throw new Error("toBlob() is only supported in browser environments.");return await this.toCanvas().convertToBlob({type:dt,quality:ft})}toTensor(dt="CHW"){let ft=new _.Tensor("uint8",new Uint8Array(this.data),[this.height,this.width,this.channels]);if(dt!=="HWC")if(dt==="CHW")ft=ft.permute(2,0,1);else throw new Error(`Unsupported channel format: ${dt}`);return ft}toCanvas(){if(!at)throw new Error("toCanvas() is only supported in browser environments.");const dt=this.clone().rgba(),ft=$(dt.width,dt.height),kt=new _e(dt.data,dt.width,dt.height);return ft.getContext("2d").putImageData(kt,0,0),ft}split(){const{data:dt,width:ft,height:kt,channels:St}=this,Lt=dt.constructor,Gt=dt.length/St,Bt=Array.from({length:St},()=>new Lt(Gt));for(let nr=0;nr<Gt;++nr){const cr=St*nr;for(let ur=0;ur<St;++ur)Bt[ur][nr]=dt[cr+ur]}return Bt.map(nr=>new mt(nr,ft,kt,1))}_update(dt,ft,kt,St=null){return this.data=dt,this.width=ft,this.height=kt,St!==null&&(this.channels=St),this}clone(){return new mt(this.data.slice(),this.width,this.height,this.channels)}convert(dt){if(this.channels===dt)return this;switch(dt){case 1:this.grayscale();break;case 3:this.rgb();break;case 4:this.rgba();break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this}async save(dt){if(at){if(h.apis.IS_WEBWORKER_ENV)throw new Error("Unable to save an image from a Web Worker.");const ft=dt.split(".").pop().toLowerCase(),kt=ct.get(ft)??"image/png",St=await this.toBlob(kt);(0,c.saveBlob)(dt,St)}else{if(h.apis.IS_FS_AVAILABLE)return await this.toSharp().toFile(dt);throw new Error("Unable to save the image because filesystem is disabled in this environment.")}}toSharp(){if(at)throw new Error("toSharp() is only supported in server-side environments.");return g(this.data,{raw:{width:this.width,height:this.height,channels:this.channels}})}}const pt=mt.read.bind(mt)},"./src/utils/maths.js":(e,s,i)=>{i.r(s),i.d(s,{FFT:()=>pt,bankers_round:()=>ft,cos_sim:()=>$,dot:()=>g,dynamic_time_warping:()=>kt,interpolate_data:()=>c,log_softmax:()=>_,magnitude:()=>_e,max:()=>at,medianFilter:()=>zt,min:()=>lt,permute_data:()=>d,round:()=>dt,softmax:()=>h});function c(St,[Lt,Gt,Bt],[nr,cr],ur="bilinear",yn=!1){const hn=cr/Bt,_n=nr/Gt,gn=new St.constructor(nr*cr*Lt),vn=Gt*Bt,Tn=nr*cr;for(let kn=0;kn<nr;++kn)for(let bn=0;bn<cr;++bn){const Sn=kn*cr+bn,fn=(bn+.5)/hn-.5,or=(kn+.5)/_n-.5;let lr=Math.floor(fn),pn=Math.floor(or);const Cn=Math.min(lr+1,Bt-1),Lo=Math.min(pn+1,Gt-1);lr=Math.max(lr,0),pn=Math.max(pn,0);const Mo=fn-lr,Ro=or-pn,qo=(1-Mo)*(1-Ro),tp=Mo*(1-Ro),Wo=(1-Mo)*Ro,En=Mo*Ro,mr=pn*Bt,Do=Lo*Bt,Go=mr+lr,Jo=mr+Cn,_i=Do+lr,Ho=Do+Cn;for(let _c=0;_c<Lt;++_c){const Qo=_c*vn;gn[_c*Tn+Sn]=qo*St[Qo+Go]+tp*St[Qo+Jo]+Wo*St[Qo+_i]+En*St[Qo+Ho]}}return gn}function d(St,Lt,Gt){const Bt=new Array(Gt.length),nr=new Array(Gt.length);for(let yn=Gt.length-1,hn=1;yn>=0;--yn)nr[yn]=hn,Bt[yn]=Lt[Gt[yn]],hn*=Bt[yn];const cr=Gt.map((yn,hn)=>nr[Gt.indexOf(hn)]),ur=new St.constructor(St.length);for(let yn=0;yn<St.length;++yn){let hn=0;for(let _n=Lt.length-1,gn=yn;_n>=0;--_n)hn+=gn%Lt[_n]*cr[_n],gn=Math.floor(gn/Lt[_n]);ur[hn]=St[yn]}return[ur,Bt]}function h(St){const Lt=at(St)[0],Gt=St.map(cr=>Math.exp(cr-Lt)),Bt=Gt.reduce((cr,ur)=>cr+ur,0);return Gt.map(cr=>cr/Bt)}function _(St){const Lt=at(St)[0];let Gt=0;for(let cr=0;cr<St.length;++cr)Gt+=Math.exp(St[cr]-Lt);const Bt=Math.log(Gt);return St.map(cr=>cr-Lt-Bt)}function g(St,Lt){let Gt=0;for(let Bt=0;Bt<St.length;++Bt)Gt+=St[Bt]*Lt[Bt];return Gt}function $(St,Lt){const Gt=g(St,Lt),Bt=_e(St),nr=_e(Lt);return Gt/(Bt*nr)}function _e(St){return Math.sqrt(St.reduce((Lt,Gt)=>Lt+Gt*Gt,0))}function lt(St){if(St.length===0)throw Error("Array must not be empty");let Lt=St[0],Gt=0;for(let Bt=1;Bt<St.length;++Bt)St[Bt]<Lt&&(Lt=St[Bt],Gt=Bt);return[Lt,Gt]}function at(St){if(St.length===0)throw Error("Array must not be empty");let Lt=St[0],Gt=0;for(let Bt=1;Bt<St.length;++Bt)St[Bt]>Lt&&(Lt=St[Bt],Gt=Bt);return[Lt,Gt]}function it(St){return St>0&&(St&St-1)===0}class ct{constructor(Lt){if(this.size=Lt|0,this.size<=1||!it(this.size))throw new Error("FFT size must be a power of two larger than 1");this._csize=Lt<<1,this.table=new Float64Array(this.size*2);for(let Bt=0;Bt<this.table.length;Bt+=2){const nr=Math.PI*Bt/this.size;this.table[Bt]=Math.cos(nr),this.table[Bt+1]=-Math.sin(nr)}let Gt=0;for(let Bt=1;this.size>Bt;Bt<<=1)++Gt;this._width=Gt%2===0?Gt-1:Gt,this._bitrev=new Int32Array(1<<this._width);for(let Bt=0;Bt<this._bitrev.length;++Bt){this._bitrev[Bt]=0;for(let nr=0;nr<this._width;nr+=2){const cr=this._width-nr-2;this._bitrev[Bt]|=(Bt>>>nr&3)<<cr}}}createComplexArray(){return new Float64Array(this._csize)}fromComplexArray(Lt,Gt){const Bt=Gt||new Array(Lt.length>>>1);for(let nr=0;nr<Lt.length;nr+=2)Bt[nr>>>1]=Lt[nr];return Bt}toComplexArray(Lt,Gt){const Bt=Gt||this.createComplexArray();for(let nr=0;nr<Bt.length;nr+=2)Bt[nr]=Lt[nr>>>1],Bt[nr+1]=0;return Bt}transform(Lt,Gt){if(Lt===Gt)throw new Error("Input and output buffers must be different");this._transform4(Lt,Gt,1)}realTransform(Lt,Gt){if(Lt===Gt)throw new Error("Input and output buffers must be different");this._realTransform4(Lt,Gt,1)}inverseTransform(Lt,Gt){if(Lt===Gt)throw new Error("Input and output buffers must be different");this._transform4(Lt,Gt,-1);for(let Bt=0;Bt<Lt.length;++Bt)Lt[Bt]/=this.size}_transform4(Lt,Gt,Bt){const nr=this._csize;let ur=1<<this._width,yn=nr/ur<<1,hn,_n;const gn=this._bitrev;if(yn===4)for(hn=0,_n=0;hn<nr;hn+=yn,++_n){const Tn=gn[_n];this._singleTransform2(Gt,Lt,hn,Tn,ur)}else for(hn=0,_n=0;hn<nr;hn+=yn,++_n){const Tn=gn[_n];this._singleTransform4(Gt,Lt,hn,Tn,ur,Bt)}const vn=this.table;for(ur>>=2;ur>=2;ur>>=2){yn=nr/ur<<1;const Tn=yn>>>2;for(hn=0;hn<nr;hn+=yn){const kn=hn+Tn-1;for(let bn=hn,Sn=0;bn<kn;bn+=2,Sn+=ur){const fn=bn,or=fn+Tn,lr=or+Tn,pn=lr+Tn,Cn=Lt[fn],Lo=Lt[fn+1],Mo=Lt[or],Ro=Lt[or+1],qo=Lt[lr],tp=Lt[lr+1],Wo=Lt[pn],En=Lt[pn+1],mr=vn[Sn],Do=Bt*vn[Sn+1],Go=Mo*mr-Ro*Do,Jo=Mo*Do+Ro*mr,_i=vn[2*Sn],Ho=Bt*vn[2*Sn+1],_c=qo*_i-tp*Ho,Qo=qo*Ho+tp*_i,ep=vn[3*Sn],lp=Bt*vn[3*Sn+1],_p=Wo*ep-En*lp,Zo=Wo*lp+En*ep,bp=Cn+_c,gp=Lo+Qo,Mp=Cn-_c,wp=Lo-Qo,ip=Go+_p,fp=Jo+Zo,Rp=Bt*(Go-_p),Ap=Bt*(Jo-Zo);Lt[fn]=bp+ip,Lt[fn+1]=gp+fp,Lt[or]=Mp+Ap,Lt[or+1]=wp-Rp,Lt[lr]=bp-ip,Lt[lr+1]=gp-fp,Lt[pn]=Mp-Ap,Lt[pn+1]=wp+Rp}}}}_singleTransform2(Lt,Gt,Bt,nr,cr){const ur=Lt[nr],yn=Lt[nr+1],hn=Lt[nr+cr],_n=Lt[nr+cr+1];Gt[Bt]=ur+hn,Gt[Bt+1]=yn+_n,Gt[Bt+2]=ur-hn,Gt[Bt+3]=yn-_n}_singleTransform4(Lt,Gt,Bt,nr,cr,ur){const yn=cr*2,hn=cr*3,_n=Lt[nr],gn=Lt[nr+1],vn=Lt[nr+cr],Tn=Lt[nr+cr+1],kn=Lt[nr+yn],bn=Lt[nr+yn+1],Sn=Lt[nr+hn],fn=Lt[nr+hn+1],or=_n+kn,lr=gn+bn,pn=_n-kn,Cn=gn-bn,Lo=vn+Sn,Mo=Tn+fn,Ro=ur*(vn-Sn),qo=ur*(Tn-fn);Gt[Bt]=or+Lo,Gt[Bt+1]=lr+Mo,Gt[Bt+2]=pn+qo,Gt[Bt+3]=Cn-Ro,Gt[Bt+4]=or-Lo,Gt[Bt+5]=lr-Mo,Gt[Bt+6]=pn-qo,Gt[Bt+7]=Cn+Ro}_realTransform4(Lt,Gt,Bt){const nr=this._csize;let ur=1<<this._width,yn=nr/ur<<1,hn,_n;const gn=this._bitrev;if(yn===4)for(hn=0,_n=0;hn<nr;hn+=yn,++_n){const kn=gn[_n];this._singleRealTransform2(Gt,Lt,hn,kn>>>1,ur>>>1)}else for(hn=0,_n=0;hn<nr;hn+=yn,++_n){const kn=gn[_n];this._singleRealTransform4(Gt,Lt,hn,kn>>>1,ur>>>1,Bt)}const vn=this.table;for(ur>>=2;ur>=2;ur>>=2){yn=nr/ur<<1;const kn=yn>>>1,bn=kn>>>1,Sn=bn>>>1;for(hn=0;hn<nr;hn+=yn)for(let fn=0,or=0;fn<=Sn;fn+=2,or+=ur){const lr=hn+fn,pn=lr+bn,Cn=pn+bn,Lo=Cn+bn,Mo=Lt[lr],Ro=Lt[lr+1],qo=Lt[pn],tp=Lt[pn+1],Wo=Lt[Cn],En=Lt[Cn+1],mr=Lt[Lo],Do=Lt[Lo+1],Go=Mo,Jo=Ro,_i=vn[or],Ho=Bt*vn[or+1],_c=qo*_i-tp*Ho,Qo=qo*Ho+tp*_i,ep=vn[2*or],lp=Bt*vn[2*or+1],_p=Wo*ep-En*lp,Zo=Wo*lp+En*ep,bp=vn[3*or],gp=Bt*vn[3*or+1],Mp=mr*bp-Do*gp,wp=mr*gp+Do*bp,ip=Go+_p,fp=Jo+Zo,Rp=Go-_p,Ap=Jo-Zo,u_=_c+Mp,Ip=Qo+wp,C_=Bt*(_c-Mp),G_=Bt*(Qo-wp);if(Lt[lr]=ip+u_,Lt[lr+1]=fp+Ip,Lt[pn]=Rp+G_,Lt[pn+1]=Ap-C_,fn===0){Lt[Cn]=ip-u_,Lt[Cn+1]=fp-Ip;continue}if(fn===Sn)continue;const z_=hn+bn-fn,hx=hn+kn-fn;Lt[z_]=Rp-Bt*G_,Lt[z_+1]=-Ap-Bt*C_,Lt[hx]=ip-Bt*u_,Lt[hx+1]=-fp+Bt*Ip}}const Tn=nr>>>1;for(let kn=2;kn<Tn;kn+=2)Lt[nr-kn]=Lt[kn],Lt[nr-kn+1]=-Lt[kn+1]}_singleRealTransform2(Lt,Gt,Bt,nr,cr){const ur=Lt[nr],yn=Lt[nr+cr];Gt[Bt]=ur+yn,Gt[Bt+1]=0,Gt[Bt+2]=ur-yn,Gt[Bt+3]=0}_singleRealTransform4(Lt,Gt,Bt,nr,cr,ur){const yn=cr*2,hn=cr*3,_n=Lt[nr],gn=Lt[nr+cr],vn=Lt[nr+yn],Tn=Lt[nr+hn],kn=_n+vn,bn=_n-vn,Sn=gn+Tn,fn=ur*(gn-Tn);Gt[Bt]=kn+Sn,Gt[Bt+1]=0,Gt[Bt+2]=bn,Gt[Bt+3]=-fn,Gt[Bt+4]=kn-Sn,Gt[Bt+5]=0,Gt[Bt+6]=bn,Gt[Bt+7]=fn}}class mt{constructor(Lt){const Gt=2*(Lt-1),Bt=2*(2*Lt-1),nr=2**Math.ceil(Math.log2(Bt));this.bufferSize=nr,this._a=Gt;const cr=new Float64Array(Bt),ur=new Float64Array(nr);this._chirpBuffer=new Float64Array(nr),this._buffer1=new Float64Array(nr),this._buffer2=new Float64Array(nr),this._outBuffer1=new Float64Array(nr),this._outBuffer2=new Float64Array(nr);const yn=-2*Math.PI/Lt,hn=Math.cos(yn),_n=Math.sin(yn);for(let gn=0;gn<Bt>>1;++gn){const vn=(gn+1-Lt)**2/2,Tn=Math.sqrt(hn**2+_n**2)**vn,kn=vn*Math.atan2(_n,hn),bn=2*gn;cr[bn]=Tn*Math.cos(kn),cr[bn+1]=Tn*Math.sin(kn),ur[bn]=cr[bn],ur[bn+1]=-cr[bn+1]}this._slicedChirpBuffer=cr.subarray(Gt,Bt),this._f=new ct(nr>>1),this._f.transform(this._chirpBuffer,ur)}_transform(Lt,Gt,Bt){const nr=this._buffer1,cr=this._buffer2,ur=this._outBuffer1,yn=this._outBuffer2,hn=this._chirpBuffer,_n=this._slicedChirpBuffer,gn=this._a;if(Bt)for(let vn=0;vn<_n.length;vn+=2){const Tn=vn+1,kn=vn>>1,bn=Gt[kn];nr[vn]=bn*_n[vn],nr[Tn]=bn*_n[Tn]}else for(let vn=0;vn<_n.length;vn+=2){const Tn=vn+1;nr[vn]=Gt[vn]*_n[vn]-Gt[Tn]*_n[Tn],nr[Tn]=Gt[vn]*_n[Tn]+Gt[Tn]*_n[vn]}this._f.transform(ur,nr);for(let vn=0;vn<hn.length;vn+=2){const Tn=vn+1;cr[vn]=ur[vn]*hn[vn]-ur[Tn]*hn[Tn],cr[Tn]=ur[vn]*hn[Tn]+ur[Tn]*hn[vn]}this._f.inverseTransform(yn,cr);for(let vn=0;vn<yn.length;vn+=2){const Tn=yn[vn+gn],kn=yn[vn+gn+1],bn=_n[vn],Sn=_n[vn+1];Lt[vn]=Tn*bn-kn*Sn,Lt[vn+1]=Tn*Sn+kn*bn}}transform(Lt,Gt){this._transform(Lt,Gt,!1)}realTransform(Lt,Gt){this._transform(Lt,Gt,!0)}}class pt{constructor(Lt){this.fft_length=Lt,this.isPowerOfTwo=it(Lt),this.isPowerOfTwo?(this.fft=new ct(Lt),this.outputBufferSize=2*Lt):(this.fft=new mt(Lt),this.outputBufferSize=this.fft.bufferSize)}realTransform(Lt,Gt){this.fft.realTransform(Lt,Gt)}transform(Lt,Gt){this.fft.transform(Lt,Gt)}}function zt(St,Lt){if(Lt%2===0||Lt<=0)throw new Error("Window size must be a positive odd number");const Gt=new St.constructor(St.length),Bt=new St.constructor(Lt),nr=Math.floor(Lt/2);for(let cr=0;cr<St.length;++cr){let ur=0;for(let yn=-nr;yn<=nr;++yn){let hn=cr+yn;hn<0?hn=Math.abs(hn):hn>=St.length&&(hn=2*(St.length-1)-hn),Bt[ur++]=St[hn]}Bt.sort(),Gt[cr]=Bt[nr]}return Gt}function dt(St,Lt){const Gt=Math.pow(10,Lt);return Math.round(St*Gt)/Gt}function ft(St){const Lt=Math.round(St);return Math.abs(St)%1===.5?Lt%2===0?Lt:Lt-1:Lt}function kt(St){const Lt=St.length,Gt=St[0].length,Bt=[Lt+1,Gt+1],nr=Array.from({length:Bt[0]},()=>Array(Bt[1]).fill(1/0));nr[0][0]=0;const cr=Array.from({length:Bt[0]},()=>Array(Bt[1]).fill(-1));for(let gn=1;gn<Bt[1];++gn)for(let vn=1;vn<Bt[0];++vn){const Tn=nr[vn-1][gn-1],kn=nr[vn-1][gn],bn=nr[vn][gn-1];let Sn,fn;Tn<kn&&Tn<bn?(Sn=Tn,fn=0):kn<Tn&&kn<bn?(Sn=kn,fn=1):(Sn=bn,fn=2),nr[vn][gn]=St[vn-1][gn-1]+Sn,cr[vn][gn]=fn}for(let gn=0;gn<Bt[1];++gn)cr[0][gn]=2;for(let gn=0;gn<Bt[0];++gn)cr[gn][0]=1;let ur=Lt,yn=Gt,hn=[],_n=[];for(;ur>0||yn>0;)switch(hn.push(ur-1),_n.push(yn-1),cr[ur][yn]){case 0:--ur,--yn;break;case 1:--ur;break;case 2:--yn;break;default:throw new Error(`Internal error in dynamic time warping. Unexpected trace[${ur}, ${yn}]. Please file a bug report.`)}return hn.reverse(),_n.reverse(),[hn,_n]}},"./src/utils/tensor.js":(e,s,i)=>{i.r(s),i.d(s,{DataTypeMap:()=>_,Tensor:()=>g,cat:()=>Gt,full:()=>_n,full_like:()=>gn,interpolate:()=>lt,interpolate_4d:()=>at,layer_norm:()=>ft,matmul:()=>it,mean:()=>ur,mean_pooling:()=>dt,ones:()=>vn,ones_like:()=>Tn,permute:()=>_e,quantize_embeddings:()=>fn,rand:()=>Sn,rfft:()=>ct,slice:()=>zt,stack:()=>Bt,std_mean:()=>cr,topk:()=>mt,zeros:()=>kn,zeros_like:()=>bn});var c=i("./src/utils/maths.js"),d=i("./src/backends/onnx.js"),h=i("./src/ops/registry.js");const _=Object.freeze({float32:Float32Array,float16:typeof Float16Array<"u"?Float16Array:Uint16Array,float64:Float64Array,string:Array,int8:Int8Array,uint8:Uint8Array,int16:Int16Array,uint16:Uint16Array,int32:Int32Array,uint32:Uint32Array,int64:BigInt64Array,uint64:BigUint64Array,bool:Uint8Array,uint4:Uint8Array,int4:Int8Array});class g{constructor(...lr){Oo(this,"ort_tensor");return(0,d.isONNXTensor)(lr[0])?this.ort_tensor=lr[0]:this.ort_tensor=new d.Tensor(lr[0],lr[1],lr[2]),new Proxy(this,{get:(pn,Cn)=>{if(typeof Cn=="string"){let Lo=Number(Cn);if(Number.isInteger(Lo))return pn._getitem(Lo)}return pn[Cn]},set:(pn,Cn,Lo)=>pn[Cn]=Lo})}get dims(){return this.ort_tensor.dims}set dims(lr){this.ort_tensor.dims=lr}get type(){return this.ort_tensor.type}get data(){return this.ort_tensor.data}get size(){return this.ort_tensor.size}get location(){return this.ort_tensor.location}dispose(){this.ort_tensor.dispose()}*[Symbol.iterator](){const[lr,...pn]=this.dims;if(pn.length>0){const Cn=pn.reduce((Lo,Mo)=>Lo*Mo);for(let Lo=0;Lo<lr;++Lo)yield this._subarray(Lo,Cn,pn)}else yield*this.data}_getitem(lr){const[pn,...Cn]=this.dims;if(lr=Lt(lr,pn),Cn.length>0){const Lo=Cn.reduce((Mo,Ro)=>Mo*Ro);return this._subarray(lr,Lo,Cn)}else return new g(this.type,[this.data[lr]],Cn)}indexOf(lr){const pn=this.data;for(let Cn=0;Cn<pn.length;++Cn)if(pn[Cn]==lr)return Cn;return-1}_subarray(lr,pn,Cn){const Lo=lr*pn,Mo=(lr+1)*pn,Ro="subarray"in this.data?this.data.subarray(Lo,Mo):this.data.slice(Lo,Mo);return new g(this.type,Ro,Cn)}item(){const lr=this.data;if(lr.length!==1)throw new Error(`a Tensor with ${lr.length} elements cannot be converted to Scalar`);return lr[0]}tolist(){return $(this.data,this.dims)}sigmoid(){return this.clone().sigmoid_()}sigmoid_(){const lr=this.data;for(let pn=0;pn<lr.length;++pn)lr[pn]=1/(1+Math.exp(-lr[pn]));return this}map(lr){return this.clone().map_(lr)}map_(lr){const pn=this.data;for(let Cn=0;Cn<pn.length;++Cn)pn[Cn]=lr(pn[Cn],Cn,pn);return this}mul(lr){return this.clone().mul_(lr)}mul_(lr){const pn=this.data;for(let Cn=0;Cn<pn.length;++Cn)pn[Cn]*=lr;return this}div(lr){return this.clone().div_(lr)}div_(lr){const pn=this.data;for(let Cn=0;Cn<pn.length;++Cn)pn[Cn]/=lr;return this}add(lr){return this.clone().add_(lr)}add_(lr){const pn=this.data;for(let Cn=0;Cn<pn.length;++Cn)pn[Cn]+=lr;return this}sub(lr){return this.clone().sub_(lr)}sub_(lr){const pn=this.data;for(let Cn=0;Cn<pn.length;++Cn)pn[Cn]-=lr;return this}clone(){return new g(this.type,this.data.slice(),this.dims.slice())}slice(...lr){const pn=[],Cn=[];for(let En=0;En<this.dims.length;++En){let mr=lr[En];if(mr==null)Cn.push([0,this.dims[En]]),pn.push(this.dims[En]);else if(typeof mr=="number")mr=Lt(mr,this.dims[En],En),Cn.push([mr,mr+1]);else if(Array.isArray(mr)&&mr.length===2){let[Do,Go]=mr;if(Do=Do===null?0:Lt(Do,this.dims[En],En,!1),Go=Go===null?this.dims[En]:Lt(Go,this.dims[En],En,!1),Do>Go)throw new Error(`Invalid slice: ${mr}`);const Jo=[Math.max(Do,0),Math.min(Go,this.dims[En])];Cn.push(Jo),pn.push(Jo[1]-Jo[0])}else throw new Error(`Invalid slice: ${mr}`)}const Lo=Cn.map(([En,mr])=>mr-En),Mo=Lo.reduce((En,mr)=>En*mr),Ro=this.data,qo=new Ro.constructor(Mo),tp=this.stride();let Wo=!0;for(let En=1;En<Lo.length;++En)if(Cn[En][0]!==0||Cn[En][1]!==this.dims[En]){Wo=!1;break}if(Wo){const En=Cn[0][0]*tp[0],mr=Cn[0][1]*tp[0];if(ArrayBuffer.isView(Ro))qo.set(Ro.subarray(En,mr));else if(Array.isArray(Ro)){const Do=Ro.slice(En,mr);for(let Go=0;Go<Do.length;++Go)qo[Go]=Do[Go]}else throw new Error("Unsupported data type for slicing")}else for(let En=0;En<Mo;++En){let mr=0;for(let Do=Lo.length-1,Go=En;Do>=0;--Do){const Jo=Lo[Do];mr+=(Go%Jo+Cn[Do][0])*tp[Do],Go=Math.floor(Go/Jo)}qo[En]=Ro[mr]}return new g(this.type,qo,pn)}permute(...lr){return _e(this,lr)}transpose(...lr){return this.permute(...lr)}sum(lr=null,pn=!1){return this.norm(1,lr,pn)}norm(lr="fro",pn=null,Cn=!1){if(lr==="fro")lr=2;else if(typeof lr=="string")throw Error(`Unsupported norm: ${lr}`);const Lo=this.data,Mo=(Wo,En)=>Wo+En**lr;if(pn===null){const Wo=Lo.reduce(Mo,0)**(1/lr);return new g(this.type,[Wo],[])}const[Ro,qo,tp]=nr(Mo,this,pn,Cn);if(lr!==1)for(let Wo=0;Wo<qo.length;++Wo)qo[Wo]=qo[Wo]**(1/lr);return new g(Ro,qo,tp)}normalize_(lr=2,pn=1){pn=Lt(pn,this.dims.length);const Cn=this.norm(lr,pn,!0),Lo=this.data,Mo=Cn.data;for(let Ro=0;Ro<Lo.length;++Ro){let qo=0;for(let tp=this.dims.length-1,Wo=Ro,En=1;tp>=0;--tp){const mr=this.dims[tp];if(tp!==pn){const Do=Wo%mr;qo+=Do*En,En*=this.dims[tp]}Wo=Math.floor(Wo/mr)}Lo[Ro]/=Mo[qo]}return this}normalize(lr=2,pn=1){return this.clone().normalize_(lr,pn)}stride(){return yn(this.dims)}squeeze(lr=null){return new g(this.type,this.data,kt(this.dims,lr))}squeeze_(lr=null){return this.dims=kt(this.dims,lr),this}unsqueeze(lr=null){return new g(this.type,this.data,St(this.dims,lr))}unsqueeze_(lr=null){return this.dims=St(this.dims,lr),this}flatten_(lr=0,pn=-1){pn=(pn+this.dims.length)%this.dims.length;let Cn=this.dims.slice(0,lr),Lo=this.dims.slice(lr,pn+1),Mo=this.dims.slice(pn+1);return this.dims=[...Cn,Lo.reduce((Ro,qo)=>Ro*qo,1),...Mo],this}flatten(lr=0,pn=-1){return this.clone().flatten_(lr,pn)}view(...lr){let pn=-1;for(let Lo=0;Lo<lr.length;++Lo)if(lr[Lo]===-1){if(pn!==-1)throw new Error("Only one dimension can be inferred");pn=Lo}const Cn=this.data;if(pn!==-1){const Lo=lr.reduce((Mo,Ro,qo)=>qo!==pn?Mo*Ro:Mo,1);lr[pn]=Cn.length/Lo}return new g(this.type,Cn,lr)}neg_(){const lr=this.data;for(let pn=0;pn<lr.length;++pn)lr[pn]=-lr[pn];return this}neg(){return this.clone().neg_()}gt(lr){const pn=new Uint8Array(this.data.length),Cn=this.data;for(let Lo=0;Lo<Cn.length;++Lo)pn[Lo]=Cn[Lo]>lr?1:0;return new g("bool",pn,this.dims)}lt(lr){const pn=new Uint8Array(this.data.length),Cn=this.data;for(let Lo=0;Lo<Cn.length;++Lo)pn[Lo]=Cn[Lo]<lr?1:0;return new g("bool",pn,this.dims)}clamp_(lr,pn){const Cn=this.data;for(let Lo=0;Lo<Cn.length;++Lo)Cn[Lo]=Math.min(Math.max(Cn[Lo],lr),pn);return this}clamp(lr,pn){return this.clone().clamp_(lr,pn)}round_(){const lr=this.data;for(let pn=0;pn<lr.length;++pn)lr[pn]=Math.round(lr[pn]);return this}round(){return this.clone().round_()}mean(lr=null,pn=!1){return ur(this,lr,pn)}min(lr=null,pn=!1){if(lr===null){const Ro=(0,c.min)(this.data)[0];return new g(this.type,[Ro],[])}const[Cn,Lo,Mo]=nr((Ro,qo)=>Math.min(Ro,qo),this,lr,pn,1/0);return new g(Cn,Lo,Mo)}max(lr=null,pn=!1){if(lr===null){const Ro=(0,c.max)(this.data)[0];return new g(this.type,[Ro],[])}const[Cn,Lo,Mo]=nr((Ro,qo)=>Math.max(Ro,qo),this,lr,pn,-1/0);return new g(Cn,Lo,Mo)}argmin(lr=null,pn=!1){if(lr!==null)throw new Error("`dim !== null` not yet implemented.");const Cn=(0,c.min)(this.data)[1];return new g("int64",[BigInt(Cn)],[])}argmax(lr=null,pn=!1){if(lr!==null)throw new Error("`dim !== null` not yet implemented.");const Cn=(0,c.max)(this.data)[1];return new g("int64",[BigInt(Cn)],[])}to(lr){if(this.type===lr)return this;if(!_.hasOwnProperty(lr))throw new Error(`Unsupported type: ${lr}`);let pn;const Cn=["int64","uint64"].includes(this.type),Lo=["int64","uint64"].includes(lr);return Cn&&!Lo?pn=Number:!Cn&&Lo&&(pn=BigInt),new g(lr,_[lr].from(this.data,pn),this.dims)}}function $(or,lr){const pn=or.length,Cn=lr.reduce((Mo,Ro)=>Mo*Ro);if(pn!==Cn)throw Error(`cannot reshape array of size ${pn} into shape (${lr})`);let Lo=or;for(let Mo=lr.length-1;Mo>=0;Mo--)Lo=Lo.reduce((Ro,qo)=>{let tp=Ro[Ro.length-1];return tp.length<lr[Mo]?tp.push(qo):Ro.push([qo]),Ro},[[]]);return Lo[0]}function _e(or,lr){const[pn,Cn]=(0,c.permute_data)(or.data,or.dims,lr);return new g(or.type,pn,Cn)}function lt(or,[lr,pn],Cn="bilinear",Lo=!1){const Mo=or.dims.at(-3)??1,Ro=or.dims.at(-2),qo=or.dims.at(-1);let tp=(0,c.interpolate_data)(or.data,[Mo,Ro,qo],[lr,pn],Cn,Lo);return new g(or.type,tp,[Mo,lr,pn])}async function at(or,{size:lr=null,mode:pn="bilinear"}={}){if(or.dims.length!==4)throw new Error("`interpolate_4d` currently only supports 4D input.");if(!lr)throw new Error("`interpolate_4d` requires a `size` argument.");let Cn;if(lr.length===2)Cn=[...or.dims.slice(0,2),...lr];else if(lr.length===3)Cn=[or.dims[0],...lr];else if(lr.length===4)Cn=lr;else throw new Error("`size` must be of length 2, 3, or 4.");let Lo;if(pn==="nearest")Lo=await h.TensorOpRegistry.nearest_interpolate_4d;else if(pn==="bilinear")Lo=await h.TensorOpRegistry.bilinear_interpolate_4d;else if(pn==="bicubic")Lo=await h.TensorOpRegistry.bicubic_interpolate_4d;else throw new Error(`Unsupported mode: ${pn}`);const Mo=new g("int64",new BigInt64Array(Cn.map(BigInt)),[Cn.length]);return await Lo({x:or,s:Mo})}async function it(or,lr){return await(await h.TensorOpRegistry.matmul)({a:or,b:lr})}async function ct(or,lr){return await(await h.TensorOpRegistry.rfft)({x:or,a:lr})}async function mt(or,lr){const pn=await h.TensorOpRegistry.top_k;return lr==null?lr=or.dims.at(-1):lr=Math.min(lr,or.dims.at(-1)),await pn({x:or,k:new g("int64",[BigInt(lr)],[1])})}const pt=or=>new g("int64",or,[or.length]);async function zt(or,lr,pn,Cn,Lo){return await(await h.TensorOpRegistry.slice)({x:or,s:pt(lr),e:pt(pn),a:pt(Cn),t:pt(Lo??new Array(Cn.length).fill(1))})}function dt(or,lr){const pn=or.data,Cn=lr.data,Lo=[or.dims[0],or.dims[2]],Mo=new pn.constructor(Lo[0]*Lo[1]),[Ro,qo,tp]=or.dims;let Wo=0;for(let En=0;En<Ro;++En){const mr=En*tp*qo;for(let Do=0;Do<tp;++Do){let Go=0,Jo=0;const _i=En*qo,Ho=mr+Do;for(let Qo=0;Qo<qo;++Qo){const ep=Number(Cn[_i+Qo]);Jo+=ep,Go+=pn[Ho+Qo*tp]*ep}const _c=Go/Jo;Mo[Wo++]=_c}}return new g(or.type,Mo,Lo)}function ft(or,lr,{eps:pn=1e-5}={}){if(or.dims.length!==2)throw new Error("`layer_norm` currently only supports 2D input.");const[Cn,Lo]=or.dims;if(lr.length!==1&&lr[0]!==Lo)throw new Error("`normalized_shape` must be a 1D array with shape `[input.dims[1]]`.");const[Mo,Ro]=cr(or,1,0,!0),qo=Mo.data,tp=Ro.data,Wo=or.data,En=new Wo.constructor(Wo.length);for(let mr=0;mr<Cn;++mr){const Do=mr*Lo;for(let Go=0;Go<Lo;++Go){const Jo=Do+Go;En[Jo]=(Wo[Jo]-tp[mr])/(qo[mr]+pn)}}return new g(or.type,En,or.dims)}function kt(or,lr){return or=or.slice(),lr===null?or=or.filter(pn=>pn!==1):typeof lr=="number"?or[lr]===1&&or.splice(lr,1):Array.isArray(lr)&&(or=or.filter((pn,Cn)=>pn!==1||!lr.includes(Cn))),or}function St(or,lr){return lr=Lt(lr,or.length+1),or=or.slice(),or.splice(lr,0,1),or}function Lt(or,lr,pn=null,Cn=!0){if(or<-lr||or>=lr){if(Cn)throw new Error(`IndexError: index ${or} is out of bounds for dimension${pn===null?"":" "+pn} with size ${lr}`);return or<-lr?0:lr}return or<0&&(or=(or%lr+lr)%lr),or}function Gt(or,lr=0){lr=Lt(lr,or[0].dims.length);const pn=or[0].dims.slice();pn[lr]=or.reduce((Ro,qo)=>Ro+qo.dims[lr],0);const Cn=pn.reduce((Ro,qo)=>Ro*qo,1),Lo=new or[0].data.constructor(Cn),Mo=or[0].type;if(lr===0){let Ro=0;for(const qo of or){const tp=qo.data;Lo.set(tp,Ro),Ro+=tp.length}}else{let Ro=0;for(let qo=0;qo<or.length;++qo){const{data:tp,dims:Wo}=or[qo];for(let En=0;En<tp.length;++En){let mr=0;for(let Do=Wo.length-1,Go=En,Jo=1;Do>=0;--Do){const _i=Wo[Do];let Ho=Go%_i;Do===lr&&(Ho+=Ro),mr+=Ho*Jo,Jo*=pn[Do],Go=Math.floor(Go/_i)}Lo[mr]=tp[En]}Ro+=Wo[lr]}}return new g(Mo,Lo,pn)}function Bt(or,lr=0){return Gt(or.map(pn=>pn.unsqueeze(lr)),lr)}function nr(or,lr,pn=null,Cn=!1,Lo=null){const Mo=lr.data,Ro=lr.dims;pn=Lt(pn,Ro.length);const qo=Ro.slice();qo[pn]=1;const tp=new Mo.constructor(Mo.length/Ro[pn]);Lo!==null&&tp.fill(Lo);for(let Wo=0;Wo<Mo.length;++Wo){let En=0;for(let mr=Ro.length-1,Do=Wo,Go=1;mr>=0;--mr){const Jo=Ro[mr];if(mr!==pn){const _i=Do%Jo;En+=_i*Go,Go*=qo[mr]}Do=Math.floor(Do/Jo)}tp[En]=or(tp[En],Mo[Wo],Wo,En)}return Cn||qo.splice(pn,1),[lr.type,tp,qo]}function cr(or,lr=null,pn=1,Cn=!1){const Lo=or.data,Mo=or.dims;if(lr===null){const Go=Lo.reduce((_c,Qo)=>_c+Qo,0)/Lo.length,Jo=Math.sqrt(Lo.reduce((_c,Qo)=>_c+(Qo-Go)**2,0)/(Lo.length-pn)),_i=new g(or.type,[Go],[]);return[new g(or.type,[Jo],[]),_i]}lr=Lt(lr,Mo.length);const Ro=ur(or,lr,Cn),qo=Ro.data,[tp,Wo,En]=nr((Do,Go,Jo,_i)=>Do+(Go-qo[_i])**2,or,lr,Cn);for(let Do=0;Do<Wo.length;++Do)Wo[Do]=Math.sqrt(Wo[Do]/(Mo[lr]-pn));return[new g(tp,Wo,En),Ro]}function ur(or,lr=null,pn=!1){const Cn=or.dims,Lo=or.data;if(lr===null){const tp=Lo.reduce((Wo,En)=>Wo+En,0);return new g(or.type,[tp/Lo.length],[])}lr=Lt(lr,Cn.length);const[Mo,Ro,qo]=nr((tp,Wo)=>tp+Wo,or,lr,pn);if(Cn[lr]!==1)for(let tp=0;tp<Ro.length;++tp)Ro[tp]/=Cn[lr];return new g(Mo,Ro,qo)}function yn(or){const lr=new Array(or.length);for(let pn=or.length-1,Cn=1;pn>=0;--pn)lr[pn]=Cn,Cn*=or[pn];return lr}function hn(or,lr,pn,Cn){const Lo=or.reduce((Mo,Ro)=>Mo*Ro,1);return new g(pn,new Cn(Lo).fill(lr),or)}function _n(or,lr){let pn,Cn;if(typeof lr=="number")pn="float32",Cn=Float32Array;else if(typeof lr=="bigint")pn="int64",Cn=BigInt64Array;else if(typeof lr=="boolean")pn="bool",Cn=Uint8Array;else throw new Error(`Unsupported data type: ${typeof lr}`);return hn(or,lr,pn,Cn)}function gn(or,lr){return _n(or.dims,lr)}function vn(or){return hn(or,1n,"int64",BigInt64Array)}function Tn(or){return vn(or.dims)}function kn(or){return hn(or,0n,"int64",BigInt64Array)}function bn(or){return kn(or.dims)}function Sn(or){const lr=or.reduce((pn,Cn)=>pn*Cn,1);return new g("float32",Float32Array.from({length:lr},()=>Math.random()),or)}function fn(or,lr){if(or.dims.length!==2)throw new Error("The tensor must have 2 dimensions");if(or.dims.at(-1)%8!==0)throw new Error("The last dimension of the tensor must be a multiple of 8");if(!["binary","ubinary"].includes(lr))throw new Error("The precision must be either 'binary' or 'ubinary'");const pn=lr==="binary",Cn=pn?"int8":"uint8",Lo=pn?Int8Array:Uint8Array,Mo=or.data,Ro=new Lo(Mo.length/8);for(let qo=0;qo<Mo.length;++qo){const tp=Mo[qo]>0?1:0,Wo=Math.floor(qo/8),En=qo%8;Ro[Wo]|=tp<<7-En,pn&&En===0&&(Ro[Wo]-=128)}return new g(Cn,Ro,[or.dims[0],or.dims[1]/8])}},"./src/utils/video.js":(e,s,i)=>{i.r(s),i.d(s,{RawVideo:()=>_,RawVideoFrame:()=>h,load_video:()=>g});var c=i("./src/utils/image.js"),d=i("./src/env.js");class h{constructor(_e,lt){this.image=_e,this.timestamp=lt}}class _{constructor(_e,lt){_e.length>0&&_e[0]instanceof c.RawImage&&(_e=_e.map((at,it)=>new h(at,(it+1)/(_e.length+1)*lt))),this.frames=_e,this.duration=lt}get width(){return this.frames[0].image.width}get height(){return this.frames[0].image.height}get fps(){return this.frames.length/this.duration}}async function g($,{num_frames:_e=null,fps:lt=null}={}){if(!d.apis.IS_BROWSER_ENV)throw new Error("`load_video` is currently only supported in browser environments.");if(_e==null&&lt==null)throw new Error("Either num_frames or fps must be provided.");const at=[],it=document.createElement("video");if(it.crossOrigin="anonymous",it.muted=!0,typeof $=="string")it.src=$;else if($ instanceof Blob)it.src=URL.createObjectURL($);else if($ instanceof HTMLVideoElement)it.src=$.src;else throw new Error("Invalid URL or video element provided.");if(await new Promise(kt=>it.onloadedmetadata=kt),it.seekable.start(0)===it.seekable.end(0)){const St=await(await fetch(it.src)).blob();it.src=URL.createObjectURL(St),await new Promise(Lt=>it.onloadedmetadata=Lt)}const ct=it.duration;let mt,pt;_e!=null?(mt=_e,pt=_e===1?0:ct/(_e-1)):(pt=1/lt,mt=Math.floor(ct/pt));let zt=[];for(let kt=0;kt<mt;++kt)zt.push(_e===1?ct/2:kt*pt);const dt=document.createElement("canvas");dt.width=it.videoWidth,dt.height=it.videoHeight;const ft=dt.getContext("2d",{willReadFrequently:!0});for(const kt of zt){it.currentTime=kt,await new Promise(Bt=>{it.onseeked=Bt}),ft.drawImage(it,0,0,dt.width,dt.height);const St=ft.getImageData(0,0,dt.width,dt.height),Lt=new c.RawImage(St.data,dt.width,dt.height,4),Gt=new h(Lt,kt);at.push(Gt)}return it.remove(),new _(at,ct)}}},__webpack_module_cache__={};function __webpack_require__(e){var s=__webpack_module_cache__[e];if(s!==void 0)return s.exports;var i=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](i,i.exports,__webpack_require__),i.exports}(()=>{var e=Object.getPrototypeOf?i=>Object.getPrototypeOf(i):i=>i.__proto__,s;__webpack_require__.t=function(i,c){if(c&1&&(i=this(i)),c&8||typeof i=="object"&&i&&(c&4&&i.__esModule||c&16&&typeof i.then=="function"))return i;var d=Object.create(null);__webpack_require__.r(d);var h={};s=s||[null,e({}),e([]),e(e)];for(var _=c&2&&i;typeof _=="object"&&!~s.indexOf(_);_=e(_))Object.getOwnPropertyNames(_).forEach(g=>h[g]=()=>i[g]);return h.default=()=>i,__webpack_require__.d(d,h),d}})();__webpack_require__.d=(e,s)=>{for(var i in s)__webpack_require__.o(s,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:s[i]})};__webpack_require__.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s);__webpack_require__.r=e=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{/*!*****************************!*\
  !*** ./src/transformers.js ***!
  \*****************************/__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ASTFeatureExtractor:()=>at.ASTFeatureExtractor,ASTForAudioClassification:()=>i.ASTForAudioClassification,ASTModel:()=>i.ASTModel,ASTPreTrainedModel:()=>i.ASTPreTrainedModel,AlbertForMaskedLM:()=>i.AlbertForMaskedLM,AlbertForQuestionAnswering:()=>i.AlbertForQuestionAnswering,AlbertForSequenceClassification:()=>i.AlbertForSequenceClassification,AlbertModel:()=>i.AlbertModel,AlbertPreTrainedModel:()=>i.AlbertPreTrainedModel,AlbertTokenizer:()=>c.AlbertTokenizer,ArceeForCausalLM:()=>i.ArceeForCausalLM,ArceeModel:()=>i.ArceeModel,ArceePreTrainedModel:()=>i.ArceePreTrainedModel,AudioClassificationPipeline:()=>s.AudioClassificationPipeline,AutoConfig:()=>d.AutoConfig,AutoFeatureExtractor:()=>it.AutoFeatureExtractor,AutoImageProcessor:()=>pt.AutoImageProcessor,AutoModel:()=>i.AutoModel,AutoModelForAudioClassification:()=>i.AutoModelForAudioClassification,AutoModelForAudioFrameClassification:()=>i.AutoModelForAudioFrameClassification,AutoModelForAudioTextToText:()=>i.AutoModelForAudioTextToText,AutoModelForCTC:()=>i.AutoModelForCTC,AutoModelForCausalLM:()=>i.AutoModelForCausalLM,AutoModelForDepthEstimation:()=>i.AutoModelForDepthEstimation,AutoModelForDocumentQuestionAnswering:()=>i.AutoModelForDocumentQuestionAnswering,AutoModelForImageClassification:()=>i.AutoModelForImageClassification,AutoModelForImageFeatureExtraction:()=>i.AutoModelForImageFeatureExtraction,AutoModelForImageMatting:()=>i.AutoModelForImageMatting,AutoModelForImageSegmentation:()=>i.AutoModelForImageSegmentation,AutoModelForImageTextToText:()=>i.AutoModelForImageTextToText,AutoModelForImageToImage:()=>i.AutoModelForImageToImage,AutoModelForMaskGeneration:()=>i.AutoModelForMaskGeneration,AutoModelForMaskedLM:()=>i.AutoModelForMaskedLM,AutoModelForNormalEstimation:()=>i.AutoModelForNormalEstimation,AutoModelForObjectDetection:()=>i.AutoModelForObjectDetection,AutoModelForPoseEstimation:()=>i.AutoModelForPoseEstimation,AutoModelForQuestionAnswering:()=>i.AutoModelForQuestionAnswering,AutoModelForSemanticSegmentation:()=>i.AutoModelForSemanticSegmentation,AutoModelForSeq2SeqLM:()=>i.AutoModelForSeq2SeqLM,AutoModelForSequenceClassification:()=>i.AutoModelForSequenceClassification,AutoModelForSpeechSeq2Seq:()=>i.AutoModelForSpeechSeq2Seq,AutoModelForTextToSpectrogram:()=>i.AutoModelForTextToSpectrogram,AutoModelForTextToWaveform:()=>i.AutoModelForTextToWaveform,AutoModelForTokenClassification:()=>i.AutoModelForTokenClassification,AutoModelForUniversalSegmentation:()=>i.AutoModelForUniversalSegmentation,AutoModelForVision2Seq:()=>i.AutoModelForVision2Seq,AutoModelForXVector:()=>i.AutoModelForXVector,AutoModelForZeroShotObjectDetection:()=>i.AutoModelForZeroShotObjectDetection,AutoProcessor:()=>ft.AutoProcessor,AutoTokenizer:()=>c.AutoTokenizer,AutomaticSpeechRecognitionPipeline:()=>s.AutomaticSpeechRecognitionPipeline,BackgroundRemovalPipeline:()=>s.BackgroundRemovalPipeline,BartForConditionalGeneration:()=>i.BartForConditionalGeneration,BartForSequenceClassification:()=>i.BartForSequenceClassification,BartModel:()=>i.BartModel,BartPretrainedModel:()=>i.BartPretrainedModel,BartTokenizer:()=>c.BartTokenizer,BaseModelOutput:()=>i.BaseModelOutput,BaseStreamer:()=>kt.BaseStreamer,BeitFeatureExtractor:()=>mt.BeitFeatureExtractor,BeitForImageClassification:()=>i.BeitForImageClassification,BeitModel:()=>i.BeitModel,BeitPreTrainedModel:()=>i.BeitPreTrainedModel,BertForMaskedLM:()=>i.BertForMaskedLM,BertForQuestionAnswering:()=>i.BertForQuestionAnswering,BertForSequenceClassification:()=>i.BertForSequenceClassification,BertForTokenClassification:()=>i.BertForTokenClassification,BertModel:()=>i.BertModel,BertPreTrainedModel:()=>i.BertPreTrainedModel,BertTokenizer:()=>c.BertTokenizer,BitImageProcessor:()=>mt.BitImageProcessor,BlenderbotForConditionalGeneration:()=>i.BlenderbotForConditionalGeneration,BlenderbotModel:()=>i.BlenderbotModel,BlenderbotPreTrainedModel:()=>i.BlenderbotPreTrainedModel,BlenderbotSmallForConditionalGeneration:()=>i.BlenderbotSmallForConditionalGeneration,BlenderbotSmallModel:()=>i.BlenderbotSmallModel,BlenderbotSmallPreTrainedModel:()=>i.BlenderbotSmallPreTrainedModel,BlenderbotSmallTokenizer:()=>c.BlenderbotSmallTokenizer,BlenderbotTokenizer:()=>c.BlenderbotTokenizer,BloomForCausalLM:()=>i.BloomForCausalLM,BloomModel:()=>i.BloomModel,BloomPreTrainedModel:()=>i.BloomPreTrainedModel,BloomTokenizer:()=>c.BloomTokenizer,CLIPFeatureExtractor:()=>mt.CLIPFeatureExtractor,CLIPImageProcessor:()=>mt.CLIPImageProcessor,CLIPModel:()=>i.CLIPModel,CLIPPreTrainedModel:()=>i.CLIPPreTrainedModel,CLIPSegForImageSegmentation:()=>i.CLIPSegForImageSegmentation,CLIPSegModel:()=>i.CLIPSegModel,CLIPSegPreTrainedModel:()=>i.CLIPSegPreTrainedModel,CLIPTextModel:()=>i.CLIPTextModel,CLIPTextModelWithProjection:()=>i.CLIPTextModelWithProjection,CLIPTokenizer:()=>c.CLIPTokenizer,CLIPVisionModel:()=>i.CLIPVisionModel,CLIPVisionModelWithProjection:()=>i.CLIPVisionModelWithProjection,CamembertForMaskedLM:()=>i.CamembertForMaskedLM,CamembertForQuestionAnswering:()=>i.CamembertForQuestionAnswering,CamembertForSequenceClassification:()=>i.CamembertForSequenceClassification,CamembertForTokenClassification:()=>i.CamembertForTokenClassification,CamembertModel:()=>i.CamembertModel,CamembertPreTrainedModel:()=>i.CamembertPreTrainedModel,CamembertTokenizer:()=>c.CamembertTokenizer,CausalLMOutput:()=>i.CausalLMOutput,CausalLMOutputWithPast:()=>i.CausalLMOutputWithPast,ChineseCLIPFeatureExtractor:()=>mt.ChineseCLIPFeatureExtractor,ChineseCLIPModel:()=>i.ChineseCLIPModel,ChineseCLIPPreTrainedModel:()=>i.ChineseCLIPPreTrainedModel,ClapAudioModelWithProjection:()=>i.ClapAudioModelWithProjection,ClapFeatureExtractor:()=>at.ClapFeatureExtractor,ClapModel:()=>i.ClapModel,ClapPreTrainedModel:()=>i.ClapPreTrainedModel,ClapTextModelWithProjection:()=>i.ClapTextModelWithProjection,ClassifierFreeGuidanceLogitsProcessor:()=>Lt.ClassifierFreeGuidanceLogitsProcessor,CodeGenForCausalLM:()=>i.CodeGenForCausalLM,CodeGenModel:()=>i.CodeGenModel,CodeGenPreTrainedModel:()=>i.CodeGenPreTrainedModel,CodeGenTokenizer:()=>c.CodeGenTokenizer,CodeLlamaTokenizer:()=>c.CodeLlamaTokenizer,CohereForCausalLM:()=>i.CohereForCausalLM,CohereModel:()=>i.CohereModel,CoherePreTrainedModel:()=>i.CoherePreTrainedModel,CohereTokenizer:()=>c.CohereTokenizer,ConvBertForMaskedLM:()=>i.ConvBertForMaskedLM,ConvBertForQuestionAnswering:()=>i.ConvBertForQuestionAnswering,ConvBertForSequenceClassification:()=>i.ConvBertForSequenceClassification,ConvBertForTokenClassification:()=>i.ConvBertForTokenClassification,ConvBertModel:()=>i.ConvBertModel,ConvBertPreTrainedModel:()=>i.ConvBertPreTrainedModel,ConvBertTokenizer:()=>c.ConvBertTokenizer,ConvNextFeatureExtractor:()=>mt.ConvNextFeatureExtractor,ConvNextForImageClassification:()=>i.ConvNextForImageClassification,ConvNextImageProcessor:()=>mt.ConvNextImageProcessor,ConvNextModel:()=>i.ConvNextModel,ConvNextPreTrainedModel:()=>i.ConvNextPreTrainedModel,ConvNextV2ForImageClassification:()=>i.ConvNextV2ForImageClassification,ConvNextV2Model:()=>i.ConvNextV2Model,ConvNextV2PreTrainedModel:()=>i.ConvNextV2PreTrainedModel,DFineForObjectDetection:()=>i.DFineForObjectDetection,DFineModel:()=>i.DFineModel,DFinePreTrainedModel:()=>i.DFinePreTrainedModel,DINOv3ConvNextModel:()=>i.DINOv3ConvNextModel,DINOv3ConvNextPreTrainedModel:()=>i.DINOv3ConvNextPreTrainedModel,DINOv3ViTImageProcessor:()=>mt.DINOv3ViTImageProcessor,DINOv3ViTModel:()=>i.DINOv3ViTModel,DINOv3ViTPreTrainedModel:()=>i.DINOv3ViTPreTrainedModel,DPTFeatureExtractor:()=>mt.DPTFeatureExtractor,DPTForDepthEstimation:()=>i.DPTForDepthEstimation,DPTImageProcessor:()=>mt.DPTImageProcessor,DPTModel:()=>i.DPTModel,DPTPreTrainedModel:()=>i.DPTPreTrainedModel,DacDecoderModel:()=>i.DacDecoderModel,DacDecoderOutput:()=>i.DacDecoderOutput,DacEncoderModel:()=>i.DacEncoderModel,DacEncoderOutput:()=>i.DacEncoderOutput,DacFeatureExtractor:()=>at.DacFeatureExtractor,DacModel:()=>i.DacModel,DacPreTrainedModel:()=>i.DacPreTrainedModel,DataTypeMap:()=>$.DataTypeMap,DebertaForMaskedLM:()=>i.DebertaForMaskedLM,DebertaForQuestionAnswering:()=>i.DebertaForQuestionAnswering,DebertaForSequenceClassification:()=>i.DebertaForSequenceClassification,DebertaForTokenClassification:()=>i.DebertaForTokenClassification,DebertaModel:()=>i.DebertaModel,DebertaPreTrainedModel:()=>i.DebertaPreTrainedModel,DebertaTokenizer:()=>c.DebertaTokenizer,DebertaV2ForMaskedLM:()=>i.DebertaV2ForMaskedLM,DebertaV2ForQuestionAnswering:()=>i.DebertaV2ForQuestionAnswering,DebertaV2ForSequenceClassification:()=>i.DebertaV2ForSequenceClassification,DebertaV2ForTokenClassification:()=>i.DebertaV2ForTokenClassification,DebertaV2Model:()=>i.DebertaV2Model,DebertaV2PreTrainedModel:()=>i.DebertaV2PreTrainedModel,DebertaV2Tokenizer:()=>c.DebertaV2Tokenizer,DecisionTransformerModel:()=>i.DecisionTransformerModel,DecisionTransformerPreTrainedModel:()=>i.DecisionTransformerPreTrainedModel,DeiTFeatureExtractor:()=>mt.DeiTFeatureExtractor,DeiTForImageClassification:()=>i.DeiTForImageClassification,DeiTImageProcessor:()=>mt.DeiTImageProcessor,DeiTModel:()=>i.DeiTModel,DeiTPreTrainedModel:()=>i.DeiTPreTrainedModel,DepthAnythingForDepthEstimation:()=>i.DepthAnythingForDepthEstimation,DepthAnythingPreTrainedModel:()=>i.DepthAnythingPreTrainedModel,DepthEstimationPipeline:()=>s.DepthEstimationPipeline,DepthProForDepthEstimation:()=>i.DepthProForDepthEstimation,DepthProPreTrainedModel:()=>i.DepthProPreTrainedModel,DetrFeatureExtractor:()=>mt.DetrFeatureExtractor,DetrForObjectDetection:()=>i.DetrForObjectDetection,DetrForSegmentation:()=>i.DetrForSegmentation,DetrImageProcessor:()=>mt.DetrImageProcessor,DetrModel:()=>i.DetrModel,DetrObjectDetectionOutput:()=>i.DetrObjectDetectionOutput,DetrPreTrainedModel:()=>i.DetrPreTrainedModel,DetrSegmentationOutput:()=>i.DetrSegmentationOutput,Dinov2ForImageClassification:()=>i.Dinov2ForImageClassification,Dinov2Model:()=>i.Dinov2Model,Dinov2PreTrainedModel:()=>i.Dinov2PreTrainedModel,Dinov2WithRegistersForImageClassification:()=>i.Dinov2WithRegistersForImageClassification,Dinov2WithRegistersModel:()=>i.Dinov2WithRegistersModel,Dinov2WithRegistersPreTrainedModel:()=>i.Dinov2WithRegistersPreTrainedModel,DistilBertForMaskedLM:()=>i.DistilBertForMaskedLM,DistilBertForQuestionAnswering:()=>i.DistilBertForQuestionAnswering,DistilBertForSequenceClassification:()=>i.DistilBertForSequenceClassification,DistilBertForTokenClassification:()=>i.DistilBertForTokenClassification,DistilBertModel:()=>i.DistilBertModel,DistilBertPreTrainedModel:()=>i.DistilBertPreTrainedModel,DistilBertTokenizer:()=>c.DistilBertTokenizer,DocumentQuestionAnsweringPipeline:()=>s.DocumentQuestionAnsweringPipeline,DonutFeatureExtractor:()=>mt.DonutFeatureExtractor,DonutImageProcessor:()=>mt.DonutImageProcessor,DonutSwinModel:()=>i.DonutSwinModel,DonutSwinPreTrainedModel:()=>i.DonutSwinPreTrainedModel,EfficientNetForImageClassification:()=>i.EfficientNetForImageClassification,EfficientNetImageProcessor:()=>mt.EfficientNetImageProcessor,EfficientNetModel:()=>i.EfficientNetModel,EfficientNetPreTrainedModel:()=>i.EfficientNetPreTrainedModel,ElectraForMaskedLM:()=>i.ElectraForMaskedLM,ElectraForQuestionAnswering:()=>i.ElectraForQuestionAnswering,ElectraForSequenceClassification:()=>i.ElectraForSequenceClassification,ElectraForTokenClassification:()=>i.ElectraForTokenClassification,ElectraModel:()=>i.ElectraModel,ElectraPreTrainedModel:()=>i.ElectraPreTrainedModel,ElectraTokenizer:()=>c.ElectraTokenizer,EncodecFeatureExtractor:()=>at.EncodecFeatureExtractor,EosTokenCriteria:()=>St.EosTokenCriteria,Ernie4_5_ForCausalLM:()=>i.Ernie4_5_ForCausalLM,Ernie4_5_Model:()=>i.Ernie4_5_Model,Ernie4_5_PretrainedModel:()=>i.Ernie4_5_PretrainedModel,Ernie4_5_Tokenizer:()=>c.Ernie4_5_Tokenizer,EsmForMaskedLM:()=>i.EsmForMaskedLM,EsmForSequenceClassification:()=>i.EsmForSequenceClassification,EsmForTokenClassification:()=>i.EsmForTokenClassification,EsmModel:()=>i.EsmModel,EsmPreTrainedModel:()=>i.EsmPreTrainedModel,EsmTokenizer:()=>c.EsmTokenizer,ExaoneForCausalLM:()=>i.ExaoneForCausalLM,ExaoneModel:()=>i.ExaoneModel,ExaonePreTrainedModel:()=>i.ExaonePreTrainedModel,FFT:()=>_e.FFT,FalconForCausalLM:()=>i.FalconForCausalLM,FalconModel:()=>i.FalconModel,FalconPreTrainedModel:()=>i.FalconPreTrainedModel,FalconTokenizer:()=>c.FalconTokenizer,FastViTForImageClassification:()=>i.FastViTForImageClassification,FastViTModel:()=>i.FastViTModel,FastViTPreTrainedModel:()=>i.FastViTPreTrainedModel,FeatureExtractionPipeline:()=>s.FeatureExtractionPipeline,FeatureExtractor:()=>lt.FeatureExtractor,FillMaskPipeline:()=>s.FillMaskPipeline,Florence2ForConditionalGeneration:()=>i.Florence2ForConditionalGeneration,Florence2PreTrainedModel:()=>i.Florence2PreTrainedModel,Florence2Processor:()=>dt.Florence2Processor,ForcedBOSTokenLogitsProcessor:()=>Lt.ForcedBOSTokenLogitsProcessor,ForcedEOSTokenLogitsProcessor:()=>Lt.ForcedEOSTokenLogitsProcessor,GLPNFeatureExtractor:()=>mt.GLPNFeatureExtractor,GLPNForDepthEstimation:()=>i.GLPNForDepthEstimation,GLPNModel:()=>i.GLPNModel,GLPNPreTrainedModel:()=>i.GLPNPreTrainedModel,GPT2LMHeadModel:()=>i.GPT2LMHeadModel,GPT2Model:()=>i.GPT2Model,GPT2PreTrainedModel:()=>i.GPT2PreTrainedModel,GPT2Tokenizer:()=>c.GPT2Tokenizer,GPTBigCodeForCausalLM:()=>i.GPTBigCodeForCausalLM,GPTBigCodeModel:()=>i.GPTBigCodeModel,GPTBigCodePreTrainedModel:()=>i.GPTBigCodePreTrainedModel,GPTJForCausalLM:()=>i.GPTJForCausalLM,GPTJModel:()=>i.GPTJModel,GPTJPreTrainedModel:()=>i.GPTJPreTrainedModel,GPTNeoForCausalLM:()=>i.GPTNeoForCausalLM,GPTNeoModel:()=>i.GPTNeoModel,GPTNeoPreTrainedModel:()=>i.GPTNeoPreTrainedModel,GPTNeoXForCausalLM:()=>i.GPTNeoXForCausalLM,GPTNeoXModel:()=>i.GPTNeoXModel,GPTNeoXPreTrainedModel:()=>i.GPTNeoXPreTrainedModel,GPTNeoXTokenizer:()=>c.GPTNeoXTokenizer,Gemma2ForCausalLM:()=>i.Gemma2ForCausalLM,Gemma2Model:()=>i.Gemma2Model,Gemma2PreTrainedModel:()=>i.Gemma2PreTrainedModel,Gemma3ForCausalLM:()=>i.Gemma3ForCausalLM,Gemma3Model:()=>i.Gemma3Model,Gemma3PreTrainedModel:()=>i.Gemma3PreTrainedModel,Gemma3nAudioFeatureExtractor:()=>at.Gemma3nAudioFeatureExtractor,Gemma3nForConditionalGeneration:()=>i.Gemma3nForConditionalGeneration,Gemma3nPreTrainedModel:()=>i.Gemma3nPreTrainedModel,Gemma3nProcessor:()=>dt.Gemma3nProcessor,GemmaForCausalLM:()=>i.GemmaForCausalLM,GemmaModel:()=>i.GemmaModel,GemmaPreTrainedModel:()=>i.GemmaPreTrainedModel,GemmaTokenizer:()=>c.GemmaTokenizer,GlmForCausalLM:()=>i.GlmForCausalLM,GlmModel:()=>i.GlmModel,GlmPreTrainedModel:()=>i.GlmPreTrainedModel,GraniteForCausalLM:()=>i.GraniteForCausalLM,GraniteModel:()=>i.GraniteModel,GraniteMoeHybridForCausalLM:()=>i.GraniteMoeHybridForCausalLM,GraniteMoeHybridModel:()=>i.GraniteMoeHybridModel,GraniteMoeHybridPreTrainedModel:()=>i.GraniteMoeHybridPreTrainedModel,GranitePreTrainedModel:()=>i.GranitePreTrainedModel,Grok1Tokenizer:()=>c.Grok1Tokenizer,GroundingDinoForObjectDetection:()=>i.GroundingDinoForObjectDetection,GroundingDinoImageProcessor:()=>mt.GroundingDinoImageProcessor,GroundingDinoPreTrainedModel:()=>i.GroundingDinoPreTrainedModel,GroundingDinoProcessor:()=>dt.GroundingDinoProcessor,GroupViTModel:()=>i.GroupViTModel,GroupViTPreTrainedModel:()=>i.GroupViTPreTrainedModel,HeliumForCausalLM:()=>i.HeliumForCausalLM,HeliumModel:()=>i.HeliumModel,HeliumPreTrainedModel:()=>i.HeliumPreTrainedModel,HerbertTokenizer:()=>c.HerbertTokenizer,HieraForImageClassification:()=>i.HieraForImageClassification,HieraModel:()=>i.HieraModel,HieraPreTrainedModel:()=>i.HieraPreTrainedModel,HubertForCTC:()=>i.HubertForCTC,HubertForSequenceClassification:()=>i.HubertForSequenceClassification,HubertModel:()=>i.HubertModel,HubertPreTrainedModel:()=>i.HubertPreTrainedModel,IJepaForImageClassification:()=>i.IJepaForImageClassification,IJepaModel:()=>i.IJepaModel,IJepaPreTrainedModel:()=>i.IJepaPreTrainedModel,Idefics3ForConditionalGeneration:()=>i.Idefics3ForConditionalGeneration,Idefics3ImageProcessor:()=>mt.Idefics3ImageProcessor,Idefics3PreTrainedModel:()=>i.Idefics3PreTrainedModel,Idefics3Processor:()=>dt.Idefics3Processor,ImageClassificationPipeline:()=>s.ImageClassificationPipeline,ImageFeatureExtractionPipeline:()=>s.ImageFeatureExtractionPipeline,ImageFeatureExtractor:()=>at.ImageFeatureExtractor,ImageMattingOutput:()=>i.ImageMattingOutput,ImageProcessor:()=>ct.ImageProcessor,ImageSegmentationPipeline:()=>s.ImageSegmentationPipeline,ImageToImagePipeline:()=>s.ImageToImagePipeline,ImageToTextPipeline:()=>s.ImageToTextPipeline,InterruptableStoppingCriteria:()=>St.InterruptableStoppingCriteria,JAISLMHeadModel:()=>i.JAISLMHeadModel,JAISModel:()=>i.JAISModel,JAISPreTrainedModel:()=>i.JAISPreTrainedModel,JinaCLIPImageProcessor:()=>mt.JinaCLIPImageProcessor,JinaCLIPModel:()=>i.JinaCLIPModel,JinaCLIPPreTrainedModel:()=>i.JinaCLIPPreTrainedModel,JinaCLIPProcessor:()=>dt.JinaCLIPProcessor,JinaCLIPTextModel:()=>i.JinaCLIPTextModel,JinaCLIPVisionModel:()=>i.JinaCLIPVisionModel,Lfm2ForCausalLM:()=>i.Lfm2ForCausalLM,Lfm2Model:()=>i.Lfm2Model,Lfm2PreTrainedModel:()=>i.Lfm2PreTrainedModel,LiteWhisperForConditionalGeneration:()=>i.LiteWhisperForConditionalGeneration,Llama4ForCausalLM:()=>i.Llama4ForCausalLM,Llama4PreTrainedModel:()=>i.Llama4PreTrainedModel,LlamaForCausalLM:()=>i.LlamaForCausalLM,LlamaModel:()=>i.LlamaModel,LlamaPreTrainedModel:()=>i.LlamaPreTrainedModel,LlamaTokenizer:()=>c.LlamaTokenizer,LlavaForConditionalGeneration:()=>i.LlavaForConditionalGeneration,LlavaOnevisionForConditionalGeneration:()=>i.LlavaOnevisionForConditionalGeneration,LlavaOnevisionImageProcessor:()=>mt.LlavaOnevisionImageProcessor,LlavaPreTrainedModel:()=>i.LlavaPreTrainedModel,LlavaProcessor:()=>dt.LlavaProcessor,LlavaQwen2ForCausalLM:()=>i.LlavaQwen2ForCausalLM,LogitsProcessor:()=>Lt.LogitsProcessor,LogitsProcessorList:()=>Lt.LogitsProcessorList,LogitsWarper:()=>Lt.LogitsWarper,LongT5ForConditionalGeneration:()=>i.LongT5ForConditionalGeneration,LongT5Model:()=>i.LongT5Model,LongT5PreTrainedModel:()=>i.LongT5PreTrainedModel,M2M100ForConditionalGeneration:()=>i.M2M100ForConditionalGeneration,M2M100Model:()=>i.M2M100Model,M2M100PreTrainedModel:()=>i.M2M100PreTrainedModel,M2M100Tokenizer:()=>c.M2M100Tokenizer,MBart50Tokenizer:()=>c.MBart50Tokenizer,MBartForCausalLM:()=>i.MBartForCausalLM,MBartForConditionalGeneration:()=>i.MBartForConditionalGeneration,MBartForSequenceClassification:()=>i.MBartForSequenceClassification,MBartModel:()=>i.MBartModel,MBartPreTrainedModel:()=>i.MBartPreTrainedModel,MBartTokenizer:()=>c.MBartTokenizer,MPNetForMaskedLM:()=>i.MPNetForMaskedLM,MPNetForQuestionAnswering:()=>i.MPNetForQuestionAnswering,MPNetForSequenceClassification:()=>i.MPNetForSequenceClassification,MPNetForTokenClassification:()=>i.MPNetForTokenClassification,MPNetModel:()=>i.MPNetModel,MPNetPreTrainedModel:()=>i.MPNetPreTrainedModel,MPNetTokenizer:()=>c.MPNetTokenizer,MT5ForConditionalGeneration:()=>i.MT5ForConditionalGeneration,MT5Model:()=>i.MT5Model,MT5PreTrainedModel:()=>i.MT5PreTrainedModel,MarianMTModel:()=>i.MarianMTModel,MarianModel:()=>i.MarianModel,MarianPreTrainedModel:()=>i.MarianPreTrainedModel,MarianTokenizer:()=>c.MarianTokenizer,Mask2FormerImageProcessor:()=>mt.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>mt.MaskFormerFeatureExtractor,MaskFormerForInstanceSegmentation:()=>i.MaskFormerForInstanceSegmentation,MaskFormerImageProcessor:()=>mt.MaskFormerImageProcessor,MaskFormerModel:()=>i.MaskFormerModel,MaskFormerPreTrainedModel:()=>i.MaskFormerPreTrainedModel,MaskedLMOutput:()=>i.MaskedLMOutput,MaxLengthCriteria:()=>St.MaxLengthCriteria,Metric3DForDepthEstimation:()=>i.Metric3DForDepthEstimation,Metric3DPreTrainedModel:()=>i.Metric3DPreTrainedModel,Metric3Dv2ForDepthEstimation:()=>i.Metric3Dv2ForDepthEstimation,Metric3Dv2PreTrainedModel:()=>i.Metric3Dv2PreTrainedModel,MgpstrForSceneTextRecognition:()=>i.MgpstrForSceneTextRecognition,MgpstrModelOutput:()=>i.MgpstrModelOutput,MgpstrPreTrainedModel:()=>i.MgpstrPreTrainedModel,MgpstrProcessor:()=>dt.MgpstrProcessor,MgpstrTokenizer:()=>c.MgpstrTokenizer,MimiDecoderModel:()=>i.MimiDecoderModel,MimiDecoderOutput:()=>i.MimiDecoderOutput,MimiEncoderModel:()=>i.MimiEncoderModel,MimiEncoderOutput:()=>i.MimiEncoderOutput,MimiModel:()=>i.MimiModel,MimiPreTrainedModel:()=>i.MimiPreTrainedModel,MinLengthLogitsProcessor:()=>Lt.MinLengthLogitsProcessor,MinNewTokensLengthLogitsProcessor:()=>Lt.MinNewTokensLengthLogitsProcessor,MistralForCausalLM:()=>i.MistralForCausalLM,MistralModel:()=>i.MistralModel,MistralPreTrainedModel:()=>i.MistralPreTrainedModel,MobileBertForMaskedLM:()=>i.MobileBertForMaskedLM,MobileBertForQuestionAnswering:()=>i.MobileBertForQuestionAnswering,MobileBertForSequenceClassification:()=>i.MobileBertForSequenceClassification,MobileBertModel:()=>i.MobileBertModel,MobileBertPreTrainedModel:()=>i.MobileBertPreTrainedModel,MobileBertTokenizer:()=>c.MobileBertTokenizer,MobileLLMForCausalLM:()=>i.MobileLLMForCausalLM,MobileLLMModel:()=>i.MobileLLMModel,MobileLLMPreTrainedModel:()=>i.MobileLLMPreTrainedModel,MobileNetV1FeatureExtractor:()=>mt.MobileNetV1FeatureExtractor,MobileNetV1ForImageClassification:()=>i.MobileNetV1ForImageClassification,MobileNetV1ForSemanticSegmentation:()=>i.MobileNetV1ForSemanticSegmentation,MobileNetV1ImageProcessor:()=>mt.MobileNetV1ImageProcessor,MobileNetV1Model:()=>i.MobileNetV1Model,MobileNetV1PreTrainedModel:()=>i.MobileNetV1PreTrainedModel,MobileNetV2FeatureExtractor:()=>mt.MobileNetV2FeatureExtractor,MobileNetV2ForImageClassification:()=>i.MobileNetV2ForImageClassification,MobileNetV2ForSemanticSegmentation:()=>i.MobileNetV2ForSemanticSegmentation,MobileNetV2ImageProcessor:()=>mt.MobileNetV2ImageProcessor,MobileNetV2Model:()=>i.MobileNetV2Model,MobileNetV2PreTrainedModel:()=>i.MobileNetV2PreTrainedModel,MobileNetV3FeatureExtractor:()=>mt.MobileNetV3FeatureExtractor,MobileNetV3ForImageClassification:()=>i.MobileNetV3ForImageClassification,MobileNetV3ForSemanticSegmentation:()=>i.MobileNetV3ForSemanticSegmentation,MobileNetV3ImageProcessor:()=>mt.MobileNetV3ImageProcessor,MobileNetV3Model:()=>i.MobileNetV3Model,MobileNetV3PreTrainedModel:()=>i.MobileNetV3PreTrainedModel,MobileNetV4FeatureExtractor:()=>mt.MobileNetV4FeatureExtractor,MobileNetV4ForImageClassification:()=>i.MobileNetV4ForImageClassification,MobileNetV4ForSemanticSegmentation:()=>i.MobileNetV4ForSemanticSegmentation,MobileNetV4ImageProcessor:()=>mt.MobileNetV4ImageProcessor,MobileNetV4Model:()=>i.MobileNetV4Model,MobileNetV4PreTrainedModel:()=>i.MobileNetV4PreTrainedModel,MobileViTFeatureExtractor:()=>mt.MobileViTFeatureExtractor,MobileViTForImageClassification:()=>i.MobileViTForImageClassification,MobileViTImageProcessor:()=>mt.MobileViTImageProcessor,MobileViTModel:()=>i.MobileViTModel,MobileViTPreTrainedModel:()=>i.MobileViTPreTrainedModel,MobileViTV2ForImageClassification:()=>i.MobileViTV2ForImageClassification,MobileViTV2Model:()=>i.MobileViTV2Model,MobileViTV2PreTrainedModel:()=>i.MobileViTV2PreTrainedModel,ModelOutput:()=>i.ModelOutput,ModernBertDecoderForCausalLM:()=>i.ModernBertDecoderForCausalLM,ModernBertDecoderModel:()=>i.ModernBertDecoderModel,ModernBertDecoderPreTrainedModel:()=>i.ModernBertDecoderPreTrainedModel,ModernBertForMaskedLM:()=>i.ModernBertForMaskedLM,ModernBertForSequenceClassification:()=>i.ModernBertForSequenceClassification,ModernBertForTokenClassification:()=>i.ModernBertForTokenClassification,ModernBertModel:()=>i.ModernBertModel,ModernBertPreTrainedModel:()=>i.ModernBertPreTrainedModel,Moondream1ForConditionalGeneration:()=>i.Moondream1ForConditionalGeneration,MoonshineFeatureExtractor:()=>at.MoonshineFeatureExtractor,MoonshineForConditionalGeneration:()=>i.MoonshineForConditionalGeneration,MoonshineModel:()=>i.MoonshineModel,MoonshinePreTrainedModel:()=>i.MoonshinePreTrainedModel,MoonshineProcessor:()=>dt.MoonshineProcessor,MptForCausalLM:()=>i.MptForCausalLM,MptModel:()=>i.MptModel,MptPreTrainedModel:()=>i.MptPreTrainedModel,MultiModalityCausalLM:()=>i.MultiModalityCausalLM,MultiModalityPreTrainedModel:()=>i.MultiModalityPreTrainedModel,MusicgenForCausalLM:()=>i.MusicgenForCausalLM,MusicgenForConditionalGeneration:()=>i.MusicgenForConditionalGeneration,MusicgenModel:()=>i.MusicgenModel,MusicgenPreTrainedModel:()=>i.MusicgenPreTrainedModel,NanoChatForCausalLM:()=>i.NanoChatForCausalLM,NanoChatModel:()=>i.NanoChatModel,NanoChatPreTrainedModel:()=>i.NanoChatPreTrainedModel,NeoBertForMaskedLM:()=>i.NeoBertForMaskedLM,NeoBertForQuestionAnswering:()=>i.NeoBertForQuestionAnswering,NeoBertForSequenceClassification:()=>i.NeoBertForSequenceClassification,NeoBertForTokenClassification:()=>i.NeoBertForTokenClassification,NeoBertModel:()=>i.NeoBertModel,NeoBertPreTrainedModel:()=>i.NeoBertPreTrainedModel,NllbTokenizer:()=>c.NllbTokenizer,NoBadWordsLogitsProcessor:()=>Lt.NoBadWordsLogitsProcessor,NoRepeatNGramLogitsProcessor:()=>Lt.NoRepeatNGramLogitsProcessor,NomicBertModel:()=>i.NomicBertModel,NomicBertPreTrainedModel:()=>i.NomicBertPreTrainedModel,NougatImageProcessor:()=>mt.NougatImageProcessor,NougatTokenizer:()=>c.NougatTokenizer,OPTForCausalLM:()=>i.OPTForCausalLM,OPTModel:()=>i.OPTModel,OPTPreTrainedModel:()=>i.OPTPreTrainedModel,ObjectDetectionPipeline:()=>s.ObjectDetectionPipeline,Olmo2ForCausalLM:()=>i.Olmo2ForCausalLM,Olmo2Model:()=>i.Olmo2Model,Olmo2PreTrainedModel:()=>i.Olmo2PreTrainedModel,OlmoForCausalLM:()=>i.OlmoForCausalLM,OlmoModel:()=>i.OlmoModel,OlmoPreTrainedModel:()=>i.OlmoPreTrainedModel,OpenELMForCausalLM:()=>i.OpenELMForCausalLM,OpenELMModel:()=>i.OpenELMModel,OpenELMPreTrainedModel:()=>i.OpenELMPreTrainedModel,OwlViTFeatureExtractor:()=>mt.OwlViTFeatureExtractor,OwlViTForObjectDetection:()=>i.OwlViTForObjectDetection,OwlViTImageProcessor:()=>mt.OwlViTImageProcessor,OwlViTModel:()=>i.OwlViTModel,OwlViTPreTrainedModel:()=>i.OwlViTPreTrainedModel,OwlViTProcessor:()=>dt.OwlViTProcessor,Owlv2ForObjectDetection:()=>i.Owlv2ForObjectDetection,Owlv2ImageProcessor:()=>mt.Owlv2ImageProcessor,Owlv2Model:()=>i.Owlv2Model,Owlv2PreTrainedModel:()=>i.Owlv2PreTrainedModel,PaliGemmaForConditionalGeneration:()=>i.PaliGemmaForConditionalGeneration,PaliGemmaPreTrainedModel:()=>i.PaliGemmaPreTrainedModel,PaliGemmaProcessor:()=>dt.PaliGemmaProcessor,ParakeetFeatureExtractor:()=>at.ParakeetFeatureExtractor,ParakeetForCTC:()=>i.ParakeetForCTC,ParakeetPreTrainedModel:()=>i.ParakeetPreTrainedModel,PatchTSMixerForPrediction:()=>i.PatchTSMixerForPrediction,PatchTSMixerModel:()=>i.PatchTSMixerModel,PatchTSMixerPreTrainedModel:()=>i.PatchTSMixerPreTrainedModel,PatchTSTForPrediction:()=>i.PatchTSTForPrediction,PatchTSTModel:()=>i.PatchTSTModel,PatchTSTPreTrainedModel:()=>i.PatchTSTPreTrainedModel,Phi3ForCausalLM:()=>i.Phi3ForCausalLM,Phi3Model:()=>i.Phi3Model,Phi3PreTrainedModel:()=>i.Phi3PreTrainedModel,Phi3VForCausalLM:()=>i.Phi3VForCausalLM,Phi3VImageProcessor:()=>mt.Phi3VImageProcessor,Phi3VPreTrainedModel:()=>i.Phi3VPreTrainedModel,Phi3VProcessor:()=>dt.Phi3VProcessor,PhiForCausalLM:()=>i.PhiForCausalLM,PhiModel:()=>i.PhiModel,PhiPreTrainedModel:()=>i.PhiPreTrainedModel,Pipeline:()=>s.Pipeline,PreTrainedModel:()=>i.PreTrainedModel,PreTrainedTokenizer:()=>c.PreTrainedTokenizer,PretrainedConfig:()=>d.PretrainedConfig,PretrainedMixin:()=>i.PretrainedMixin,Processor:()=>zt.Processor,PvtForImageClassification:()=>i.PvtForImageClassification,PvtImageProcessor:()=>mt.PvtImageProcessor,PvtModel:()=>i.PvtModel,PvtPreTrainedModel:()=>i.PvtPreTrainedModel,PyAnnoteFeatureExtractor:()=>at.PyAnnoteFeatureExtractor,PyAnnoteForAudioFrameClassification:()=>i.PyAnnoteForAudioFrameClassification,PyAnnoteModel:()=>i.PyAnnoteModel,PyAnnotePreTrainedModel:()=>i.PyAnnotePreTrainedModel,PyAnnoteProcessor:()=>dt.PyAnnoteProcessor,QuestionAnsweringModelOutput:()=>i.QuestionAnsweringModelOutput,QuestionAnsweringPipeline:()=>s.QuestionAnsweringPipeline,Qwen2ForCausalLM:()=>i.Qwen2ForCausalLM,Qwen2Model:()=>i.Qwen2Model,Qwen2PreTrainedModel:()=>i.Qwen2PreTrainedModel,Qwen2Tokenizer:()=>c.Qwen2Tokenizer,Qwen2VLForConditionalGeneration:()=>i.Qwen2VLForConditionalGeneration,Qwen2VLImageProcessor:()=>mt.Qwen2VLImageProcessor,Qwen2VLPreTrainedModel:()=>i.Qwen2VLPreTrainedModel,Qwen2VLProcessor:()=>dt.Qwen2VLProcessor,Qwen3ForCausalLM:()=>i.Qwen3ForCausalLM,Qwen3Model:()=>i.Qwen3Model,Qwen3PreTrainedModel:()=>i.Qwen3PreTrainedModel,RFDetrForObjectDetection:()=>i.RFDetrForObjectDetection,RFDetrModel:()=>i.RFDetrModel,RFDetrObjectDetectionOutput:()=>i.RFDetrObjectDetectionOutput,RFDetrPreTrainedModel:()=>i.RFDetrPreTrainedModel,RTDetrForObjectDetection:()=>i.RTDetrForObjectDetection,RTDetrImageProcessor:()=>mt.RTDetrImageProcessor,RTDetrModel:()=>i.RTDetrModel,RTDetrObjectDetectionOutput:()=>i.RTDetrObjectDetectionOutput,RTDetrPreTrainedModel:()=>i.RTDetrPreTrainedModel,RTDetrV2ForObjectDetection:()=>i.RTDetrV2ForObjectDetection,RTDetrV2Model:()=>i.RTDetrV2Model,RTDetrV2ObjectDetectionOutput:()=>i.RTDetrV2ObjectDetectionOutput,RTDetrV2PreTrainedModel:()=>i.RTDetrV2PreTrainedModel,RawAudio:()=>h.RawAudio,RawImage:()=>_.RawImage,RawVideo:()=>g.RawVideo,RawVideoFrame:()=>g.RawVideoFrame,RepetitionPenaltyLogitsProcessor:()=>Lt.RepetitionPenaltyLogitsProcessor,ResNetForImageClassification:()=>i.ResNetForImageClassification,ResNetModel:()=>i.ResNetModel,ResNetPreTrainedModel:()=>i.ResNetPreTrainedModel,RoFormerForMaskedLM:()=>i.RoFormerForMaskedLM,RoFormerForQuestionAnswering:()=>i.RoFormerForQuestionAnswering,RoFormerForSequenceClassification:()=>i.RoFormerForSequenceClassification,RoFormerForTokenClassification:()=>i.RoFormerForTokenClassification,RoFormerModel:()=>i.RoFormerModel,RoFormerPreTrainedModel:()=>i.RoFormerPreTrainedModel,RoFormerTokenizer:()=>c.RoFormerTokenizer,RobertaForMaskedLM:()=>i.RobertaForMaskedLM,RobertaForQuestionAnswering:()=>i.RobertaForQuestionAnswering,RobertaForSequenceClassification:()=>i.RobertaForSequenceClassification,RobertaForTokenClassification:()=>i.RobertaForTokenClassification,RobertaModel:()=>i.RobertaModel,RobertaPreTrainedModel:()=>i.RobertaPreTrainedModel,RobertaTokenizer:()=>c.RobertaTokenizer,SamImageProcessor:()=>mt.SamImageProcessor,SamImageSegmentationOutput:()=>i.SamImageSegmentationOutput,SamModel:()=>i.SamModel,SamPreTrainedModel:()=>i.SamPreTrainedModel,SamProcessor:()=>dt.SamProcessor,SapiensForDepthEstimation:()=>i.SapiensForDepthEstimation,SapiensForNormalEstimation:()=>i.SapiensForNormalEstimation,SapiensForSemanticSegmentation:()=>i.SapiensForSemanticSegmentation,SapiensPreTrainedModel:()=>i.SapiensPreTrainedModel,SeamlessM4TFeatureExtractor:()=>at.SeamlessM4TFeatureExtractor,SegformerFeatureExtractor:()=>mt.SegformerFeatureExtractor,SegformerForImageClassification:()=>i.SegformerForImageClassification,SegformerForSemanticSegmentation:()=>i.SegformerForSemanticSegmentation,SegformerImageProcessor:()=>mt.SegformerImageProcessor,SegformerModel:()=>i.SegformerModel,SegformerPreTrainedModel:()=>i.SegformerPreTrainedModel,Seq2SeqLMOutput:()=>i.Seq2SeqLMOutput,SequenceClassifierOutput:()=>i.SequenceClassifierOutput,SiglipImageProcessor:()=>mt.SiglipImageProcessor,SiglipModel:()=>i.SiglipModel,SiglipPreTrainedModel:()=>i.SiglipPreTrainedModel,SiglipTextModel:()=>i.SiglipTextModel,SiglipTokenizer:()=>c.SiglipTokenizer,SiglipVisionModel:()=>i.SiglipVisionModel,SmolLM3ForCausalLM:()=>i.SmolLM3ForCausalLM,SmolLM3Model:()=>i.SmolLM3Model,SmolLM3PreTrainedModel:()=>i.SmolLM3PreTrainedModel,SmolVLMForConditionalGeneration:()=>i.SmolVLMForConditionalGeneration,SmolVLMImageProcessor:()=>mt.SmolVLMImageProcessor,SmolVLMProcessor:()=>dt.SmolVLMProcessor,SnacDecoderModel:()=>i.SnacDecoderModel,SnacEncoderModel:()=>i.SnacEncoderModel,SnacFeatureExtractor:()=>at.SnacFeatureExtractor,SnacModel:()=>i.SnacModel,SnacPreTrainedModel:()=>i.SnacPreTrainedModel,SpeechT5FeatureExtractor:()=>at.SpeechT5FeatureExtractor,SpeechT5ForSpeechToText:()=>i.SpeechT5ForSpeechToText,SpeechT5ForTextToSpeech:()=>i.SpeechT5ForTextToSpeech,SpeechT5HifiGan:()=>i.SpeechT5HifiGan,SpeechT5Model:()=>i.SpeechT5Model,SpeechT5PreTrainedModel:()=>i.SpeechT5PreTrainedModel,SpeechT5Processor:()=>dt.SpeechT5Processor,SpeechT5Tokenizer:()=>c.SpeechT5Tokenizer,SqueezeBertForMaskedLM:()=>i.SqueezeBertForMaskedLM,SqueezeBertForQuestionAnswering:()=>i.SqueezeBertForQuestionAnswering,SqueezeBertForSequenceClassification:()=>i.SqueezeBertForSequenceClassification,SqueezeBertModel:()=>i.SqueezeBertModel,SqueezeBertPreTrainedModel:()=>i.SqueezeBertPreTrainedModel,SqueezeBertTokenizer:()=>c.SqueezeBertTokenizer,StableLmForCausalLM:()=>i.StableLmForCausalLM,StableLmModel:()=>i.StableLmModel,StableLmPreTrainedModel:()=>i.StableLmPreTrainedModel,Starcoder2ForCausalLM:()=>i.Starcoder2ForCausalLM,Starcoder2Model:()=>i.Starcoder2Model,Starcoder2PreTrainedModel:()=>i.Starcoder2PreTrainedModel,StoppingCriteria:()=>St.StoppingCriteria,StoppingCriteriaList:()=>St.StoppingCriteriaList,StyleTextToSpeech2Model:()=>i.StyleTextToSpeech2Model,StyleTextToSpeech2PreTrainedModel:()=>i.StyleTextToSpeech2PreTrainedModel,SummarizationPipeline:()=>s.SummarizationPipeline,SuppressTokensAtBeginLogitsProcessor:()=>Lt.SuppressTokensAtBeginLogitsProcessor,Swin2SRForImageSuperResolution:()=>i.Swin2SRForImageSuperResolution,Swin2SRImageProcessor:()=>mt.Swin2SRImageProcessor,Swin2SRModel:()=>i.Swin2SRModel,Swin2SRPreTrainedModel:()=>i.Swin2SRPreTrainedModel,SwinForImageClassification:()=>i.SwinForImageClassification,SwinForSemanticSegmentation:()=>i.SwinForSemanticSegmentation,SwinModel:()=>i.SwinModel,SwinPreTrainedModel:()=>i.SwinPreTrainedModel,T5ForConditionalGeneration:()=>i.T5ForConditionalGeneration,T5Model:()=>i.T5Model,T5PreTrainedModel:()=>i.T5PreTrainedModel,T5Tokenizer:()=>c.T5Tokenizer,TableTransformerForObjectDetection:()=>i.TableTransformerForObjectDetection,TableTransformerModel:()=>i.TableTransformerModel,TableTransformerObjectDetectionOutput:()=>i.TableTransformerObjectDetectionOutput,TableTransformerPreTrainedModel:()=>i.TableTransformerPreTrainedModel,TemperatureLogitsWarper:()=>Lt.TemperatureLogitsWarper,Tensor:()=>$.Tensor,Text2TextGenerationPipeline:()=>s.Text2TextGenerationPipeline,TextClassificationPipeline:()=>s.TextClassificationPipeline,TextGenerationPipeline:()=>s.TextGenerationPipeline,TextStreamer:()=>kt.TextStreamer,TextToAudioPipeline:()=>s.TextToAudioPipeline,TokenClassificationPipeline:()=>s.TokenClassificationPipeline,TokenClassifierOutput:()=>i.TokenClassifierOutput,TokenizerModel:()=>c.TokenizerModel,TopKLogitsWarper:()=>Lt.TopKLogitsWarper,TopPLogitsWarper:()=>Lt.TopPLogitsWarper,TrOCRForCausalLM:()=>i.TrOCRForCausalLM,TrOCRPreTrainedModel:()=>i.TrOCRPreTrainedModel,TranslationPipeline:()=>s.TranslationPipeline,UltravoxModel:()=>i.UltravoxModel,UltravoxPreTrainedModel:()=>i.UltravoxPreTrainedModel,UltravoxProcessor:()=>dt.UltravoxProcessor,UniSpeechForCTC:()=>i.UniSpeechForCTC,UniSpeechForSequenceClassification:()=>i.UniSpeechForSequenceClassification,UniSpeechModel:()=>i.UniSpeechModel,UniSpeechPreTrainedModel:()=>i.UniSpeechPreTrainedModel,UniSpeechSatForAudioFrameClassification:()=>i.UniSpeechSatForAudioFrameClassification,UniSpeechSatForCTC:()=>i.UniSpeechSatForCTC,UniSpeechSatForSequenceClassification:()=>i.UniSpeechSatForSequenceClassification,UniSpeechSatModel:()=>i.UniSpeechSatModel,UniSpeechSatPreTrainedModel:()=>i.UniSpeechSatPreTrainedModel,VLChatProcessor:()=>dt.VLChatProcessor,VLMImageProcessor:()=>mt.VLMImageProcessor,VaultGemmaForCausalLM:()=>i.VaultGemmaForCausalLM,VaultGemmaModel:()=>i.VaultGemmaModel,VaultGemmaPreTrainedModel:()=>i.VaultGemmaPreTrainedModel,ViTFeatureExtractor:()=>mt.ViTFeatureExtractor,ViTForImageClassification:()=>i.ViTForImageClassification,ViTImageProcessor:()=>mt.ViTImageProcessor,ViTMAEModel:()=>i.ViTMAEModel,ViTMAEPreTrainedModel:()=>i.ViTMAEPreTrainedModel,ViTMSNForImageClassification:()=>i.ViTMSNForImageClassification,ViTMSNModel:()=>i.ViTMSNModel,ViTMSNPreTrainedModel:()=>i.ViTMSNPreTrainedModel,ViTModel:()=>i.ViTModel,ViTPreTrainedModel:()=>i.ViTPreTrainedModel,VisionEncoderDecoderModel:()=>i.VisionEncoderDecoderModel,VitMatteForImageMatting:()=>i.VitMatteForImageMatting,VitMatteImageProcessor:()=>mt.VitMatteImageProcessor,VitMattePreTrainedModel:()=>i.VitMattePreTrainedModel,VitPoseForPoseEstimation:()=>i.VitPoseForPoseEstimation,VitPoseImageProcessor:()=>mt.VitPoseImageProcessor,VitPosePreTrainedModel:()=>i.VitPosePreTrainedModel,VitsModel:()=>i.VitsModel,VitsModelOutput:()=>i.VitsModelOutput,VitsPreTrainedModel:()=>i.VitsPreTrainedModel,VitsTokenizer:()=>c.VitsTokenizer,VoxtralForConditionalGeneration:()=>i.VoxtralForConditionalGeneration,VoxtralProcessor:()=>dt.VoxtralProcessor,Wav2Vec2BertForCTC:()=>i.Wav2Vec2BertForCTC,Wav2Vec2BertForSequenceClassification:()=>i.Wav2Vec2BertForSequenceClassification,Wav2Vec2BertModel:()=>i.Wav2Vec2BertModel,Wav2Vec2BertPreTrainedModel:()=>i.Wav2Vec2BertPreTrainedModel,Wav2Vec2CTCTokenizer:()=>c.Wav2Vec2CTCTokenizer,Wav2Vec2FeatureExtractor:()=>at.Wav2Vec2FeatureExtractor,Wav2Vec2ForAudioFrameClassification:()=>i.Wav2Vec2ForAudioFrameClassification,Wav2Vec2ForCTC:()=>i.Wav2Vec2ForCTC,Wav2Vec2ForSequenceClassification:()=>i.Wav2Vec2ForSequenceClassification,Wav2Vec2Model:()=>i.Wav2Vec2Model,Wav2Vec2PreTrainedModel:()=>i.Wav2Vec2PreTrainedModel,Wav2Vec2Processor:()=>dt.Wav2Vec2Processor,Wav2Vec2ProcessorWithLM:()=>dt.Wav2Vec2ProcessorWithLM,WavLMForAudioFrameClassification:()=>i.WavLMForAudioFrameClassification,WavLMForCTC:()=>i.WavLMForCTC,WavLMForSequenceClassification:()=>i.WavLMForSequenceClassification,WavLMForXVector:()=>i.WavLMForXVector,WavLMModel:()=>i.WavLMModel,WavLMPreTrainedModel:()=>i.WavLMPreTrainedModel,WeSpeakerFeatureExtractor:()=>at.WeSpeakerFeatureExtractor,WeSpeakerResNetModel:()=>i.WeSpeakerResNetModel,WeSpeakerResNetPreTrainedModel:()=>i.WeSpeakerResNetPreTrainedModel,WhisperFeatureExtractor:()=>at.WhisperFeatureExtractor,WhisperForConditionalGeneration:()=>i.WhisperForConditionalGeneration,WhisperModel:()=>i.WhisperModel,WhisperPreTrainedModel:()=>i.WhisperPreTrainedModel,WhisperProcessor:()=>dt.WhisperProcessor,WhisperTextStreamer:()=>kt.WhisperTextStreamer,WhisperTimeStampLogitsProcessor:()=>Lt.WhisperTimeStampLogitsProcessor,WhisperTokenizer:()=>c.WhisperTokenizer,XLMForQuestionAnswering:()=>i.XLMForQuestionAnswering,XLMForSequenceClassification:()=>i.XLMForSequenceClassification,XLMForTokenClassification:()=>i.XLMForTokenClassification,XLMModel:()=>i.XLMModel,XLMPreTrainedModel:()=>i.XLMPreTrainedModel,XLMRobertaForMaskedLM:()=>i.XLMRobertaForMaskedLM,XLMRobertaForQuestionAnswering:()=>i.XLMRobertaForQuestionAnswering,XLMRobertaForSequenceClassification:()=>i.XLMRobertaForSequenceClassification,XLMRobertaForTokenClassification:()=>i.XLMRobertaForTokenClassification,XLMRobertaModel:()=>i.XLMRobertaModel,XLMRobertaPreTrainedModel:()=>i.XLMRobertaPreTrainedModel,XLMRobertaTokenizer:()=>c.XLMRobertaTokenizer,XLMTokenizer:()=>c.XLMTokenizer,XLMWithLMHeadModel:()=>i.XLMWithLMHeadModel,XVectorOutput:()=>i.XVectorOutput,YolosFeatureExtractor:()=>mt.YolosFeatureExtractor,YolosForObjectDetection:()=>i.YolosForObjectDetection,YolosImageProcessor:()=>mt.YolosImageProcessor,YolosModel:()=>i.YolosModel,YolosObjectDetectionOutput:()=>i.YolosObjectDetectionOutput,YolosPreTrainedModel:()=>i.YolosPreTrainedModel,ZeroShotAudioClassificationPipeline:()=>s.ZeroShotAudioClassificationPipeline,ZeroShotClassificationPipeline:()=>s.ZeroShotClassificationPipeline,ZeroShotImageClassificationPipeline:()=>s.ZeroShotImageClassificationPipeline,ZeroShotObjectDetectionPipeline:()=>s.ZeroShotObjectDetectionPipeline,bankers_round:()=>_e.bankers_round,cat:()=>$.cat,cos_sim:()=>_e.cos_sim,dot:()=>_e.dot,dynamic_time_warping:()=>_e.dynamic_time_warping,env:()=>e.env,full:()=>$.full,full_like:()=>$.full_like,getCacheShapes:()=>d.getCacheShapes,hamming:()=>h.hamming,hanning:()=>h.hanning,interpolate:()=>$.interpolate,interpolate_4d:()=>$.interpolate_4d,interpolate_data:()=>_e.interpolate_data,is_chinese_char:()=>c.is_chinese_char,layer_norm:()=>$.layer_norm,load_image:()=>_.load_image,load_video:()=>g.load_video,log_softmax:()=>_e.log_softmax,magnitude:()=>_e.magnitude,matmul:()=>$.matmul,max:()=>_e.max,mean:()=>$.mean,mean_pooling:()=>$.mean_pooling,medianFilter:()=>_e.medianFilter,mel_filter_bank:()=>h.mel_filter_bank,min:()=>_e.min,ones:()=>$.ones,ones_like:()=>$.ones_like,permute:()=>$.permute,permute_data:()=>_e.permute_data,pipeline:()=>s.pipeline,quantize_embeddings:()=>$.quantize_embeddings,rand:()=>$.rand,read_audio:()=>h.read_audio,rfft:()=>$.rfft,round:()=>_e.round,slice:()=>$.slice,softmax:()=>_e.softmax,spectrogram:()=>h.spectrogram,stack:()=>$.stack,std_mean:()=>$.std_mean,topk:()=>$.topk,window_function:()=>h.window_function,zeros:()=>$.zeros,zeros_like:()=>$.zeros_like});var e=__webpack_require__("./src/env.js"),s=__webpack_require__("./src/pipelines.js"),i=__webpack_require__("./src/models.js"),c=__webpack_require__("./src/tokenizers.js"),d=__webpack_require__("./src/configs.js"),h=__webpack_require__("./src/utils/audio.js"),_=__webpack_require__("./src/utils/image.js"),g=__webpack_require__("./src/utils/video.js"),$=__webpack_require__("./src/utils/tensor.js"),_e=__webpack_require__("./src/utils/maths.js"),lt=__webpack_require__("./src/base/feature_extraction_utils.js"),at=__webpack_require__("./src/models/feature_extractors.js"),it=__webpack_require__("./src/models/auto/feature_extraction_auto.js"),ct=__webpack_require__("./src/base/image_processors_utils.js"),mt=__webpack_require__("./src/models/image_processors.js"),pt=__webpack_require__("./src/models/auto/image_processing_auto.js"),zt=__webpack_require__("./src/base/processing_utils.js"),dt=__webpack_require__("./src/models/processors.js"),ft=__webpack_require__("./src/models/auto/processing_auto.js"),kt=__webpack_require__("./src/generation/streamers.js"),St=__webpack_require__("./src/generation/stopping_criteria.js"),Lt=__webpack_require__("./src/generation/logits_process.js")})();__webpack_exports__.ASTFeatureExtractor;__webpack_exports__.ASTForAudioClassification;__webpack_exports__.ASTModel;__webpack_exports__.ASTPreTrainedModel;__webpack_exports__.AlbertForMaskedLM;__webpack_exports__.AlbertForQuestionAnswering;__webpack_exports__.AlbertForSequenceClassification;__webpack_exports__.AlbertModel;__webpack_exports__.AlbertPreTrainedModel;__webpack_exports__.AlbertTokenizer;__webpack_exports__.ArceeForCausalLM;__webpack_exports__.ArceeModel;__webpack_exports__.ArceePreTrainedModel;__webpack_exports__.AudioClassificationPipeline;__webpack_exports__.AutoConfig;__webpack_exports__.AutoFeatureExtractor;__webpack_exports__.AutoImageProcessor;__webpack_exports__.AutoModel;__webpack_exports__.AutoModelForAudioClassification;__webpack_exports__.AutoModelForAudioFrameClassification;__webpack_exports__.AutoModelForAudioTextToText;__webpack_exports__.AutoModelForCTC;__webpack_exports__.AutoModelForCausalLM;__webpack_exports__.AutoModelForDepthEstimation;__webpack_exports__.AutoModelForDocumentQuestionAnswering;__webpack_exports__.AutoModelForImageClassification;__webpack_exports__.AutoModelForImageFeatureExtraction;__webpack_exports__.AutoModelForImageMatting;__webpack_exports__.AutoModelForImageSegmentation;__webpack_exports__.AutoModelForImageTextToText;__webpack_exports__.AutoModelForImageToImage;__webpack_exports__.AutoModelForMaskGeneration;__webpack_exports__.AutoModelForMaskedLM;__webpack_exports__.AutoModelForNormalEstimation;__webpack_exports__.AutoModelForObjectDetection;__webpack_exports__.AutoModelForPoseEstimation;__webpack_exports__.AutoModelForQuestionAnswering;__webpack_exports__.AutoModelForSemanticSegmentation;__webpack_exports__.AutoModelForSeq2SeqLM;__webpack_exports__.AutoModelForSequenceClassification;__webpack_exports__.AutoModelForSpeechSeq2Seq;__webpack_exports__.AutoModelForTextToSpectrogram;__webpack_exports__.AutoModelForTextToWaveform;__webpack_exports__.AutoModelForTokenClassification;__webpack_exports__.AutoModelForUniversalSegmentation;__webpack_exports__.AutoModelForVision2Seq;__webpack_exports__.AutoModelForXVector;__webpack_exports__.AutoModelForZeroShotObjectDetection;__webpack_exports__.AutoProcessor;__webpack_exports__.AutoTokenizer;__webpack_exports__.AutomaticSpeechRecognitionPipeline;__webpack_exports__.BackgroundRemovalPipeline;__webpack_exports__.BartForConditionalGeneration;__webpack_exports__.BartForSequenceClassification;__webpack_exports__.BartModel;__webpack_exports__.BartPretrainedModel;__webpack_exports__.BartTokenizer;__webpack_exports__.BaseModelOutput;__webpack_exports__.BaseStreamer;__webpack_exports__.BeitFeatureExtractor;__webpack_exports__.BeitForImageClassification;__webpack_exports__.BeitModel;__webpack_exports__.BeitPreTrainedModel;__webpack_exports__.BertForMaskedLM;__webpack_exports__.BertForQuestionAnswering;__webpack_exports__.BertForSequenceClassification;__webpack_exports__.BertForTokenClassification;__webpack_exports__.BertModel;__webpack_exports__.BertPreTrainedModel;__webpack_exports__.BertTokenizer;__webpack_exports__.BitImageProcessor;__webpack_exports__.BlenderbotForConditionalGeneration;__webpack_exports__.BlenderbotModel;__webpack_exports__.BlenderbotPreTrainedModel;__webpack_exports__.BlenderbotSmallForConditionalGeneration;__webpack_exports__.BlenderbotSmallModel;__webpack_exports__.BlenderbotSmallPreTrainedModel;__webpack_exports__.BlenderbotSmallTokenizer;__webpack_exports__.BlenderbotTokenizer;__webpack_exports__.BloomForCausalLM;__webpack_exports__.BloomModel;__webpack_exports__.BloomPreTrainedModel;__webpack_exports__.BloomTokenizer;__webpack_exports__.CLIPFeatureExtractor;__webpack_exports__.CLIPImageProcessor;__webpack_exports__.CLIPModel;__webpack_exports__.CLIPPreTrainedModel;__webpack_exports__.CLIPSegForImageSegmentation;__webpack_exports__.CLIPSegModel;__webpack_exports__.CLIPSegPreTrainedModel;__webpack_exports__.CLIPTextModel;__webpack_exports__.CLIPTextModelWithProjection;__webpack_exports__.CLIPTokenizer;__webpack_exports__.CLIPVisionModel;__webpack_exports__.CLIPVisionModelWithProjection;__webpack_exports__.CamembertForMaskedLM;__webpack_exports__.CamembertForQuestionAnswering;__webpack_exports__.CamembertForSequenceClassification;__webpack_exports__.CamembertForTokenClassification;__webpack_exports__.CamembertModel;__webpack_exports__.CamembertPreTrainedModel;__webpack_exports__.CamembertTokenizer;__webpack_exports__.CausalLMOutput;__webpack_exports__.CausalLMOutputWithPast;__webpack_exports__.ChineseCLIPFeatureExtractor;__webpack_exports__.ChineseCLIPModel;__webpack_exports__.ChineseCLIPPreTrainedModel;__webpack_exports__.ClapAudioModelWithProjection;__webpack_exports__.ClapFeatureExtractor;__webpack_exports__.ClapModel;__webpack_exports__.ClapPreTrainedModel;__webpack_exports__.ClapTextModelWithProjection;__webpack_exports__.ClassifierFreeGuidanceLogitsProcessor;__webpack_exports__.CodeGenForCausalLM;__webpack_exports__.CodeGenModel;__webpack_exports__.CodeGenPreTrainedModel;__webpack_exports__.CodeGenTokenizer;__webpack_exports__.CodeLlamaTokenizer;__webpack_exports__.CohereForCausalLM;__webpack_exports__.CohereModel;__webpack_exports__.CoherePreTrainedModel;__webpack_exports__.CohereTokenizer;__webpack_exports__.ConvBertForMaskedLM;__webpack_exports__.ConvBertForQuestionAnswering;__webpack_exports__.ConvBertForSequenceClassification;__webpack_exports__.ConvBertForTokenClassification;__webpack_exports__.ConvBertModel;__webpack_exports__.ConvBertPreTrainedModel;__webpack_exports__.ConvBertTokenizer;__webpack_exports__.ConvNextFeatureExtractor;__webpack_exports__.ConvNextForImageClassification;__webpack_exports__.ConvNextImageProcessor;__webpack_exports__.ConvNextModel;__webpack_exports__.ConvNextPreTrainedModel;__webpack_exports__.ConvNextV2ForImageClassification;__webpack_exports__.ConvNextV2Model;__webpack_exports__.ConvNextV2PreTrainedModel;__webpack_exports__.DFineForObjectDetection;__webpack_exports__.DFineModel;__webpack_exports__.DFinePreTrainedModel;__webpack_exports__.DINOv3ConvNextModel;__webpack_exports__.DINOv3ConvNextPreTrainedModel;__webpack_exports__.DINOv3ViTImageProcessor;__webpack_exports__.DINOv3ViTModel;__webpack_exports__.DINOv3ViTPreTrainedModel;__webpack_exports__.DPTFeatureExtractor;__webpack_exports__.DPTForDepthEstimation;__webpack_exports__.DPTImageProcessor;__webpack_exports__.DPTModel;__webpack_exports__.DPTPreTrainedModel;__webpack_exports__.DacDecoderModel;__webpack_exports__.DacDecoderOutput;__webpack_exports__.DacEncoderModel;__webpack_exports__.DacEncoderOutput;__webpack_exports__.DacFeatureExtractor;__webpack_exports__.DacModel;__webpack_exports__.DacPreTrainedModel;__webpack_exports__.DataTypeMap;__webpack_exports__.DebertaForMaskedLM;__webpack_exports__.DebertaForQuestionAnswering;__webpack_exports__.DebertaForSequenceClassification;__webpack_exports__.DebertaForTokenClassification;__webpack_exports__.DebertaModel;__webpack_exports__.DebertaPreTrainedModel;__webpack_exports__.DebertaTokenizer;__webpack_exports__.DebertaV2ForMaskedLM;__webpack_exports__.DebertaV2ForQuestionAnswering;__webpack_exports__.DebertaV2ForSequenceClassification;__webpack_exports__.DebertaV2ForTokenClassification;__webpack_exports__.DebertaV2Model;__webpack_exports__.DebertaV2PreTrainedModel;__webpack_exports__.DebertaV2Tokenizer;__webpack_exports__.DecisionTransformerModel;__webpack_exports__.DecisionTransformerPreTrainedModel;__webpack_exports__.DeiTFeatureExtractor;__webpack_exports__.DeiTForImageClassification;__webpack_exports__.DeiTImageProcessor;__webpack_exports__.DeiTModel;__webpack_exports__.DeiTPreTrainedModel;__webpack_exports__.DepthAnythingForDepthEstimation;__webpack_exports__.DepthAnythingPreTrainedModel;__webpack_exports__.DepthEstimationPipeline;__webpack_exports__.DepthProForDepthEstimation;__webpack_exports__.DepthProPreTrainedModel;__webpack_exports__.DetrFeatureExtractor;__webpack_exports__.DetrForObjectDetection;__webpack_exports__.DetrForSegmentation;__webpack_exports__.DetrImageProcessor;__webpack_exports__.DetrModel;__webpack_exports__.DetrObjectDetectionOutput;__webpack_exports__.DetrPreTrainedModel;__webpack_exports__.DetrSegmentationOutput;__webpack_exports__.Dinov2ForImageClassification;__webpack_exports__.Dinov2Model;__webpack_exports__.Dinov2PreTrainedModel;__webpack_exports__.Dinov2WithRegistersForImageClassification;__webpack_exports__.Dinov2WithRegistersModel;__webpack_exports__.Dinov2WithRegistersPreTrainedModel;__webpack_exports__.DistilBertForMaskedLM;__webpack_exports__.DistilBertForQuestionAnswering;__webpack_exports__.DistilBertForSequenceClassification;__webpack_exports__.DistilBertForTokenClassification;__webpack_exports__.DistilBertModel;__webpack_exports__.DistilBertPreTrainedModel;__webpack_exports__.DistilBertTokenizer;__webpack_exports__.DocumentQuestionAnsweringPipeline;__webpack_exports__.DonutFeatureExtractor;__webpack_exports__.DonutImageProcessor;__webpack_exports__.DonutSwinModel;__webpack_exports__.DonutSwinPreTrainedModel;__webpack_exports__.EfficientNetForImageClassification;__webpack_exports__.EfficientNetImageProcessor;__webpack_exports__.EfficientNetModel;__webpack_exports__.EfficientNetPreTrainedModel;__webpack_exports__.ElectraForMaskedLM;__webpack_exports__.ElectraForQuestionAnswering;__webpack_exports__.ElectraForSequenceClassification;__webpack_exports__.ElectraForTokenClassification;__webpack_exports__.ElectraModel;__webpack_exports__.ElectraPreTrainedModel;__webpack_exports__.ElectraTokenizer;__webpack_exports__.EncodecFeatureExtractor;__webpack_exports__.EosTokenCriteria;__webpack_exports__.Ernie4_5_ForCausalLM;__webpack_exports__.Ernie4_5_Model;__webpack_exports__.Ernie4_5_PretrainedModel;__webpack_exports__.Ernie4_5_Tokenizer;__webpack_exports__.EsmForMaskedLM;__webpack_exports__.EsmForSequenceClassification;__webpack_exports__.EsmForTokenClassification;__webpack_exports__.EsmModel;__webpack_exports__.EsmPreTrainedModel;__webpack_exports__.EsmTokenizer;__webpack_exports__.ExaoneForCausalLM;__webpack_exports__.ExaoneModel;__webpack_exports__.ExaonePreTrainedModel;__webpack_exports__.FFT;__webpack_exports__.FalconForCausalLM;__webpack_exports__.FalconModel;__webpack_exports__.FalconPreTrainedModel;__webpack_exports__.FalconTokenizer;__webpack_exports__.FastViTForImageClassification;__webpack_exports__.FastViTModel;__webpack_exports__.FastViTPreTrainedModel;__webpack_exports__.FeatureExtractionPipeline;__webpack_exports__.FeatureExtractor;__webpack_exports__.FillMaskPipeline;__webpack_exports__.Florence2ForConditionalGeneration;__webpack_exports__.Florence2PreTrainedModel;__webpack_exports__.Florence2Processor;__webpack_exports__.ForcedBOSTokenLogitsProcessor;__webpack_exports__.ForcedEOSTokenLogitsProcessor;__webpack_exports__.GLPNFeatureExtractor;__webpack_exports__.GLPNForDepthEstimation;__webpack_exports__.GLPNModel;__webpack_exports__.GLPNPreTrainedModel;__webpack_exports__.GPT2LMHeadModel;__webpack_exports__.GPT2Model;__webpack_exports__.GPT2PreTrainedModel;__webpack_exports__.GPT2Tokenizer;__webpack_exports__.GPTBigCodeForCausalLM;__webpack_exports__.GPTBigCodeModel;__webpack_exports__.GPTBigCodePreTrainedModel;__webpack_exports__.GPTJForCausalLM;__webpack_exports__.GPTJModel;__webpack_exports__.GPTJPreTrainedModel;__webpack_exports__.GPTNeoForCausalLM;__webpack_exports__.GPTNeoModel;__webpack_exports__.GPTNeoPreTrainedModel;__webpack_exports__.GPTNeoXForCausalLM;__webpack_exports__.GPTNeoXModel;__webpack_exports__.GPTNeoXPreTrainedModel;__webpack_exports__.GPTNeoXTokenizer;__webpack_exports__.Gemma2ForCausalLM;__webpack_exports__.Gemma2Model;__webpack_exports__.Gemma2PreTrainedModel;__webpack_exports__.Gemma3ForCausalLM;__webpack_exports__.Gemma3Model;__webpack_exports__.Gemma3PreTrainedModel;__webpack_exports__.Gemma3nAudioFeatureExtractor;__webpack_exports__.Gemma3nForConditionalGeneration;__webpack_exports__.Gemma3nPreTrainedModel;__webpack_exports__.Gemma3nProcessor;__webpack_exports__.GemmaForCausalLM;__webpack_exports__.GemmaModel;__webpack_exports__.GemmaPreTrainedModel;__webpack_exports__.GemmaTokenizer;__webpack_exports__.GlmForCausalLM;__webpack_exports__.GlmModel;__webpack_exports__.GlmPreTrainedModel;__webpack_exports__.GraniteForCausalLM;__webpack_exports__.GraniteModel;__webpack_exports__.GraniteMoeHybridForCausalLM;__webpack_exports__.GraniteMoeHybridModel;__webpack_exports__.GraniteMoeHybridPreTrainedModel;__webpack_exports__.GranitePreTrainedModel;__webpack_exports__.Grok1Tokenizer;__webpack_exports__.GroundingDinoForObjectDetection;__webpack_exports__.GroundingDinoImageProcessor;__webpack_exports__.GroundingDinoPreTrainedModel;__webpack_exports__.GroundingDinoProcessor;__webpack_exports__.GroupViTModel;__webpack_exports__.GroupViTPreTrainedModel;__webpack_exports__.HeliumForCausalLM;__webpack_exports__.HeliumModel;__webpack_exports__.HeliumPreTrainedModel;__webpack_exports__.HerbertTokenizer;__webpack_exports__.HieraForImageClassification;__webpack_exports__.HieraModel;__webpack_exports__.HieraPreTrainedModel;__webpack_exports__.HubertForCTC;__webpack_exports__.HubertForSequenceClassification;__webpack_exports__.HubertModel;__webpack_exports__.HubertPreTrainedModel;__webpack_exports__.IJepaForImageClassification;__webpack_exports__.IJepaModel;__webpack_exports__.IJepaPreTrainedModel;__webpack_exports__.Idefics3ForConditionalGeneration;__webpack_exports__.Idefics3ImageProcessor;__webpack_exports__.Idefics3PreTrainedModel;__webpack_exports__.Idefics3Processor;__webpack_exports__.ImageClassificationPipeline;__webpack_exports__.ImageFeatureExtractionPipeline;__webpack_exports__.ImageFeatureExtractor;__webpack_exports__.ImageMattingOutput;__webpack_exports__.ImageProcessor;__webpack_exports__.ImageSegmentationPipeline;__webpack_exports__.ImageToImagePipeline;__webpack_exports__.ImageToTextPipeline;__webpack_exports__.InterruptableStoppingCriteria;__webpack_exports__.JAISLMHeadModel;__webpack_exports__.JAISModel;__webpack_exports__.JAISPreTrainedModel;__webpack_exports__.JinaCLIPImageProcessor;__webpack_exports__.JinaCLIPModel;__webpack_exports__.JinaCLIPPreTrainedModel;__webpack_exports__.JinaCLIPProcessor;__webpack_exports__.JinaCLIPTextModel;__webpack_exports__.JinaCLIPVisionModel;__webpack_exports__.Lfm2ForCausalLM;__webpack_exports__.Lfm2Model;__webpack_exports__.Lfm2PreTrainedModel;__webpack_exports__.LiteWhisperForConditionalGeneration;__webpack_exports__.Llama4ForCausalLM;__webpack_exports__.Llama4PreTrainedModel;__webpack_exports__.LlamaForCausalLM;__webpack_exports__.LlamaModel;__webpack_exports__.LlamaPreTrainedModel;__webpack_exports__.LlamaTokenizer;__webpack_exports__.LlavaForConditionalGeneration;__webpack_exports__.LlavaOnevisionForConditionalGeneration;__webpack_exports__.LlavaOnevisionImageProcessor;__webpack_exports__.LlavaPreTrainedModel;__webpack_exports__.LlavaProcessor;__webpack_exports__.LlavaQwen2ForCausalLM;__webpack_exports__.LogitsProcessor;__webpack_exports__.LogitsProcessorList;__webpack_exports__.LogitsWarper;__webpack_exports__.LongT5ForConditionalGeneration;__webpack_exports__.LongT5Model;__webpack_exports__.LongT5PreTrainedModel;__webpack_exports__.M2M100ForConditionalGeneration;__webpack_exports__.M2M100Model;__webpack_exports__.M2M100PreTrainedModel;__webpack_exports__.M2M100Tokenizer;__webpack_exports__.MBart50Tokenizer;__webpack_exports__.MBartForCausalLM;__webpack_exports__.MBartForConditionalGeneration;__webpack_exports__.MBartForSequenceClassification;__webpack_exports__.MBartModel;__webpack_exports__.MBartPreTrainedModel;__webpack_exports__.MBartTokenizer;__webpack_exports__.MPNetForMaskedLM;__webpack_exports__.MPNetForQuestionAnswering;__webpack_exports__.MPNetForSequenceClassification;__webpack_exports__.MPNetForTokenClassification;__webpack_exports__.MPNetModel;__webpack_exports__.MPNetPreTrainedModel;__webpack_exports__.MPNetTokenizer;__webpack_exports__.MT5ForConditionalGeneration;__webpack_exports__.MT5Model;__webpack_exports__.MT5PreTrainedModel;__webpack_exports__.MarianMTModel;__webpack_exports__.MarianModel;__webpack_exports__.MarianPreTrainedModel;__webpack_exports__.MarianTokenizer;__webpack_exports__.Mask2FormerImageProcessor;__webpack_exports__.MaskFormerFeatureExtractor;__webpack_exports__.MaskFormerForInstanceSegmentation;__webpack_exports__.MaskFormerImageProcessor;__webpack_exports__.MaskFormerModel;__webpack_exports__.MaskFormerPreTrainedModel;__webpack_exports__.MaskedLMOutput;__webpack_exports__.MaxLengthCriteria;__webpack_exports__.Metric3DForDepthEstimation;__webpack_exports__.Metric3DPreTrainedModel;__webpack_exports__.Metric3Dv2ForDepthEstimation;__webpack_exports__.Metric3Dv2PreTrainedModel;__webpack_exports__.MgpstrForSceneTextRecognition;__webpack_exports__.MgpstrModelOutput;__webpack_exports__.MgpstrPreTrainedModel;__webpack_exports__.MgpstrProcessor;__webpack_exports__.MgpstrTokenizer;__webpack_exports__.MimiDecoderModel;__webpack_exports__.MimiDecoderOutput;__webpack_exports__.MimiEncoderModel;__webpack_exports__.MimiEncoderOutput;__webpack_exports__.MimiModel;__webpack_exports__.MimiPreTrainedModel;__webpack_exports__.MinLengthLogitsProcessor;__webpack_exports__.MinNewTokensLengthLogitsProcessor;__webpack_exports__.MistralForCausalLM;__webpack_exports__.MistralModel;__webpack_exports__.MistralPreTrainedModel;__webpack_exports__.MobileBertForMaskedLM;__webpack_exports__.MobileBertForQuestionAnswering;__webpack_exports__.MobileBertForSequenceClassification;__webpack_exports__.MobileBertModel;__webpack_exports__.MobileBertPreTrainedModel;__webpack_exports__.MobileBertTokenizer;__webpack_exports__.MobileLLMForCausalLM;__webpack_exports__.MobileLLMModel;__webpack_exports__.MobileLLMPreTrainedModel;__webpack_exports__.MobileNetV1FeatureExtractor;__webpack_exports__.MobileNetV1ForImageClassification;__webpack_exports__.MobileNetV1ForSemanticSegmentation;__webpack_exports__.MobileNetV1ImageProcessor;__webpack_exports__.MobileNetV1Model;__webpack_exports__.MobileNetV1PreTrainedModel;__webpack_exports__.MobileNetV2FeatureExtractor;__webpack_exports__.MobileNetV2ForImageClassification;__webpack_exports__.MobileNetV2ForSemanticSegmentation;__webpack_exports__.MobileNetV2ImageProcessor;__webpack_exports__.MobileNetV2Model;__webpack_exports__.MobileNetV2PreTrainedModel;__webpack_exports__.MobileNetV3FeatureExtractor;__webpack_exports__.MobileNetV3ForImageClassification;__webpack_exports__.MobileNetV3ForSemanticSegmentation;__webpack_exports__.MobileNetV3ImageProcessor;__webpack_exports__.MobileNetV3Model;__webpack_exports__.MobileNetV3PreTrainedModel;__webpack_exports__.MobileNetV4FeatureExtractor;__webpack_exports__.MobileNetV4ForImageClassification;__webpack_exports__.MobileNetV4ForSemanticSegmentation;__webpack_exports__.MobileNetV4ImageProcessor;__webpack_exports__.MobileNetV4Model;__webpack_exports__.MobileNetV4PreTrainedModel;__webpack_exports__.MobileViTFeatureExtractor;__webpack_exports__.MobileViTForImageClassification;__webpack_exports__.MobileViTImageProcessor;__webpack_exports__.MobileViTModel;__webpack_exports__.MobileViTPreTrainedModel;__webpack_exports__.MobileViTV2ForImageClassification;__webpack_exports__.MobileViTV2Model;__webpack_exports__.MobileViTV2PreTrainedModel;__webpack_exports__.ModelOutput;__webpack_exports__.ModernBertDecoderForCausalLM;__webpack_exports__.ModernBertDecoderModel;__webpack_exports__.ModernBertDecoderPreTrainedModel;__webpack_exports__.ModernBertForMaskedLM;__webpack_exports__.ModernBertForSequenceClassification;__webpack_exports__.ModernBertForTokenClassification;__webpack_exports__.ModernBertModel;__webpack_exports__.ModernBertPreTrainedModel;__webpack_exports__.Moondream1ForConditionalGeneration;__webpack_exports__.MoonshineFeatureExtractor;__webpack_exports__.MoonshineForConditionalGeneration;__webpack_exports__.MoonshineModel;__webpack_exports__.MoonshinePreTrainedModel;__webpack_exports__.MoonshineProcessor;__webpack_exports__.MptForCausalLM;__webpack_exports__.MptModel;__webpack_exports__.MptPreTrainedModel;__webpack_exports__.MultiModalityCausalLM;__webpack_exports__.MultiModalityPreTrainedModel;__webpack_exports__.MusicgenForCausalLM;__webpack_exports__.MusicgenForConditionalGeneration;__webpack_exports__.MusicgenModel;__webpack_exports__.MusicgenPreTrainedModel;__webpack_exports__.NanoChatForCausalLM;__webpack_exports__.NanoChatModel;__webpack_exports__.NanoChatPreTrainedModel;__webpack_exports__.NeoBertForMaskedLM;__webpack_exports__.NeoBertForQuestionAnswering;__webpack_exports__.NeoBertForSequenceClassification;__webpack_exports__.NeoBertForTokenClassification;__webpack_exports__.NeoBertModel;__webpack_exports__.NeoBertPreTrainedModel;__webpack_exports__.NllbTokenizer;__webpack_exports__.NoBadWordsLogitsProcessor;__webpack_exports__.NoRepeatNGramLogitsProcessor;__webpack_exports__.NomicBertModel;__webpack_exports__.NomicBertPreTrainedModel;__webpack_exports__.NougatImageProcessor;__webpack_exports__.NougatTokenizer;__webpack_exports__.OPTForCausalLM;__webpack_exports__.OPTModel;__webpack_exports__.OPTPreTrainedModel;__webpack_exports__.ObjectDetectionPipeline;__webpack_exports__.Olmo2ForCausalLM;__webpack_exports__.Olmo2Model;__webpack_exports__.Olmo2PreTrainedModel;__webpack_exports__.OlmoForCausalLM;__webpack_exports__.OlmoModel;__webpack_exports__.OlmoPreTrainedModel;__webpack_exports__.OpenELMForCausalLM;__webpack_exports__.OpenELMModel;__webpack_exports__.OpenELMPreTrainedModel;__webpack_exports__.OwlViTFeatureExtractor;__webpack_exports__.OwlViTForObjectDetection;__webpack_exports__.OwlViTImageProcessor;__webpack_exports__.OwlViTModel;__webpack_exports__.OwlViTPreTrainedModel;__webpack_exports__.OwlViTProcessor;__webpack_exports__.Owlv2ForObjectDetection;__webpack_exports__.Owlv2ImageProcessor;__webpack_exports__.Owlv2Model;__webpack_exports__.Owlv2PreTrainedModel;__webpack_exports__.PaliGemmaForConditionalGeneration;__webpack_exports__.PaliGemmaPreTrainedModel;__webpack_exports__.PaliGemmaProcessor;__webpack_exports__.ParakeetFeatureExtractor;__webpack_exports__.ParakeetForCTC;__webpack_exports__.ParakeetPreTrainedModel;__webpack_exports__.PatchTSMixerForPrediction;__webpack_exports__.PatchTSMixerModel;__webpack_exports__.PatchTSMixerPreTrainedModel;__webpack_exports__.PatchTSTForPrediction;__webpack_exports__.PatchTSTModel;__webpack_exports__.PatchTSTPreTrainedModel;__webpack_exports__.Phi3ForCausalLM;__webpack_exports__.Phi3Model;__webpack_exports__.Phi3PreTrainedModel;__webpack_exports__.Phi3VForCausalLM;__webpack_exports__.Phi3VImageProcessor;__webpack_exports__.Phi3VPreTrainedModel;__webpack_exports__.Phi3VProcessor;__webpack_exports__.PhiForCausalLM;__webpack_exports__.PhiModel;__webpack_exports__.PhiPreTrainedModel;__webpack_exports__.Pipeline;__webpack_exports__.PreTrainedModel;__webpack_exports__.PreTrainedTokenizer;__webpack_exports__.PretrainedConfig;__webpack_exports__.PretrainedMixin;__webpack_exports__.Processor;__webpack_exports__.PvtForImageClassification;__webpack_exports__.PvtImageProcessor;__webpack_exports__.PvtModel;__webpack_exports__.PvtPreTrainedModel;__webpack_exports__.PyAnnoteFeatureExtractor;__webpack_exports__.PyAnnoteForAudioFrameClassification;__webpack_exports__.PyAnnoteModel;__webpack_exports__.PyAnnotePreTrainedModel;__webpack_exports__.PyAnnoteProcessor;__webpack_exports__.QuestionAnsweringModelOutput;__webpack_exports__.QuestionAnsweringPipeline;__webpack_exports__.Qwen2ForCausalLM;__webpack_exports__.Qwen2Model;__webpack_exports__.Qwen2PreTrainedModel;__webpack_exports__.Qwen2Tokenizer;__webpack_exports__.Qwen2VLForConditionalGeneration;__webpack_exports__.Qwen2VLImageProcessor;__webpack_exports__.Qwen2VLPreTrainedModel;__webpack_exports__.Qwen2VLProcessor;__webpack_exports__.Qwen3ForCausalLM;__webpack_exports__.Qwen3Model;__webpack_exports__.Qwen3PreTrainedModel;__webpack_exports__.RFDetrForObjectDetection;__webpack_exports__.RFDetrModel;__webpack_exports__.RFDetrObjectDetectionOutput;__webpack_exports__.RFDetrPreTrainedModel;__webpack_exports__.RTDetrForObjectDetection;__webpack_exports__.RTDetrImageProcessor;__webpack_exports__.RTDetrModel;__webpack_exports__.RTDetrObjectDetectionOutput;__webpack_exports__.RTDetrPreTrainedModel;__webpack_exports__.RTDetrV2ForObjectDetection;__webpack_exports__.RTDetrV2Model;__webpack_exports__.RTDetrV2ObjectDetectionOutput;__webpack_exports__.RTDetrV2PreTrainedModel;__webpack_exports__.RawAudio;__webpack_exports__.RawImage;__webpack_exports__.RawVideo;__webpack_exports__.RawVideoFrame;__webpack_exports__.RepetitionPenaltyLogitsProcessor;__webpack_exports__.ResNetForImageClassification;__webpack_exports__.ResNetModel;__webpack_exports__.ResNetPreTrainedModel;__webpack_exports__.RoFormerForMaskedLM;__webpack_exports__.RoFormerForQuestionAnswering;__webpack_exports__.RoFormerForSequenceClassification;__webpack_exports__.RoFormerForTokenClassification;__webpack_exports__.RoFormerModel;__webpack_exports__.RoFormerPreTrainedModel;__webpack_exports__.RoFormerTokenizer;__webpack_exports__.RobertaForMaskedLM;__webpack_exports__.RobertaForQuestionAnswering;__webpack_exports__.RobertaForSequenceClassification;__webpack_exports__.RobertaForTokenClassification;__webpack_exports__.RobertaModel;__webpack_exports__.RobertaPreTrainedModel;__webpack_exports__.RobertaTokenizer;__webpack_exports__.SamImageProcessor;__webpack_exports__.SamImageSegmentationOutput;__webpack_exports__.SamModel;__webpack_exports__.SamPreTrainedModel;__webpack_exports__.SamProcessor;__webpack_exports__.SapiensForDepthEstimation;__webpack_exports__.SapiensForNormalEstimation;__webpack_exports__.SapiensForSemanticSegmentation;__webpack_exports__.SapiensPreTrainedModel;__webpack_exports__.SeamlessM4TFeatureExtractor;__webpack_exports__.SegformerFeatureExtractor;__webpack_exports__.SegformerForImageClassification;__webpack_exports__.SegformerForSemanticSegmentation;__webpack_exports__.SegformerImageProcessor;__webpack_exports__.SegformerModel;__webpack_exports__.SegformerPreTrainedModel;__webpack_exports__.Seq2SeqLMOutput;__webpack_exports__.SequenceClassifierOutput;__webpack_exports__.SiglipImageProcessor;__webpack_exports__.SiglipModel;__webpack_exports__.SiglipPreTrainedModel;__webpack_exports__.SiglipTextModel;__webpack_exports__.SiglipTokenizer;__webpack_exports__.SiglipVisionModel;__webpack_exports__.SmolLM3ForCausalLM;__webpack_exports__.SmolLM3Model;__webpack_exports__.SmolLM3PreTrainedModel;__webpack_exports__.SmolVLMForConditionalGeneration;__webpack_exports__.SmolVLMImageProcessor;__webpack_exports__.SmolVLMProcessor;__webpack_exports__.SnacDecoderModel;__webpack_exports__.SnacEncoderModel;__webpack_exports__.SnacFeatureExtractor;__webpack_exports__.SnacModel;__webpack_exports__.SnacPreTrainedModel;__webpack_exports__.SpeechT5FeatureExtractor;__webpack_exports__.SpeechT5ForSpeechToText;__webpack_exports__.SpeechT5ForTextToSpeech;__webpack_exports__.SpeechT5HifiGan;__webpack_exports__.SpeechT5Model;__webpack_exports__.SpeechT5PreTrainedModel;__webpack_exports__.SpeechT5Processor;__webpack_exports__.SpeechT5Tokenizer;__webpack_exports__.SqueezeBertForMaskedLM;__webpack_exports__.SqueezeBertForQuestionAnswering;__webpack_exports__.SqueezeBertForSequenceClassification;__webpack_exports__.SqueezeBertModel;__webpack_exports__.SqueezeBertPreTrainedModel;__webpack_exports__.SqueezeBertTokenizer;__webpack_exports__.StableLmForCausalLM;__webpack_exports__.StableLmModel;__webpack_exports__.StableLmPreTrainedModel;__webpack_exports__.Starcoder2ForCausalLM;__webpack_exports__.Starcoder2Model;__webpack_exports__.Starcoder2PreTrainedModel;__webpack_exports__.StoppingCriteria;__webpack_exports__.StoppingCriteriaList;__webpack_exports__.StyleTextToSpeech2Model;__webpack_exports__.StyleTextToSpeech2PreTrainedModel;__webpack_exports__.SummarizationPipeline;__webpack_exports__.SuppressTokensAtBeginLogitsProcessor;__webpack_exports__.Swin2SRForImageSuperResolution;__webpack_exports__.Swin2SRImageProcessor;__webpack_exports__.Swin2SRModel;__webpack_exports__.Swin2SRPreTrainedModel;__webpack_exports__.SwinForImageClassification;__webpack_exports__.SwinForSemanticSegmentation;__webpack_exports__.SwinModel;__webpack_exports__.SwinPreTrainedModel;__webpack_exports__.T5ForConditionalGeneration;__webpack_exports__.T5Model;__webpack_exports__.T5PreTrainedModel;__webpack_exports__.T5Tokenizer;__webpack_exports__.TableTransformerForObjectDetection;__webpack_exports__.TableTransformerModel;__webpack_exports__.TableTransformerObjectDetectionOutput;__webpack_exports__.TableTransformerPreTrainedModel;__webpack_exports__.TemperatureLogitsWarper;__webpack_exports__.Tensor;__webpack_exports__.Text2TextGenerationPipeline;__webpack_exports__.TextClassificationPipeline;__webpack_exports__.TextGenerationPipeline;__webpack_exports__.TextStreamer;__webpack_exports__.TextToAudioPipeline;__webpack_exports__.TokenClassificationPipeline;__webpack_exports__.TokenClassifierOutput;__webpack_exports__.TokenizerModel;__webpack_exports__.TopKLogitsWarper;__webpack_exports__.TopPLogitsWarper;__webpack_exports__.TrOCRForCausalLM;__webpack_exports__.TrOCRPreTrainedModel;__webpack_exports__.TranslationPipeline;__webpack_exports__.UltravoxModel;__webpack_exports__.UltravoxPreTrainedModel;__webpack_exports__.UltravoxProcessor;__webpack_exports__.UniSpeechForCTC;__webpack_exports__.UniSpeechForSequenceClassification;__webpack_exports__.UniSpeechModel;__webpack_exports__.UniSpeechPreTrainedModel;__webpack_exports__.UniSpeechSatForAudioFrameClassification;__webpack_exports__.UniSpeechSatForCTC;__webpack_exports__.UniSpeechSatForSequenceClassification;__webpack_exports__.UniSpeechSatModel;__webpack_exports__.UniSpeechSatPreTrainedModel;__webpack_exports__.VLChatProcessor;__webpack_exports__.VLMImageProcessor;__webpack_exports__.VaultGemmaForCausalLM;__webpack_exports__.VaultGemmaModel;__webpack_exports__.VaultGemmaPreTrainedModel;__webpack_exports__.ViTFeatureExtractor;__webpack_exports__.ViTForImageClassification;__webpack_exports__.ViTImageProcessor;__webpack_exports__.ViTMAEModel;__webpack_exports__.ViTMAEPreTrainedModel;__webpack_exports__.ViTMSNForImageClassification;__webpack_exports__.ViTMSNModel;__webpack_exports__.ViTMSNPreTrainedModel;__webpack_exports__.ViTModel;__webpack_exports__.ViTPreTrainedModel;__webpack_exports__.VisionEncoderDecoderModel;__webpack_exports__.VitMatteForImageMatting;__webpack_exports__.VitMatteImageProcessor;__webpack_exports__.VitMattePreTrainedModel;__webpack_exports__.VitPoseForPoseEstimation;__webpack_exports__.VitPoseImageProcessor;__webpack_exports__.VitPosePreTrainedModel;__webpack_exports__.VitsModel;__webpack_exports__.VitsModelOutput;__webpack_exports__.VitsPreTrainedModel;__webpack_exports__.VitsTokenizer;__webpack_exports__.VoxtralForConditionalGeneration;__webpack_exports__.VoxtralProcessor;__webpack_exports__.Wav2Vec2BertForCTC;__webpack_exports__.Wav2Vec2BertForSequenceClassification;__webpack_exports__.Wav2Vec2BertModel;__webpack_exports__.Wav2Vec2BertPreTrainedModel;__webpack_exports__.Wav2Vec2CTCTokenizer;__webpack_exports__.Wav2Vec2FeatureExtractor;__webpack_exports__.Wav2Vec2ForAudioFrameClassification;__webpack_exports__.Wav2Vec2ForCTC;__webpack_exports__.Wav2Vec2ForSequenceClassification;__webpack_exports__.Wav2Vec2Model;__webpack_exports__.Wav2Vec2PreTrainedModel;__webpack_exports__.Wav2Vec2Processor;__webpack_exports__.Wav2Vec2ProcessorWithLM;__webpack_exports__.WavLMForAudioFrameClassification;__webpack_exports__.WavLMForCTC;__webpack_exports__.WavLMForSequenceClassification;__webpack_exports__.WavLMForXVector;__webpack_exports__.WavLMModel;__webpack_exports__.WavLMPreTrainedModel;__webpack_exports__.WeSpeakerFeatureExtractor;__webpack_exports__.WeSpeakerResNetModel;__webpack_exports__.WeSpeakerResNetPreTrainedModel;__webpack_exports__.WhisperFeatureExtractor;__webpack_exports__.WhisperForConditionalGeneration;__webpack_exports__.WhisperModel;__webpack_exports__.WhisperPreTrainedModel;__webpack_exports__.WhisperProcessor;__webpack_exports__.WhisperTextStreamer;__webpack_exports__.WhisperTimeStampLogitsProcessor;__webpack_exports__.WhisperTokenizer;__webpack_exports__.XLMForQuestionAnswering;__webpack_exports__.XLMForSequenceClassification;__webpack_exports__.XLMForTokenClassification;__webpack_exports__.XLMModel;__webpack_exports__.XLMPreTrainedModel;__webpack_exports__.XLMRobertaForMaskedLM;__webpack_exports__.XLMRobertaForQuestionAnswering;__webpack_exports__.XLMRobertaForSequenceClassification;__webpack_exports__.XLMRobertaForTokenClassification;__webpack_exports__.XLMRobertaModel;__webpack_exports__.XLMRobertaPreTrainedModel;__webpack_exports__.XLMRobertaTokenizer;__webpack_exports__.XLMTokenizer;__webpack_exports__.XLMWithLMHeadModel;__webpack_exports__.XVectorOutput;__webpack_exports__.YolosFeatureExtractor;__webpack_exports__.YolosForObjectDetection;__webpack_exports__.YolosImageProcessor;__webpack_exports__.YolosModel;__webpack_exports__.YolosObjectDetectionOutput;__webpack_exports__.YolosPreTrainedModel;__webpack_exports__.ZeroShotAudioClassificationPipeline;__webpack_exports__.ZeroShotClassificationPipeline;__webpack_exports__.ZeroShotImageClassificationPipeline;__webpack_exports__.ZeroShotObjectDetectionPipeline;__webpack_exports__.bankers_round;__webpack_exports__.cat;__webpack_exports__.cos_sim;__webpack_exports__.dot;__webpack_exports__.dynamic_time_warping;__webpack_exports__.env;__webpack_exports__.full;__webpack_exports__.full_like;__webpack_exports__.getCacheShapes;__webpack_exports__.hamming;__webpack_exports__.hanning;__webpack_exports__.interpolate;__webpack_exports__.interpolate_4d;__webpack_exports__.interpolate_data;__webpack_exports__.is_chinese_char;__webpack_exports__.layer_norm;__webpack_exports__.load_image;__webpack_exports__.load_video;__webpack_exports__.log_softmax;__webpack_exports__.magnitude;__webpack_exports__.matmul;__webpack_exports__.max;__webpack_exports__.mean;__webpack_exports__.mean_pooling;__webpack_exports__.medianFilter;__webpack_exports__.mel_filter_bank;__webpack_exports__.min;__webpack_exports__.ones;__webpack_exports__.ones_like;__webpack_exports__.permute;__webpack_exports__.permute_data;var __webpack_exports__pipeline=__webpack_exports__.pipeline;__webpack_exports__.quantize_embeddings;__webpack_exports__.rand;__webpack_exports__.read_audio;__webpack_exports__.rfft;__webpack_exports__.round;__webpack_exports__.slice;__webpack_exports__.softmax;__webpack_exports__.spectrogram;__webpack_exports__.stack;__webpack_exports__.std_mean;__webpack_exports__.topk;__webpack_exports__.window_function;__webpack_exports__.zeros;__webpack_exports__.zeros_like;const AIModelLoader=({onModelLoaded:e})=>{const[s,i]=reactExports.useState(0),[c,d]=reactExports.useState("Initializing AI model...");return reactExports.useEffect(()=>{(async()=>{try{d("Checking GPU availability..."),i(10);let _="wasm";try{"gpu"in navigator?(await navigator.gpu.requestAdapter(),_="webgpu",d("WebGPU detected! Loading AI model...")):d("Loading AI model (CPU mode)...")}catch{d("Loading AI model (CPU mode)...")}i(25),d("Downloading math model...");const g=await __webpack_exports__pipeline("text2text-generation","Xenova/flan-t5-small",{device:_,dtype:_==="webgpu"?"fp32":"q8",progress_callback:_e=>{_e.status==="progress"&&_e.progress&&i(25+_e.progress*.3)}});i(55),d("Downloading explanation model...");const $=await __webpack_exports__pipeline("text-generation","Xenova/Qwen2.5-0.5B-Instruct",{device:_,dtype:_==="webgpu"?"fp32":"q8",progress_callback:_e=>{_e.status==="progress"&&_e.progress&&i(55+_e.progress*.35)}});i(95),d("Initializing offline mode..."),await new Promise(_e=>setTimeout(_e,500)),i(100),d(`Ready! Running on ${_==="webgpu"?"GPU":"CPU"} `),console.log(" Both models loaded successfully!"),console.log("Math Model:",g),console.log("Text Model:",$),setTimeout(()=>e({mathModel:g,textModel:$}),300)}catch(_){console.error(" Error loading models:",_),console.error("Error details:",JSON.stringify(_,null,2)),d(`Error: ${_ instanceof Error?_.message:"Failed to load models"}. Using fallback mode.`),setTimeout(()=>e({mathModel:null,textModel:null}),500)}})()},[e]),jsxRuntimeExports.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen p-6 bg-gradient-to-b from-background to-primary/5",children:jsxRuntimeExports.jsxs("div",{className:"w-full max-w-md space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center space-y-3",children:[jsxRuntimeExports.jsx("div",{className:"w-20 h-20 mx-auto rounded-3xl bg-gradient-to-br from-primary to-secondary flex items-center justify-center shadow-lg",children:jsxRuntimeExports.jsx(LoaderCircle,{className:"w-10 h-10 text-white animate-spin"})}),jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"AI Sathi"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:c})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Progress,{value:s,className:"h-2"}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-center text-muted-foreground",children:[s,"% complete"]})]}),jsxRuntimeExports.jsx("div",{className:"p-4 bg-card rounded-xl border border-border",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"First time: ~200MB download (Math + Text models). After that, works completely offline! "})})]})})},ModelLoadingWrapper=({children:e})=>{const[s,i]=reactExports.useState(!1),{setAiPipeline:c}=useLanguage();return s?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:e}):jsxRuntimeExports.jsx(AIModelLoader,{onModelLoaded:d=>{c(d),i(!0)}})},buttonVariants=cva("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Button=reactExports.forwardRef(({className:e,variant:s,size:i,asChild:c=!1,...d},h)=>{const _=c?Slot$1:"button";return jsxRuntimeExports.jsx(_,{className:cn(buttonVariants({variant:s,size:i,className:e})),ref:h,...d})});Button.displayName="Button";function clamp(e,[s,i]){return Math.min(i,Math.max(s,e))}var DirectionContext=reactExports.createContext(void 0);function useDirection(e){const s=reactExports.useContext(DirectionContext);return e||s||"ltr"}var count=0;function useFocusGuards(){reactExports.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??createFocusGuard()),document.body.insertAdjacentElement("beforeend",e[1]??createFocusGuard()),count++,()=>{count===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(s=>s.remove()),count--}},[])}function createFocusGuard(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var AUTOFOCUS_ON_MOUNT="focusScope.autoFocusOnMount",AUTOFOCUS_ON_UNMOUNT="focusScope.autoFocusOnUnmount",EVENT_OPTIONS={bubbles:!1,cancelable:!0},FOCUS_SCOPE_NAME="FocusScope",FocusScope=reactExports.forwardRef((e,s)=>{const{loop:i=!1,trapped:c=!1,onMountAutoFocus:d,onUnmountAutoFocus:h,..._}=e,[g,$]=reactExports.useState(null),_e=useCallbackRef$1(d),lt=useCallbackRef$1(h),at=reactExports.useRef(null),it=useComposedRefs(s,pt=>$(pt)),ct=reactExports.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;reactExports.useEffect(()=>{if(c){let pt=function(kt){if(ct.paused||!g)return;const St=kt.target;g.contains(St)?at.current=St:focus(at.current,{select:!0})},zt=function(kt){if(ct.paused||!g)return;const St=kt.relatedTarget;St!==null&&(g.contains(St)||focus(at.current,{select:!0}))},dt=function(kt){if(document.activeElement===document.body)for(const Lt of kt)Lt.removedNodes.length>0&&focus(g)};document.addEventListener("focusin",pt),document.addEventListener("focusout",zt);const ft=new MutationObserver(dt);return g&&ft.observe(g,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",pt),document.removeEventListener("focusout",zt),ft.disconnect()}}},[c,g,ct.paused]),reactExports.useEffect(()=>{if(g){focusScopesStack.add(ct);const pt=document.activeElement;if(!g.contains(pt)){const dt=new CustomEvent(AUTOFOCUS_ON_MOUNT,EVENT_OPTIONS);g.addEventListener(AUTOFOCUS_ON_MOUNT,_e),g.dispatchEvent(dt),dt.defaultPrevented||(focusFirst(removeLinks(getTabbableCandidates(g)),{select:!0}),document.activeElement===pt&&focus(g))}return()=>{g.removeEventListener(AUTOFOCUS_ON_MOUNT,_e),setTimeout(()=>{const dt=new CustomEvent(AUTOFOCUS_ON_UNMOUNT,EVENT_OPTIONS);g.addEventListener(AUTOFOCUS_ON_UNMOUNT,lt),g.dispatchEvent(dt),dt.defaultPrevented||focus(pt??document.body,{select:!0}),g.removeEventListener(AUTOFOCUS_ON_UNMOUNT,lt),focusScopesStack.remove(ct)},0)}}},[g,_e,lt,ct]);const mt=reactExports.useCallback(pt=>{if(!i&&!c||ct.paused)return;const zt=pt.key==="Tab"&&!pt.altKey&&!pt.ctrlKey&&!pt.metaKey,dt=document.activeElement;if(zt&&dt){const ft=pt.currentTarget,[kt,St]=getTabbableEdges(ft);kt&&St?!pt.shiftKey&&dt===St?(pt.preventDefault(),i&&focus(kt,{select:!0})):pt.shiftKey&&dt===kt&&(pt.preventDefault(),i&&focus(St,{select:!0})):dt===ft&&pt.preventDefault()}},[i,c,ct.paused]);return jsxRuntimeExports.jsx(Primitive.div,{tabIndex:-1,..._,ref:it,onKeyDown:mt})});FocusScope.displayName=FOCUS_SCOPE_NAME;function focusFirst(e,{select:s=!1}={}){const i=document.activeElement;for(const c of e)if(focus(c,{select:s}),document.activeElement!==i)return}function getTabbableEdges(e){const s=getTabbableCandidates(e),i=findVisible(s,e),c=findVisible(s.reverse(),e);return[i,c]}function getTabbableCandidates(e){const s=[],i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:c=>{const d=c.tagName==="INPUT"&&c.type==="hidden";return c.disabled||c.hidden||d?NodeFilter.FILTER_SKIP:c.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;i.nextNode();)s.push(i.currentNode);return s}function findVisible(e,s){for(const i of e)if(!isHidden(i,{upTo:s}))return i}function isHidden(e,{upTo:s}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(s!==void 0&&e===s)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function isSelectableInput(e){return e instanceof HTMLInputElement&&"select"in e}function focus(e,{select:s=!1}={}){if(e&&e.focus){const i=document.activeElement;e.focus({preventScroll:!0}),e!==i&&isSelectableInput(e)&&s&&e.select()}}var focusScopesStack=createFocusScopesStack();function createFocusScopesStack(){let e=[];return{add(s){const i=e[0];s!==i&&(i==null||i.pause()),e=arrayRemove(e,s),e.unshift(s)},remove(s){var i;e=arrayRemove(e,s),(i=e[0])==null||i.resume()}}}function arrayRemove(e,s){const i=[...e],c=i.indexOf(s);return c!==-1&&i.splice(c,1),i}function removeLinks(e){return e.filter(s=>s.tagName!=="A")}function usePrevious(e){const s=reactExports.useRef({value:e,previous:e});return reactExports.useMemo(()=>(s.current.value!==e&&(s.current.previous=s.current.value,s.current.value=e),s.current.previous),[e])}var getDefaultParent=function(e){if(typeof document>"u")return null;var s=Array.isArray(e)?e[0]:e;return s.ownerDocument.body},counterMap=new WeakMap,uncontrolledNodes=new WeakMap,markerMap={},lockCount=0,unwrapHost=function(e){return e&&(e.host||unwrapHost(e.parentNode))},correctTargets=function(e,s){return s.map(function(i){if(e.contains(i))return i;var c=unwrapHost(i);return c&&e.contains(c)?c:(console.error("aria-hidden",i,"in not contained inside",e,". Doing nothing"),null)}).filter(function(i){return!!i})},applyAttributeToOthers=function(e,s,i,c){var d=correctTargets(s,Array.isArray(e)?e:[e]);markerMap[i]||(markerMap[i]=new WeakMap);var h=markerMap[i],_=[],g=new Set,$=new Set(d),_e=function(at){!at||g.has(at)||(g.add(at),_e(at.parentNode))};d.forEach(_e);var lt=function(at){!at||$.has(at)||Array.prototype.forEach.call(at.children,function(it){if(g.has(it))lt(it);else try{var ct=it.getAttribute(c),mt=ct!==null&&ct!=="false",pt=(counterMap.get(it)||0)+1,zt=(h.get(it)||0)+1;counterMap.set(it,pt),h.set(it,zt),_.push(it),pt===1&&mt&&uncontrolledNodes.set(it,!0),zt===1&&it.setAttribute(i,"true"),mt||it.setAttribute(c,"true")}catch(dt){console.error("aria-hidden: cannot operate on ",it,dt)}})};return lt(s),g.clear(),lockCount++,function(){_.forEach(function(at){var it=counterMap.get(at)-1,ct=h.get(at)-1;counterMap.set(at,it),h.set(at,ct),it||(uncontrolledNodes.has(at)||at.removeAttribute(c),uncontrolledNodes.delete(at)),ct||at.removeAttribute(i)}),lockCount--,lockCount||(counterMap=new WeakMap,counterMap=new WeakMap,uncontrolledNodes=new WeakMap,markerMap={})}},hideOthers=function(e,s,i){i===void 0&&(i="data-aria-hidden");var c=Array.from(Array.isArray(e)?e:[e]),d=getDefaultParent(e);return d?(c.push.apply(c,Array.from(d.querySelectorAll("[aria-live]"))),applyAttributeToOthers(c,d,i,"aria-hidden")):function(){return null}},__assign=function(){return __assign=Object.assign||function(s){for(var i,c=1,d=arguments.length;c<d;c++){i=arguments[c];for(var h in i)Object.prototype.hasOwnProperty.call(i,h)&&(s[h]=i[h])}return s},__assign.apply(this,arguments)};function __rest(e,s){var i={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&s.indexOf(c)<0&&(i[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)s.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(i[c[d]]=e[c[d]]);return i}function __spreadArray(e,s,i){if(i||arguments.length===2)for(var c=0,d=s.length,h;c<d;c++)(h||!(c in s))&&(h||(h=Array.prototype.slice.call(s,0,c)),h[c]=s[c]);return e.concat(h||Array.prototype.slice.call(s))}typeof SuppressedError=="function"&&SuppressedError;var zeroRightClassName="right-scroll-bar-position",fullWidthClassName="width-before-scroll-bar",noScrollbarsClassName="with-scroll-bars-hidden",removedBarSizeVariable="--removed-body-scroll-bar-size";function assignRef(e,s){return typeof e=="function"?e(s):e&&(e.current=s),e}function useCallbackRef(e,s){var i=reactExports.useState(function(){return{value:e,callback:s,facade:{get current(){return i.value},set current(c){var d=i.value;d!==c&&(i.value=c,i.callback(c,d))}}}})[0];return i.callback=s,i.facade}var useIsomorphicLayoutEffect=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,currentValues=new WeakMap;function useMergeRefs(e,s){var i=useCallbackRef(null,function(c){return e.forEach(function(d){return assignRef(d,c)})});return useIsomorphicLayoutEffect(function(){var c=currentValues.get(i);if(c){var d=new Set(c),h=new Set(e),_=i.current;d.forEach(function(g){h.has(g)||assignRef(g,null)}),h.forEach(function(g){d.has(g)||assignRef(g,_)})}currentValues.set(i,e)},[e]),i}function ItoI(e){return e}function innerCreateMedium(e,s){s===void 0&&(s=ItoI);var i=[],c=!1,d={read:function(){if(c)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return i.length?i[i.length-1]:e},useMedium:function(h){var _=s(h,c);return i.push(_),function(){i=i.filter(function(g){return g!==_})}},assignSyncMedium:function(h){for(c=!0;i.length;){var _=i;i=[],_.forEach(h)}i={push:function(g){return h(g)},filter:function(){return i}}},assignMedium:function(h){c=!0;var _=[];if(i.length){var g=i;i=[],g.forEach(h),_=i}var $=function(){var lt=_;_=[],lt.forEach(h)},_e=function(){return Promise.resolve().then($)};_e(),i={push:function(lt){_.push(lt),_e()},filter:function(lt){return _=_.filter(lt),i}}}};return d}function createSidecarMedium(e){e===void 0&&(e={});var s=innerCreateMedium(null);return s.options=__assign({async:!0,ssr:!1},e),s}var SideCar$1=function(e){var s=e.sideCar,i=__rest(e,["sideCar"]);if(!s)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var c=s.read();if(!c)throw new Error("Sidecar medium not found");return reactExports.createElement(c,__assign({},i))};SideCar$1.isSideCarExport=!0;function exportSidecar(e,s){return e.useMedium(s),SideCar$1}var effectCar=createSidecarMedium(),nothing=function(){},RemoveScroll=reactExports.forwardRef(function(e,s){var i=reactExports.useRef(null),c=reactExports.useState({onScrollCapture:nothing,onWheelCapture:nothing,onTouchMoveCapture:nothing}),d=c[0],h=c[1],_=e.forwardProps,g=e.children,$=e.className,_e=e.removeScrollBar,lt=e.enabled,at=e.shards,it=e.sideCar,ct=e.noRelative,mt=e.noIsolation,pt=e.inert,zt=e.allowPinchZoom,dt=e.as,ft=dt===void 0?"div":dt,kt=e.gapMode,St=__rest(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),Lt=it,Gt=useMergeRefs([i,s]),Bt=__assign(__assign({},St),d);return reactExports.createElement(reactExports.Fragment,null,lt&&reactExports.createElement(Lt,{sideCar:effectCar,removeScrollBar:_e,shards:at,noRelative:ct,noIsolation:mt,inert:pt,setCallbacks:h,allowPinchZoom:!!zt,lockRef:i,gapMode:kt}),_?reactExports.cloneElement(reactExports.Children.only(g),__assign(__assign({},Bt),{ref:Gt})):reactExports.createElement(ft,__assign({},Bt,{className:$,ref:Gt}),g))});RemoveScroll.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};RemoveScroll.classNames={fullWidth:fullWidthClassName,zeroRight:zeroRightClassName};var getNonce=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function makeStyleTag(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var s=getNonce();return s&&e.setAttribute("nonce",s),e}function injectStyles(e,s){e.styleSheet?e.styleSheet.cssText=s:e.appendChild(document.createTextNode(s))}function insertStyleTag(e){var s=document.head||document.getElementsByTagName("head")[0];s.appendChild(e)}var stylesheetSingleton=function(){var e=0,s=null;return{add:function(i){e==0&&(s=makeStyleTag())&&(injectStyles(s,i),insertStyleTag(s)),e++},remove:function(){e--,!e&&s&&(s.parentNode&&s.parentNode.removeChild(s),s=null)}}},styleHookSingleton=function(){var e=stylesheetSingleton();return function(s,i){reactExports.useEffect(function(){return e.add(s),function(){e.remove()}},[s&&i])}},styleSingleton=function(){var e=styleHookSingleton(),s=function(i){var c=i.styles,d=i.dynamic;return e(c,d),null};return s},zeroGap={left:0,top:0,right:0,gap:0},parse=function(e){return parseInt(e||"",10)||0},getOffset=function(e){var s=window.getComputedStyle(document.body),i=s[e==="padding"?"paddingLeft":"marginLeft"],c=s[e==="padding"?"paddingTop":"marginTop"],d=s[e==="padding"?"paddingRight":"marginRight"];return[parse(i),parse(c),parse(d)]},getGapWidth=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return zeroGap;var s=getOffset(e),i=document.documentElement.clientWidth,c=window.innerWidth;return{left:s[0],top:s[1],right:s[2],gap:Math.max(0,c-i+s[2]-s[0])}},Style=styleSingleton(),lockAttribute="data-scroll-locked",getStyles=function(e,s,i,c){var d=e.left,h=e.top,_=e.right,g=e.gap;return i===void 0&&(i="margin"),`
  .`.concat(noScrollbarsClassName,` {
   overflow: hidden `).concat(c,`;
   padding-right: `).concat(g,"px ").concat(c,`;
  }
  body[`).concat(lockAttribute,`] {
    overflow: hidden `).concat(c,`;
    overscroll-behavior: contain;
    `).concat([s&&"position: relative ".concat(c,";"),i==="margin"&&`
    padding-left: `.concat(d,`px;
    padding-top: `).concat(h,`px;
    padding-right: `).concat(_,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(g,"px ").concat(c,`;
    `),i==="padding"&&"padding-right: ".concat(g,"px ").concat(c,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(zeroRightClassName,` {
    right: `).concat(g,"px ").concat(c,`;
  }
  
  .`).concat(fullWidthClassName,` {
    margin-right: `).concat(g,"px ").concat(c,`;
  }
  
  .`).concat(zeroRightClassName," .").concat(zeroRightClassName,` {
    right: 0 `).concat(c,`;
  }
  
  .`).concat(fullWidthClassName," .").concat(fullWidthClassName,` {
    margin-right: 0 `).concat(c,`;
  }
  
  body[`).concat(lockAttribute,`] {
    `).concat(removedBarSizeVariable,": ").concat(g,`px;
  }
`)},getCurrentUseCounter=function(){var e=parseInt(document.body.getAttribute(lockAttribute)||"0",10);return isFinite(e)?e:0},useLockAttribute=function(){reactExports.useEffect(function(){return document.body.setAttribute(lockAttribute,(getCurrentUseCounter()+1).toString()),function(){var e=getCurrentUseCounter()-1;e<=0?document.body.removeAttribute(lockAttribute):document.body.setAttribute(lockAttribute,e.toString())}},[])},RemoveScrollBar=function(e){var s=e.noRelative,i=e.noImportant,c=e.gapMode,d=c===void 0?"margin":c;useLockAttribute();var h=reactExports.useMemo(function(){return getGapWidth(d)},[d]);return reactExports.createElement(Style,{styles:getStyles(h,!s,d,i?"":"!important")})},passiveSupported=!1;if(typeof window<"u")try{var options=Object.defineProperty({},"passive",{get:function(){return passiveSupported=!0,!0}});window.addEventListener("test",options,options),window.removeEventListener("test",options,options)}catch{passiveSupported=!1}var nonPassive=passiveSupported?{passive:!1}:!1,alwaysContainsScroll=function(e){return e.tagName==="TEXTAREA"},elementCanBeScrolled=function(e,s){if(!(e instanceof Element))return!1;var i=window.getComputedStyle(e);return i[s]!=="hidden"&&!(i.overflowY===i.overflowX&&!alwaysContainsScroll(e)&&i[s]==="visible")},elementCouldBeVScrolled=function(e){return elementCanBeScrolled(e,"overflowY")},elementCouldBeHScrolled=function(e){return elementCanBeScrolled(e,"overflowX")},locationCouldBeScrolled=function(e,s){var i=s.ownerDocument,c=s;do{typeof ShadowRoot<"u"&&c instanceof ShadowRoot&&(c=c.host);var d=elementCouldBeScrolled(e,c);if(d){var h=getScrollVariables(e,c),_=h[1],g=h[2];if(_>g)return!0}c=c.parentNode}while(c&&c!==i.body);return!1},getVScrollVariables=function(e){var s=e.scrollTop,i=e.scrollHeight,c=e.clientHeight;return[s,i,c]},getHScrollVariables=function(e){var s=e.scrollLeft,i=e.scrollWidth,c=e.clientWidth;return[s,i,c]},elementCouldBeScrolled=function(e,s){return e==="v"?elementCouldBeVScrolled(s):elementCouldBeHScrolled(s)},getScrollVariables=function(e,s){return e==="v"?getVScrollVariables(s):getHScrollVariables(s)},getDirectionFactor=function(e,s){return e==="h"&&s==="rtl"?-1:1},handleScroll=function(e,s,i,c,d){var h=getDirectionFactor(e,window.getComputedStyle(s).direction),_=h*c,g=i.target,$=s.contains(g),_e=!1,lt=_>0,at=0,it=0;do{if(!g)break;var ct=getScrollVariables(e,g),mt=ct[0],pt=ct[1],zt=ct[2],dt=pt-zt-h*mt;(mt||dt)&&elementCouldBeScrolled(e,g)&&(at+=dt,it+=mt);var ft=g.parentNode;g=ft&&ft.nodeType===Node.DOCUMENT_FRAGMENT_NODE?ft.host:ft}while(!$&&g!==document.body||$&&(s.contains(g)||s===g));return(lt&&(Math.abs(at)<1||!d)||!lt&&(Math.abs(it)<1||!d))&&(_e=!0),_e},getTouchXY=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},getDeltaXY=function(e){return[e.deltaX,e.deltaY]},extractRef=function(e){return e&&"current"in e?e.current:e},deltaCompare=function(e,s){return e[0]===s[0]&&e[1]===s[1]},generateStyle=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},idCounter=0,lockStack=[];function RemoveScrollSideCar(e){var s=reactExports.useRef([]),i=reactExports.useRef([0,0]),c=reactExports.useRef(),d=reactExports.useState(idCounter++)[0],h=reactExports.useState(styleSingleton)[0],_=reactExports.useRef(e);reactExports.useEffect(function(){_.current=e},[e]),reactExports.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(d));var pt=__spreadArray([e.lockRef.current],(e.shards||[]).map(extractRef),!0).filter(Boolean);return pt.forEach(function(zt){return zt.classList.add("allow-interactivity-".concat(d))}),function(){document.body.classList.remove("block-interactivity-".concat(d)),pt.forEach(function(zt){return zt.classList.remove("allow-interactivity-".concat(d))})}}},[e.inert,e.lockRef.current,e.shards]);var g=reactExports.useCallback(function(pt,zt){if("touches"in pt&&pt.touches.length===2||pt.type==="wheel"&&pt.ctrlKey)return!_.current.allowPinchZoom;var dt=getTouchXY(pt),ft=i.current,kt="deltaX"in pt?pt.deltaX:ft[0]-dt[0],St="deltaY"in pt?pt.deltaY:ft[1]-dt[1],Lt,Gt=pt.target,Bt=Math.abs(kt)>Math.abs(St)?"h":"v";if("touches"in pt&&Bt==="h"&&Gt.type==="range")return!1;var nr=locationCouldBeScrolled(Bt,Gt);if(!nr)return!0;if(nr?Lt=Bt:(Lt=Bt==="v"?"h":"v",nr=locationCouldBeScrolled(Bt,Gt)),!nr)return!1;if(!c.current&&"changedTouches"in pt&&(kt||St)&&(c.current=Lt),!Lt)return!0;var cr=c.current||Lt;return handleScroll(cr,zt,pt,cr==="h"?kt:St,!0)},[]),$=reactExports.useCallback(function(pt){var zt=pt;if(!(!lockStack.length||lockStack[lockStack.length-1]!==h)){var dt="deltaY"in zt?getDeltaXY(zt):getTouchXY(zt),ft=s.current.filter(function(Lt){return Lt.name===zt.type&&(Lt.target===zt.target||zt.target===Lt.shadowParent)&&deltaCompare(Lt.delta,dt)})[0];if(ft&&ft.should){zt.cancelable&&zt.preventDefault();return}if(!ft){var kt=(_.current.shards||[]).map(extractRef).filter(Boolean).filter(function(Lt){return Lt.contains(zt.target)}),St=kt.length>0?g(zt,kt[0]):!_.current.noIsolation;St&&zt.cancelable&&zt.preventDefault()}}},[]),_e=reactExports.useCallback(function(pt,zt,dt,ft){var kt={name:pt,delta:zt,target:dt,should:ft,shadowParent:getOutermostShadowParent(dt)};s.current.push(kt),setTimeout(function(){s.current=s.current.filter(function(St){return St!==kt})},1)},[]),lt=reactExports.useCallback(function(pt){i.current=getTouchXY(pt),c.current=void 0},[]),at=reactExports.useCallback(function(pt){_e(pt.type,getDeltaXY(pt),pt.target,g(pt,e.lockRef.current))},[]),it=reactExports.useCallback(function(pt){_e(pt.type,getTouchXY(pt),pt.target,g(pt,e.lockRef.current))},[]);reactExports.useEffect(function(){return lockStack.push(h),e.setCallbacks({onScrollCapture:at,onWheelCapture:at,onTouchMoveCapture:it}),document.addEventListener("wheel",$,nonPassive),document.addEventListener("touchmove",$,nonPassive),document.addEventListener("touchstart",lt,nonPassive),function(){lockStack=lockStack.filter(function(pt){return pt!==h}),document.removeEventListener("wheel",$,nonPassive),document.removeEventListener("touchmove",$,nonPassive),document.removeEventListener("touchstart",lt,nonPassive)}},[]);var ct=e.removeScrollBar,mt=e.inert;return reactExports.createElement(reactExports.Fragment,null,mt?reactExports.createElement(h,{styles:generateStyle(d)}):null,ct?reactExports.createElement(RemoveScrollBar,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function getOutermostShadowParent(e){for(var s=null;e!==null;)e instanceof ShadowRoot&&(s=e.host,e=e.host),e=e.parentNode;return s}const SideCar=exportSidecar(effectCar,RemoveScrollSideCar);var ReactRemoveScroll=reactExports.forwardRef(function(e,s){return reactExports.createElement(RemoveScroll,__assign({},e,{ref:s,sideCar:SideCar}))});ReactRemoveScroll.classNames=RemoveScroll.classNames;var OPEN_KEYS=[" ","Enter","ArrowUp","ArrowDown"],SELECTION_KEYS=[" ","Enter"],SELECT_NAME="Select",[Collection,useCollection,createCollectionScope]=createCollection(SELECT_NAME),[createSelectContext,createSelectScope]=createContextScope(SELECT_NAME,[createCollectionScope,createPopperScope]),usePopperScope=createPopperScope(),[SelectProvider,useSelectContext]=createSelectContext(SELECT_NAME),[SelectNativeOptionsProvider,useSelectNativeOptionsContext]=createSelectContext(SELECT_NAME),Select$1=e=>{const{__scopeSelect:s,children:i,open:c,defaultOpen:d,onOpenChange:h,value:_,defaultValue:g,onValueChange:$,dir:_e,name:lt,autoComplete:at,disabled:it,required:ct,form:mt}=e,pt=usePopperScope(s),[zt,dt]=reactExports.useState(null),[ft,kt]=reactExports.useState(null),[St,Lt]=reactExports.useState(!1),Gt=useDirection(_e),[Bt,nr]=useControllableState({prop:c,defaultProp:d??!1,onChange:h,caller:SELECT_NAME}),[cr,ur]=useControllableState({prop:_,defaultProp:g,onChange:$,caller:SELECT_NAME}),yn=reactExports.useRef(null),hn=zt?mt||!!zt.closest("form"):!0,[_n,gn]=reactExports.useState(new Set),vn=Array.from(_n).map(Tn=>Tn.props.value).join(";");return jsxRuntimeExports.jsx(Root2$1,{...pt,children:jsxRuntimeExports.jsxs(SelectProvider,{required:ct,scope:s,trigger:zt,onTriggerChange:dt,valueNode:ft,onValueNodeChange:kt,valueNodeHasChildren:St,onValueNodeHasChildrenChange:Lt,contentId:useId(),value:cr,onValueChange:ur,open:Bt,onOpenChange:nr,dir:Gt,triggerPointerDownPosRef:yn,disabled:it,children:[jsxRuntimeExports.jsx(Collection.Provider,{scope:s,children:jsxRuntimeExports.jsx(SelectNativeOptionsProvider,{scope:e.__scopeSelect,onNativeOptionAdd:reactExports.useCallback(Tn=>{gn(kn=>new Set(kn).add(Tn))},[]),onNativeOptionRemove:reactExports.useCallback(Tn=>{gn(kn=>{const bn=new Set(kn);return bn.delete(Tn),bn})},[]),children:i})}),hn?jsxRuntimeExports.jsxs(SelectBubbleInput,{"aria-hidden":!0,required:ct,tabIndex:-1,name:lt,autoComplete:at,value:cr,onChange:Tn=>ur(Tn.target.value),disabled:it,form:mt,children:[cr===void 0?jsxRuntimeExports.jsx("option",{value:""}):null,Array.from(_n)]},vn):null]})})};Select$1.displayName=SELECT_NAME;var TRIGGER_NAME="SelectTrigger",SelectTrigger$1=reactExports.forwardRef((e,s)=>{const{__scopeSelect:i,disabled:c=!1,...d}=e,h=usePopperScope(i),_=useSelectContext(TRIGGER_NAME,i),g=_.disabled||c,$=useComposedRefs(s,_.onTriggerChange),_e=useCollection(i),lt=reactExports.useRef("touch"),[at,it,ct]=useTypeaheadSearch(pt=>{const zt=_e().filter(kt=>!kt.disabled),dt=zt.find(kt=>kt.value===_.value),ft=findNextItem(zt,pt,dt);ft!==void 0&&_.onValueChange(ft.value)}),mt=pt=>{g||(_.onOpenChange(!0),ct()),pt&&(_.triggerPointerDownPosRef.current={x:Math.round(pt.pageX),y:Math.round(pt.pageY)})};return jsxRuntimeExports.jsx(Anchor,{asChild:!0,...h,children:jsxRuntimeExports.jsx(Primitive.button,{type:"button",role:"combobox","aria-controls":_.contentId,"aria-expanded":_.open,"aria-required":_.required,"aria-autocomplete":"none",dir:_.dir,"data-state":_.open?"open":"closed",disabled:g,"data-disabled":g?"":void 0,"data-placeholder":shouldShowPlaceholder(_.value)?"":void 0,...d,ref:$,onClick:composeEventHandlers(d.onClick,pt=>{pt.currentTarget.focus(),lt.current!=="mouse"&&mt(pt)}),onPointerDown:composeEventHandlers(d.onPointerDown,pt=>{lt.current=pt.pointerType;const zt=pt.target;zt.hasPointerCapture(pt.pointerId)&&zt.releasePointerCapture(pt.pointerId),pt.button===0&&pt.ctrlKey===!1&&pt.pointerType==="mouse"&&(mt(pt),pt.preventDefault())}),onKeyDown:composeEventHandlers(d.onKeyDown,pt=>{const zt=at.current!=="";!(pt.ctrlKey||pt.altKey||pt.metaKey)&&pt.key.length===1&&it(pt.key),!(zt&&pt.key===" ")&&OPEN_KEYS.includes(pt.key)&&(mt(),pt.preventDefault())})})})});SelectTrigger$1.displayName=TRIGGER_NAME;var VALUE_NAME="SelectValue",SelectValue$1=reactExports.forwardRef((e,s)=>{const{__scopeSelect:i,className:c,style:d,children:h,placeholder:_="",...g}=e,$=useSelectContext(VALUE_NAME,i),{onValueNodeHasChildrenChange:_e}=$,lt=h!==void 0,at=useComposedRefs(s,$.onValueNodeChange);return useLayoutEffect2(()=>{_e(lt)},[_e,lt]),jsxRuntimeExports.jsx(Primitive.span,{...g,ref:at,style:{pointerEvents:"none"},children:shouldShowPlaceholder($.value)?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:_}):h})});SelectValue$1.displayName=VALUE_NAME;var ICON_NAME="SelectIcon",SelectIcon=reactExports.forwardRef((e,s)=>{const{__scopeSelect:i,children:c,...d}=e;return jsxRuntimeExports.jsx(Primitive.span,{"aria-hidden":!0,...d,ref:s,children:c||""})});SelectIcon.displayName=ICON_NAME;var PORTAL_NAME="SelectPortal",SelectPortal=e=>jsxRuntimeExports.jsx(Portal$1,{asChild:!0,...e});SelectPortal.displayName=PORTAL_NAME;var CONTENT_NAME="SelectContent",SelectContent$1=reactExports.forwardRef((e,s)=>{const i=useSelectContext(CONTENT_NAME,e.__scopeSelect),[c,d]=reactExports.useState();if(useLayoutEffect2(()=>{d(new DocumentFragment)},[]),!i.open){const h=c;return h?reactDomExports.createPortal(jsxRuntimeExports.jsx(SelectContentProvider,{scope:e.__scopeSelect,children:jsxRuntimeExports.jsx(Collection.Slot,{scope:e.__scopeSelect,children:jsxRuntimeExports.jsx("div",{children:e.children})})}),h):null}return jsxRuntimeExports.jsx(SelectContentImpl,{...e,ref:s})});SelectContent$1.displayName=CONTENT_NAME;var CONTENT_MARGIN=10,[SelectContentProvider,useSelectContentContext]=createSelectContext(CONTENT_NAME),CONTENT_IMPL_NAME="SelectContentImpl",Slot=createSlot("SelectContent.RemoveScroll"),SelectContentImpl=reactExports.forwardRef((e,s)=>{const{__scopeSelect:i,position:c="item-aligned",onCloseAutoFocus:d,onEscapeKeyDown:h,onPointerDownOutside:_,side:g,sideOffset:$,align:_e,alignOffset:lt,arrowPadding:at,collisionBoundary:it,collisionPadding:ct,sticky:mt,hideWhenDetached:pt,avoidCollisions:zt,...dt}=e,ft=useSelectContext(CONTENT_NAME,i),[kt,St]=reactExports.useState(null),[Lt,Gt]=reactExports.useState(null),Bt=useComposedRefs(s,Ro=>St(Ro)),[nr,cr]=reactExports.useState(null),[ur,yn]=reactExports.useState(null),hn=useCollection(i),[_n,gn]=reactExports.useState(!1),vn=reactExports.useRef(!1);reactExports.useEffect(()=>{if(kt)return hideOthers(kt)},[kt]),useFocusGuards();const Tn=reactExports.useCallback(Ro=>{const[qo,...tp]=hn().map(mr=>mr.ref.current),[Wo]=tp.slice(-1),En=document.activeElement;for(const mr of Ro)if(mr===En||(mr==null||mr.scrollIntoView({block:"nearest"}),mr===qo&&Lt&&(Lt.scrollTop=0),mr===Wo&&Lt&&(Lt.scrollTop=Lt.scrollHeight),mr==null||mr.focus(),document.activeElement!==En))return},[hn,Lt]),kn=reactExports.useCallback(()=>Tn([nr,kt]),[Tn,nr,kt]);reactExports.useEffect(()=>{_n&&kn()},[_n,kn]);const{onOpenChange:bn,triggerPointerDownPosRef:Sn}=ft;reactExports.useEffect(()=>{if(kt){let Ro={x:0,y:0};const qo=Wo=>{var En,mr;Ro={x:Math.abs(Math.round(Wo.pageX)-(((En=Sn.current)==null?void 0:En.x)??0)),y:Math.abs(Math.round(Wo.pageY)-(((mr=Sn.current)==null?void 0:mr.y)??0))}},tp=Wo=>{Ro.x<=10&&Ro.y<=10?Wo.preventDefault():kt.contains(Wo.target)||bn(!1),document.removeEventListener("pointermove",qo),Sn.current=null};return Sn.current!==null&&(document.addEventListener("pointermove",qo),document.addEventListener("pointerup",tp,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",qo),document.removeEventListener("pointerup",tp,{capture:!0})}}},[kt,bn,Sn]),reactExports.useEffect(()=>{const Ro=()=>bn(!1);return window.addEventListener("blur",Ro),window.addEventListener("resize",Ro),()=>{window.removeEventListener("blur",Ro),window.removeEventListener("resize",Ro)}},[bn]);const[fn,or]=useTypeaheadSearch(Ro=>{const qo=hn().filter(En=>!En.disabled),tp=qo.find(En=>En.ref.current===document.activeElement),Wo=findNextItem(qo,Ro,tp);Wo&&setTimeout(()=>Wo.ref.current.focus())}),lr=reactExports.useCallback((Ro,qo,tp)=>{const Wo=!vn.current&&!tp;(ft.value!==void 0&&ft.value===qo||Wo)&&(cr(Ro),Wo&&(vn.current=!0))},[ft.value]),pn=reactExports.useCallback(()=>kt==null?void 0:kt.focus(),[kt]),Cn=reactExports.useCallback((Ro,qo,tp)=>{const Wo=!vn.current&&!tp;(ft.value!==void 0&&ft.value===qo||Wo)&&yn(Ro)},[ft.value]),Lo=c==="popper"?SelectPopperPosition:SelectItemAlignedPosition,Mo=Lo===SelectPopperPosition?{side:g,sideOffset:$,align:_e,alignOffset:lt,arrowPadding:at,collisionBoundary:it,collisionPadding:ct,sticky:mt,hideWhenDetached:pt,avoidCollisions:zt}:{};return jsxRuntimeExports.jsx(SelectContentProvider,{scope:i,content:kt,viewport:Lt,onViewportChange:Gt,itemRefCallback:lr,selectedItem:nr,onItemLeave:pn,itemTextRefCallback:Cn,focusSelectedItem:kn,selectedItemText:ur,position:c,isPositioned:_n,searchRef:fn,children:jsxRuntimeExports.jsx(ReactRemoveScroll,{as:Slot,allowPinchZoom:!0,children:jsxRuntimeExports.jsx(FocusScope,{asChild:!0,trapped:ft.open,onMountAutoFocus:Ro=>{Ro.preventDefault()},onUnmountAutoFocus:composeEventHandlers(d,Ro=>{var qo;(qo=ft.trigger)==null||qo.focus({preventScroll:!0}),Ro.preventDefault()}),children:jsxRuntimeExports.jsx(DismissableLayer,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:h,onPointerDownOutside:_,onFocusOutside:Ro=>Ro.preventDefault(),onDismiss:()=>ft.onOpenChange(!1),children:jsxRuntimeExports.jsx(Lo,{role:"listbox",id:ft.contentId,"data-state":ft.open?"open":"closed",dir:ft.dir,onContextMenu:Ro=>Ro.preventDefault(),...dt,...Mo,onPlaced:()=>gn(!0),ref:Bt,style:{display:"flex",flexDirection:"column",outline:"none",...dt.style},onKeyDown:composeEventHandlers(dt.onKeyDown,Ro=>{const qo=Ro.ctrlKey||Ro.altKey||Ro.metaKey;if(Ro.key==="Tab"&&Ro.preventDefault(),!qo&&Ro.key.length===1&&or(Ro.key),["ArrowUp","ArrowDown","Home","End"].includes(Ro.key)){let Wo=hn().filter(En=>!En.disabled).map(En=>En.ref.current);if(["ArrowUp","End"].includes(Ro.key)&&(Wo=Wo.slice().reverse()),["ArrowUp","ArrowDown"].includes(Ro.key)){const En=Ro.target,mr=Wo.indexOf(En);Wo=Wo.slice(mr+1)}setTimeout(()=>Tn(Wo)),Ro.preventDefault()}})})})})})})});SelectContentImpl.displayName=CONTENT_IMPL_NAME;var ITEM_ALIGNED_POSITION_NAME="SelectItemAlignedPosition",SelectItemAlignedPosition=reactExports.forwardRef((e,s)=>{const{__scopeSelect:i,onPlaced:c,...d}=e,h=useSelectContext(CONTENT_NAME,i),_=useSelectContentContext(CONTENT_NAME,i),[g,$]=reactExports.useState(null),[_e,lt]=reactExports.useState(null),at=useComposedRefs(s,Bt=>lt(Bt)),it=useCollection(i),ct=reactExports.useRef(!1),mt=reactExports.useRef(!0),{viewport:pt,selectedItem:zt,selectedItemText:dt,focusSelectedItem:ft}=_,kt=reactExports.useCallback(()=>{if(h.trigger&&h.valueNode&&g&&_e&&pt&&zt&&dt){const Bt=h.trigger.getBoundingClientRect(),nr=_e.getBoundingClientRect(),cr=h.valueNode.getBoundingClientRect(),ur=dt.getBoundingClientRect();if(h.dir!=="rtl"){const En=ur.left-nr.left,mr=cr.left-En,Do=Bt.left-mr,Go=Bt.width+Do,Jo=Math.max(Go,nr.width),_i=window.innerWidth-CONTENT_MARGIN,Ho=clamp(mr,[CONTENT_MARGIN,Math.max(CONTENT_MARGIN,_i-Jo)]);g.style.minWidth=Go+"px",g.style.left=Ho+"px"}else{const En=nr.right-ur.right,mr=window.innerWidth-cr.right-En,Do=window.innerWidth-Bt.right-mr,Go=Bt.width+Do,Jo=Math.max(Go,nr.width),_i=window.innerWidth-CONTENT_MARGIN,Ho=clamp(mr,[CONTENT_MARGIN,Math.max(CONTENT_MARGIN,_i-Jo)]);g.style.minWidth=Go+"px",g.style.right=Ho+"px"}const yn=it(),hn=window.innerHeight-CONTENT_MARGIN*2,_n=pt.scrollHeight,gn=window.getComputedStyle(_e),vn=parseInt(gn.borderTopWidth,10),Tn=parseInt(gn.paddingTop,10),kn=parseInt(gn.borderBottomWidth,10),bn=parseInt(gn.paddingBottom,10),Sn=vn+Tn+_n+bn+kn,fn=Math.min(zt.offsetHeight*5,Sn),or=window.getComputedStyle(pt),lr=parseInt(or.paddingTop,10),pn=parseInt(or.paddingBottom,10),Cn=Bt.top+Bt.height/2-CONTENT_MARGIN,Lo=hn-Cn,Mo=zt.offsetHeight/2,Ro=zt.offsetTop+Mo,qo=vn+Tn+Ro,tp=Sn-qo;if(qo<=Cn){const En=yn.length>0&&zt===yn[yn.length-1].ref.current;g.style.bottom="0px";const mr=_e.clientHeight-pt.offsetTop-pt.offsetHeight,Do=Math.max(Lo,Mo+(En?pn:0)+mr+kn),Go=qo+Do;g.style.height=Go+"px"}else{const En=yn.length>0&&zt===yn[0].ref.current;g.style.top="0px";const Do=Math.max(Cn,vn+pt.offsetTop+(En?lr:0)+Mo)+tp;g.style.height=Do+"px",pt.scrollTop=qo-Cn+pt.offsetTop}g.style.margin=`${CONTENT_MARGIN}px 0`,g.style.minHeight=fn+"px",g.style.maxHeight=hn+"px",c==null||c(),requestAnimationFrame(()=>ct.current=!0)}},[it,h.trigger,h.valueNode,g,_e,pt,zt,dt,h.dir,c]);useLayoutEffect2(()=>kt(),[kt]);const[St,Lt]=reactExports.useState();useLayoutEffect2(()=>{_e&&Lt(window.getComputedStyle(_e).zIndex)},[_e]);const Gt=reactExports.useCallback(Bt=>{Bt&&mt.current===!0&&(kt(),ft==null||ft(),mt.current=!1)},[kt,ft]);return jsxRuntimeExports.jsx(SelectViewportProvider,{scope:i,contentWrapper:g,shouldExpandOnScrollRef:ct,onScrollButtonChange:Gt,children:jsxRuntimeExports.jsx("div",{ref:$,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:St},children:jsxRuntimeExports.jsx(Primitive.div,{...d,ref:at,style:{boxSizing:"border-box",maxHeight:"100%",...d.style}})})})});SelectItemAlignedPosition.displayName=ITEM_ALIGNED_POSITION_NAME;var POPPER_POSITION_NAME="SelectPopperPosition",SelectPopperPosition=reactExports.forwardRef((e,s)=>{const{__scopeSelect:i,align:c="start",collisionPadding:d=CONTENT_MARGIN,...h}=e,_=usePopperScope(i);return jsxRuntimeExports.jsx(Content,{..._,...h,ref:s,align:c,collisionPadding:d,style:{boxSizing:"border-box",...h.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});SelectPopperPosition.displayName=POPPER_POSITION_NAME;var[SelectViewportProvider,useSelectViewportContext]=createSelectContext(CONTENT_NAME,{}),VIEWPORT_NAME="SelectViewport",SelectViewport=reactExports.forwardRef((e,s)=>{const{__scopeSelect:i,nonce:c,...d}=e,h=useSelectContentContext(VIEWPORT_NAME,i),_=useSelectViewportContext(VIEWPORT_NAME,i),g=useComposedRefs(s,h.onViewportChange),$=reactExports.useRef(0);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:c}),jsxRuntimeExports.jsx(Collection.Slot,{scope:i,children:jsxRuntimeExports.jsx(Primitive.div,{"data-radix-select-viewport":"",role:"presentation",...d,ref:g,style:{position:"relative",flex:1,overflow:"hidden auto",...d.style},onScroll:composeEventHandlers(d.onScroll,_e=>{const lt=_e.currentTarget,{contentWrapper:at,shouldExpandOnScrollRef:it}=_;if(it!=null&&it.current&&at){const ct=Math.abs($.current-lt.scrollTop);if(ct>0){const mt=window.innerHeight-CONTENT_MARGIN*2,pt=parseFloat(at.style.minHeight),zt=parseFloat(at.style.height),dt=Math.max(pt,zt);if(dt<mt){const ft=dt+ct,kt=Math.min(mt,ft),St=ft-kt;at.style.height=kt+"px",at.style.bottom==="0px"&&(lt.scrollTop=St>0?St:0,at.style.justifyContent="flex-end")}}}$.current=lt.scrollTop})})})]})});SelectViewport.displayName=VIEWPORT_NAME;var GROUP_NAME="SelectGroup",[SelectGroupContextProvider,useSelectGroupContext]=createSelectContext(GROUP_NAME),SelectGroup=reactExports.forwardRef((e,s)=>{const{__scopeSelect:i,...c}=e,d=useId();return jsxRuntimeExports.jsx(SelectGroupContextProvider,{scope:i,id:d,children:jsxRuntimeExports.jsx(Primitive.div,{role:"group","aria-labelledby":d,...c,ref:s})})});SelectGroup.displayName=GROUP_NAME;var LABEL_NAME="SelectLabel",SelectLabel$1=reactExports.forwardRef((e,s)=>{const{__scopeSelect:i,...c}=e,d=useSelectGroupContext(LABEL_NAME,i);return jsxRuntimeExports.jsx(Primitive.div,{id:d.id,...c,ref:s})});SelectLabel$1.displayName=LABEL_NAME;var ITEM_NAME="SelectItem",[SelectItemContextProvider,useSelectItemContext]=createSelectContext(ITEM_NAME),SelectItem$1=reactExports.forwardRef((e,s)=>{const{__scopeSelect:i,value:c,disabled:d=!1,textValue:h,..._}=e,g=useSelectContext(ITEM_NAME,i),$=useSelectContentContext(ITEM_NAME,i),_e=g.value===c,[lt,at]=reactExports.useState(h??""),[it,ct]=reactExports.useState(!1),mt=useComposedRefs(s,ft=>{var kt;return(kt=$.itemRefCallback)==null?void 0:kt.call($,ft,c,d)}),pt=useId(),zt=reactExports.useRef("touch"),dt=()=>{d||(g.onValueChange(c),g.onOpenChange(!1))};if(c==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return jsxRuntimeExports.jsx(SelectItemContextProvider,{scope:i,value:c,disabled:d,textId:pt,isSelected:_e,onItemTextChange:reactExports.useCallback(ft=>{at(kt=>kt||((ft==null?void 0:ft.textContent)??"").trim())},[]),children:jsxRuntimeExports.jsx(Collection.ItemSlot,{scope:i,value:c,disabled:d,textValue:lt,children:jsxRuntimeExports.jsx(Primitive.div,{role:"option","aria-labelledby":pt,"data-highlighted":it?"":void 0,"aria-selected":_e&&it,"data-state":_e?"checked":"unchecked","aria-disabled":d||void 0,"data-disabled":d?"":void 0,tabIndex:d?void 0:-1,..._,ref:mt,onFocus:composeEventHandlers(_.onFocus,()=>ct(!0)),onBlur:composeEventHandlers(_.onBlur,()=>ct(!1)),onClick:composeEventHandlers(_.onClick,()=>{zt.current!=="mouse"&&dt()}),onPointerUp:composeEventHandlers(_.onPointerUp,()=>{zt.current==="mouse"&&dt()}),onPointerDown:composeEventHandlers(_.onPointerDown,ft=>{zt.current=ft.pointerType}),onPointerMove:composeEventHandlers(_.onPointerMove,ft=>{var kt;zt.current=ft.pointerType,d?(kt=$.onItemLeave)==null||kt.call($):zt.current==="mouse"&&ft.currentTarget.focus({preventScroll:!0})}),onPointerLeave:composeEventHandlers(_.onPointerLeave,ft=>{var kt;ft.currentTarget===document.activeElement&&((kt=$.onItemLeave)==null||kt.call($))}),onKeyDown:composeEventHandlers(_.onKeyDown,ft=>{var St;((St=$.searchRef)==null?void 0:St.current)!==""&&ft.key===" "||(SELECTION_KEYS.includes(ft.key)&&dt(),ft.key===" "&&ft.preventDefault())})})})})});SelectItem$1.displayName=ITEM_NAME;var ITEM_TEXT_NAME="SelectItemText",SelectItemText=reactExports.forwardRef((e,s)=>{const{__scopeSelect:i,className:c,style:d,...h}=e,_=useSelectContext(ITEM_TEXT_NAME,i),g=useSelectContentContext(ITEM_TEXT_NAME,i),$=useSelectItemContext(ITEM_TEXT_NAME,i),_e=useSelectNativeOptionsContext(ITEM_TEXT_NAME,i),[lt,at]=reactExports.useState(null),it=useComposedRefs(s,dt=>at(dt),$.onItemTextChange,dt=>{var ft;return(ft=g.itemTextRefCallback)==null?void 0:ft.call(g,dt,$.value,$.disabled)}),ct=lt==null?void 0:lt.textContent,mt=reactExports.useMemo(()=>jsxRuntimeExports.jsx("option",{value:$.value,disabled:$.disabled,children:ct},$.value),[$.disabled,$.value,ct]),{onNativeOptionAdd:pt,onNativeOptionRemove:zt}=_e;return useLayoutEffect2(()=>(pt(mt),()=>zt(mt)),[pt,zt,mt]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Primitive.span,{id:$.textId,...h,ref:it}),$.isSelected&&_.valueNode&&!_.valueNodeHasChildren?reactDomExports.createPortal(h.children,_.valueNode):null]})});SelectItemText.displayName=ITEM_TEXT_NAME;var ITEM_INDICATOR_NAME="SelectItemIndicator",SelectItemIndicator=reactExports.forwardRef((e,s)=>{const{__scopeSelect:i,...c}=e;return useSelectItemContext(ITEM_INDICATOR_NAME,i).isSelected?jsxRuntimeExports.jsx(Primitive.span,{"aria-hidden":!0,...c,ref:s}):null});SelectItemIndicator.displayName=ITEM_INDICATOR_NAME;var SCROLL_UP_BUTTON_NAME="SelectScrollUpButton",SelectScrollUpButton$1=reactExports.forwardRef((e,s)=>{const i=useSelectContentContext(SCROLL_UP_BUTTON_NAME,e.__scopeSelect),c=useSelectViewportContext(SCROLL_UP_BUTTON_NAME,e.__scopeSelect),[d,h]=reactExports.useState(!1),_=useComposedRefs(s,c.onScrollButtonChange);return useLayoutEffect2(()=>{if(i.viewport&&i.isPositioned){let g=function(){const _e=$.scrollTop>0;h(_e)};const $=i.viewport;return g(),$.addEventListener("scroll",g),()=>$.removeEventListener("scroll",g)}},[i.viewport,i.isPositioned]),d?jsxRuntimeExports.jsx(SelectScrollButtonImpl,{...e,ref:_,onAutoScroll:()=>{const{viewport:g,selectedItem:$}=i;g&&$&&(g.scrollTop=g.scrollTop-$.offsetHeight)}}):null});SelectScrollUpButton$1.displayName=SCROLL_UP_BUTTON_NAME;var SCROLL_DOWN_BUTTON_NAME="SelectScrollDownButton",SelectScrollDownButton$1=reactExports.forwardRef((e,s)=>{const i=useSelectContentContext(SCROLL_DOWN_BUTTON_NAME,e.__scopeSelect),c=useSelectViewportContext(SCROLL_DOWN_BUTTON_NAME,e.__scopeSelect),[d,h]=reactExports.useState(!1),_=useComposedRefs(s,c.onScrollButtonChange);return useLayoutEffect2(()=>{if(i.viewport&&i.isPositioned){let g=function(){const _e=$.scrollHeight-$.clientHeight,lt=Math.ceil($.scrollTop)<_e;h(lt)};const $=i.viewport;return g(),$.addEventListener("scroll",g),()=>$.removeEventListener("scroll",g)}},[i.viewport,i.isPositioned]),d?jsxRuntimeExports.jsx(SelectScrollButtonImpl,{...e,ref:_,onAutoScroll:()=>{const{viewport:g,selectedItem:$}=i;g&&$&&(g.scrollTop=g.scrollTop+$.offsetHeight)}}):null});SelectScrollDownButton$1.displayName=SCROLL_DOWN_BUTTON_NAME;var SelectScrollButtonImpl=reactExports.forwardRef((e,s)=>{const{__scopeSelect:i,onAutoScroll:c,...d}=e,h=useSelectContentContext("SelectScrollButton",i),_=reactExports.useRef(null),g=useCollection(i),$=reactExports.useCallback(()=>{_.current!==null&&(window.clearInterval(_.current),_.current=null)},[]);return reactExports.useEffect(()=>()=>$(),[$]),useLayoutEffect2(()=>{var lt;const _e=g().find(at=>at.ref.current===document.activeElement);(lt=_e==null?void 0:_e.ref.current)==null||lt.scrollIntoView({block:"nearest"})},[g]),jsxRuntimeExports.jsx(Primitive.div,{"aria-hidden":!0,...d,ref:s,style:{flexShrink:0,...d.style},onPointerDown:composeEventHandlers(d.onPointerDown,()=>{_.current===null&&(_.current=window.setInterval(c,50))}),onPointerMove:composeEventHandlers(d.onPointerMove,()=>{var _e;(_e=h.onItemLeave)==null||_e.call(h),_.current===null&&(_.current=window.setInterval(c,50))}),onPointerLeave:composeEventHandlers(d.onPointerLeave,()=>{$()})})}),SEPARATOR_NAME="SelectSeparator",SelectSeparator$1=reactExports.forwardRef((e,s)=>{const{__scopeSelect:i,...c}=e;return jsxRuntimeExports.jsx(Primitive.div,{"aria-hidden":!0,...c,ref:s})});SelectSeparator$1.displayName=SEPARATOR_NAME;var ARROW_NAME="SelectArrow",SelectArrow=reactExports.forwardRef((e,s)=>{const{__scopeSelect:i,...c}=e,d=usePopperScope(i),h=useSelectContext(ARROW_NAME,i),_=useSelectContentContext(ARROW_NAME,i);return h.open&&_.position==="popper"?jsxRuntimeExports.jsx(Arrow,{...d,...c,ref:s}):null});SelectArrow.displayName=ARROW_NAME;var BUBBLE_INPUT_NAME="SelectBubbleInput",SelectBubbleInput=reactExports.forwardRef(({__scopeSelect:e,value:s,...i},c)=>{const d=reactExports.useRef(null),h=useComposedRefs(c,d),_=usePrevious(s);return reactExports.useEffect(()=>{const g=d.current;if(!g)return;const $=window.HTMLSelectElement.prototype,lt=Object.getOwnPropertyDescriptor($,"value").set;if(_!==s&&lt){const at=new Event("change",{bubbles:!0});lt.call(g,s),g.dispatchEvent(at)}},[_,s]),jsxRuntimeExports.jsx(Primitive.select,{...i,style:{...VISUALLY_HIDDEN_STYLES,...i.style},ref:h,defaultValue:s})});SelectBubbleInput.displayName=BUBBLE_INPUT_NAME;function shouldShowPlaceholder(e){return e===""||e===void 0}function useTypeaheadSearch(e){const s=useCallbackRef$1(e),i=reactExports.useRef(""),c=reactExports.useRef(0),d=reactExports.useCallback(_=>{const g=i.current+_;s(g),function $(_e){i.current=_e,window.clearTimeout(c.current),_e!==""&&(c.current=window.setTimeout(()=>$(""),1e3))}(g)},[s]),h=reactExports.useCallback(()=>{i.current="",window.clearTimeout(c.current)},[]);return reactExports.useEffect(()=>()=>window.clearTimeout(c.current),[]),[i,d,h]}function findNextItem(e,s,i){const d=s.length>1&&Array.from(s).every(_e=>_e===s[0])?s[0]:s,h=i?e.indexOf(i):-1;let _=wrapArray(e,Math.max(h,0));d.length===1&&(_=_.filter(_e=>_e!==i));const $=_.find(_e=>_e.textValue.toLowerCase().startsWith(d.toLowerCase()));return $!==i?$:void 0}function wrapArray(e,s){return e.map((i,c)=>e[(s+c)%e.length])}var Root2=Select$1,Trigger=SelectTrigger$1,Value=SelectValue$1,Icon=SelectIcon,Portal=SelectPortal,Content2=SelectContent$1,Viewport=SelectViewport,Label=SelectLabel$1,Item=SelectItem$1,ItemText=SelectItemText,ItemIndicator=SelectItemIndicator,ScrollUpButton=SelectScrollUpButton$1,ScrollDownButton=SelectScrollDownButton$1,Separator=SelectSeparator$1;const Select=Root2,SelectValue=Value,SelectTrigger=reactExports.forwardRef(({className:e,children:s,...i},c)=>jsxRuntimeExports.jsxs(Trigger,{ref:c,className:cn("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...i,children:[s,jsxRuntimeExports.jsx(Icon,{asChild:!0,children:jsxRuntimeExports.jsx(ChevronDown,{className:"h-4 w-4 opacity-50"})})]}));SelectTrigger.displayName=Trigger.displayName;const SelectScrollUpButton=reactExports.forwardRef(({className:e,...s},i)=>jsxRuntimeExports.jsx(ScrollUpButton,{ref:i,className:cn("flex cursor-default items-center justify-center py-1",e),...s,children:jsxRuntimeExports.jsx(ChevronUp,{className:"h-4 w-4"})}));SelectScrollUpButton.displayName=ScrollUpButton.displayName;const SelectScrollDownButton=reactExports.forwardRef(({className:e,...s},i)=>jsxRuntimeExports.jsx(ScrollDownButton,{ref:i,className:cn("flex cursor-default items-center justify-center py-1",e),...s,children:jsxRuntimeExports.jsx(ChevronDown,{className:"h-4 w-4"})}));SelectScrollDownButton.displayName=ScrollDownButton.displayName;const SelectContent=reactExports.forwardRef(({className:e,children:s,position:i="popper",...c},d)=>jsxRuntimeExports.jsx(Portal,{children:jsxRuntimeExports.jsxs(Content2,{ref:d,className:cn("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",i==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:i,...c,children:[jsxRuntimeExports.jsx(SelectScrollUpButton,{}),jsxRuntimeExports.jsx(Viewport,{className:cn("p-1",i==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),jsxRuntimeExports.jsx(SelectScrollDownButton,{})]})}));SelectContent.displayName=Content2.displayName;const SelectLabel=reactExports.forwardRef(({className:e,...s},i)=>jsxRuntimeExports.jsx(Label,{ref:i,className:cn("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...s}));SelectLabel.displayName=Label.displayName;const SelectItem=reactExports.forwardRef(({className:e,children:s,...i},c)=>jsxRuntimeExports.jsxs(Item,{ref:c,className:cn("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),...i,children:[jsxRuntimeExports.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:jsxRuntimeExports.jsx(ItemIndicator,{children:jsxRuntimeExports.jsx(Check,{className:"h-4 w-4"})})}),jsxRuntimeExports.jsx(ItemText,{children:s})]}));SelectItem.displayName=Item.displayName;const SelectSeparator=reactExports.forwardRef(({className:e,...s},i)=>jsxRuntimeExports.jsx(Separator,{ref:i,className:cn("-mx-1 my-1 h-px bg-muted",e),...s}));SelectSeparator.displayName=Separator.displayName;const LanguageSelector=()=>{const{language:e,setLanguage:s}=useLanguage(),i=[{code:"en",name:"English",nativeName:"English"},{code:"hi",name:"Hindi",nativeName:""},{code:"kn",name:"Kannada",nativeName:""}];return jsxRuntimeExports.jsxs(Select,{value:e,onValueChange:c=>s(c),children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-[140px] rounded-full border-border/50 bg-background/50 backdrop-blur-sm hover:bg-background/80 transition-all",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Languages,{className:"w-4 h-4 text-muted-foreground"}),jsxRuntimeExports.jsx(SelectValue,{})]})}),jsxRuntimeExports.jsx(SelectContent,{children:i.map(c=>jsxRuntimeExports.jsx(SelectItem,{value:c.code,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:c.nativeName}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",c.name,")"]})]})},c.code))})]})},useTranslation=e=>{const{translate:s,language:i}=useLanguage(),[c,d]=reactExports.useState(e),[h,_]=reactExports.useState(!1);return reactExports.useEffect(()=>{let g=!0;return(async()=>{if(i==="en"){d(e);return}_(!0);try{const _e=await s(e);g&&d(_e)}catch(_e){console.error("Translation error:",_e),g&&d(e)}finally{g&&_(!1)}})(),()=>{g=!1}},[e,i,s]),{text:c,isTranslating:h}},ClassSelection=()=>{const e=useNavigate(),s=useTranslation("AI Sathi"),i=useTranslation("Your personal AI tutor that works without internet. Learn anytime, anywhere!"),c=useTranslation("Works Offline"),d=useTranslation("NCERT Aligned"),h=useTranslation("Free Forever"),_=useTranslation("Choose Your Class"),g=useTranslation("Select your grade to start learning"),$=useTranslation("Coming Soon"),_e=useTranslation("Start with Class 5"),lt=useTranslation("Learn Maths, Language, and more with AI-powered explanations in simple language. More classes coming soon!"),at=useTranslation("Powered by AI  Designed for Indian Students  Made with "),it=useTranslation("Class"),ct=[{number:5,available:!0},{number:6,available:!1},{number:7,available:!1},{number:8,available:!1},{number:9,available:!1},{number:10,available:!1}],mt=(pt,zt)=>{zt?e("/subjects"):ue.info(`Class ${pt} coming soon! Start with Class 5 for now.`)};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background via-background to-primary/5",children:[jsxRuntimeExports.jsx("div",{className:"absolute top-4 right-4 z-10",children:jsxRuntimeExports.jsx(LanguageSelector,{})}),jsxRuntimeExports.jsxs("div",{className:"px-6 pt-16 pb-12 text-center space-y-6",children:[jsxRuntimeExports.jsx("div",{className:"w-32 h-32 mx-auto rounded-3xl bg-gradient-to-br from-primary/10 to-secondary/10 flex items-center justify-center shadow-[var(--shadow-medium)] animate-in fade-in zoom-in duration-500 overflow-hidden border-2 border-primary/20",children:jsxRuntimeExports.jsx("img",{src:"/teacher-mascot.jpg",alt:"AI Sathi Teacher",className:"w-full h-full object-cover"})}),jsxRuntimeExports.jsxs("div",{className:"space-y-3 animate-in fade-in slide-in-from-bottom-4 duration-700 delay-150",children:[jsxRuntimeExports.jsx("h1",{className:"text-4xl font-bold text-foreground bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:s.text}),jsxRuntimeExports.jsx("p",{className:"text-lg text-muted-foreground max-w-md mx-auto leading-relaxed",children:i.text})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2 pt-2 animate-in fade-in slide-in-from-bottom-4 duration-700 delay-300",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-medium text-success bg-success/10 px-3 py-1.5 rounded-full border border-success/20",children:[jsxRuntimeExports.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-success animate-pulse"}),c.text]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-medium text-primary bg-primary/10 px-3 py-1.5 rounded-full border border-primary/20",children:[jsxRuntimeExports.jsx(GraduationCap,{className:"w-3 h-3"}),d.text]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-medium text-accent bg-accent/10 px-3 py-1.5 rounded-full border border-accent/20",children:[" ",h.text]})]})]}),jsxRuntimeExports.jsxs("div",{className:"px-6 pb-12 space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center space-y-2 animate-in fade-in slide-in-from-bottom-4 duration-700 delay-500",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-foreground",children:_.text}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:g.text})]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 gap-4 max-w-md mx-auto animate-in fade-in slide-in-from-bottom-4 duration-700 delay-700",children:ct.map((pt,zt)=>jsxRuntimeExports.jsx(Button,{onClick:()=>mt(pt.number,pt.available),disabled:!pt.available,className:`
                relative h-32 rounded-2xl text-lg font-semibold transition-all duration-300
                ${pt.available?"bg-gradient-to-br from-primary to-secondary hover:shadow-xl hover:scale-105 text-white border-0":"bg-muted/50 text-muted-foreground hover:bg-muted border border-border/50"}
                animate-in fade-in zoom-in duration-500
              `,style:{animationDelay:`${800+zt*100}ms`},children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-3xl font-bold",children:pt.number}),jsxRuntimeExports.jsxs("span",{className:"text-sm font-medium opacity-90",children:[it.text," ",pt.number]}),pt.available&&jsxRuntimeExports.jsx("div",{className:"absolute top-2 right-2",children:jsxRuntimeExports.jsx("div",{className:"w-2 h-2 rounded-full bg-white animate-pulse"})}),!pt.available&&jsxRuntimeExports.jsx("span",{className:"absolute bottom-2 text-xs opacity-60",children:$.text})]})},pt.number))}),jsxRuntimeExports.jsx("div",{className:"max-w-md mx-auto p-6 bg-gradient-to-br from-primary/10 to-secondary/10 rounded-3xl border border-primary/20 space-y-3 animate-in fade-in slide-in-from-bottom-4 duration-700 delay-1000",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-primary/10 to-secondary/10 flex items-center justify-center flex-shrink-0 overflow-hidden border-2 border-primary/20",children:jsxRuntimeExports.jsx("img",{src:"/teacher-mascot.jpg",alt:"AI Sathi Teacher",className:"w-full h-full object-cover"})}),jsxRuntimeExports.jsxs("div",{className:"space-y-1",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-foreground",children:_e.text}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:lt.text})]})]})})]}),jsxRuntimeExports.jsx("div",{className:"px-6 pb-8 text-center animate-in fade-in duration-700 delay-1200",children:jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground",children:at.text})})]})},Card=reactExports.forwardRef(({className:e,...s},i)=>jsxRuntimeExports.jsx("div",{ref:i,className:cn("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));Card.displayName="Card";const CardHeader=reactExports.forwardRef(({className:e,...s},i)=>jsxRuntimeExports.jsx("div",{ref:i,className:cn("flex flex-col space-y-1.5 p-6",e),...s}));CardHeader.displayName="CardHeader";const CardTitle=reactExports.forwardRef(({className:e,...s},i)=>jsxRuntimeExports.jsx("h3",{ref:i,className:cn("text-2xl font-semibold leading-none tracking-tight",e),...s}));CardTitle.displayName="CardTitle";const CardDescription=reactExports.forwardRef(({className:e,...s},i)=>jsxRuntimeExports.jsx("p",{ref:i,className:cn("text-sm text-muted-foreground",e),...s}));CardDescription.displayName="CardDescription";const CardContent=reactExports.forwardRef(({className:e,...s},i)=>jsxRuntimeExports.jsx("div",{ref:i,className:cn("p-6 pt-0",e),...s}));CardContent.displayName="CardContent";const CardFooter=reactExports.forwardRef(({className:e,...s},i)=>jsxRuntimeExports.jsx("div",{ref:i,className:cn("flex items-center p-6 pt-0",e),...s}));CardFooter.displayName="CardFooter";const SubjectCard=({title:e,description:s,icon:i,onClick:c,color:d})=>{const h={primary:"from-primary to-secondary",learning:"from-learning to-learning/80",accent:"from-accent to-accent/80",success:"from-success to-success/80"};return jsxRuntimeExports.jsxs(Card,{onClick:c,className:"p-6 cursor-pointer transition-all hover:scale-105 hover:shadow-[var(--shadow-medium)] active:scale-95",children:[jsxRuntimeExports.jsx("div",{className:cn("w-12 h-12 rounded-2xl bg-gradient-to-br mb-4 flex items-center justify-center",h[d]),children:jsxRuntimeExports.jsx(i,{className:"w-6 h-6 text-white"})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:e}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:s})]})},Subjects=()=>{const e=useNavigate(),[s,i]=reactExports.useState(!1),{setAiPipeline:c,aiPipeline:d}=useLanguage(),[h,_]=reactExports.useState(navigator.onLine);if(reactExports.useEffect(()=>{const $=()=>{_(!0),ue.success("Back online!")},_e=()=>{_(!1),ue.info("Offline mode - AI Sathi still works!")};return window.addEventListener("online",$),window.addEventListener("offline",_e),"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").catch(lt=>{console.log("Service worker registration failed:",lt)}),()=>{window.removeEventListener("online",$),window.removeEventListener("offline",_e)}},[]),!s)return jsxRuntimeExports.jsx(AIModelLoader,{onModelLoaded:$=>{c($),i(!0)}});const g=[{title:"Maths ()",description:"Grade 5 NCERT - Numbers, Addition, Fractions",icon:Calculator,color:"primary",route:"/maths-chapters"},{title:"Science ()",description:"Grade 5 NCERT - Body, Plants, Weather",icon:Globe,color:"accent",route:"/science-chapters"},{title:"Language Learning",description:"Learn Hindi, English, Kannada",icon:Book,color:"learning",route:"/language-learning"}];return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background via-background to-primary/5",children:[jsxRuntimeExports.jsxs("div",{className:"px-4 pt-4 flex items-center justify-between",children:[jsxRuntimeExports.jsxs(Button,{variant:"ghost",size:"sm",onClick:()=>e("/"),className:"rounded-full hover:bg-muted",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]}),jsxRuntimeExports.jsx(LanguageSelector,{})]}),jsxRuntimeExports.jsxs("div",{className:"px-6 pt-8 pb-8 text-center space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"w-24 h-24 mx-auto rounded-3xl bg-gradient-to-br from-primary/10 to-secondary/10 flex items-center justify-center shadow-[var(--shadow-medium)] overflow-hidden border-2 border-primary/20",children:jsxRuntimeExports.jsx("img",{src:"/teacher-mascot.jpg",alt:"AI Sathi Teacher",className:"w-full h-full object-cover"})}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"AI Sathi"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:"Your personal AI tutor that works without internet. Learn anytime, anywhere!"})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center gap-2 pt-2",children:h?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground bg-muted px-3 py-1.5 rounded-full",children:[jsxRuntimeExports.jsx(Wifi,{className:"w-3 h-3"}),"Online"]}):jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-xs text-success bg-success/10 px-3 py-1.5 rounded-full",children:[jsxRuntimeExports.jsx(WifiOff,{className:"w-3 h-3"}),"Offline Mode Active "]})})]}),jsxRuntimeExports.jsxs("div",{className:"px-6 pb-8 space-y-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Choose a Subject"}),jsxRuntimeExports.jsx("div",{className:"grid gap-4",children:g.map($=>jsxRuntimeExports.jsx(SubjectCard,{title:$.title,description:$.description,icon:$.icon,color:$.color,onClick:()=>{$.route==="/chat"?e($.route,{state:{pipeline:d}}):$.route==="/science-chapters"||$.route==="/maths-chapters"?e($.route):ue.info("Coming soon! Start with Maths for now.")}},$.title))})]}),jsxRuntimeExports.jsx("div",{className:"px-6 pb-12",children:jsxRuntimeExports.jsxs("div",{className:"p-6 bg-gradient-to-br from-primary/10 to-secondary/10 rounded-3xl border border-primary/20 space-y-4",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-foreground",children:"Ready to Learn?"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Start with Grade 5 Maths and ask me anything! I'll explain step-by-step in simple language."}),jsxRuntimeExports.jsx(Button,{onClick:()=>e("/chat"),className:"w-full rounded-2xl h-12 bg-gradient-to-r from-primary to-secondary hover:shadow-lg transition-all",children:"Start Learning Now "})]})}),jsxRuntimeExports.jsx("div",{className:"px-6 pb-8 text-center",children:jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground",children:"Works completely offline  NCERT aligned  Free forever"})})]})},ChatMessage=({role:e,content:s})=>{const i=e==="assistant";return jsxRuntimeExports.jsxs("div",{className:cn("flex gap-3 p-4 rounded-2xl animate-in fade-in-0 slide-in-from-bottom-3",i?"bg-card shadow-[var(--shadow-soft)]":"bg-primary/10 ml-auto max-w-[85%]"),children:[i&&jsxRuntimeExports.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center",children:jsxRuntimeExports.jsx(Bot,{className:"w-5 h-5 text-white"})}),jsxRuntimeExports.jsx("div",{className:"flex-1 space-y-2",children:jsxRuntimeExports.jsx("p",{className:"text-foreground leading-relaxed whitespace-pre-wrap",children:s})}),!i&&jsxRuntimeExports.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-muted flex items-center justify-center",children:jsxRuntimeExports.jsx(User,{className:"w-5 h-5 text-muted-foreground"})})]})},Textarea=reactExports.forwardRef(({className:e,...s},i)=>jsxRuntimeExports.jsx("textarea",{className:cn("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:i,...s}));Textarea.displayName="Textarea";const Chat=()=>{var e;const location=useLocation(),navigate=useNavigate(),{aiPipeline}=useLanguage(),pipelines=aiPipeline||((e=location.state)==null?void 0:e.pipeline),mathModel=pipelines==null?void 0:pipelines.mathModel,textModel=pipelines==null?void 0:pipelines.textModel;reactExports.useEffect(()=>{var s;console.log(" Chat Component - Debug Info:"),console.log("aiPipeline from context:",aiPipeline),console.log("pipeline from location.state:",(s=location.state)==null?void 0:s.pipeline),console.log("Final pipelines object:",pipelines),console.log("Math Model loaded:",mathModel?"":""),console.log("Text Model loaded:",textModel?"":"")},[aiPipeline,location.state,pipelines,mathModel,textModel]);const[messages,setMessages]=reactExports.useState([{role:"assistant",content:"! Hello! I'm your AI Sathi. I can help you learn Grade 5 Maths. Ask me anything about addition, subtraction, multiplication, division, or fractions! "}]),[input,setInput]=reactExports.useState(""),[isLoading,setIsLoading]=reactExports.useState(!1),[currentModel,setCurrentModel]=reactExports.useState(null),messagesEndRef=reactExports.useRef(null),scrollToBottom=()=>{var s;(s=messagesEndRef.current)==null||s.scrollIntoView({behavior:"smooth"})};reactExports.useEffect(()=>{scrollToBottom()},[messages]);const isMathQuestion=s=>{const i=s.toLowerCase();return/\d+\s*[\+\-\*\/]\s*\d+/.test(s)?!0:["add","addition","plus","sum","","total","subtract","subtraction","minus","difference","","take away","multiply","multiplication","times","product","","divide","division","","quotient","fraction","","half","quarter","third","calculate","solve","answer","equal","=","number","digit","place value","tens","hundreds","ones","greater","less","compare","bigger","smaller"].some(d=>i.includes(d))},getAIResponse=async userMessage=>{const isMath=isMathQuestion(userMessage);if(mathModel&&textModel)try{if(isMath){setCurrentModel("math"),console.log(" Using MATH model for:",userMessage);const s=`Solve this math problem for a Grade 5 student. Explain step-by-step in simple language.

Question: ${userMessage}

Answer:`;return(await mathModel(s,{max_new_tokens:150,temperature:.3,do_sample:!1}))[0].generated_text||"I'm having trouble with that calculation. Can you rephrase?"}else{setCurrentModel("text"),console.log(" Using TEXT model for:",userMessage);const s=messages.slice(-6);let i="";s.forEach(_=>{_.role==="user"?i+=`Student: ${_.content}
`:i+=`Teacher: ${_.content}
`});const c=`<|im_start|>system
You are AI Sathi, a friendly and patient tutor for Grade 5 NCERT Maths in India. 
- Answer in simple language that a 10-year-old can understand
- Use both English and Hindi terms when helpful
- Keep responses short (3-5 sentences), encouraging, and grade-appropriate
- When student asks "yes" or "explain", provide the explanation they're asking for
- Use examples from daily life (rotis, rupees, cricket, etc)
- Always be encouraging and supportive<|im_end|>
<|im_start|>user
Previous conversation:
${i}

Current question: ${userMessage}<|im_end|>
<|im_start|>assistant
`;let h=(await textModel(c,{max_new_tokens:250,temperature:.7,do_sample:!0,top_p:.9}))[0].generated_text||"";return h=h.replace(c,"").trim(),h=h.replace(/<\|im_end\|>/g,"").trim(),h=h.replace(/<\|im_start\|>/g,"").trim(),!h||h.length<20?"I'm here to help! Could you please be more specific about what you'd like to learn? For example, you can ask me about addition, subtraction, multiplication, division, or fractions! ":h}}catch(s){console.error("AI generation error:",s),setCurrentModel(null)}const lowerMessage=userMessage.toLowerCase();if((lowerMessage==="yes"||lowerMessage.includes("explain")||lowerMessage.includes("how"))&&messages.length>=2){const lastAssistant=messages[messages.length-1];if(lastAssistant.role==="assistant"&&lastAssistant.content.includes("answer is:")){const lastUser=messages[messages.length-2],calcMatch=lastUser.content.match(/(\d+)\s*([\+\-\*\/])\s*(\d+)/);if(calcMatch){const[,a,op,b]=calcMatch,operations={"+":{name:"Addition",hindi:"",explain:`we put ${a} and ${b} together`},"-":{name:"Subtraction",hindi:"",explain:`we take away ${b} from ${a}`},"*":{name:"Multiplication",hindi:"",explain:`we add ${a}, ${b} times`},"":{name:"Multiplication",hindi:"",explain:`we add ${a}, ${b} times`},"/":{name:"Division",hindi:"",explain:`we split ${a} into ${b} equal parts`},"":{name:"Division",hindi:"",explain:`we split ${a} into ${b} equal parts`}},opInfo=operations[op];if(opInfo)return`Great! Let me explain how we solve ${a} ${op} ${b}:

${opInfo.name} (${opInfo.hindi}) means ${opInfo.explain}.

${lastUser.content} = ${eval(`${a}${op.replace("","*").replace("","/")}${b}`)}

Do you understand now? Feel free to ask more questions! `}}}if(lowerMessage.includes("add")||lowerMessage.includes("plus")||lowerMessage.includes(""))return`Great! Let's learn addition ().

When we add numbers, we put them together. For example:
5 + 3 = 8

Try this: What is 12 + 7?`;if(lowerMessage.includes("multiply")||lowerMessage.includes("times")||lowerMessage.includes(""))return`Wonderful! Multiplication () is repeated addition.

For example: 4  3 means adding 4 three times:
4 + 4 + 4 = 12

So 4  3 = 12

Try: What is 5  6?`;if(lowerMessage.includes("fraction")||lowerMessage.includes("half")||lowerMessage.includes(""))return`Fractions () show parts of a whole!

1/2 means one part out of two equal parts (half)
1/4 means one part out of four equal parts (quarter)

If you have 1 roti and cut it into 4 equal pieces, each piece is 1/4 of the roti! 

What fraction questions do you have?`;if(/\d+\s*[\+\-\*\/]\s*\d+/.test(userMessage))try{const cleanExpr=userMessage.replace(/[^\d\+\-\*\/\(\)]/g,"").replace(//g,"*").replace(//g,"/"),result=eval(cleanExpr);return`Great question! Let me help you solve this step by step.

The answer is: ${result}

Would you like me to explain how we got this answer?`}catch{return"I can help you with that! Can you write it in this format: number + number (like 5 + 3)?"}return lowerMessage.includes("help")||lowerMessage.includes("")?`I'm here to help you learn! 

I can teach you:
 Addition ()
 Subtraction ()
 Multiplication ()
 Division ()
 Fractions ()

Just ask me about any topic or give me a math problem to solve!`:/^(yes|yeah|ok|okay|sure|no|nah)$/i.test(lowerMessage.trim())?`I'm here to help! What would you like to learn about? You can ask me:
 Math problems (like 5 + 3)
 Concepts (like 'what is multiplication?')
 Explanations (like 'explain fractions')

Go ahead, I'm listening! `:"That's a great question! I can help you with Grade 5 Maths topics like addition, subtraction, multiplication, division, and fractions. What would you like to learn about? "},handleSend=async()=>{if(!input.trim()||isLoading)return;const s={role:"user",content:input.trim()};setMessages(i=>[...i,s]),setInput(""),setIsLoading(!0);try{await new Promise(d=>setTimeout(d,800));const c={role:"assistant",content:await getAIResponse(s.content)};setMessages(d=>[...d,c])}catch(i){console.error("Error getting response:",i),ue.error("Sorry, I had trouble understanding. Please try again!")}finally{setIsLoading(!1)}},handleKeyPress=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),handleSend())};return jsxRuntimeExports.jsxs("div",{className:"flex flex-col h-screen bg-gradient-to-b from-background to-primary/5",children:[jsxRuntimeExports.jsxs("div",{className:"bg-card shadow-[var(--shadow-soft)] border-b border-border px-4 py-3 flex items-center gap-3",children:[jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"icon",onClick:()=>navigate("/"),className:"rounded-full",children:jsxRuntimeExports.jsx(ArrowLeft,{className:"w-5 h-5"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h1",{className:"font-semibold text-foreground",children:"AI Sathi"}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-success flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-2 h-2 bg-success rounded-full animate-pulse"}),mathModel&&textModel?currentModel==="math"?" Math Mode (Offline)":currentModel==="text"?" Explain Mode (Offline)":"AI Ready (Offline)":"Basic Mode"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[!mathModel||!textModel?jsxRuntimeExports.jsxs("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-xl",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-semibold text-yellow-800 dark:text-yellow-200 mb-2",children:" AI Models Status:"}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-yellow-700 dark:text-yellow-300",children:["Math Model: ",mathModel?" Loaded":" Not Loaded",jsxRuntimeExports.jsx("br",{}),"Text Model: ",textModel?" Loaded":" Not Loaded",jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("span",{className:"mt-1 block italic",children:"Using rule-based responses for now."})]})]}):jsxRuntimeExports.jsx("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700 rounded-xl",children:jsxRuntimeExports.jsx("p",{className:"text-xs text-green-700 dark:text-green-300",children:" Both AI models loaded successfully! Fully offline mode active."})}),messages.map((s,i)=>jsxRuntimeExports.jsx(ChatMessage,{role:s.role,content:s.content},i)),isLoading&&jsxRuntimeExports.jsxs("div",{className:"flex gap-2 p-4 rounded-2xl bg-card shadow-[var(--shadow-soft)]",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce"}),jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce [animation-delay:0.2s]"}),jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce [animation-delay:0.4s]"})]}),jsxRuntimeExports.jsx("div",{ref:messagesEndRef})]}),jsxRuntimeExports.jsx("div",{className:"bg-card border-t border-border p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx(Textarea,{value:input,onChange:s=>setInput(s.target.value),onKeyPress:handleKeyPress,placeholder:"Ask me anything about maths...",className:"min-h-[60px] max-h-[120px] resize-none rounded-2xl",disabled:isLoading}),jsxRuntimeExports.jsx(Button,{onClick:handleSend,disabled:!input.trim()||isLoading,size:"icon",className:"h-[60px] w-[60px] rounded-2xl bg-gradient-to-br from-primary to-secondary hover:shadow-lg transition-all",children:jsxRuntimeExports.jsx(Send,{className:"w-5 h-5"})})]})})]})},ScienceChapters=()=>{const e=useNavigate(),{aiPipeline:s,t:i}=useLanguage(),c=[{id:"human-body",title:i("The Human Body"),description:i("Learn about body parts and their functions"),icon:HeartPulse,color:"primary"},{id:"plants",title:i("Plants Around Us"),description:i("Understand plant parts and their importance"),icon:Leaf,color:"learning"},{id:"animals",title:i("Animal Life"),description:i("Discover different animals and their habitats"),icon:FlaskConical,color:"accent"},{id:"weather",title:i("Weather and Climate"),description:i("Explore weather patterns and seasons"),icon:CloudSun,color:"primary"}],d=h=>{e("/chat",{state:{pipeline:s,context:{subject:"Science",chapter:h}}})};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background via-background to-primary/5",children:[jsxRuntimeExports.jsxs("div",{className:"px-4 pt-4 flex items-center justify-between",children:[jsxRuntimeExports.jsxs(Button,{variant:"ghost",size:"sm",onClick:()=>e("/subjects"),className:"rounded-full hover:bg-muted",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),i("Back")]}),jsxRuntimeExports.jsx(LanguageSelector,{})]}),jsxRuntimeExports.jsxs("div",{className:"px-6 pt-8 pb-8 text-center space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"w-20 h-20 mx-auto rounded-3xl bg-gradient-to-br from-blue-500/10 to-cyan-500/10 flex items-center justify-center shadow-[var(--shadow-medium)] overflow-hidden border-2 border-blue-500/20",children:jsxRuntimeExports.jsx(FlaskConical,{className:"w-10 h-10 text-blue-600"})}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-foreground",children:i("Science Chapters")}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:i("Class 5  NCERT")})]})]}),jsxRuntimeExports.jsx("div",{className:"px-6 pb-8 space-y-4",children:jsxRuntimeExports.jsx("div",{className:"grid gap-4",children:c.map(h=>jsxRuntimeExports.jsx(SubjectCard,{title:h.title,description:h.description,icon:h.icon,color:h.color,onClick:()=>d(h.id)},h.id))})})]})},MathsChapters=()=>{const e=useNavigate(),{aiPipeline:s,t:i}=useLanguage(),c=[{id:"numbers",title:i("Numbers and Operations"),description:i("Learn about numbers, addition, and subtraction"),icon:Calculator,color:"primary"},{id:"shapes",title:i("Shapes and Patterns"),description:i("Identify shapes and create patterns"),icon:Shapes,color:"learning"},{id:"measurement",title:i("Measurement"),description:i("Learn about length, weight, and capacity"),icon:Scale,color:"accent"},{id:"time",title:i("Time and Money"),description:i("Tell time and understand money"),icon:Clock,color:"primary"}],d=h=>{e("/chat",{state:{pipeline:s,context:{subject:"Maths",chapter:h}}})};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background via-background to-primary/5",children:[jsxRuntimeExports.jsxs("div",{className:"px-4 pt-4 flex items-center justify-between",children:[jsxRuntimeExports.jsxs(Button,{variant:"ghost",size:"sm",onClick:()=>e("/subjects"),className:"rounded-full hover:bg-muted",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),i("Back")]}),jsxRuntimeExports.jsx(LanguageSelector,{})]}),jsxRuntimeExports.jsxs("div",{className:"px-6 pt-8 pb-8 text-center space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"w-20 h-20 mx-auto rounded-3xl bg-gradient-to-br from-orange-500/10 to-red-500/10 flex items-center justify-center shadow-[var(--shadow-medium)] overflow-hidden border-2 border-orange-500/20",children:jsxRuntimeExports.jsx(Calculator,{className:"w-10 h-10 text-orange-600"})}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-foreground",children:i("Maths Chapters")}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:i("Class 5  NCERT")})]})]}),jsxRuntimeExports.jsx("div",{className:"px-6 pb-8 space-y-4",children:jsxRuntimeExports.jsx("div",{className:"grid gap-4",children:c.map(h=>jsxRuntimeExports.jsx(SubjectCard,{title:h.title,description:h.description,icon:h.icon,color:h.color,onClick:()=>d(h.id)},h.id))})})]})},NotFound=()=>{const e=useLocation();return reactExports.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),jsxRuntimeExports.jsx("div",{className:"flex min-h-screen items-center justify-center bg-muted",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),jsxRuntimeExports.jsx("p",{className:"mb-4 text-xl text-muted-foreground",children:"Oops! Page not found"}),jsxRuntimeExports.jsx("a",{href:"/",className:"text-primary underline hover:text-primary/90",children:"Return to Home"})]})})},LanguageLearningHub=()=>{const e=useNavigate(),[s,i]=reactExports.useState(!1);reactExports.useEffect(()=>{i(localStorage.getItem("demoMode")==="true")},[]);const c=()=>{const h=!s;if(i(h),localStorage.setItem("demoMode",h.toString()),h){const _={completed:["hindi-1","english-1"],wordsLearned:15,pronunciationAccuracy:85};localStorage.setItem("lessonProgress",JSON.stringify(_))}},d=[{id:"select-language",title:"Start Learning",titleHindi:"  ",description:"Choose your language and take a quick assessment",descriptionHindi:"       ",icon:BookOpen,color:"from-blue-500/20 to-blue-600/20",route:"/language-learning/select"},{id:"picture-dictionary",title:"Picture Dictionary",titleHindi:" ",description:"Learn words with pictures and audio",descriptionHindi:"      ",icon:Image$1,color:"from-purple-500/20 to-purple-600/20",route:"/language-learning/dictionary"},{id:"hindi-lessons",title:"Hindi Lessons",titleHindi:" ",description:"Interactive Hindi learning modules",descriptionHindi:"    ",icon:Trophy,color:"from-orange-500/20 to-orange-600/20",route:"/language-learning/lessons/hi"},{id:"english-lessons",title:"English Lessons",titleHindi:" ",description:"Interactive English learning modules",descriptionHindi:"    ",icon:Trophy,color:"from-green-500/20 to-green-600/20",route:"/language-learning/lessons/en"}];return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background via-background to-primary/5 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"max-w-6xl mx-auto mb-8",children:[jsxRuntimeExports.jsxs(Button,{variant:"ghost",size:"sm",onClick:()=>e("/subjects"),className:"mb-4 rounded-full hover:bg-muted",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back to Subjects"]}),jsxRuntimeExports.jsxs("div",{className:"text-center space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"w-24 h-24 mx-auto rounded-3xl bg-gradient-to-br from-primary/10 to-secondary/10 flex items-center justify-center shadow-lg",children:jsxRuntimeExports.jsx("span",{className:"text-5xl",children:""})}),jsxRuntimeExports.jsx("h1",{className:"text-4xl font-bold text-foreground",children:"Language Learning"}),jsxRuntimeExports.jsx("p",{className:"text-xl text-muted-foreground",children:" "}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground max-w-2xl mx-auto",children:"Learn Hindi and English with interactive lessons, games, and audio support. Perfect for all ages!"})]}),jsxRuntimeExports.jsx("div",{className:"mt-6 flex justify-center",children:jsxRuntimeExports.jsxs(Button,{onClick:c,variant:s?"default":"outline",className:"rounded-full",children:[jsxRuntimeExports.jsx(Zap,{className:"w-4 h-4 mr-2"}),s?" Demo Mode Active":"Enable Demo Mode"]})}),s&&jsxRuntimeExports.jsx("div",{className:"mt-4 p-4 bg-yellow-500/10 border border-yellow-500/30 rounded-xl text-center",children:jsxRuntimeExports.jsxs("p",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:[jsxRuntimeExports.jsx("strong",{children:"Demo Mode:"})," All lessons unlocked  Pre-filled progress  Perfect for presentations!"]})})]}),jsxRuntimeExports.jsx("div",{className:"max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-6",children:d.map(h=>jsxRuntimeExports.jsx(Card,{onClick:()=>e(h.route),className:"p-6 cursor-pointer transition-all hover:scale-105 hover:shadow-lg",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-4",children:[jsxRuntimeExports.jsx("div",{className:`w-16 h-16 rounded-2xl bg-gradient-to-br ${h.color} flex items-center justify-center flex-shrink-0`,children:jsxRuntimeExports.jsx(h.icon,{className:"w-8 h-8 text-foreground"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-foreground mb-1",children:h.title}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:h.titleHindi}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:h.description})]})]})},h.id))}),jsxRuntimeExports.jsxs("div",{className:"max-w-6xl mx-auto mt-12 grid grid-cols-1 md:grid-cols-3 gap-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center p-6 bg-card rounded-xl border border-border",children:[jsxRuntimeExports.jsx("div",{className:"text-4xl mb-2",children:""}),jsxRuntimeExports.jsx("h3",{className:"font-semibold mb-1",children:"Interactive Games"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Fun matching games and exercises"})]}),jsxRuntimeExports.jsxs("div",{className:"text-center p-6 bg-card rounded-xl border border-border",children:[jsxRuntimeExports.jsx("div",{className:"text-4xl mb-2",children:""}),jsxRuntimeExports.jsx("h3",{className:"font-semibold mb-1",children:"Audio Support"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Hear every word pronounced correctly"})]}),jsxRuntimeExports.jsxs("div",{className:"text-center p-6 bg-card rounded-xl border border-border",children:[jsxRuntimeExports.jsx("div",{className:"text-4xl mb-2",children:""}),jsxRuntimeExports.jsx("h3",{className:"font-semibold mb-1",children:"Track Progress"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"See your improvement over time"})]})]})]})},languages=[{code:"hi",name:"Hindi",nativeName:"",flag:"",audioUrl:"/assets/audio/lang-hindi.mp3"},{code:"en",name:"English",nativeName:"English",flag:"",audioUrl:"/assets/audio/lang-english.mp3"}],LanguageSelect=()=>{const e=useNavigate(),[s,i]=reactExports.useState(null),c=_=>{const g=new SpeechSynthesisUtterance;_.includes("hindi")?(g.text="",g.lang="hi-IN"):(g.text="English",g.lang="en-US"),window.speechSynthesis.speak(g)},d=_=>{i(_),localStorage.setItem("learningLanguage",_)},h=()=>{s&&e("/language-learning/assessment")};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background via-background to-primary/5 p-6",children:[jsxRuntimeExports.jsxs(Button,{variant:"ghost",size:"sm",onClick:()=>e("/subjects"),className:"mb-6 rounded-full hover:bg-muted",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]}),jsxRuntimeExports.jsxs("div",{className:"text-center space-y-4 mb-12",children:[jsxRuntimeExports.jsx("div",{className:"w-24 h-24 mx-auto rounded-3xl bg-gradient-to-br from-primary/10 to-secondary/10 flex items-center justify-center shadow-lg",children:jsxRuntimeExports.jsx("span",{className:"text-5xl",children:""})}),jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Select Your Language"}),jsxRuntimeExports.jsx("p",{className:"text-xl text-muted-foreground font-semibold",children:"  "}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground max-w-md mx-auto",children:"Choose the language you want to learn. You can change this later."})]}),jsxRuntimeExports.jsx("div",{className:"max-w-2xl mx-auto space-y-4 mb-8",children:languages.map(_=>jsxRuntimeExports.jsx(Card,{onClick:()=>d(_.code),className:`p-6 cursor-pointer transition-all hover:scale-105 hover:shadow-lg ${s===_.code?"ring-2 ring-primary bg-primary/5":""}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("span",{className:"text-5xl",children:_.flag}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-2xl font-bold text-foreground",children:_.nativeName}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:_.name})]})]}),jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"icon",className:"rounded-full hover:bg-primary/10",onClick:g=>{g.stopPropagation(),c(_.audioUrl)},children:jsxRuntimeExports.jsx(Volume2,{className:"w-6 h-6 text-primary"})})]})},_.code))}),s&&jsxRuntimeExports.jsx("div",{className:"max-w-2xl mx-auto",children:jsxRuntimeExports.jsx(Button,{onClick:h,className:"w-full h-14 text-lg rounded-2xl bg-gradient-to-r from-primary to-secondary hover:shadow-lg transition-all",children:"Continue /   "})}),jsxRuntimeExports.jsx("div",{className:"mt-12 text-center",children:jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground",children:" Interactive lessons   Fun games   Track progress"})})]})},assessmentQuestions=[{id:"q1",type:"letter",language:"hi",question:"Which letter is this?",questionHindi:"    ?",audioUrl:"/assets/audio/assessment/q1.mp3",options:[{id:"a",text:"",correct:!0},{id:"b",text:"",correct:!1},{id:"c",text:"",correct:!1}]},{id:"q2",type:"word",language:"hi",question:"Match the word to the picture",questionHindi:"   ",audioUrl:"/assets/audio/assessment/q2.mp3",options:[{id:"a",text:"",image:"/assets/vocab/cat.png",correct:!0},{id:"b",text:"",image:"/assets/vocab/cat.png",correct:!1},{id:"c",text:"",image:"/assets/vocab/cat.png",correct:!1}]},{id:"q3",type:"letter",language:"en",question:"Which letter is this?",questionHindi:"    ?",audioUrl:"/assets/audio/assessment/q3.mp3",options:[{id:"a",text:"A",correct:!0},{id:"b",text:"B",correct:!1},{id:"c",text:"C",correct:!1}]},{id:"q4",type:"word",language:"en",question:"Which word matches the picture?",questionHindi:"       ?",audioUrl:"/assets/audio/assessment/q4.mp3",options:[{id:"a",text:"Cat",image:"/assets/vocab/cat.png",correct:!0},{id:"b",text:"Dog",image:"/assets/vocab/cat.png",correct:!1},{id:"c",text:"Cow",image:"/assets/vocab/cat.png",correct:!1}]}],LiteracyAssessment=()=>{const e=useNavigate(),[s,i]=reactExports.useState(0),[c,d]=reactExports.useState({}),[h,_]=reactExports.useState(null),[g,$]=reactExports.useState(!1),_e=assessmentQuestions[s],lt=(s+1)/assessmentQuestions.length*100,at=(dt,ft)=>{const kt=new SpeechSynthesisUtterance(dt);kt.lang=ft==="hi"?"hi-IN":"en-US",window.speechSynthesis.speak(kt)},it=dt=>{_(dt)},ct=()=>{if(h){const dt=_e.options.find(ft=>ft.id===h);d({...c,[_e.id]:(dt==null?void 0:dt.correct)||!1}),s<assessmentQuestions.length-1?(i(s+1),_(null)):mt()}},mt=()=>{const dt=assessmentQuestions.filter(nr=>nr.language==="hi"),ft=assessmentQuestions.filter(nr=>nr.language==="en"),kt=dt.filter(nr=>c[nr.id]).length,St=ft.filter(nr=>c[nr.id]).length,Lt=kt/dt.length*100,Gt=St/ft.length*100,Bt={hindiScore:Lt,englishScore:Gt,placement:pt(Lt,Gt),completedAt:new Date().toISOString()};localStorage.setItem("assessmentResult",JSON.stringify(Bt)),$(!0)},pt=(dt,ft)=>dt>=70&&ft>=70?"skip-to-tutor":dt<50&&ft<50?"both":dt<ft?"hindi-literacy":"english-literacy",zt=()=>{const dt=localStorage.getItem("learningLanguage");e(`/language-learning/lessons/${dt}`)};if(g){const dt=JSON.parse(localStorage.getItem("assessmentResult")||"{}");return jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-b from-background via-background to-primary/5 p-6 flex items-center justify-center",children:jsxRuntimeExports.jsxs(Card,{className:"max-w-2xl w-full p-8 space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"w-24 h-24 mx-auto rounded-full bg-gradient-to-br from-success/20 to-success/10 flex items-center justify-center",children:jsxRuntimeExports.jsx(Check,{className:"w-12 h-12 text-success"})}),jsxRuntimeExports.jsx("h2",{className:"text-3xl font-bold text-foreground",children:"Assessment Complete!"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"  !"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"p-4 bg-muted rounded-xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-2",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Hindi Score"}),jsxRuntimeExports.jsxs("span",{className:"text-2xl font-bold text-primary",children:[Math.round(dt.hindiScore),"%"]})]}),jsxRuntimeExports.jsx(Progress,{value:dt.hindiScore,className:"h-2"})]}),jsxRuntimeExports.jsxs("div",{className:"p-4 bg-muted rounded-xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-2",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"English Score"}),jsxRuntimeExports.jsxs("span",{className:"text-2xl font-bold text-primary",children:[Math.round(dt.englishScore),"%"]})]}),jsxRuntimeExports.jsx(Progress,{value:dt.englishScore,className:"h-2"})]})]}),jsxRuntimeExports.jsxs("div",{className:"p-6 bg-gradient-to-br from-primary/10 to-secondary/10 rounded-2xl border border-primary/20",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Recommended Path"}),jsxRuntimeExports.jsxs("p",{className:"text-muted-foreground",children:[dt.placement==="skip-to-tutor"&&"Great job! You can start with advanced lessons.",dt.placement==="hindi-literacy"&&"Let's start with Hindi literacy lessons.",dt.placement==="english-literacy"&&"Let's start with English literacy lessons.",dt.placement==="both"&&"We'll start with both Hindi and English basics."]})]}),jsxRuntimeExports.jsx(Button,{onClick:zt,className:"w-full h-14 text-lg rounded-2xl bg-gradient-to-r from-primary to-secondary",children:"Start Learning! "})]})})}return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background via-background to-primary/5 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"max-w-2xl mx-auto mb-8 space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("h2",{className:"text-xl font-semibold",children:["Question ",s+1," of ",assessmentQuestions.length]}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-muted-foreground",children:[Math.round(lt),"%"]})]}),jsxRuntimeExports.jsx(Progress,{value:lt,className:"h-2"})]}),jsxRuntimeExports.jsxs(Card,{className:"max-w-2xl mx-auto p-8 space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx("h3",{className:"text-2xl font-bold text-foreground",children:_e.question}),jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"icon",className:"rounded-full",onClick:()=>at(_e.question,_e.language),children:jsxRuntimeExports.jsx(Volume2,{className:"w-5 h-5 text-primary"})})]}),jsxRuntimeExports.jsx("p",{className:"text-lg text-muted-foreground",children:_e.questionHindi})]}),jsxRuntimeExports.jsx("div",{className:"grid gap-4",children:_e.options.map(dt=>jsxRuntimeExports.jsx(Card,{onClick:()=>it(dt.id),className:`p-6 cursor-pointer transition-all hover:scale-105 ${h===dt.id?"ring-2 ring-primary bg-primary/5":""}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[dt.image&&jsxRuntimeExports.jsx("div",{className:"w-16 h-16 rounded-xl bg-muted flex items-center justify-center",children:jsxRuntimeExports.jsx("span",{className:"text-4xl",children:""})}),jsxRuntimeExports.jsx("span",{className:"text-3xl font-bold",children:dt.text})]})},dt.id))}),jsxRuntimeExports.jsx(Button,{onClick:ct,disabled:!h,className:"w-full h-14 text-lg rounded-2xl bg-gradient-to-r from-primary to-secondary",children:s<assessmentQuestions.length-1?"Next ":"Finish"})]})]})},vocabularyData={greetings:[{id:"greet-1",hindi:"",english:"Hello",romanization:"Namaste",imageUrl:"/assets/vocab/hello.png",audioUrl:"/assets/audio/namaste.mp3",category:"greetings"},{id:"greet-2",hindi:"",english:"Thank you",romanization:"Dhanyavaad",imageUrl:"/assets/vocab/thankyou.png",audioUrl:"/assets/audio/dhanyavaad.mp3",category:"greetings"},{id:"greet-3",hindi:"",english:"Goodbye",romanization:"Alvida",imageUrl:"/assets/vocab/goodbye.png",audioUrl:"/assets/audio/alvida.mp3",category:"greetings"}],numbers:[{id:"num-1",hindi:"",english:"One",romanization:"Ek",imageUrl:"/assets/vocab/one.png",audioUrl:"/assets/audio/ek.mp3",category:"numbers"},{id:"num-2",hindi:"",english:"Two",romanization:"Do",imageUrl:"/assets/vocab/two.png",audioUrl:"/assets/audio/do.mp3",category:"numbers"},{id:"num-3",hindi:"",english:"Three",romanization:"Teen",imageUrl:"/assets/vocab/three.png",audioUrl:"/assets/audio/teen.mp3",category:"numbers"},{id:"num-4",hindi:"",english:"Four",romanization:"Chaar",imageUrl:"/assets/vocab/four.png",audioUrl:"/assets/audio/chaar.mp3",category:"numbers"},{id:"num-5",hindi:"",english:"Five",romanization:"Paanch",imageUrl:"/assets/vocab/five.png",audioUrl:"/assets/audio/paanch.mp3",category:"numbers"}],family:[{id:"fam-1",hindi:"",english:"Mother",romanization:"Maa",imageUrl:"/assets/vocab/mother.png",audioUrl:"/assets/audio/maa.mp3",category:"family"},{id:"fam-2",hindi:"",english:"Father",romanization:"Pita",imageUrl:"/assets/vocab/father.png",audioUrl:"/assets/audio/pita.mp3",category:"family"},{id:"fam-3",hindi:"",english:"Brother",romanization:"Bhai",imageUrl:"/assets/vocab/brother.png",audioUrl:"/assets/audio/bhai.mp3",category:"family"},{id:"fam-4",hindi:"",english:"Sister",romanization:"Bahan",imageUrl:"/assets/vocab/sister.png",audioUrl:"/assets/audio/bahan.mp3",category:"family"}],animals:[{id:"anim-1",hindi:"",english:"Cat",romanization:"Billi",imageUrl:"/assets/vocab/cat.png",audioUrl:"/assets/audio/billi.mp3",category:"animals"},{id:"anim-2",hindi:"",english:"Dog",romanization:"Kutta",imageUrl:"/assets/vocab/dog.png",audioUrl:"/assets/audio/kutta.mp3",category:"animals"},{id:"anim-3",hindi:"",english:"Cow",romanization:"Gaay",imageUrl:"/assets/vocab/cow.png",audioUrl:"/assets/audio/gaay.mp3",category:"animals"},{id:"anim-4",hindi:"",english:"Elephant",romanization:"Haathi",imageUrl:"/assets/vocab/elephant.png",audioUrl:"/assets/audio/haathi.mp3",category:"animals"}],food:[{id:"food-1",hindi:"",english:"Bread",romanization:"Roti",imageUrl:"/assets/vocab/bread.png",audioUrl:"/assets/audio/roti.mp3",category:"food"},{id:"food-2",hindi:"",english:"Water",romanization:"Paani",imageUrl:"/assets/vocab/water.png",audioUrl:"/assets/audio/paani.mp3",category:"food"},{id:"food-3",hindi:"",english:"Milk",romanization:"Doodh",imageUrl:"/assets/vocab/milk.png",audioUrl:"/assets/audio/doodh.mp3",category:"food"},{id:"food-4",hindi:"",english:"Rice",romanization:"Chawal",imageUrl:"/assets/vocab/rice.png",audioUrl:"/assets/audio/chawal.mp3",category:"food"}],school:[{id:"sch-1",hindi:"",english:"Book",romanization:"Kitaab",imageUrl:"/assets/vocab/book.png",audioUrl:"/assets/audio/kitaab.mp3",category:"school"},{id:"sch-2",hindi:"",english:"Pencil",romanization:"Pencil",imageUrl:"/assets/vocab/pencil.png",audioUrl:"/assets/audio/pencil.mp3",category:"school"},{id:"sch-3",hindi:"",english:"School",romanization:"School",imageUrl:"/assets/vocab/school.png",audioUrl:"/assets/audio/school.mp3",category:"school"},{id:"sch-4",hindi:"",english:"Teacher",romanization:"Shikshak",imageUrl:"/assets/vocab/teacher.png",audioUrl:"/assets/audio/shikshak.mp3",category:"school"}],home:[{id:"home-1",hindi:"",english:"Home",romanization:"Ghar",imageUrl:"/assets/vocab/home.png",audioUrl:"/assets/audio/ghar.mp3",category:"home"},{id:"home-2",hindi:"",english:"Door",romanization:"Darwaaza",imageUrl:"/assets/vocab/door.png",audioUrl:"/assets/audio/darwaaza.mp3",category:"home"},{id:"home-3",hindi:"",english:"Window",romanization:"Khidki",imageUrl:"/assets/vocab/window.png",audioUrl:"/assets/audio/khidki.mp3",category:"home"},{id:"home-4",hindi:"",english:"Bed",romanization:"Bistar",imageUrl:"/assets/vocab/bed.png",audioUrl:"/assets/audio/bistar.mp3",category:"home"}]},categories=[{id:"greetings",name:"Greetings",nameHindi:"",icon:"",color:"from-blue-500/20 to-blue-600/20"},{id:"numbers",name:"Numbers",nameHindi:"",icon:"",color:"from-green-500/20 to-green-600/20"},{id:"family",name:"Family",nameHindi:"",icon:"",color:"from-purple-500/20 to-purple-600/20"},{id:"animals",name:"Animals",nameHindi:"",icon:"",color:"from-orange-500/20 to-orange-600/20"},{id:"food",name:"Food",nameHindi:" ",icon:"",color:"from-red-500/20 to-red-600/20"},{id:"school",name:"School",nameHindi:"",icon:"",color:"from-yellow-500/20 to-yellow-600/20"},{id:"home",name:"Home",nameHindi:"",icon:"",color:"from-pink-500/20 to-pink-600/20"}],PictureDictionary=()=>{const e=useNavigate(),[s,i]=reactExports.useState(null),[c,d]=reactExports.useState(null),h=(g,$)=>{const _e=new SpeechSynthesisUtterance(g);_e.lang=$==="hi"?"hi-IN":"en-US",_e.rate=.9,window.speechSynthesis.speak(_e)},_=g=>{d(g),h(g.hindi,"hi"),setTimeout(()=>h(g.english,"en"),1500)};if(s){const g=vocabularyData[s]||[],$=categories.find(_e=>_e.id===s);return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background via-background to-primary/5 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"max-w-6xl mx-auto mb-8",children:[jsxRuntimeExports.jsxs(Button,{variant:"ghost",size:"sm",onClick:()=>i(null),className:"mb-4 rounded-full hover:bg-muted",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back to Categories"]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:`w-16 h-16 rounded-2xl bg-gradient-to-br ${$==null?void 0:$.color} flex items-center justify-center text-3xl`,children:$==null?void 0:$.icon}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-foreground",children:$==null?void 0:$.name}),jsxRuntimeExports.jsx("p",{className:"text-xl text-muted-foreground",children:$==null?void 0:$.nameHindi})]})]})]}),jsxRuntimeExports.jsx("div",{className:"max-w-6xl mx-auto grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:g.map(_e=>jsxRuntimeExports.jsx(Card,{onClick:()=>_(_e),className:`p-6 cursor-pointer transition-all hover:scale-105 hover:shadow-lg ${(c==null?void 0:c.id)===_e.id?"ring-2 ring-primary bg-primary/5":""}`,children:jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsx("div",{className:"w-full aspect-square rounded-xl bg-gradient-to-br from-muted to-muted/50 flex items-center justify-center",children:jsxRuntimeExports.jsx("span",{className:"text-6xl",children:$==null?void 0:$.icon})}),jsxRuntimeExports.jsxs("div",{className:"text-center space-y-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx("h3",{className:"text-2xl font-bold text-foreground",children:_e.hindi}),jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"icon",className:"h-8 w-8 rounded-full",onClick:lt=>{lt.stopPropagation(),h(_e.hindi,"hi")},children:jsxRuntimeExports.jsx(Volume2,{className:"w-4 h-4 text-primary"})})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:_e.romanization}),jsxRuntimeExports.jsx("p",{className:"text-lg font-semibold text-foreground",children:_e.english})]})]})},_e.id))}),c&&jsxRuntimeExports.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-6 bg-background/95 backdrop-blur-lg border-t border-border",children:jsxRuntimeExports.jsxs("div",{className:"max-w-2xl mx-auto flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 rounded-xl bg-gradient-to-br from-primary/20 to-secondary/20 flex items-center justify-center text-3xl",children:$==null?void 0:$.icon}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-2xl font-bold text-foreground",children:c.hindi}),jsxRuntimeExports.jsxs("p",{className:"text-muted-foreground",children:[c.romanization,"  ",c.english]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",size:"icon",className:"rounded-full",onClick:()=>h(c.hindi,"hi"),children:jsxRuntimeExports.jsx(Volume2,{className:"w-5 h-5"})}),jsxRuntimeExports.jsx(Button,{variant:"outline",size:"icon",className:"rounded-full",onClick:()=>h(c.english,"en"),children:jsxRuntimeExports.jsx(Volume2,{className:"w-5 h-5"})})]})]})})]})}return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background via-background to-primary/5 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"max-w-6xl mx-auto mb-8",children:[jsxRuntimeExports.jsxs(Button,{variant:"ghost",size:"sm",onClick:()=>e("/subjects"),className:"mb-4 rounded-full hover:bg-muted",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]}),jsxRuntimeExports.jsxs("div",{className:"text-center space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"w-24 h-24 mx-auto rounded-3xl bg-gradient-to-br from-primary/10 to-secondary/10 flex items-center justify-center shadow-lg",children:jsxRuntimeExports.jsx(BookOpen,{className:"w-12 h-12 text-primary"})}),jsxRuntimeExports.jsx("h1",{className:"text-4xl font-bold text-foreground",children:"Picture Dictionary"}),jsxRuntimeExports.jsx("p",{className:"text-xl text-muted-foreground",children:" "}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground max-w-2xl mx-auto",children:"Tap any category to explore words with pictures and audio. Perfect for visual learners!"})]})]}),jsxRuntimeExports.jsx("div",{className:"max-w-6xl mx-auto grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:categories.map(g=>{var $;return jsxRuntimeExports.jsx(Card,{onClick:()=>i(g.id),className:"p-6 cursor-pointer transition-all hover:scale-105 hover:shadow-lg",children:jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("div",{className:`w-full aspect-square rounded-2xl bg-gradient-to-br ${g.color} flex items-center justify-center`,children:jsxRuntimeExports.jsx("span",{className:"text-6xl",children:g.icon})}),jsxRuntimeExports.jsxs("div",{className:"text-center space-y-1",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-foreground",children:g.name}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:g.nameHindi}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-muted-foreground",children:[(($=vocabularyData[g.id])==null?void 0:$.length)||0," words"]})]})]})},g.id)})})]})},hindiLessons=[{id:"hindi-1",title:"Greetings",titleHindi:"",description:"Learn basic Hindi greetings",descriptionHindi:"   ",language:"hi",level:1,vocabulary:vocabularyData.greetings,exercises:[{id:"ex-1",type:"vocab-viewer",instruction:"Learn these greeting words",instructionHindi:"    ",audioUrl:"/assets/audio/instructions/greetings.mp3",data:{words:vocabularyData.greetings}},{id:"ex-2",type:"matching",instruction:"Match Hindi words with English meanings",instructionHindi:"      ",audioUrl:"/assets/audio/instructions/match-greetings.mp3",data:{pairs:vocabularyData.greetings.map(e=>({left:e.hindi,right:e.english,id:e.id}))}}],unlocked:!0,completed:!1,bestScore:0},{id:"hindi-2",title:"Numbers 1-5",titleHindi:" 1-5",description:"Learn to count from 1 to 5 in Hindi",descriptionHindi:"  1  5   ",language:"hi",level:2,vocabulary:vocabularyData.numbers,exercises:[{id:"ex-3",type:"vocab-viewer",instruction:"Learn numbers 1 to 5",instructionHindi:"1  5    ",audioUrl:"/assets/audio/instructions/numbers.mp3",data:{words:vocabularyData.numbers}},{id:"ex-4",type:"matching",instruction:"Match numbers with their names",instructionHindi:"     ",audioUrl:"/assets/audio/instructions/match-numbers.mp3",data:{pairs:vocabularyData.numbers.map(e=>({left:e.hindi,right:e.english,id:e.id}))}}],unlocked:!1,completed:!1,bestScore:0},{id:"hindi-3",title:"Family Words",titleHindi:"  ",description:"Learn family member names in Hindi",descriptionHindi:"       ",language:"hi",level:3,vocabulary:vocabularyData.family,exercises:[{id:"ex-5",type:"vocab-viewer",instruction:"Learn family words",instructionHindi:"   ",audioUrl:"/assets/audio/instructions/family.mp3",data:{words:vocabularyData.family}},{id:"ex-6",type:"matching",instruction:"Match family members",instructionHindi:"    ",audioUrl:"/assets/audio/instructions/match-family.mp3",data:{pairs:vocabularyData.family.map(e=>({left:e.hindi,right:e.english,id:e.id}))}}],unlocked:!1,completed:!1,bestScore:0}],englishLessons=[{id:"english-1",title:"Animals",titleHindi:"",description:"Learn animal names in English",descriptionHindi:"     ",language:"en",level:1,vocabulary:vocabularyData.animals,exercises:[{id:"ex-7",type:"vocab-viewer",instruction:"Learn animal names",instructionHindi:"   ",audioUrl:"/assets/audio/instructions/animals.mp3",data:{words:vocabularyData.animals}},{id:"ex-8",type:"matching",instruction:"Match animals with their names",instructionHindi:"     ",audioUrl:"/assets/audio/instructions/match-animals.mp3",data:{pairs:vocabularyData.animals.map(e=>({left:e.english,right:e.hindi,id:e.id}))}}],unlocked:!0,completed:!1,bestScore:0},{id:"english-2",title:"Food Items",titleHindi:" ",description:"Learn food names in English",descriptionHindi:"      ",language:"en",level:2,vocabulary:vocabularyData.food,exercises:[{id:"ex-9",type:"vocab-viewer",instruction:"Learn food names",instructionHindi:"    ",audioUrl:"/assets/audio/instructions/food.mp3",data:{words:vocabularyData.food}},{id:"ex-10",type:"matching",instruction:"Match food items",instructionHindi:"   ",audioUrl:"/assets/audio/instructions/match-food.mp3",data:{pairs:vocabularyData.food.map(e=>({left:e.english,right:e.hindi,id:e.id}))}}],unlocked:!1,completed:!1,bestScore:0}],LessonsList=()=>{const e=useNavigate(),{language:s}=useParams(),[i,c]=reactExports.useState([]),[d,h]=reactExports.useState([]);reactExports.useEffect(()=>{const $=s==="hi"?hindiLessons:englishLessons;c($);const _e=localStorage.getItem("lessonProgress");if(_e){const at=JSON.parse(_e);h(at.completed||[])}if(localStorage.getItem("demoMode")==="true"){const at=$.map(it=>({...it,unlocked:!0,bestScore:5}));c(at)}},[s]);const _=$=>{($.unlocked||localStorage.getItem("demoMode")==="true")&&e(`/language-learning/lesson/${$.id}`)},g=()=>i.length===0?0:d.length/i.length*100;return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background via-background to-primary/5 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"max-w-4xl mx-auto mb-8",children:[jsxRuntimeExports.jsxs(Button,{variant:"ghost",size:"sm",onClick:()=>e("/language-learning"),className:"mb-4 rounded-full hover:bg-muted",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-20 h-20 rounded-3xl bg-gradient-to-br from-primary/10 to-secondary/10 flex items-center justify-center text-4xl",children:s==="hi"?"":""}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-foreground",children:s==="hi"?"Hindi Lessons":"English Lessons"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:s==="hi"?" ":" "})]})]}),jsxRuntimeExports.jsxs("div",{className:"p-4 bg-card rounded-xl border border-border space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold",children:"Your Progress"}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-muted-foreground",children:[d.length," / ",i.length," lessons"]})]}),jsxRuntimeExports.jsx(Progress,{value:g(),className:"h-2"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"max-w-4xl mx-auto space-y-4",children:i.map(($,_e)=>{const lt=d.includes($.id),at=!$.unlocked&&localStorage.getItem("demoMode")!=="true";return jsxRuntimeExports.jsx(Card,{onClick:()=>_($),className:`p-6 transition-all ${at?"opacity-50 cursor-not-allowed":"cursor-pointer hover:scale-105 hover:shadow-lg"} ${lt?"bg-success/5 border-success/20":""}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center text-2xl font-bold ${lt?"bg-success/20 text-success":at?"bg-muted text-muted-foreground":"bg-gradient-to-br from-primary/20 to-secondary/20 text-primary"}`,children:at?jsxRuntimeExports.jsx(Lock,{className:"w-6 h-6"}):lt?jsxRuntimeExports.jsx(Check,{className:"w-6 h-6"}):_e+1}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-foreground",children:$.title}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:$.titleHindi}),jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:$.description})]}),$.bestScore>0&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1 text-yellow-500",children:[jsxRuntimeExports.jsx(Star,{className:"w-5 h-5 fill-current"}),jsxRuntimeExports.jsx("span",{className:"font-bold",children:$.bestScore})]})]})},$.id)})}),localStorage.getItem("demoMode")==="true"&&jsxRuntimeExports.jsx("div",{className:"fixed bottom-4 right-4 p-4 bg-yellow-500/20 border border-yellow-500/50 rounded-xl",children:jsxRuntimeExports.jsx("p",{className:"text-sm font-semibold text-yellow-700 dark:text-yellow-300",children:" Demo Mode Active - All lessons unlocked"})})]})};var module={};(function e(s,i,c,d){var h=!!(s.Worker&&s.Blob&&s.Promise&&s.OffscreenCanvas&&s.OffscreenCanvasRenderingContext2D&&s.HTMLCanvasElement&&s.HTMLCanvasElement.prototype.transferControlToOffscreen&&s.URL&&s.URL.createObjectURL),_=typeof Path2D=="function"&&typeof DOMMatrix=="function",g=function(){if(!s.OffscreenCanvas)return!1;try{var fn=new OffscreenCanvas(1,1),or=fn.getContext("2d");or.fillRect(0,0,1,1);var lr=fn.transferToImageBitmap();or.createPattern(lr,"no-repeat")}catch{return!1}return!0}();function $(){}function _e(fn){var or=i.exports.Promise,lr=or!==void 0?or:s.Promise;return typeof lr=="function"?new lr(fn):(fn($,$),null)}var lt=function(fn,or){return{transform:function(lr){if(fn)return lr;if(or.has(lr))return or.get(lr);var pn=new OffscreenCanvas(lr.width,lr.height),Cn=pn.getContext("2d");return Cn.drawImage(lr,0,0),or.set(lr,pn),pn},clear:function(){or.clear()}}}(g,new Map),at=function(){var fn=Math.floor(16.666666666666668),or,lr,pn={},Cn=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(or=function(Lo){var Mo=Math.random();return pn[Mo]=requestAnimationFrame(function Ro(qo){Cn===qo||Cn+fn-1<qo?(Cn=qo,delete pn[Mo],Lo()):pn[Mo]=requestAnimationFrame(Ro)}),Mo},lr=function(Lo){pn[Lo]&&cancelAnimationFrame(pn[Lo])}):(or=function(Lo){return setTimeout(Lo,fn)},lr=function(Lo){return clearTimeout(Lo)}),{frame:or,cancel:lr}}(),it=function(){var fn,or,lr={};function pn(Cn){function Lo(Mo,Ro){Cn.postMessage({options:Mo||{},callback:Ro})}Cn.init=function(Ro){var qo=Ro.transferControlToOffscreen();Cn.postMessage({canvas:qo},[qo])},Cn.fire=function(Ro,qo,tp){if(or)return Lo(Ro,null),or;var Wo=Math.random().toString(36).slice(2);return or=_e(function(En){function mr(Do){Do.data.callback===Wo&&(delete lr[Wo],Cn.removeEventListener("message",mr),or=null,lt.clear(),tp(),En())}Cn.addEventListener("message",mr),Lo(Ro,Wo),lr[Wo]=mr.bind(null,{data:{callback:Wo}})}),or},Cn.reset=function(){Cn.postMessage({reset:!0});for(var Ro in lr)lr[Ro](),delete lr[Ro]}}return function(){if(fn)return fn;if(!c&&h){var Cn=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{fn=new Worker(URL.createObjectURL(new Blob([Cn])))}catch(Lo){return typeof console<"u"&&typeof console.warn=="function"&&console.warn(" Could not load worker",Lo),null}pn(fn)}return fn}}(),ct={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function mt(fn,or){return or?or(fn):fn}function pt(fn){return fn!=null}function zt(fn,or,lr){return mt(fn&&pt(fn[or])?fn[or]:ct[or],lr)}function dt(fn){return fn<0?0:Math.floor(fn)}function ft(fn,or){return Math.floor(Math.random()*(or-fn))+fn}function kt(fn){return parseInt(fn,16)}function St(fn){return fn.map(Lt)}function Lt(fn){var or=String(fn).replace(/[^0-9a-f]/gi,"");return or.length<6&&(or=or[0]+or[0]+or[1]+or[1]+or[2]+or[2]),{r:kt(or.substring(0,2)),g:kt(or.substring(2,4)),b:kt(or.substring(4,6))}}function Gt(fn){var or=zt(fn,"origin",Object);return or.x=zt(or,"x",Number),or.y=zt(or,"y",Number),or}function Bt(fn){fn.width=document.documentElement.clientWidth,fn.height=document.documentElement.clientHeight}function nr(fn){var or=fn.getBoundingClientRect();fn.width=or.width,fn.height=or.height}function cr(fn){var or=document.createElement("canvas");return or.style.position="fixed",or.style.top="0px",or.style.left="0px",or.style.pointerEvents="none",or.style.zIndex=fn,or}function ur(fn,or,lr,pn,Cn,Lo,Mo,Ro,qo){fn.save(),fn.translate(or,lr),fn.rotate(Lo),fn.scale(pn,Cn),fn.arc(0,0,1,Mo,Ro,qo),fn.restore()}function yn(fn){var or=fn.angle*(Math.PI/180),lr=fn.spread*(Math.PI/180);return{x:fn.x,y:fn.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:fn.startVelocity*.5+Math.random()*fn.startVelocity,angle2D:-or+(.5*lr-Math.random()*lr),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:fn.color,shape:fn.shape,tick:0,totalTicks:fn.ticks,decay:fn.decay,drift:fn.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:fn.gravity*3,ovalScalar:.6,scalar:fn.scalar,flat:fn.flat}}function hn(fn,or){or.x+=Math.cos(or.angle2D)*or.velocity+or.drift,or.y+=Math.sin(or.angle2D)*or.velocity+or.gravity,or.velocity*=or.decay,or.flat?(or.wobble=0,or.wobbleX=or.x+10*or.scalar,or.wobbleY=or.y+10*or.scalar,or.tiltSin=0,or.tiltCos=0,or.random=1):(or.wobble+=or.wobbleSpeed,or.wobbleX=or.x+10*or.scalar*Math.cos(or.wobble),or.wobbleY=or.y+10*or.scalar*Math.sin(or.wobble),or.tiltAngle+=.1,or.tiltSin=Math.sin(or.tiltAngle),or.tiltCos=Math.cos(or.tiltAngle),or.random=Math.random()+2);var lr=or.tick++/or.totalTicks,pn=or.x+or.random*or.tiltCos,Cn=or.y+or.random*or.tiltSin,Lo=or.wobbleX+or.random*or.tiltCos,Mo=or.wobbleY+or.random*or.tiltSin;if(fn.fillStyle="rgba("+or.color.r+", "+or.color.g+", "+or.color.b+", "+(1-lr)+")",fn.beginPath(),_&&or.shape.type==="path"&&typeof or.shape.path=="string"&&Array.isArray(or.shape.matrix))fn.fill(kn(or.shape.path,or.shape.matrix,or.x,or.y,Math.abs(Lo-pn)*.1,Math.abs(Mo-Cn)*.1,Math.PI/10*or.wobble));else if(or.shape.type==="bitmap"){var Ro=Math.PI/10*or.wobble,qo=Math.abs(Lo-pn)*.1,tp=Math.abs(Mo-Cn)*.1,Wo=or.shape.bitmap.width*or.scalar,En=or.shape.bitmap.height*or.scalar,mr=new DOMMatrix([Math.cos(Ro)*qo,Math.sin(Ro)*qo,-Math.sin(Ro)*tp,Math.cos(Ro)*tp,or.x,or.y]);mr.multiplySelf(new DOMMatrix(or.shape.matrix));var Do=fn.createPattern(lt.transform(or.shape.bitmap),"no-repeat");Do.setTransform(mr),fn.globalAlpha=1-lr,fn.fillStyle=Do,fn.fillRect(or.x-Wo/2,or.y-En/2,Wo,En),fn.globalAlpha=1}else if(or.shape==="circle")fn.ellipse?fn.ellipse(or.x,or.y,Math.abs(Lo-pn)*or.ovalScalar,Math.abs(Mo-Cn)*or.ovalScalar,Math.PI/10*or.wobble,0,2*Math.PI):ur(fn,or.x,or.y,Math.abs(Lo-pn)*or.ovalScalar,Math.abs(Mo-Cn)*or.ovalScalar,Math.PI/10*or.wobble,0,2*Math.PI);else if(or.shape==="star")for(var Go=Math.PI/2*3,Jo=4*or.scalar,_i=8*or.scalar,Ho=or.x,_c=or.y,Qo=5,ep=Math.PI/Qo;Qo--;)Ho=or.x+Math.cos(Go)*_i,_c=or.y+Math.sin(Go)*_i,fn.lineTo(Ho,_c),Go+=ep,Ho=or.x+Math.cos(Go)*Jo,_c=or.y+Math.sin(Go)*Jo,fn.lineTo(Ho,_c),Go+=ep;else fn.moveTo(Math.floor(or.x),Math.floor(or.y)),fn.lineTo(Math.floor(or.wobbleX),Math.floor(Cn)),fn.lineTo(Math.floor(Lo),Math.floor(Mo)),fn.lineTo(Math.floor(pn),Math.floor(or.wobbleY));return fn.closePath(),fn.fill(),or.tick<or.totalTicks}function _n(fn,or,lr,pn,Cn){var Lo=or.slice(),Mo=fn.getContext("2d"),Ro,qo,tp=_e(function(Wo){function En(){Ro=qo=null,Mo.clearRect(0,0,pn.width,pn.height),lt.clear(),Cn(),Wo()}function mr(){c&&!(pn.width===d.width&&pn.height===d.height)&&(pn.width=fn.width=d.width,pn.height=fn.height=d.height),!pn.width&&!pn.height&&(lr(fn),pn.width=fn.width,pn.height=fn.height),Mo.clearRect(0,0,pn.width,pn.height),Lo=Lo.filter(function(Do){return hn(Mo,Do)}),Lo.length?Ro=at.frame(mr):En()}Ro=at.frame(mr),qo=En});return{addFettis:function(Wo){return Lo=Lo.concat(Wo),tp},canvas:fn,promise:tp,reset:function(){Ro&&at.cancel(Ro),qo&&qo()}}}function gn(fn,or){var lr=!fn,pn=!!zt(or||{},"resize"),Cn=!1,Lo=zt(or,"disableForReducedMotion",Boolean),Mo=h&&!!zt(or||{},"useWorker"),Ro=Mo?it():null,qo=lr?Bt:nr,tp=fn&&Ro?!!fn.__confetti_initialized:!1,Wo=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,En;function mr(Go,Jo,_i){for(var Ho=zt(Go,"particleCount",dt),_c=zt(Go,"angle",Number),Qo=zt(Go,"spread",Number),ep=zt(Go,"startVelocity",Number),lp=zt(Go,"decay",Number),_p=zt(Go,"gravity",Number),Zo=zt(Go,"drift",Number),bp=zt(Go,"colors",St),gp=zt(Go,"ticks",Number),Mp=zt(Go,"shapes"),wp=zt(Go,"scalar"),ip=!!zt(Go,"flat"),fp=Gt(Go),Rp=Ho,Ap=[],u_=fn.width*fp.x,Ip=fn.height*fp.y;Rp--;)Ap.push(yn({x:u_,y:Ip,angle:_c,spread:Qo,startVelocity:ep,color:bp[Rp%bp.length],shape:Mp[ft(0,Mp.length)],ticks:gp,decay:lp,gravity:_p,drift:Zo,scalar:wp,flat:ip}));return En?En.addFettis(Ap):(En=_n(fn,Ap,qo,Jo,_i),En.promise)}function Do(Go){var Jo=Lo||zt(Go,"disableForReducedMotion",Boolean),_i=zt(Go,"zIndex",Number);if(Jo&&Wo)return _e(function(ep){ep()});lr&&En?fn=En.canvas:lr&&!fn&&(fn=cr(_i),document.body.appendChild(fn)),pn&&!tp&&qo(fn);var Ho={width:fn.width,height:fn.height};Ro&&!tp&&Ro.init(fn),tp=!0,Ro&&(fn.__confetti_initialized=!0);function _c(){if(Ro){var ep={getBoundingClientRect:function(){if(!lr)return fn.getBoundingClientRect()}};qo(ep),Ro.postMessage({resize:{width:ep.width,height:ep.height}});return}Ho.width=Ho.height=null}function Qo(){En=null,pn&&(Cn=!1,s.removeEventListener("resize",_c)),lr&&fn&&(document.body.contains(fn)&&document.body.removeChild(fn),fn=null,tp=!1)}return pn&&!Cn&&(Cn=!0,s.addEventListener("resize",_c,!1)),Ro?Ro.fire(Go,Ho,Qo):mr(Go,Ho,Qo)}return Do.reset=function(){Ro&&Ro.reset(),En&&En.reset()},Do}var vn;function Tn(){return vn||(vn=gn(null,{useWorker:!0,resize:!0})),vn}function kn(fn,or,lr,pn,Cn,Lo,Mo){var Ro=new Path2D(fn),qo=new Path2D;qo.addPath(Ro,new DOMMatrix(or));var tp=new Path2D;return tp.addPath(qo,new DOMMatrix([Math.cos(Mo)*Cn,Math.sin(Mo)*Cn,-Math.sin(Mo)*Lo,Math.cos(Mo)*Lo,lr,pn])),tp}function bn(fn){if(!_)throw new Error("path confetti are not supported in this browser");var or,lr;typeof fn=="string"?or=fn:(or=fn.path,lr=fn.matrix);var pn=new Path2D(or),Cn=document.createElement("canvas"),Lo=Cn.getContext("2d");if(!lr){for(var Mo=1e3,Ro=Mo,qo=Mo,tp=0,Wo=0,En,mr,Do=0;Do<Mo;Do+=2)for(var Go=0;Go<Mo;Go+=2)Lo.isPointInPath(pn,Do,Go,"nonzero")&&(Ro=Math.min(Ro,Do),qo=Math.min(qo,Go),tp=Math.max(tp,Do),Wo=Math.max(Wo,Go));En=tp-Ro,mr=Wo-qo;var Jo=10,_i=Math.min(Jo/En,Jo/mr);lr=[_i,0,0,_i,-Math.round(En/2+Ro)*_i,-Math.round(mr/2+qo)*_i]}return{type:"path",path:or,matrix:lr}}function Sn(fn){var or,lr=1,pn="#000000",Cn='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof fn=="string"?or=fn:(or=fn.text,lr="scalar"in fn?fn.scalar:lr,Cn="fontFamily"in fn?fn.fontFamily:Cn,pn="color"in fn?fn.color:pn);var Lo=10*lr,Mo=""+Lo+"px "+Cn,Ro=new OffscreenCanvas(Lo,Lo),qo=Ro.getContext("2d");qo.font=Mo;var tp=qo.measureText(or),Wo=Math.ceil(tp.actualBoundingBoxRight+tp.actualBoundingBoxLeft),En=Math.ceil(tp.actualBoundingBoxAscent+tp.actualBoundingBoxDescent),mr=2,Do=tp.actualBoundingBoxLeft+mr,Go=tp.actualBoundingBoxAscent+mr;Wo+=mr+mr,En+=mr+mr,Ro=new OffscreenCanvas(Wo,En),qo=Ro.getContext("2d"),qo.font=Mo,qo.fillStyle=pn,qo.fillText(or,Do,Go);var Jo=1/lr;return{type:"bitmap",bitmap:Ro.transferToImageBitmap(),matrix:[Jo,0,0,Jo,-Wo*Jo/2,-En*Jo/2]}}i.exports=function(){return Tn().apply(this,arguments)},i.exports.reset=function(){Tn().reset()},i.exports.create=gn,i.exports.shapeFromPath=bn,i.exports.shapeFromText=Sn})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),module,!1);const confetti=module.exports;module.exports.create;const LessonView=()=>{const e=useNavigate(),{lessonId:s}=useParams(),[i,c]=reactExports.useState(null),[d,h]=reactExports.useState(0),[_,g]=reactExports.useState("vocab-viewer"),[$,_e]=reactExports.useState(0),[lt,at]=reactExports.useState([]),[it,ct]=reactExports.useState(null),[mt,pt]=reactExports.useState(null),[zt,dt]=reactExports.useState([]),[ft,kt]=reactExports.useState(0),[St,Lt]=reactExports.useState(!1);reactExports.useEffect(()=>{const vn=[...hindiLessons,...englishLessons].find(Tn=>Tn.id===s);vn&&(c(vn),vn.exercises.length>0&&(g(vn.exercises[0].type),vn.exercises[0].type==="matching"&&Gt(vn.exercises[0].data.pairs)))},[s]);const Gt=gn=>{const vn=[...gn].sort(()=>Math.random()-.5),Tn=[...gn].sort(()=>Math.random()-.5);at(gn.map((kn,bn)=>({left:vn[bn].left,right:Tn[bn].right,id:kn.id})))},Bt=(gn,vn)=>{const Tn=new SpeechSynthesisUtterance(gn);Tn.lang=vn==="hi"?"hi-IN":"en-US",Tn.rate=.9,window.speechSynthesis.speak(Tn)},nr=()=>{if(i&&$<i.vocabulary.length-1)_e($+1);else if(i&&d<i.exercises.length-1){const gn=i.exercises[d+1];h(d+1),g(gn.type),_e(0),gn.type==="matching"&&Gt(gn.data.pairs)}else yn()},cr=(gn,vn)=>{vn==="left"?(ct(gn),mt&&ur(gn,mt)):(pt(gn),it&&ur(it,gn))},ur=(gn,vn)=>{const Tn=lt.find(kn=>kn.left===gn&&kn.right===vn);Tn&&!zt.includes(Tn.id)?(dt([...zt,Tn.id]),kt(ft+1),confetti({particleCount:50,spread:60,origin:{y:.6}}),Bt("Correct!","en")):Bt("Try again","en"),ct(null),pt(null),zt.length+1===lt.length&&setTimeout(()=>{i&&d<i.exercises.length-1?(h(d+1),dt([])):yn()},1500)},yn=()=>{const gn=JSON.parse(localStorage.getItem("lessonProgress")||'{"completed":[]}');gn.completed.includes(s)||(gn.completed.push(s),localStorage.setItem("lessonProgress",JSON.stringify(gn))),i&&Math.max(i.bestScore,ft),Lt(!0),confetti({particleCount:100,spread:70,origin:{y:.6}})};if(!i)return jsxRuntimeExports.jsx("div",{className:"min-h-screen flex items-center justify-center",children:jsxRuntimeExports.jsx("p",{children:"Loading lesson..."})});if(St)return jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-b from-background via-background to-primary/5 p-6 flex items-center justify-center",children:jsxRuntimeExports.jsxs(Card,{className:"max-w-2xl w-full p-8 space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"w-24 h-24 mx-auto rounded-full bg-gradient-to-br from-success/20 to-success/10 flex items-center justify-center",children:jsxRuntimeExports.jsx(Trophy,{className:"w-12 h-12 text-success"})}),jsxRuntimeExports.jsx("h2",{className:"text-4xl font-bold text-foreground",children:"Lesson Complete! "}),jsxRuntimeExports.jsx("p",{className:"text-xl text-muted-foreground",children:"  !"}),jsxRuntimeExports.jsxs("div",{className:"text-6xl font-bold text-primary",children:[ft," / ",i.vocabulary.length]}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Words Mastered"})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-4",children:[jsxRuntimeExports.jsx(Button,{onClick:()=>e(`/language-learning/lessons/${i.language}`),variant:"outline",className:"flex-1 h-14 text-lg rounded-2xl",children:"Back to Lessons"}),jsxRuntimeExports.jsx(Button,{onClick:()=>window.location.reload(),className:"flex-1 h-14 text-lg rounded-2xl bg-gradient-to-r from-primary to-secondary",children:"Practice Again"})]})]})});if(_==="vocab-viewer"){const gn=i.vocabulary[$];return jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-b from-background via-background to-primary/5 p-6",children:jsxRuntimeExports.jsxs("div",{className:"max-w-2xl mx-auto",children:[jsxRuntimeExports.jsxs(Button,{variant:"ghost",size:"sm",onClick:()=>e(`/language-learning/lessons/${i.language}`),className:"mb-4 rounded-full hover:bg-muted",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]}),jsxRuntimeExports.jsxs("div",{className:"mb-8 text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:i.title}),jsxRuntimeExports.jsxs("p",{className:"text-muted-foreground",children:["Word ",$+1," of ",i.vocabulary.length]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-8 space-y-6",children:[jsxRuntimeExports.jsx("div",{className:"w-full aspect-square max-w-md mx-auto rounded-3xl bg-gradient-to-br from-primary/10 to-secondary/10 flex items-center justify-center",children:jsxRuntimeExports.jsxs("span",{className:"text-9xl",children:[gn.category==="animals"&&"",gn.category==="food"&&"",gn.category==="family"&&"",gn.category==="greetings"&&"",gn.category==="numbers"&&"",gn.category==="school"&&"",gn.category==="home"&&""]})}),jsxRuntimeExports.jsxs("div",{className:"text-center space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx("h3",{className:"text-5xl font-bold text-foreground",children:gn.hindi}),jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"icon",className:"rounded-full",onClick:()=>Bt(gn.hindi,"hi"),children:jsxRuntimeExports.jsx(Volume2,{className:"w-6 h-6 text-primary"})})]}),jsxRuntimeExports.jsx("p",{className:"text-2xl text-muted-foreground",children:gn.romanization})]}),jsxRuntimeExports.jsx("div",{className:"pt-4 border-t border-border",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx("h4",{className:"text-3xl font-bold text-foreground",children:gn.english}),jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"icon",className:"rounded-full",onClick:()=>Bt(gn.english,"en"),children:jsxRuntimeExports.jsx(Volume2,{className:"w-6 h-6 text-primary"})})]})})]}),jsxRuntimeExports.jsx(Button,{onClick:nr,className:"w-full h-14 text-lg rounded-2xl bg-gradient-to-r from-primary to-secondary",children:$<i.vocabulary.length-1?"Next Word ":"Start Practice "})]})]})})}const hn=lt.map(gn=>gn.left),_n=lt.map(gn=>gn.right);return jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-b from-background via-background to-primary/5 p-6",children:jsxRuntimeExports.jsxs("div",{className:"max-w-4xl mx-auto",children:[jsxRuntimeExports.jsxs(Button,{variant:"ghost",size:"sm",onClick:()=>e(`/language-learning/lessons/${i.language}`),className:"mb-4 rounded-full hover:bg-muted",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]}),jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:"Match the Words"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Tap a word on the left, then tap its match on the right"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Score: ",zt.length," / ",lt.length]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[jsxRuntimeExports.jsx("div",{className:"space-y-3",children:hn.map((gn,vn)=>{const Tn=lt.find(Sn=>Sn.left===gn),kn=Tn&&zt.includes(Tn.id),bn=it===gn;return jsxRuntimeExports.jsx(Card,{onClick:()=>!kn&&cr(gn,"left"),className:`p-4 cursor-pointer transition-all ${kn?"opacity-50 bg-success/10 border-success":bn?"ring-2 ring-primary bg-primary/5 scale-105":"hover:scale-105"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl font-bold",children:gn}),kn&&jsxRuntimeExports.jsx(Check,{className:"w-5 h-5 text-success"})]})},vn)})}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:_n.map((gn,vn)=>{const Tn=lt.find(Sn=>Sn.right===gn),kn=Tn&&zt.includes(Tn.id),bn=mt===gn;return jsxRuntimeExports.jsx(Card,{onClick:()=>!kn&&cr(gn,"right"),className:`p-4 cursor-pointer transition-all ${kn?"opacity-50 bg-success/10 border-success":bn?"ring-2 ring-primary bg-primary/5 scale-105":"hover:scale-105"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl font-bold",children:gn}),kn&&jsxRuntimeExports.jsx(Check,{className:"w-5 h-5 text-success"})]})},vn)})})]})]})})},queryClient=new QueryClient,App=()=>jsxRuntimeExports.jsx(QueryClientProvider,{client:queryClient,children:jsxRuntimeExports.jsx(LanguageProvider,{children:jsxRuntimeExports.jsxs(TooltipProvider,{children:[jsxRuntimeExports.jsx(Toaster$1,{}),jsxRuntimeExports.jsx(Toaster,{}),jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsx(ModelLoadingWrapper,{children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(ClassSelection,{})}),jsxRuntimeExports.jsx(Route,{path:"/subjects",element:jsxRuntimeExports.jsx(Subjects,{})}),jsxRuntimeExports.jsx(Route,{path:"/chat",element:jsxRuntimeExports.jsx(Chat,{})}),jsxRuntimeExports.jsx(Route,{path:"/science-chapters",element:jsxRuntimeExports.jsx(ScienceChapters,{})}),jsxRuntimeExports.jsx(Route,{path:"/maths-chapters",element:jsxRuntimeExports.jsx(MathsChapters,{})}),jsxRuntimeExports.jsx(Route,{path:"/language-learning",element:jsxRuntimeExports.jsx(LanguageLearningHub,{})}),jsxRuntimeExports.jsx(Route,{path:"/language-learning/select",element:jsxRuntimeExports.jsx(LanguageSelect,{})}),jsxRuntimeExports.jsx(Route,{path:"/language-learning/assessment",element:jsxRuntimeExports.jsx(LiteracyAssessment,{})}),jsxRuntimeExports.jsx(Route,{path:"/language-learning/dictionary",element:jsxRuntimeExports.jsx(PictureDictionary,{})}),jsxRuntimeExports.jsx(Route,{path:"/language-learning/lessons/:language",element:jsxRuntimeExports.jsx(LessonsList,{})}),jsxRuntimeExports.jsx(Route,{path:"/language-learning/lesson/:lessonId",element:jsxRuntimeExports.jsx(LessonView,{})}),jsxRuntimeExports.jsx(Route,{path:"*",element:jsxRuntimeExports.jsx(NotFound,{})})]})})})]})})});createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(App,{}));
